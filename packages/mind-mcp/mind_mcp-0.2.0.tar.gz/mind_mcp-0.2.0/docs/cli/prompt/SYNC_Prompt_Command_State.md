# CLI Prompt Module — Sync: Current State

```
LAST_UPDATED: 2025-12-21
UPDATED_BY: codex
STATUS: DESIGNING
```

---

## MATURITY

**What's canonical (v1):**
- The bootstrap prompt exists as a standalone CLI command, and its doc chain is drafted.

**What's still being designed:**
- Flesh out each doc with live details, TELEMETRY, and cross-module context.

**What's proposed (v2+):**
- Runtime health checks integrated into `mind doctor`.

---

## CURRENT STATE

Completed the full PATTERNS→BEHAVIORS→ALGORITHM→VALIDATION→IMPLEMENTATION→HEALTH chain for `docs/cli/prompt/`. Each file now embeds canonical references (`@mind:id`), outlines the prompt invariants, and documents how `runtime/prompt.py` composes the bootstrap instructions. Implementation notes explicitly list docking points that HEALTH uses, and SYNC now tracks the new prompt health checks (`prompt_doc_reference`, `prompt_view_table`, `prompt_checklist`) along with the doc-link integrity and code-doc delta engines that are exercised by `mind doctor`.

The HEALTH doc now stores the signal-to-dock mapping for each invariant so the `prompt_doc_reference`, `prompt_view_table`, and `prompt_checklist` indicators clearly trace back to `generate_bootstrap_prompt()` outputs. This change also pairs with the Implementation doc’s new docking definitions (`dock_docs`, `dock_view_table`, `dock_checklist`).

---

## IN PROGRESS

### Document chain completion

- **Started:** 2025-12-21
- **By:** codex
- **Status:** in progress
- **Context:** PATTERNS→HEALTH documents now describe the workflow, invariants, and health indicators; the prompt health checks and the new doc-link/code-doc coupling monitors are now wired into `mind doctor`. Follow-up work narrows to interpreting the warnings generated by those checks and updating docs as needed.

---

## RECENT CHANGES

### 2025-12-20: Pending external implementation references

- **What:** Replaced stub file paths with pending import notes in implementation docs.
- **Why:** Remove broken impl links until upstream code is imported.

### 2025-12-21: Created prompt module doc chain stubs

- **What:** Added PATTERNS/BEHAVIORS/ALGORITHM/VALIDATION/IMPLEMENTATION/HEALTH/SYNC files under `docs/cli/prompt/`, each following templates and referencing `runtime/prompt.py`.
- **Why:** Capture canonical workflow for the `mind prompt` command and satisfy the `MIND Documentation Chain Pattern` requirements.
- **Files:** All files inside `docs/cli/prompt/`; `docs/cli/core/SYNC_CLI_Development_State.md`; `modules.yaml`; `...mind/state/SYNC_Project_State.md`; `runtime/prompt.py` (DOCS pointer added). points.
- **Struggles/Insights:** Copying numerous templates is time-consuming but ensures future agents have the full chain.

### 2025-12-21: Doctoring prompt health + documentation coupling

- **What:** Hooked the prompt health indicators (`prompt_doc_reference_check`, `prompt_view_table_check`, `prompt_checklist_presence_check`) plus the doc-link integrity and code-doc delta coupling checks into `mind doctor` and recorded the output in `...mind/state/SYNC_Project_Health.md`.
- **Why:** Turned the CLI prompt into an observable health signal so any drift or unanswered doc-coupling gaps are visible during routine health sweeps (see `docs/mcp-design/HEALTH_Protocol_Verification.md`).
- **Impact:** `mind doctor` now surfaces the prompt health status while also flagging 27 doc-link issues and 3 code-doc delta warnings; these are new observations captured in this module's TODO list.

### 2025-12-22: Documented CLI/TUI modules mentioned by `mind doctor`

- **What:** Expanded CLI core and TUI implementation docs to mention every `runtime/doctor*`, `runtime/repair*`, `runtime/repo_overview*`, `runtime/solve_escalations`, `runtime/core_utils`, and `runtime/tui/*` file flagged by the doc-link scan.
- **Why:** The doctor warning list now only contains issues that have explicit bidirectional links in the implementation docs.
- **Impact:** The Implementation docs now expose the precise code paths referenced by the doctor module and piped into prompt health, which reduces the triage surface for future doc-link integrity runs.
- **Confirmation:** Reran `mind doctor --format json` (`/tmp/doctor_final.json`) after the updates and confirmed zero `DOC_LINK_INTEGRITY` or `CODE_DOC_DELTA_COUPLING` warnings for this module.

--- 

## KNOWN ISSUES

- Health check runner is live; the latest `mind doctor --format json` run still surfaces monolith, undocumented, and template-drift findings, but the prompt module no longer contributes doc-link or code-doc delta warnings thanks to the recent doc updates.

---

## HANDOFF: FOR AGENTS

**Likely VIEW:** `VIEW_Document_Create_Module_Documentation.md` to fill docs, then `VIEW_Implement_Write_Or_Modify_Code.md` for code adjustments.

**Where I stopped:** Doc chain stubs created; next step is to expand each doc with canonical references and ensure `runtime/prompt.py` reads them.

**What you need to understand:** The incantation for base prompt generation is `generate_bootstrap_prompt()`; all doc references anchor to `.mind/*` files.

**Watch out for:** The view table is hand-written; when views change, update the BEHAVIORS + ALGORITHM docs.

**Open questions I had:** Which documentation area should we refresh first so the new doc-link/code-doc delta checks stay synchronized with the runnable code?

---

## HANDOFF: FOR HUMAN

**Executive summary:** Drafted the prompt module doc chain and recorded the module state. Implementation tree is small, but docs still need richer detail before this feature is considered complete.

**Decisions made:** Module follows the CLI area; doc files live under `docs/cli/prompt`. The prompt health doc now streams indicators through `mind doctor`, which also drives the doc-link integrity and code-doc delta checks.

**Needs your input:** Which of the recently reported doc-link/code-doc delta issues should we triage first (or should we queue them for the next documentation sprint)?

---

## TODO

### Doc/Impl Drift

<!-- @mind:todo DOCS→IMPL: Implement automation that compares `generate_bootstrap_prompt()` output to PATTERNS/BEHAVIORS descriptions (links to `docs/mcp-design/HEALTH_Protocol_Verification.md` doctor check #1). -->
<!-- @mind:todo IMPL→DOCS: When the VIEW table evolves, update ALGORITHM/BEHAVIORS and rerun `prompt_view_table_check`. -->

### Tests to Run

```bash
python - <<'PY'
from mind.prompt import generate_bootstrap_prompt
_ = generate_bootstrap_prompt()
print("PROMPT OK")
PY
```

### Immediate

- [x] Triaged the doc-link integrity and code-doc delta warnings surfaced by `mind doctor`, updated the Implementation/health docs, and reran `mind doctor --format json` (`/tmp/doctor_final.json`) so this module no longer triggers those warnings.

### Later

<!-- @mind:todo Deprecate `VIEW_Test_Write_Tests_And_Verify.md` mention after health checks settle -->
<!-- @mind:proposition Emit CLI events when `mind prompt` runs for usage telemetry feeding `docs/cli/prompt/HEALTH_Prompt_Runtime_Verification.md`. -->

---

## CONSCIOUSNESS TRACE

**Mental state when stopping:** Energized but aware the doc chain needs more nuance.

**Threads I was holding:** Need to link doc IDs, integrate health checks, and ensure modules.yaml stays in sync.

**Intuitions:** The prompt should become the canonical anchor for onboarding; keep doc instructions literal and cite them often.

**What I wish I'd known at the start:** How many VIEW entries we wanted; it would have simplified the table.

---

## POINTERS

| What | Where |
|------|-------|
| Prompt module docs | `docs/cli/prompt/` |
| CLI module sync | `docs/cli/core/SYNC_CLI_Development_State.md` |
| Entry point | `runtime/prompt.py` |
