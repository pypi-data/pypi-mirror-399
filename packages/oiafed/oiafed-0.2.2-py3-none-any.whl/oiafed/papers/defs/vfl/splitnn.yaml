# ==================== SplitNN: Split Learning ====================

id: splitnn
name: "SplitNN: Split Learning for Vertical Federated Learning"
category: VFL
venue: "MIT Media Lab"
year: 2018
url: "https://arxiv.org/abs/1812.00564"
description: |
  模型垂直分割的联邦学习方法。
  客户端持有模型的前几层，服务端持有后几层。
  只传输中间激活值 (smashed data)，保护原始数据隐私。
  适用于纵向联邦学习场景。

# ==================== 组件映射 ====================
components:
  learner: vfl.splitnn
  aggregator: fedavg
  trainer: default
  model: mnist_cnn
  dataset: mnist

# ==================== 默认参数 ====================
defaults:
  experiment:
    num_clients: 2
    
  trainer:
    num_rounds: 10
    local_epochs: 1
    client_fraction: 1.0
    eval_interval: 2

  learner:
    split_layer: 2
    learning_rate: 0.01
    batch_size: 64
    momentum: 0.9
    weight_decay: 0.0005

  aggregator:
    weighted: true

  model:
    num_classes: 10

  dataset:
    data_dir: ./data
    download: true
    partition:
      strategy: iid

# ==================== 可调参数说明 ====================
params:
  # Learner 参数
  learner.split_layer:
    type: int
    range: [1, 10]
    desc: "模型切分位置 (层索引，-1 表示自动选择中间层)"
    
  learner.learning_rate:
    type: float
    range: [0.0001, 0.1]
    desc: "学习率"
    
  learner.batch_size:
    type: int
    choices: [16, 32, 64, 128, 256]
    desc: "批大小"
    
  learner.momentum:
    type: float
    range: [0.0, 0.99]
    desc: "SGD 动量"

  # Trainer 参数
  trainer.num_rounds:
    type: int
    range: [1, 100]
    desc: "训练轮数"
    
  trainer.local_epochs:
    type: int
    range: [1, 10]
    desc: "本地训练轮数 (SplitNN 通常为 1)"

  # Experiment 参数
  experiment.num_clients:
    type: int
    range: [2, 10]
    desc: "客户端数量 (VFL 通常为 2)"

# ==================== 引用信息 ====================
citation: |
  @article{splitnn2018,
    title={Split Learning for Health: Distributed Deep Learning without Sharing Raw Data},
    author={Vepakomma, Praneeth and Gupta, Otkrist and Swedish, Tristan and Raskar, Ramesh},
    journal={arXiv preprint arXiv:1812.00564},
    year={2018}
  }

# ==================== 备注 ====================
notes: |
  - 适用于纵向联邦学习 (VFL) 场景
  - 不同参与方持有相同样本的不同特征
  - 通信内容是中间激活值，而非模型参数或原始数据
  - split_layer 决定客户端和服务端的分割点
  - 对于简单 CNN，建议 split_layer=2
  - 比横向联邦通信量更少，但需要更紧密的协调
