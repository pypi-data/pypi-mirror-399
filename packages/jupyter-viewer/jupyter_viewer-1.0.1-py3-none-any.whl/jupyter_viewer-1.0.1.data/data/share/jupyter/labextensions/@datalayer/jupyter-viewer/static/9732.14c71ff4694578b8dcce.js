/*! For license information please see 9732.14c71ff4694578b8dcce.js.LICENSE.txt */
"use strict";(self.webpackChunk_datalayer_jupyter_viewer=self.webpackChunk_datalayer_jupyter_viewer||[]).push([[9732],{15669(e,t,s){s.d(t,{AP:()=>m,Lf:()=>p,cS:()=>i,cW:()=>r,kz:()=>u,m3:()=>l,un:()=>d,zw:()=>a});var n=s(23986);const a=":",r="/api/drive.v1",i=4096,o=new TextEncoder,c=new TextDecoder("utf-8"),h={0:!1,1:!0,2:!0,64:!0,65:!0,66:!0,129:!0,193:!0,514:!0,577:!0,578:!0,705:!0,706:!0,1024:!0,1025:!0,1026:!0,1089:!0,1090:!0,1153:!0,1154:!0,1217:!0,1218:!0,4096:!0,4098:!0};class l{fs;constructor(e){this.fs=e}open(e){const t=this.fs.realPath(e.node);this.fs.FS.isFile(e.node.mode)&&(e.file=this.fs.API.get(t))}close(e){if(!this.fs.FS.isFile(e.node.mode)||!e.file)return;const t=this.fs.realPath(e.node),s=e.flags;let n="string"==typeof s?parseInt(s,10):s;n&=8191;let a=!0;n in h&&(a=h[n]),a&&this.fs.API.put(t,e.file),e.file=void 0}read(e,t,s,n,a){if(n<=0||void 0===e.file||a>=(e.file.data.length||0))return 0;const r=Math.min(e.file.data.length-a,n);return t.set(e.file.data.subarray(a,a+r),s),r}write(e,t,s,n,a){if(n<=0||void 0===e.file)return 0;if(e.node.timestamp=Date.now(),a+n>(e.file?.data.length||0)){const t=e.file.data?e.file.data:new Uint8Array;e.file.data=new Uint8Array(a+n),e.file.data.set(t)}return e.file.data.set(t.subarray(s,s+n),a),n}llseek(e,t,s){let a=t;if(s===n.kL)a+=e.position;else if(s===n.j6&&this.fs.FS.isFile(e.node.mode)){if(void 0===e.file)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM);a+=e.file.data.length}if(a<0)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EINVAL);return a}}class d{fs;constructor(e){this.fs=e}node(e){return(0,n.D_)(e)?e.node:e}getattr(e){const t=this.node(e);return{...this.fs.API.getattr(this.fs.realPath(t)),mode:t.mode,ino:t.id}}setattr(e,t){const s=this.node(e);for(const[e,n]of Object.entries(t))switch(e){case"mode":s.mode=n;break;case"timestamp":s.timestamp=n;break;case"size":{const e=n,t=this.fs.realPath(s);if(this.fs.FS.isFile(s.mode)&&e>=0){const s=this.fs.API.get(t),n=s.data?s.data:new Uint8Array;e!==n.length&&(e<n.length?s.data=s.data.slice(0,e):(s.data=new Uint8Array(e),s.data.set(n)),this.fs.API.put(t,s))}else console.warn("setattr size of",e,"on",s,"not yet implemented");break}default:console.warn("setattr",e,"of",n,"on",s,"not yet implemented")}}lookup(e,t){const s=this.node(e),n=this.fs.PATH.join2(this.fs.realPath(s),t),a=this.fs.API.lookup(n);if(!a.ok)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.ENOENT);return this.fs.createNode(s,t,a.mode,0)}mknod(e,t,s,n){const a=this.node(e),r=this.fs.PATH.join2(this.fs.realPath(a),t);return this.fs.API.mknod(r,s),this.fs.createNode(a,t,s,n)}rename(e,t,s){const n=this.node(e),a=this.node(t);this.fs.API.rename(n.parent?this.fs.PATH.join2(this.fs.realPath(n.parent),n.name):n.name,this.fs.PATH.join2(this.fs.realPath(a),s)),n.name=s,n.parent=a}unlink(e,t){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(e)),t))}rmdir(e,t){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(e)),t))}readdir(e){return this.fs.API.readdir(this.fs.realPath(this.node(e)))}symlink(e,t,s){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}readlink(e){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}}class p{constructor(e,t,s,n){this._driveName=e,this._mountpoint=t,this.FS=s,this.ERRNO_CODES=n}lookup(e){return this.request({method:"lookup",path:this.normalizePath(e)})}getmode(e){return this.request({method:"getmode",path:this.normalizePath(e)})}mknod(e,t){return this.request({method:"mknod",path:this.normalizePath(e),data:{mode:t}})}rename(e,t){return this.request({method:"rename",path:this.normalizePath(e),data:{newPath:this.normalizePath(t)}})}readdir(e){const t=this.request({method:"readdir",path:this.normalizePath(e)});return t.push("."),t.push(".."),t}rmdir(e){return this.request({method:"rmdir",path:this.normalizePath(e)})}get(e){const t=this.request({method:"get",path:this.normalizePath(e)});if(!t)throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT);const s=t.content,n=t.format;switch(n){case"json":case"text":return{data:o.encode(s),format:n};case"base64":{const e=atob(s),t=e.length,a=new Uint8Array(t);for(let s=0;s<t;s++)a[s]=e.charCodeAt(s);return{data:a,format:n}}default:throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT)}}put(e,t){switch(t.format){case"json":case"text":return this.request({method:"put",path:this.normalizePath(e),data:{format:t.format,data:c.decode(t.data)}});case"base64":{let s="";for(let e=0;e<t.data.byteLength;e++)s+=String.fromCharCode(t.data[e]);return this.request({method:"put",path:this.normalizePath(e),data:{format:t.format,data:btoa(s)}})}}}getattr(e){const t=this.request({method:"getattr",path:this.normalizePath(e)});return t.atime&&(t.atime=new Date(t.atime)),t.mtime&&(t.mtime=new Date(t.mtime)),t.ctime&&(t.ctime=new Date(t.ctime)),t.size=t.size||0,t}normalizePath(e){return e.startsWith(this._mountpoint)&&(e=e.slice(this._mountpoint.length)),this._driveName&&(e=`${this._driveName}${a}${e}`),e}_driveName;_mountpoint;FS;ERRNO_CODES}class u extends p{constructor(e,t,s,n,a){super(t,s,n,a),this._baseUrl=e}request(e){const t=new XMLHttpRequest;t.open("POST",encodeURI(this.endpoint),!1);try{t.send(JSON.stringify(e))}catch(e){console.error(e)}if(t.status>=400)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return JSON.parse(t.responseText)}get endpoint(){return`${this._baseUrl}api/drive`}_baseUrl}class m{FS;API;PATH;ERRNO_CODES;driveName;constructor(e){this.FS=e.FS,this.PATH=e.PATH,this.ERRNO_CODES=e.ERRNO_CODES,this.API=this.createAPI(e),this.driveName=e.driveName,this.node_ops=new d(this),this.stream_ops=new l(this)}node_ops;stream_ops;createAPI(e){return new u(e.baseUrl,e.driveName,e.mountpoint,e.FS,e.ERRNO_CODES)}mount(e){return this.createNode(null,e.mountpoint,511|n._j,0)}createNode(e,t,s,n){const a=this.FS;if(!a.isDir(s)&&!a.isFile(s))throw new a.ErrnoError(this.ERRNO_CODES.EINVAL);const r=a.createNode(e,t,s,n);return r.node_ops=this.node_ops,r.stream_ops=this.stream_ops,r}getMode(e){return this.API.getmode(e)}realPath(e){const t=[];let s=e;for(t.push(s.name);s.parent!==s;)s=s.parent,t.push(s.name);return t.reverse(),this.PATH.join.apply(null,t)}}},23986(e,t,s){s.d(t,{D_:()=>o,_j:()=>n,j6:()=>i,kL:()=>r,rE:()=>a});const n=16895,a=33206,r=1,i=2;function o(e){return"node"in e}},78532(e,t,s){s.d(t,{l:()=>i});var n=s(63343),a=s(15669),r=s(23986);class i{contentsManager;constructor(e){this.contentsManager=e.contentsManager}async processDriveRequest(e){switch(e.method){case"readdir":return this.readdir(e);case"rmdir":return this.rmdir(e);case"rename":return this.rename(e);case"getmode":return this.getmode(e);case"lookup":return this.lookup(e);case"mknod":return this.mknod(e);case"getattr":return this.getattr(e);case"get":return this.get(e);case"put":return this.put(e)}throw`Drive request ${e.method} does not exist.`}async readdir(e){const t=await this.contentsManager.get(e.path,{content:!0});let s=[];return"directory"===t.type&&t.content&&(s=t.content.map(e=>e.name)),s}async rmdir(e){return await this.contentsManager.delete(e.path),null}async rename(e){return await this.contentsManager.rename(e.path,e.data.newPath),null}async getmode(e){let t;return t="directory"===(await this.contentsManager.get(e.path)).type?r._j:r.rE,t}async lookup(e){let t;try{t={ok:!0,mode:"directory"===(await this.contentsManager.get(e.path)).type?r._j:r.rE}}catch(e){t={ok:!1}}return t}async mknod(e){const t=await this.contentsManager.newUntitled({path:n.PathExt.dirname(e.path),type:e.data.mode===r._j?"directory":"file",ext:n.PathExt.extname(e.path)});return await this.contentsManager.rename(t.path,e.path),null}async getattr(e){const t=await this.contentsManager.get(e.path),s=new Date(0).toISOString();return{dev:1,nlink:1,uid:0,gid:0,rdev:0,size:t.size||0,blksize:a.cS,blocks:Math.ceil(t.size||0/a.cS),atime:t.last_modified||s,mtime:t.last_modified||s,ctime:t.created||s,timestamp:0}}async get(e){const t=await this.contentsManager.get(e.path,{content:!0});let s;return"directory"!==t.type&&(s={content:"json"===t.format?JSON.stringify(t.content):t.content,format:t.format}),s}async put(e){return await this.contentsManager.save(e.path,{content:"json"===e.data.format?JSON.parse(e.data.data):e.data.data,type:"file",format:e.data.format}),null}}},80280(e,t,s){s.d(t,{D:()=>r});var n=s(38976),a=s(74602);class r{constructor(e){const{id:t,name:s,location:n,sendMessage:a}=e;this._id=t,this._name=s,this._location=n,this._sendMessage=a}get ready(){return Promise.resolve()}get isDisposed(){return this._isDisposed}get disposed(){return this._disposed}get id(){return this._id}get name(){return this._name}get location(){return this._location}get executionCount(){return this._executionCount}get parentHeader(){return this._parentHeader}get parent(){return this._parent}dispose(){this.isDisposed||(this._isDisposed=!0,this._disposed.emit(void 0))}async handleMessage(e){switch(this._busy(e),this._parent=e,e.header.msg_type){case"kernel_info_request":await this._kernelInfo(e);break;case"execute_request":await this._execute(e);break;case"input_reply":this.inputReply(e.content);break;case"inspect_request":await this._inspect(e);break;case"is_complete_request":await this._isCompleteRequest(e);break;case"complete_request":await this._complete(e);break;case"history_request":await this._historyRequest(e);break;case"comm_open":await this.commOpen(e);break;case"comm_msg":await this.commMsg(e);break;case"comm_close":await this.commClose(e)}this._idle(e)}stream(e,t=void 0){const s=void 0!==t?t:this._parentHeader,a=n.KernelMessage.createMessage({channel:"iopub",msgType:"stream",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}displayData(e,t=void 0){const s=void 0!==t?t:this._parentHeader;e.metadata=e.metadata??{};const a=n.KernelMessage.createMessage({channel:"iopub",msgType:"display_data",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}inputRequest(e,t=void 0){const s=void 0!==t?t:this._parentHeader,a=n.KernelMessage.createMessage({channel:"stdin",msgType:"input_request",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}publishExecuteResult(e,t=void 0){const s=void 0!==t?t:this._parentHeader,a=n.KernelMessage.createMessage({channel:"iopub",msgType:"execute_result",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}publishExecuteError(e,t=void 0){const s=void 0!==t?t:this._parentHeader,a=n.KernelMessage.createMessage({channel:"iopub",msgType:"error",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}updateDisplayData(e,t=void 0){const s=void 0!==t?t:this._parentHeader,a=n.KernelMessage.createMessage({channel:"iopub",msgType:"update_display_data",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}clearOutput(e,t=void 0){const s=void 0!==t?t:this._parentHeader,a=n.KernelMessage.createMessage({channel:"iopub",msgType:"clear_output",session:s?.session??"",parentHeader:s,content:e});this._sendMessage(a)}handleComm(e,t,s,a,r=void 0){const i=void 0!==r?r:this._parentHeader,o=n.KernelMessage.createMessage({channel:"iopub",msgType:e,session:i?.session??"",parentHeader:i,content:t,metadata:s,buffers:a});this._sendMessage(o)}_idle(e){const t=n.KernelMessage.createMessage({msgType:"status",session:e.header.session,parentHeader:e.header,channel:"iopub",content:{execution_state:"idle"}});this._sendMessage(t)}_busy(e){const t=n.KernelMessage.createMessage({msgType:"status",session:e.header.session,parentHeader:e.header,channel:"iopub",content:{execution_state:"busy"}});this._sendMessage(t)}async _kernelInfo(e){const t=await this.kernelInfoRequest(),s=n.KernelMessage.createMessage({msgType:"kernel_info_reply",channel:"shell",session:e.header.session,parentHeader:e.header,content:t});this._sendMessage(s)}async _historyRequest(e){const t=e,s=n.KernelMessage.createMessage({msgType:"history_reply",channel:"shell",parentHeader:t.header,session:e.header.session,content:{status:"ok",history:this._history}});this._sendMessage(s)}_executeInput(e){const t=e,s=t.content.code,a=n.KernelMessage.createMessage({msgType:"execute_input",parentHeader:t.header,channel:"iopub",session:e.header.session,content:{code:s,execution_count:this._executionCount}});this._sendMessage(a)}async _execute(e){const t=e,s=t.content;s.store_history&&this._executionCount++,this._parentHeader=t.header,this._executeInput(t),s.store_history&&this._history.push([0,0,s.code]);const a=await this.executeRequest(t.content),r=n.KernelMessage.createMessage({msgType:"execute_reply",channel:"shell",parentHeader:t.header,session:e.header.session,content:a});this._sendMessage(r)}async _complete(e){const t=e,s=await this.completeRequest(t.content),a=n.KernelMessage.createMessage({msgType:"complete_reply",parentHeader:t.header,channel:"shell",session:e.header.session,content:s});this._sendMessage(a)}async _inspect(e){const t=e,s=await this.inspectRequest(t.content),a=n.KernelMessage.createMessage({msgType:"inspect_reply",parentHeader:t.header,channel:"shell",session:e.header.session,content:s});this._sendMessage(a)}async _isCompleteRequest(e){const t=e,s=await this.isCompleteRequest(t.content),a=n.KernelMessage.createMessage({msgType:"is_complete_reply",parentHeader:t.header,channel:"shell",session:e.header.session,content:s});this._sendMessage(a)}_id;_name;_location;_history=[];_executionCount=0;_isDisposed=!1;_disposed=new a.Signal(this);_sendMessage;_parentHeader=void 0;_parent=void 0}},99732(e,t,s){s.d(t,{PyodideKernel:()=>ee});const n="function",a="64e10b34-2bf7-4616-9668-f99de5aa046e",r="get",i="has",o="set",{isArray:c}=Array;let{SharedArrayBuffer:h,window:l}=globalThis,{notify:d,wait:p,waitAsync:u}=Atomics,m=null;u||(u=e=>({value:new Promise(t=>{let s=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");s.onmessage=t,s.postMessage(e)})}));try{new h(4)}catch(e){h=ArrayBuffer;const t=new WeakMap;if(l){const e=new Map,{prototype:{postMessage:s}}=Worker,n=t=>{const s=t.data?.[a];if(!c(s)){t.stopImmediatePropagation();const{id:n,sb:a}=s;e.get(n)(a)}};m=function(e,...r){const i=e?.[a];if(c(i)){const[e,s]=i;t.set(s,e),this.addEventListener("message",n)}return s.call(this,e,...r)},u=s=>({value:new Promise(n=>{e.set(t.get(s),n)}).then(n=>{e.delete(t.get(s)),t.delete(s);for(let e=0;e<n.length;e++)s[e]=n[e];return"ok"})})}else{const e=(e,t)=>({[a]:{id:e,sb:t}});d=s=>{postMessage(e(t.get(s),s))},addEventListener("message",e=>{const s=e.data?.[a];if(c(s)){const[e,n]=s;t.set(n,e)}})}}const{Int32Array:g,Map:f,Uint16Array:y}=globalThis,{BYTES_PER_ELEMENT:_}=g,{BYTES_PER_ELEMENT:w}=y,E=new WeakSet,b=new WeakMap,M={value:{then:e=>e()}};let k=0;const v=(e,{parse:t=JSON.parse,stringify:s=JSON.stringify,transform:l,interrupt:v}=JSON)=>{if(!b.has(e)){const P=m||e.postMessage,R=(t,...s)=>P.call(e,{[a]:s},{transfer:t}),S=typeof v===n?v:v?.handler,O=v?.delay||42,x=new TextDecoder("utf-16"),A=(e,t)=>e?u(t,0):(S?((e,t,s)=>{for(;"timed-out"===p(e,0,0,t);)s()})(t,O,S):p(t,0),M);let T=!1;b.set(e,new Proxy(new f,{[i]:(e,t)=>"string"==typeof t&&!t.startsWith("_"),[r]:(s,n)=>"then"===n?null:(...s)=>{const a=k++;let r=new g(new h(2*_)),i=[];E.has(s.at(-1)||i)&&E.delete(i=s.pop()),R(i,a,r,n,l?s.map(l):s);const o=e!==globalThis;let c=0;return T&&o&&(c=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${n}(...args) is awaited`)),A(o,r).value.then(()=>{clearTimeout(c);const e=r[1];if(!e)return;const s=w*e;return r=new g(new h(s+s%_)),R([],a,r),A(o,r).value.then(()=>t(x.decode(new y(r.buffer).slice(0,e))))})},[o](t,r,i){const o=typeof i;if(o!==n)throw new Error(`Unable to assign ${r} as ${o}`);if(!t.size){const n=new f;e.addEventListener("message",async e=>{const r=e.data?.[a];if(c(r)){e.stopImmediatePropagation();const[a,i,...o]=r;let c;if(o.length){const[e,r]=o;if(t.has(e)){T=!0;try{const o=await t.get(e)(...r);if(void 0!==o){const e=s(l?l(o):o);n.set(a,e),i[1]=e.length}}catch(e){c=e}finally{T=!1}}else c=new Error(`Unsupported action: ${e}`);i[0]=1}else{const e=n.get(a);n.delete(a);for(let t=new y(i.buffer),s=0;s<e.length;s++)t[s]=e.charCodeAt(s)}if(d(i,0),c)throw c}})}return!!t.set(r,i)}}))}return b.get(e)};v.transfer=(...e)=>(E.add(e),e);const P=v,R=Symbol("Comlink.proxy"),S=Symbol("Comlink.endpoint"),O=Symbol("Comlink.releaseProxy"),x=Symbol("Comlink.finalizer"),A=Symbol("Comlink.thrown"),T=e=>"object"==typeof e&&null!==e||"function"==typeof e,N=new Map([["proxy",{canHandle:e=>T(e)&&e[R],serialize(e){const{port1:t,port2:s}=new MessageChannel;return D(e,t),[s,[s]]},deserialize:e=>(e.start(),C(e))}],["throw",{canHandle:e=>T(e)&&A in e,serialize({value:e}){let t;return t=e instanceof Error?{isError:!0,value:{message:e.message,name:e.name,stack:e.stack}}:{isError:!1,value:e},[t,[]]},deserialize(e){if(e.isError)throw Object.assign(new Error(e.value.message),e.value);throw e.value}}]]);function D(e,t=globalThis,s=["*"]){t.addEventListener("message",function n(a){if(!a||!a.data)return;if(!function(e,t){for(const s of e){if(t===s||"*"===s)return!0;if(s instanceof RegExp&&s.test(t))return!0}return!1}(s,a.origin))return void console.warn(`Invalid origin '${a.origin}' for comlink proxy`);const{id:r,type:i,path:o}=Object.assign({path:[]},a.data),c=(a.data.argumentList||[]).map(W);let h;try{const t=o.slice(0,-1).reduce((e,t)=>e[t],e),s=o.reduce((e,t)=>e[t],e);switch(i){case"GET":h=s;break;case"SET":t[o.slice(-1)[0]]=W(a.data.value),h=!0;break;case"APPLY":h=s.apply(t,c);break;case"CONSTRUCT":h=function(e){return Object.assign(e,{[R]:!0})}(new s(...c));break;case"ENDPOINT":{const{port1:t,port2:s}=new MessageChannel;D(e,s),h=function(e,t){return L.set(e,t),e}(t,[t])}break;case"RELEASE":h=void 0;break;default:return}}catch(e){h={value:e,[A]:0}}Promise.resolve(h).catch(e=>({value:e,[A]:0})).then(s=>{const[a,o]=U(s);t.postMessage(Object.assign(Object.assign({},a),{id:r}),o),"RELEASE"===i&&(t.removeEventListener("message",n),H(t),x in e&&"function"==typeof e[x]&&e[x]())}).catch(e=>{const[s,n]=U({value:new TypeError("Unserializable return value"),[A]:0});t.postMessage(Object.assign(Object.assign({},s),{id:r}),n)})}),t.start&&t.start()}function H(e){(function(e){return"MessagePort"===e.constructor.name})(e)&&e.close()}function C(e,t){const s=new Map;return e.addEventListener("message",function(e){const{data:t}=e;if(!t||!t.id)return;const n=s.get(t.id);if(n)try{n(t)}finally{s.delete(t.id)}}),F(e,s,[],t)}function I(e){if(e)throw new Error("Proxy has been released and is not useable")}function q(e){return $(e,new Map,{type:"RELEASE"}).then(()=>{H(e)})}const j=new WeakMap,z="FinalizationRegistry"in globalThis&&new FinalizationRegistry(e=>{const t=(j.get(e)||0)-1;j.set(e,t),0===t&&q(e)});function F(e,t,s=[],n=function(){}){let a=!1;const r=new Proxy(n,{get(n,i){if(I(a),i===O)return()=>{!function(e){z&&z.unregister(e)}(r),q(e),t.clear(),a=!0};if("then"===i){if(0===s.length)return{then:()=>r};const n=$(e,t,{type:"GET",path:s.map(e=>e.toString())}).then(W);return n.then.bind(n)}return F(e,t,[...s,i])},set(n,r,i){I(a);const[o,c]=U(i);return $(e,t,{type:"SET",path:[...s,r].map(e=>e.toString()),value:o},c).then(W)},apply(n,r,i){I(a);const o=s[s.length-1];if(o===S)return $(e,t,{type:"ENDPOINT"}).then(W);if("bind"===o)return F(e,t,s.slice(0,-1));const[c,h]=K(i);return $(e,t,{type:"APPLY",path:s.map(e=>e.toString()),argumentList:c},h).then(W)},construct(n,r){I(a);const[i,o]=K(r);return $(e,t,{type:"CONSTRUCT",path:s.map(e=>e.toString()),argumentList:i},o).then(W)}});return function(e,t){const s=(j.get(t)||0)+1;j.set(t,s),z&&z.register(e,t,e)}(r,e),r}function K(e){const t=e.map(U);return[t.map(e=>e[0]),(s=t.map(e=>e[1]),Array.prototype.concat.apply([],s))];var s}const L=new WeakMap;function U(e){for(const[t,s]of N)if(s.canHandle(e)){const[n,a]=s.serialize(e);return[{type:"HANDLER",name:t,value:n},a]}return[{type:"RAW",value:e},L.get(e)||[]]}function W(e){switch(e.type){case"HANDLER":return N.get(e.name).deserialize(e.value);case"RAW":return e.value}}function $(e,t,s,n){return new Promise(a=>{const r=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");t.set(r,a),e.start&&e.start(),e.postMessage(Object.assign({id:r},s),n)})}var J=s(67262),B=s(63343),Y=s(80280);const G={ipykernel:{releases:{"6.9.2":[{url:"https://assets.datalayer.tech/pypi/ipykernel-6.9.2-py3-none-any.whl"}]}},piplite:{releases:{"0.5.1":[{url:"https://assets.datalayer.tech/pypi/piplite-0.5.1-py3-none-any.whl"}]}},"pyodide-kernel":{releases:{"0.5.1":[{url:"https://assets.datalayer.tech/pypi/pyodide_kernel-0.5.1-py3-none-any.whl"}]}},widgetsnbextension:{releases:{"3.6.999":[{url:"https://assets.datalayer.tech/pypi/widgetsnbextension-3.6.999-py3-none-any.whl"}],"4.0.999":[{url:"https://assets.datalayer.tech/pypi/widgetsnbextension-4.0.999-py3-none-any.whl"}]}}};function V(e,t){const s=G[e];if(!s)throw console.error("all.json contents:",G),console.error("Looking for package:",e),new Error(`Package ${e} not found in all.json`);const n=Object.keys(s.releases),a=t||n[n.length-1],r=s.releases[a];if(!r||0===r.length)throw new Error(`No releases found for ${e}@${a}`);return r[0].url}const X={default:G.piplite?.releases["0.5.1"]?.[0]?.url?.replace(/piplite-.*\.whl$/,"all.json")||"https://assets.datalayer.tech/pypi/all.json"},Q={default:V("piplite","0.5.1")};V("ipykernel","6.9.2"),V("pyodide-kernel","0.5.1"),V("widgetsnbextension","3.6.999"),V("widgetsnbextension","4.0.999");var Z=s(78532);class ee extends Y.D{constructor(e){super(e),this._worker=this.initWorker(e),this._remoteKernel=this.initRemote(e),this._contentsManager=e.contentsManager}initWorker(e){return crossOriginIsolated?new Worker(new URL(s.p+s.u(5692),s.b),{type:void 0}):new Worker(new URL(s.p+s.u(7540),s.b),{type:void 0})}initRemote(e){let t;crossOriginIsolated?(t=P(this._worker),t.processWorkerMessage=this._processWorkerMessage.bind(this),t.processDriveRequest=async e=>{if(!Z.l)throw new Error("File system calls over Atomics.wait is only supported with jupyterlite>=0.4.0a3");return void 0===this._contentsProcessor&&(this._contentsProcessor=new Z.l({contentsManager:this._contentsManager})),await this._contentsProcessor.processDriveRequest(e)}):(t=C(this._worker),this._worker.addEventListener("message",e=>{void 0!==e?.data?._kernelMessage&&this._processWorkerMessage(e.data._kernelMessage)}));const s=this.initRemoteOptions(e);return t.initialize(s).then(this._ready.resolve.bind(this._ready)),t}initRemoteOptions(e){const{pyodideUrl:t}=e,s=t.slice(0,t.lastIndexOf("/")+1),n=B.PageConfig.getBaseUrl(),a=[...e.pipliteUrls||[],X.default],r=!!e.disablePyPIFallback;return{baseUrl:n,pyodideUrl:t,indexUrl:s,pipliteWheelUrl:e.pipliteWheelUrl||Q.default,pipliteUrls:a,disablePyPIFallback:r,location:this.location,mountDrive:e.mountDrive,loadPyodideOptions:e.loadPyodideOptions||{}}}dispose(){this.isDisposed||(this._worker.terminate(),this._worker=null,super.dispose())}get ready(){return this._ready.promise}_processWorkerMessage(e){if(e.type)switch(e.type){case"stream":{const t=e.bundle??{name:"stdout",text:""};this.stream(t,e.parentHeader);break}case"input_request":{const t=e.content??{prompt:"",password:!1};this.inputRequest(t,e.parentHeader);break}case"display_data":{const t=e.bundle??{data:{},metadata:{},transient:{}};this.displayData(t,e.parentHeader);break}case"update_display_data":{const t=e.bundle??{data:{},metadata:{},transient:{}};this.updateDisplayData(t,e.parentHeader);break}case"clear_output":{const t=e.bundle??{wait:!1};this.clearOutput(t,e.parentHeader);break}case"execute_result":{const t=e.bundle??{execution_count:0,data:{},metadata:{}};this.publishExecuteResult(t,e.parentHeader);break}case"execute_error":{const t=e.bundle??{ename:"",evalue:"",traceback:[]};this.publishExecuteError(t,e.parentHeader);break}case"comm_msg":case"comm_open":case"comm_close":this.handleComm(e.type,e.content,e.metadata,e.buffers,e.parentHeader)}}async kernelInfoRequest(){return{implementation:"pyodide",implementation_version:"0.1.0",language_info:{codemirror_mode:{name:"python",version:3},file_extension:".py",mimetype:"text/x-python",name:"python",nbconvert_exporter:"python",pygments_lexer:"ipython3",version:"3.8"},protocol_version:"5.3",status:"ok",banner:"A WebAssembly-powered Python kernel backed by Pyodide",help_links:[{text:"Python (WASM) Kernel",url:"https://pyodide.org"}]}}async executeRequest(e){await this.ready;const t=await this._remoteKernel.execute(e,this.parent);return t.execution_count=this.executionCount,t}async completeRequest(e){return await this._remoteKernel.complete(e,this.parent)}async inspectRequest(e){return await this._remoteKernel.inspect(e,this.parent)}async isCompleteRequest(e){return await this._remoteKernel.isComplete(e,this.parent)}async commInfoRequest(e){return await this._remoteKernel.commInfo(e,this.parent)}async commOpen(e){return await this._remoteKernel.commOpen(e,this.parent)}async commMsg(e){return await this._remoteKernel.commMsg(e,this.parent)}async commClose(e){return await this._remoteKernel.commClose(e,this.parent)}async inputReply(e){return await this._remoteKernel.inputReply(e,this.parent)}_contentsManager;_contentsProcessor;_worker;_remoteKernel;_ready=new J.PromiseDelegate}}}]);