/*! For license information please see 7540.641b217f46edf36fb0d0.js.LICENSE.txt */
(()=>{"use strict";var t={7540(t,e,s){const r=Symbol("Comlink.proxy"),i=Symbol("Comlink.endpoint"),n=Symbol("Comlink.releaseProxy"),a=Symbol("Comlink.finalizer"),o=Symbol("Comlink.thrown"),l=t=>"object"==typeof t&&null!==t||"function"==typeof t,h={canHandle:t=>l(t)&&t[r],serialize(t){const{port1:e,port2:s}=new MessageChannel;return c(t,e),[s,[s]]},deserialize:t=>(t.start(),function(t){const e=new Map;return t.addEventListener("message",function(t){const{data:s}=t;if(!s||!s.id)return;const r=e.get(s.id);if(r)try{r(s)}finally{e.delete(s.id)}}),y(t,e,[],void 0)}(t))},d=new Map([["proxy",h],["throw",{canHandle:t=>l(t)&&o in t,serialize({value:t}){let e;return e=t instanceof Error?{isError:!0,value:{message:t.message,name:t.name,stack:t.stack}}:{isError:!1,value:t},[e,[]]},deserialize(t){if(t.isError)throw Object.assign(new Error(t.value.message),t.value);throw t.value}}]]);function c(t,e=globalThis,s=["*"]){e.addEventListener("message",function i(n){if(!n||!n.data)return;if(!function(t,e){for(const s of t){if(e===s||"*"===s)return!0;if(s instanceof RegExp&&s.test(e))return!0}return!1}(s,n.origin))return void console.warn(`Invalid origin '${n.origin}' for comlink proxy`);const{id:l,type:h,path:d}=Object.assign({path:[]},n.data),u=(n.data.argumentList||[]).map(E);let m;try{const e=d.slice(0,-1).reduce((t,e)=>t[e],t),s=d.reduce((t,e)=>t[e],t);switch(h){case"GET":m=s;break;case"SET":e[d.slice(-1)[0]]=E(n.data.value),m=!0;break;case"APPLY":m=s.apply(e,u);break;case"CONSTRUCT":m=function(t){return Object.assign(t,{[r]:!0})}(new s(...u));break;case"ENDPOINT":{const{port1:e,port2:s}=new MessageChannel;c(t,s),m=function(t,e){return P.set(t,e),t}(e,[e])}break;case"RELEASE":m=void 0;break;default:return}}catch(t){m={value:t,[o]:0}}Promise.resolve(m).catch(t=>({value:t,[o]:0})).then(s=>{const[r,n]=w(s);e.postMessage(Object.assign(Object.assign({},r),{id:l}),n),"RELEASE"===h&&(e.removeEventListener("message",i),p(e),a in t&&"function"==typeof t[a]&&t[a]())}).catch(t=>{const[s,r]=w({value:new TypeError("Unserializable return value"),[o]:0});e.postMessage(Object.assign(Object.assign({},s),{id:l}),r)})}),e.start&&e.start()}function p(t){(function(t){return"MessagePort"===t.constructor.name})(t)&&t.close()}function u(t){if(t)throw new Error("Proxy has been released and is not useable")}function m(t){return R(t,new Map,{type:"RELEASE"}).then(()=>{p(t)})}const f=new WeakMap,_="FinalizationRegistry"in globalThis&&new FinalizationRegistry(t=>{const e=(f.get(t)||0)-1;f.set(t,e),0===e&&m(t)});function y(t,e,s=[],r=function(){}){let a=!1;const o=new Proxy(r,{get(r,i){if(u(a),i===n)return()=>{!function(t){_&&_.unregister(t)}(o),m(t),e.clear(),a=!0};if("then"===i){if(0===s.length)return{then:()=>o};const r=R(t,e,{type:"GET",path:s.map(t=>t.toString())}).then(E);return r.then.bind(r)}return y(t,e,[...s,i])},set(r,i,n){u(a);const[o,l]=w(n);return R(t,e,{type:"SET",path:[...s,i].map(t=>t.toString()),value:o},l).then(E)},apply(r,n,o){u(a);const l=s[s.length-1];if(l===i)return R(t,e,{type:"ENDPOINT"}).then(E);if("bind"===l)return y(t,e,s.slice(0,-1));const[h,d]=g(o);return R(t,e,{type:"APPLY",path:s.map(t=>t.toString()),argumentList:h},d).then(E)},construct(r,i){u(a);const[n,o]=g(i);return R(t,e,{type:"CONSTRUCT",path:s.map(t=>t.toString()),argumentList:n},o).then(E)}});return function(t,e){const s=(f.get(e)||0)+1;f.set(e,s),_&&_.register(t,e,t)}(o,t),o}function g(t){const e=t.map(w);return[e.map(t=>t[0]),(s=e.map(t=>t[1]),Array.prototype.concat.apply([],s))];var s}const P=new WeakMap;function w(t){for(const[e,s]of d)if(s.canHandle(t)){const[r,i]=s.serialize(t);return[{type:"HANDLER",name:e,value:r},i]}return[{type:"RAW",value:t},P.get(t)||[]]}function E(t){switch(t.type){case"HANDLER":return d.get(t.name).deserialize(t.value);case"RAW":return t.value}}function R(t,e,s,r){return new Promise(i=>{const n=new Array(4).fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");e.set(n,i),t.start&&t.start(),t.postMessage(Object.assign({id:n},s),r)})}var b=s(15669);class k{constructor(){this._initialized=new Promise((t,e)=>{this._initializer={resolve:t,reject:e}})}async initialize(t){if(this._options=t,t.location.includes(":")){const e=t.location.split(":");this._driveName=e[0],this._localPath=e[1]}else this._driveName="",this._localPath=t.location;await this.initRuntime(t),await this.initFilesystem(t),await this.initPackageManager(t),await this.initKernel(t),await this.initGlobals(t),this._initializer?.resolve()}async initRuntime(t){const{pyodideUrl:e,indexUrl:s}=t;let r;if(r=(await import(e)).loadPyodide||self.loadPyodide,"function"!=typeof r)throw new Error(`Failed to load pyodide from ${e}. loadPyodide is not a function.`);this._pyodide=await r({indexURL:s,...t.loadPyodideOptions})}async initPackageManager(t){if(!this._options)throw new Error("Uninitialized");const{pipliteWheelUrl:e,disablePyPIFallback:s,pipliteUrls:r,loadPyodideOptions:i}=this._options,n=(i||{}).packages||[];n.includes("micropip")||await this._pyodide.loadPackage(["micropip"]),n.includes("piplite")||await this._pyodide.runPythonAsync(`\n      import micropip\n      await micropip.install('${e}', keep_going=True)\n    `),await this._pyodide.runPythonAsync(`\n      import piplite.piplite\n      piplite.piplite._PIPLITE_DISABLE_PYPI = ${s?"True":"False"}\n      piplite.piplite._PIPLITE_URLS = ${JSON.stringify(r)}\n    `)}async initKernel(t){const e=(t.loadPyodideOptions||{}).packages||[],s=["ssl","sqlite3","ipykernel","comm","pyodide_kernel","ipython"],r=[];for(const t of s)e.includes(t)||r.push(`await piplite.install('${t}', keep_going=True)`);r.push("import pyodide_kernel"),t.mountDrive&&this._localPath&&r.push("import os",`os.chdir("${this._localPath}")`),await this._pyodide.runPythonAsync(r.join("\n"))}async initGlobals(t){const{globals:e}=this._pyodide;this._kernel=e.get("pyodide_kernel").kernel_instance.copy(),this._stdout_stream=e.get("pyodide_kernel").stdout_stream.copy(),this._stderr_stream=e.get("pyodide_kernel").stderr_stream.copy(),this._interpreter=this._kernel.interpreter.copy(),this._interpreter.send_comm=this.sendComm.bind(this)}async initFilesystem(t){if(t.mountDrive){const e="/drive",{FS:r,PATH:i,ERRNO_CODES:n}=this._pyodide,{baseUrl:a}=t,{DriveFS:o}=await s.e(2738).then(s.bind(s,42738)),l=new o({FS:r,PATH:i,ERRNO_CODES:n,baseUrl:a,driveName:this._driveName,mountpoint:e});r.mkdirTree(e),r.mount(l,{},e),r.chdir(e),this._driveFS=l}}mapToObject(t){const e=t instanceof Array?[]:{};return t.forEach((t,s)=>{e[s]=t instanceof Map||t instanceof Array?this.mapToObject(t):t}),e}formatResult(t){if(!(t instanceof this._pyodide.ffi.PyProxy))return t;const e=t.toJs();return this.mapToObject(e)}registerCallback(t){this._sendWorkerMessage=t}async setup(t){await this._initialized,this._kernel._parent_header=this._pyodide.toPy(t)}async execute(t,e){await this.setup(e);const s=(t,e)=>{const s={name:this.formatResult(t),text:this.formatResult(e)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:s,type:"stream"})};this._stdout_stream.publish_stream_callback=s,this._stderr_stream.publish_stream_callback=s,this._interpreter.display_pub.clear_output_callback=t=>{const e={wait:this.formatResult(t)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:e,type:"clear_output"})},this._interpreter.display_pub.display_data_callback=(t,e,s)=>{const r={data:this.formatResult(t),metadata:this.formatResult(e),transient:this.formatResult(s)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:r,type:"display_data"})},this._interpreter.display_pub.update_display_data_callback=(t,e,s)=>{const r={data:this.formatResult(t),metadata:this.formatResult(e),transient:this.formatResult(s)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:r,type:"update_display_data"})},this._interpreter.displayhook.publish_execution_result=(t,e,s)=>{const r={execution_count:t,data:this.formatResult(e),metadata:this.formatResult(s)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:r,type:"execute_result"})},this._interpreter.input=this.input.bind(this),this._interpreter.getpass=this.getpass.bind(this);const r=await this._kernel.run(t.code),i=this.formatResult(r);return"error"===i.status&&((t,e,s)=>{const r={ename:t,evalue:e,traceback:s};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:r,type:"execute_error"})})(i.ename,i.evalue,i.traceback),i}async complete(t,e){await this.setup(e);const s=this._kernel.complete(t.code,t.cursor_pos);return this.formatResult(s)}async inspect(t,e){await this.setup(e);const s=this._kernel.inspect(t.code,t.cursor_pos,t.detail_level);return this.formatResult(s)}async isComplete(t,e){await this.setup(e);const s=this._kernel.is_complete(t.code);return this.formatResult(s)}async commInfo(t,e){await this.setup(e);const s=this._kernel.comm_info(t.target_name);return{comms:this.formatResult(s),status:"ok"}}async commOpen(t,e){await this.setup(e);const s=this._kernel.comm_manager.comm_open(this._pyodide.toPy(null),this._pyodide.toPy(null),this._pyodide.toPy(t));return this.formatResult(s)}async commMsg(t,e){await this.setup(e);const s=this._kernel.comm_manager.comm_msg(this._pyodide.toPy(null),this._pyodide.toPy(null),this._pyodide.toPy(t));return this.formatResult(s)}async commClose(t,e){await this.setup(e);const s=this._kernel.comm_manager.comm_close(this._pyodide.toPy(null),this._pyodide.toPy(null),this._pyodide.toPy(t));return this.formatResult(s)}async inputReply(t,e){await this.setup(e),this._resolveInputReply(t)}async sendInputRequest(t,e){const s={prompt:t,password:e};this._sendWorkerMessage({type:"input_request",parentHeader:this.formatResult(this._kernel._parent_header).header,content:s})}async getpass(t){t=void 0===t?"":t,await this.sendInputRequest(t,!0);const e=new Promise(t=>{this._resolveInputReply=t});return(await e).value}async input(t){t=void 0===t?"":t,await this.sendInputRequest(t,!1);const e=new Promise(t=>{this._resolveInputReply=t});return(await e).value}async sendComm(t,e,s,r,i){this._sendWorkerMessage({type:t,content:this.formatResult(e),metadata:this.formatResult(s),ident:this.formatResult(r),buffers:this.formatResult(i),parentHeader:this.formatResult(this._kernel._parent_header).header})}_options=null;_initialized;_initializer=null;_pyodide=null;_localPath="";_driveName="";_kernel;_interpreter;_stdout_stream;_stderr_stream;_resolveInputReply;_driveFS=null;_sendWorkerMessage=()=>{}}class v extends b.AP{createAPI(t){return new b.kz(t.baseUrl,t.driveName,t.mountpoint,t.FS,t.ERRNO_CODES)}}c(new class extends k{constructor(){super(),this._sendWorkerMessage=t=>{postMessage({_kernelMessage:t})}}async initFilesystem(t){if(t.mountDrive){const e="/drive",{FS:s,PATH:r,ERRNO_CODES:i}=this._pyodide,{baseUrl:n}=t,a=new v({FS:s,PATH:r,ERRNO_CODES:i,baseUrl:n,driveName:this._driveName,mountpoint:e});s.mkdirTree(e),s.mount(a,{},e),s.chdir(e),this._driveFS=a}}})},15669(t,e,s){s.d(e,{AP:()=>c,kz:()=>d});var r=s(23986);const i=new TextEncoder,n=new TextDecoder("utf-8"),a={0:!1,1:!0,2:!0,64:!0,65:!0,66:!0,129:!0,193:!0,514:!0,577:!0,578:!0,705:!0,706:!0,1024:!0,1025:!0,1026:!0,1089:!0,1090:!0,1153:!0,1154:!0,1217:!0,1218:!0,4096:!0,4098:!0};class o{fs;constructor(t){this.fs=t}open(t){const e=this.fs.realPath(t.node);this.fs.FS.isFile(t.node.mode)&&(t.file=this.fs.API.get(e))}close(t){if(!this.fs.FS.isFile(t.node.mode)||!t.file)return;const e=this.fs.realPath(t.node),s=t.flags;let r="string"==typeof s?parseInt(s,10):s;r&=8191;let i=!0;r in a&&(i=a[r]),i&&this.fs.API.put(e,t.file),t.file=void 0}read(t,e,s,r,i){if(r<=0||void 0===t.file||i>=(t.file.data.length||0))return 0;const n=Math.min(t.file.data.length-i,r);return e.set(t.file.data.subarray(i,i+n),s),n}write(t,e,s,r,i){if(r<=0||void 0===t.file)return 0;if(t.node.timestamp=Date.now(),i+r>(t.file?.data.length||0)){const e=t.file.data?t.file.data:new Uint8Array;t.file.data=new Uint8Array(i+r),t.file.data.set(e)}return t.file.data.set(e.subarray(s,s+r),i),r}llseek(t,e,s){let i=e;if(s===r.kL)i+=t.position;else if(s===r.j6&&this.fs.FS.isFile(t.node.mode)){if(void 0===t.file)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM);i+=t.file.data.length}if(i<0)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EINVAL);return i}}class l{fs;constructor(t){this.fs=t}node(t){return(0,r.D_)(t)?t.node:t}getattr(t){const e=this.node(t);return{...this.fs.API.getattr(this.fs.realPath(e)),mode:e.mode,ino:e.id}}setattr(t,e){const s=this.node(t);for(const[t,r]of Object.entries(e))switch(t){case"mode":s.mode=r;break;case"timestamp":s.timestamp=r;break;case"size":{const t=r,e=this.fs.realPath(s);if(this.fs.FS.isFile(s.mode)&&t>=0){const s=this.fs.API.get(e),r=s.data?s.data:new Uint8Array;t!==r.length&&(t<r.length?s.data=s.data.slice(0,t):(s.data=new Uint8Array(t),s.data.set(r)),this.fs.API.put(e,s))}else console.warn("setattr size of",t,"on",s,"not yet implemented");break}default:console.warn("setattr",t,"of",r,"on",s,"not yet implemented")}}lookup(t,e){const s=this.node(t),r=this.fs.PATH.join2(this.fs.realPath(s),e),i=this.fs.API.lookup(r);if(!i.ok)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.ENOENT);return this.fs.createNode(s,e,i.mode,0)}mknod(t,e,s,r){const i=this.node(t),n=this.fs.PATH.join2(this.fs.realPath(i),e);return this.fs.API.mknod(n,s),this.fs.createNode(i,e,s,r)}rename(t,e,s){const r=this.node(t),i=this.node(e);this.fs.API.rename(r.parent?this.fs.PATH.join2(this.fs.realPath(r.parent),r.name):r.name,this.fs.PATH.join2(this.fs.realPath(i),s)),r.name=s,r.parent=i}unlink(t,e){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(t)),e))}rmdir(t,e){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(t)),e))}readdir(t){return this.fs.API.readdir(this.fs.realPath(this.node(t)))}symlink(t,e,s){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}readlink(t){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}}class h{constructor(t,e,s,r){this._driveName=t,this._mountpoint=e,this.FS=s,this.ERRNO_CODES=r}lookup(t){return this.request({method:"lookup",path:this.normalizePath(t)})}getmode(t){return this.request({method:"getmode",path:this.normalizePath(t)})}mknod(t,e){return this.request({method:"mknod",path:this.normalizePath(t),data:{mode:e}})}rename(t,e){return this.request({method:"rename",path:this.normalizePath(t),data:{newPath:this.normalizePath(e)}})}readdir(t){const e=this.request({method:"readdir",path:this.normalizePath(t)});return e.push("."),e.push(".."),e}rmdir(t){return this.request({method:"rmdir",path:this.normalizePath(t)})}get(t){const e=this.request({method:"get",path:this.normalizePath(t)});if(!e)throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT);const s=e.content,r=e.format;switch(r){case"json":case"text":return{data:i.encode(s),format:r};case"base64":{const t=atob(s),e=t.length,i=new Uint8Array(e);for(let s=0;s<e;s++)i[s]=t.charCodeAt(s);return{data:i,format:r}}default:throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT)}}put(t,e){switch(e.format){case"json":case"text":return this.request({method:"put",path:this.normalizePath(t),data:{format:e.format,data:n.decode(e.data)}});case"base64":{let s="";for(let t=0;t<e.data.byteLength;t++)s+=String.fromCharCode(e.data[t]);return this.request({method:"put",path:this.normalizePath(t),data:{format:e.format,data:btoa(s)}})}}}getattr(t){const e=this.request({method:"getattr",path:this.normalizePath(t)});return e.atime&&(e.atime=new Date(e.atime)),e.mtime&&(e.mtime=new Date(e.mtime)),e.ctime&&(e.ctime=new Date(e.ctime)),e.size=e.size||0,e}normalizePath(t){return t.startsWith(this._mountpoint)&&(t=t.slice(this._mountpoint.length)),this._driveName&&(t=`${this._driveName}:${t}`),t}_driveName;_mountpoint;FS;ERRNO_CODES}class d extends h{constructor(t,e,s,r,i){super(e,s,r,i),this._baseUrl=t}request(t){const e=new XMLHttpRequest;e.open("POST",encodeURI(this.endpoint),!1);try{e.send(JSON.stringify(t))}catch(t){console.error(t)}if(e.status>=400)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return JSON.parse(e.responseText)}get endpoint(){return`${this._baseUrl}api/drive`}_baseUrl}class c{FS;API;PATH;ERRNO_CODES;driveName;constructor(t){this.FS=t.FS,this.PATH=t.PATH,this.ERRNO_CODES=t.ERRNO_CODES,this.API=this.createAPI(t),this.driveName=t.driveName,this.node_ops=new l(this),this.stream_ops=new o(this)}node_ops;stream_ops;createAPI(t){return new d(t.baseUrl,t.driveName,t.mountpoint,t.FS,t.ERRNO_CODES)}mount(t){return this.createNode(null,t.mountpoint,511|r._j,0)}createNode(t,e,s,r){const i=this.FS;if(!i.isDir(s)&&!i.isFile(s))throw new i.ErrnoError(this.ERRNO_CODES.EINVAL);const n=i.createNode(t,e,s,r);return n.node_ops=this.node_ops,n.stream_ops=this.stream_ops,n}getMode(t){return this.API.getmode(t)}realPath(t){const e=[];let s=t;for(e.push(s.name);s.parent!==s;)s=s.parent,e.push(s.name);return e.reverse(),this.PATH.join.apply(null,e)}}},23986(t,e,s){s.d(e,{D_:()=>a,_j:()=>r,j6:()=>n,kL:()=>i});const r=16895,i=1,n=2;function a(t){return"node"in t}}},e={};function s(r){var i=e[r];if(void 0!==i)return i.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,s),n.exports}s.m=t,s.c=e,s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce((e,r)=>(s.f[r](t,e),e),[])),s.u=t=>t+".0bd1de2e2e0cb6745f0d.js?v=0bd1de2e2e0cb6745f0d",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{s.S={};var t={},e={};s.I=(r,i)=>{i||(i=[]);var n=e[r];if(n||(n=e[r]={}),!(i.indexOf(n)>=0)){if(i.push(n),t[r])return t[r];s.o(s.S,r)||(s.S[r]={}),s.S[r];var a=[];return t[r]=a.length?Promise.all(a).then(()=>t[r]=1):1}}})(),(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");if(r.length)for(var i=r.length-1;i>-1&&(!t||!/^http(s?):/.test(t));)t=r[i--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={7540:1};s.f.i=(e,r)=>{t[e]||importScripts(s.p+s.u(e))};var e=self.webpackChunk_datalayer_jupyter_viewer=self.webpackChunk_datalayer_jupyter_viewer||[],r=e.push.bind(e);e.push=e=>{var[i,n,a]=e;for(var o in n)s.o(n,o)&&(s.m[o]=n[o]);for(a&&a(s);i.length;)t[i.pop()]=1;r(e)}})(),s(7540)})();