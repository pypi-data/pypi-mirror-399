/*! For license information please see 5692.72ccaab43d3321514ce4.js.LICENSE.txt */
(()=>{"use strict";var t={15669(t,e,s){s.d(e,{AP:()=>c,Lf:()=>l});var i=s(23986);const r=new TextEncoder,a=new TextDecoder("utf-8"),n={0:!1,1:!0,2:!0,64:!0,65:!0,66:!0,129:!0,193:!0,514:!0,577:!0,578:!0,705:!0,706:!0,1024:!0,1025:!0,1026:!0,1089:!0,1090:!0,1153:!0,1154:!0,1217:!0,1218:!0,4096:!0,4098:!0};class o{fs;constructor(t){this.fs=t}open(t){const e=this.fs.realPath(t.node);this.fs.FS.isFile(t.node.mode)&&(t.file=this.fs.API.get(e))}close(t){if(!this.fs.FS.isFile(t.node.mode)||!t.file)return;const e=this.fs.realPath(t.node),s=t.flags;let i="string"==typeof s?parseInt(s,10):s;i&=8191;let r=!0;i in n&&(r=n[i]),r&&this.fs.API.put(e,t.file),t.file=void 0}read(t,e,s,i,r){if(i<=0||void 0===t.file||r>=(t.file.data.length||0))return 0;const a=Math.min(t.file.data.length-r,i);return e.set(t.file.data.subarray(r,r+a),s),a}write(t,e,s,i,r){if(i<=0||void 0===t.file)return 0;if(t.node.timestamp=Date.now(),r+i>(t.file?.data.length||0)){const e=t.file.data?t.file.data:new Uint8Array;t.file.data=new Uint8Array(r+i),t.file.data.set(e)}return t.file.data.set(e.subarray(s,s+i),r),i}llseek(t,e,s){let r=e;if(s===i.kL)r+=t.position;else if(s===i.j6&&this.fs.FS.isFile(t.node.mode)){if(void 0===t.file)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM);r+=t.file.data.length}if(r<0)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EINVAL);return r}}class h{fs;constructor(t){this.fs=t}node(t){return(0,i.D_)(t)?t.node:t}getattr(t){const e=this.node(t);return{...this.fs.API.getattr(this.fs.realPath(e)),mode:e.mode,ino:e.id}}setattr(t,e){const s=this.node(t);for(const[t,i]of Object.entries(e))switch(t){case"mode":s.mode=i;break;case"timestamp":s.timestamp=i;break;case"size":{const t=i,e=this.fs.realPath(s);if(this.fs.FS.isFile(s.mode)&&t>=0){const s=this.fs.API.get(e),i=s.data?s.data:new Uint8Array;t!==i.length&&(t<i.length?s.data=s.data.slice(0,t):(s.data=new Uint8Array(t),s.data.set(i)),this.fs.API.put(e,s))}else console.warn("setattr size of",t,"on",s,"not yet implemented");break}default:console.warn("setattr",t,"of",i,"on",s,"not yet implemented")}}lookup(t,e){const s=this.node(t),i=this.fs.PATH.join2(this.fs.realPath(s),e),r=this.fs.API.lookup(i);if(!r.ok)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.ENOENT);return this.fs.createNode(s,e,r.mode,0)}mknod(t,e,s,i){const r=this.node(t),a=this.fs.PATH.join2(this.fs.realPath(r),e);return this.fs.API.mknod(a,s),this.fs.createNode(r,e,s,i)}rename(t,e,s){const i=this.node(t),r=this.node(e);this.fs.API.rename(i.parent?this.fs.PATH.join2(this.fs.realPath(i.parent),i.name):i.name,this.fs.PATH.join2(this.fs.realPath(r),s)),i.name=s,i.parent=r}unlink(t,e){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(t)),e))}rmdir(t,e){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(t)),e))}readdir(t){return this.fs.API.readdir(this.fs.realPath(this.node(t)))}symlink(t,e,s){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}readlink(t){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}}class l{constructor(t,e,s,i){this._driveName=t,this._mountpoint=e,this.FS=s,this.ERRNO_CODES=i}lookup(t){return this.request({method:"lookup",path:this.normalizePath(t)})}getmode(t){return this.request({method:"getmode",path:this.normalizePath(t)})}mknod(t,e){return this.request({method:"mknod",path:this.normalizePath(t),data:{mode:e}})}rename(t,e){return this.request({method:"rename",path:this.normalizePath(t),data:{newPath:this.normalizePath(e)}})}readdir(t){const e=this.request({method:"readdir",path:this.normalizePath(t)});return e.push("."),e.push(".."),e}rmdir(t){return this.request({method:"rmdir",path:this.normalizePath(t)})}get(t){const e=this.request({method:"get",path:this.normalizePath(t)});if(!e)throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT);const s=e.content,i=e.format;switch(i){case"json":case"text":return{data:r.encode(s),format:i};case"base64":{const t=atob(s),e=t.length,r=new Uint8Array(e);for(let s=0;s<e;s++)r[s]=t.charCodeAt(s);return{data:r,format:i}}default:throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT)}}put(t,e){switch(e.format){case"json":case"text":return this.request({method:"put",path:this.normalizePath(t),data:{format:e.format,data:a.decode(e.data)}});case"base64":{let s="";for(let t=0;t<e.data.byteLength;t++)s+=String.fromCharCode(e.data[t]);return this.request({method:"put",path:this.normalizePath(t),data:{format:e.format,data:btoa(s)}})}}}getattr(t){const e=this.request({method:"getattr",path:this.normalizePath(t)});return e.atime&&(e.atime=new Date(e.atime)),e.mtime&&(e.mtime=new Date(e.mtime)),e.ctime&&(e.ctime=new Date(e.ctime)),e.size=e.size||0,e}normalizePath(t){return t.startsWith(this._mountpoint)&&(t=t.slice(this._mountpoint.length)),this._driveName&&(t=`${this._driveName}:${t}`),t}_driveName;_mountpoint;FS;ERRNO_CODES}class d extends l{constructor(t,e,s,i,r){super(e,s,i,r),this._baseUrl=t}request(t){const e=new XMLHttpRequest;e.open("POST",encodeURI(this.endpoint),!1);try{e.send(JSON.stringify(t))}catch(t){console.error(t)}if(e.status>=400)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return JSON.parse(e.responseText)}get endpoint(){return`${this._baseUrl}api/drive`}_baseUrl}class c{FS;API;PATH;ERRNO_CODES;driveName;constructor(t){this.FS=t.FS,this.PATH=t.PATH,this.ERRNO_CODES=t.ERRNO_CODES,this.API=this.createAPI(t),this.driveName=t.driveName,this.node_ops=new h(this),this.stream_ops=new o(this)}node_ops;stream_ops;createAPI(t){return new d(t.baseUrl,t.driveName,t.mountpoint,t.FS,t.ERRNO_CODES)}mount(t){return this.createNode(null,t.mountpoint,511|i._j,0)}createNode(t,e,s,i){const r=this.FS;if(!r.isDir(s)&&!r.isFile(s))throw new r.ErrnoError(this.ERRNO_CODES.EINVAL);const a=r.createNode(t,e,s,i);return a.node_ops=this.node_ops,a.stream_ops=this.stream_ops,a}getMode(t){return this.API.getmode(t)}realPath(t){const e=[];let s=t;for(e.push(s.name);s.parent!==s;)s=s.parent,e.push(s.name);return e.reverse(),this.PATH.join.apply(null,e)}}},23986(t,e,s){s.d(e,{D_:()=>n,_j:()=>i,j6:()=>a,kL:()=>r});const i=16895,r=1,a=2;function n(t){return"node"in t}},65692(t,e,s){const i="function",r="64e10b34-2bf7-4616-9668-f99de5aa046e",a="get",n="has",o="set",{isArray:h}=Array;let{SharedArrayBuffer:l,window:d}=globalThis,{notify:c,wait:p,waitAsync:u}=Atomics,m=null;u||(u=t=>({value:new Promise(e=>{let s=new Worker("data:application/javascript,onmessage%3D(%7Bdata%3Ab%7D)%3D%3E(Atomics.wait(b%2C0)%2CpostMessage(0))");s.onmessage=e,s.postMessage(t)})}));try{new l(4)}catch(t){l=ArrayBuffer;const e=new WeakMap;if(d){const t=new Map,{prototype:{postMessage:s}}=Worker,i=e=>{const s=e.data?.[r];if(!h(s)){e.stopImmediatePropagation();const{id:i,sb:r}=s;t.get(i)(r)}};m=function(t,...a){const n=t?.[r];if(h(n)){const[t,s]=n;e.set(s,t),this.addEventListener("message",i)}return s.call(this,t,...a)},u=s=>({value:new Promise(i=>{t.set(e.get(s),i)}).then(i=>{t.delete(e.get(s)),e.delete(s);for(let t=0;t<i.length;t++)s[t]=i[t];return"ok"})})}else{const t=(t,e)=>({[r]:{id:t,sb:e}});c=s=>{postMessage(t(e.get(s),s))},addEventListener("message",t=>{const s=t.data?.[r];if(h(s)){const[t,i]=s;e.set(i,t)}})}}const{Int32Array:f,Map:_,Uint16Array:y}=globalThis,{BYTES_PER_ELEMENT:w}=f,{BYTES_PER_ELEMENT:P}=y,g=new WeakSet,E=new WeakMap,b={value:{then:t=>t()}};let R=0;const k=(t,{parse:e=JSON.parse,stringify:s=JSON.stringify,transform:d,interrupt:k}=JSON)=>{if(!E.has(t)){const v=m||t.postMessage,S=(e,...s)=>v.call(t,{[r]:s},{transfer:e}),O=typeof k===i?k:k?.handler,A=k?.delay||42,N=new TextDecoder("utf-16"),T=(t,e)=>t?u(e,0):(O?((t,e,s)=>{for(;"timed-out"===p(t,0,0,e);)s()})(e,A,O):p(e,0),b);let I=!1;E.set(t,new Proxy(new _,{[n]:(t,e)=>"string"==typeof e&&!e.startsWith("_"),[a]:(s,i)=>"then"===i?null:(...s)=>{const r=R++;let a=new f(new l(2*w)),n=[];g.has(s.at(-1)||n)&&g.delete(n=s.pop()),S(n,r,a,i,d?s.map(d):s);const o=t!==globalThis;let h=0;return I&&o&&(h=setTimeout(console.warn,1e3,`ðŸ’€ðŸ”’ - Possible deadlock if proxy.${i}(...args) is awaited`)),T(o,a).value.then(()=>{clearTimeout(h);const t=a[1];if(!t)return;const s=P*t;return a=new f(new l(s+s%w)),S([],r,a),T(o,a).value.then(()=>e(N.decode(new y(a.buffer).slice(0,t))))})},[o](e,a,n){const o=typeof n;if(o!==i)throw new Error(`Unable to assign ${a} as ${o}`);if(!e.size){const i=new _;t.addEventListener("message",async t=>{const a=t.data?.[r];if(h(a)){t.stopImmediatePropagation();const[r,n,...o]=a;let h;if(o.length){const[t,a]=o;if(e.has(t)){I=!0;try{const o=await e.get(t)(...a);if(void 0!==o){const t=s(d?d(o):o);i.set(r,t),n[1]=t.length}}catch(t){h=t}finally{I=!1}}else h=new Error(`Unsupported action: ${t}`);n[0]=1}else{const t=i.get(r);i.delete(r);for(let e=new y(n.buffer),s=0;s<t.length;s++)e[s]=t.charCodeAt(s)}if(c(n,0),h)throw h}})}return!!e.set(a,n)}}))}return E.get(t)};k.transfer=(...t)=>(g.add(t),t);const v=k;var S=s(15669);class O{constructor(){this._initialized=new Promise((t,e)=>{this._initializer={resolve:t,reject:e}})}async initialize(t){if(this._options=t,t.location.includes(":")){const e=t.location.split(":");this._driveName=e[0],this._localPath=e[1]}else this._driveName="",this._localPath=t.location;await this.initRuntime(t),await this.initFilesystem(t),await this.initPackageManager(t),await this.initKernel(t),await this.initGlobals(t),this._initializer?.resolve()}async initRuntime(t){const{pyodideUrl:e,indexUrl:s}=t;let i;if(i=(await import(e)).loadPyodide||self.loadPyodide,"function"!=typeof i)throw new Error(`Failed to load pyodide from ${e}. loadPyodide is not a function.`);this._pyodide=await i({indexURL:s,...t.loadPyodideOptions})}async initPackageManager(t){if(!this._options)throw new Error("Uninitialized");const{pipliteWheelUrl:e,disablePyPIFallback:s,pipliteUrls:i,loadPyodideOptions:r}=this._options,a=(r||{}).packages||[];a.includes("micropip")||await this._pyodide.loadPackage(["micropip"]),a.includes("piplite")||await this._pyodide.runPythonAsync(`\n      import micropip\n      await micropip.install('${e}', keep_going=True)\n    `),await this._pyodide.runPythonAsync(`\n      import piplite.piplite\n      piplite.piplite._PIPLITE_DISABLE_PYPI = ${s?"True":"False"}\n      piplite.piplite._PIPLITE_URLS = ${JSON.stringify(i)}\n    `)}async initKernel(t){const e=(t.loadPyodideOptions||{}).packages||[],s=["ssl","sqlite3","ipykernel","comm","pyodide_kernel","ipython"],i=[];for(const t of s)e.includes(t)||i.push(`await piplite.install('${t}', keep_going=True)`);i.push("import pyodide_kernel"),t.mountDrive&&this._localPath&&i.push("import os",`os.chdir("${this._localPath}")`),await this._pyodide.runPythonAsync(i.join("\n"))}async initGlobals(t){const{globals:e}=this._pyodide;this._kernel=e.get("pyodide_kernel").kernel_instance.copy(),this._stdout_stream=e.get("pyodide_kernel").stdout_stream.copy(),this._stderr_stream=e.get("pyodide_kernel").stderr_stream.copy(),this._interpreter=this._kernel.interpreter.copy(),this._interpreter.send_comm=this.sendComm.bind(this)}async initFilesystem(t){if(t.mountDrive){const e="/drive",{FS:i,PATH:r,ERRNO_CODES:a}=this._pyodide,{baseUrl:n}=t,{DriveFS:o}=await s.e(2738).then(s.bind(s,42738)),h=new o({FS:i,PATH:r,ERRNO_CODES:a,baseUrl:n,driveName:this._driveName,mountpoint:e});i.mkdirTree(e),i.mount(h,{},e),i.chdir(e),this._driveFS=h}}mapToObject(t){const e=t instanceof Array?[]:{};return t.forEach((t,s)=>{e[s]=t instanceof Map||t instanceof Array?this.mapToObject(t):t}),e}formatResult(t){if(!(t instanceof this._pyodide.ffi.PyProxy))return t;const e=t.toJs();return this.mapToObject(e)}registerCallback(t){this._sendWorkerMessage=t}async setup(t){await this._initialized,this._kernel._parent_header=this._pyodide.toPy(t)}async execute(t,e){await this.setup(e);const s=(t,e)=>{const s={name:this.formatResult(t),text:this.formatResult(e)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:s,type:"stream"})};this._stdout_stream.publish_stream_callback=s,this._stderr_stream.publish_stream_callback=s,this._interpreter.display_pub.clear_output_callback=t=>{const e={wait:this.formatResult(t)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:e,type:"clear_output"})},this._interpreter.display_pub.display_data_callback=(t,e,s)=>{const i={data:this.formatResult(t),metadata:this.formatResult(e),transient:this.formatResult(s)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:i,type:"display_data"})},this._interpreter.display_pub.update_display_data_callback=(t,e,s)=>{const i={data:this.formatResult(t),metadata:this.formatResult(e),transient:this.formatResult(s)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:i,type:"update_display_data"})},this._interpreter.displayhook.publish_execution_result=(t,e,s)=>{const i={execution_count:t,data:this.formatResult(e),metadata:this.formatResult(s)};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:i,type:"execute_result"})},this._interpreter.input=this.input.bind(this),this._interpreter.getpass=this.getpass.bind(this);const i=await this._kernel.run(t.code),r=this.formatResult(i);return"error"===r.status&&((t,e,s)=>{const i={ename:t,evalue:e,traceback:s};this._sendWorkerMessage({parentHeader:this.formatResult(this._kernel._parent_header).header,bundle:i,type:"execute_error"})})(r.ename,r.evalue,r.traceback),r}async complete(t,e){await this.setup(e);const s=this._kernel.complete(t.code,t.cursor_pos);return this.formatResult(s)}async inspect(t,e){await this.setup(e);const s=this._kernel.inspect(t.code,t.cursor_pos,t.detail_level);return this.formatResult(s)}async isComplete(t,e){await this.setup(e);const s=this._kernel.is_complete(t.code);return this.formatResult(s)}async commInfo(t,e){await this.setup(e);const s=this._kernel.comm_info(t.target_name);return{comms:this.formatResult(s),status:"ok"}}async commOpen(t,e){await this.setup(e);const s=this._kernel.comm_manager.comm_open(this._pyodide.toPy(null),this._pyodide.toPy(null),this._pyodide.toPy(t));return this.formatResult(s)}async commMsg(t,e){await this.setup(e);const s=this._kernel.comm_manager.comm_msg(this._pyodide.toPy(null),this._pyodide.toPy(null),this._pyodide.toPy(t));return this.formatResult(s)}async commClose(t,e){await this.setup(e);const s=this._kernel.comm_manager.comm_close(this._pyodide.toPy(null),this._pyodide.toPy(null),this._pyodide.toPy(t));return this.formatResult(s)}async inputReply(t,e){await this.setup(e),this._resolveInputReply(t)}async sendInputRequest(t,e){const s={prompt:t,password:e};this._sendWorkerMessage({type:"input_request",parentHeader:this.formatResult(this._kernel._parent_header).header,content:s})}async getpass(t){t=void 0===t?"":t,await this.sendInputRequest(t,!0);const e=new Promise(t=>{this._resolveInputReply=t});return(await e).value}async input(t){t=void 0===t?"":t,await this.sendInputRequest(t,!1);const e=new Promise(t=>{this._resolveInputReply=t});return(await e).value}async sendComm(t,e,s,i,r){this._sendWorkerMessage({type:t,content:this.formatResult(e),metadata:this.formatResult(s),ident:this.formatResult(i),buffers:this.formatResult(r),parentHeader:this.formatResult(this._kernel._parent_header).header})}_options=null;_initialized;_initializer=null;_pyodide=null;_localPath="";_driveName="";_kernel;_interpreter;_stdout_stream;_stderr_stream;_resolveInputReply;_driveFS=null;_sendWorkerMessage=()=>{}}const A=v(self);class N extends S.Lf{request(t){return A.processDriveRequest(t)}}class T extends S.AP{createAPI(t){return new N(t.driveName,t.mountpoint,t.FS,t.ERRNO_CODES)}}const I=new class extends O{async initFilesystem(t){if(t.mountDrive){const e="/drive",{FS:s,PATH:i,ERRNO_CODES:r}=this._pyodide,{baseUrl:a}=t,n=new T({FS:s,PATH:i,ERRNO_CODES:r,baseUrl:a,driveName:this._driveName,mountpoint:e});s.mkdirTree(e),s.mount(n,{},e),s.chdir(e),this._driveFS=n}}},C=A.processWorkerMessage.bind(A);I.registerCallback(C),A.initialize=I.initialize.bind(I),A.execute=I.execute.bind(I),A.complete=I.complete.bind(I),A.inspect=I.inspect.bind(I),A.isComplete=I.isComplete.bind(I),A.commInfo=I.commInfo.bind(I),A.commOpen=I.commOpen.bind(I),A.commMsg=I.commMsg.bind(I),A.commClose=I.commClose.bind(I),A.inputReply=I.inputReply.bind(I)}},e={};function s(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,s),a.exports}s.m=t,s.c=e,s.d=(t,e)=>{for(var i in e)s.o(e,i)&&!s.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce((e,i)=>(s.f[i](t,e),e),[])),s.u=t=>t+".0bd1de2e2e0cb6745f0d.js?v=0bd1de2e2e0cb6745f0d",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{s.S={};var t={},e={};s.I=(i,r)=>{r||(r=[]);var a=e[i];if(a||(a=e[i]={}),!(r.indexOf(a)>=0)){if(r.push(a),t[i])return t[i];s.o(s.S,i)||(s.S[i]={}),s.S[i];var n=[];return t[i]=n.length?Promise.all(n).then(()=>t[i]=1):1}}})(),(()=>{var t;s.g.importScripts&&(t=s.g.location+"");var e=s.g.document;if(!t&&e&&(e.currentScript&&"SCRIPT"===e.currentScript.tagName.toUpperCase()&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");if(i.length)for(var r=i.length-1;r>-1&&(!t||!/^http(s?):/.test(t));)t=i[r--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=t})(),(()=>{var t={5692:1};s.f.i=(e,i)=>{t[e]||importScripts(s.p+s.u(e))};var e=self.webpackChunk_datalayer_jupyter_viewer=self.webpackChunk_datalayer_jupyter_viewer||[],i=e.push.bind(e);e.push=e=>{var[r,a,n]=e;for(var o in a)s.o(a,o)&&(s.m[o]=a[o]);for(n&&n(s);r.length;)t[r.pop()]=1;i(e)}})(),s(65692)})();