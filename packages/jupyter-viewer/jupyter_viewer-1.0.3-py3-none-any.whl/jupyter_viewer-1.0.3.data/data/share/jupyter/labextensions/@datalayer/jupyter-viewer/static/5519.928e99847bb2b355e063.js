(self.webpackChunk_datalayer_jupyter_viewer=self.webpackChunk_datalayer_jupyter_viewer||[]).push([[5519],{7184(e,t,n){"use strict";n.d(t,{j:()=>p});var r=n(63343),s=n(11667),i=n(38976),a=n(93962),o=n(59798),c=n(67262),h=n(74602);new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");const l=new Error("request for lock canceled");var d=function(e,t,n,r){return new(n||(n=Promise))(function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,o)}c((r=r.apply(e,t||[])).next())})};class u{constructor(e,t=l){if(this._maxConcurrency=e,this._cancelError=t,this._queue=[],this._waiters=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}acquire(){const e=this.isLocked(),t=new Promise((e,t)=>this._queue.push({resolve:e,reject:t}));return e||this._dispatch(),t}runExclusive(e){return d(this,void 0,void 0,function*(){const[t,n]=yield this.acquire();try{return yield e(t)}finally{n()}})}waitForUnlock(){return d(this,void 0,void 0,function*(){return this.isLocked()?new Promise(e=>this._waiters.push({resolve:e})):Promise.resolve()})}isLocked(){return this._value<=0}release(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){const e=this._currentReleaser;this._currentReleaser=void 0,e()}}cancel(){this._queue.forEach(e=>e.reject(this._cancelError)),this._queue=[]}_dispatch(){const e=this._queue.shift();if(!e)return;let t=!1;this._currentReleaser=()=>{t||(t=!0,this._value++,this._resolveWaiters(),this._dispatch())},e.resolve([this._value--,this._currentReleaser])}_resolveWaiters(){this._waiters.forEach(e=>e.resolve()),this._waiters=[]}}class f{constructor(e){this._semaphore=new u(1,e)}acquire(){return e=this,t=void 0,r=function*(){const[,e]=yield this._semaphore.acquire();return e},new((n=void 0)||(n=Promise))(function(s,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function o(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,o)}c((r=r.apply(e,t||[])).next())});var e,t,n,r}runExclusive(e){return this._semaphore.runExclusive(()=>e())}isLocked(){return this._semaphore.isLocked()}waitForUnlock(){return this._semaphore.waitForUnlock()}release(){this._semaphore.release()}cancel(){return this._semaphore.cancel()}}var m=n(11644);const g=o.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg;class p{constructor(e){const{kernelspecs:t}=e;this._kernelspecs=t,this._kernels.changed.connect((e,t)=>{this._changed.emit(t)})}get changed(){return this._changed}async startNew(e){const{id:t,name:n,location:s}=e,o=this._kernelspecs.factories.get(n);if(!o)return console.error("No factory associated with",n,this._kernelspecs.factories),{id:t,name:n};const h=new f,l=(e,t,n)=>{const r=this._kernels.get(e);if(!r)throw Error(`No kernel ${e}`);this._clients.set(t,n),this._kernelClients.get(e)?.add(t),n.on("message",async e=>{let t;if(e instanceof ArrayBuffer)e=new Uint8Array(e).buffer,t=(0,a.deserialize)(e,g);else{if("string"!=typeof e)return;{const n=(new TextEncoder).encode(e);t=(0,a.deserialize)(n.buffer,g)}}"input_reply"===t.header.msg_type?r.handleMessage(t):(async e=>{await h.runExclusive(async()=>{await r.ready,await r.handleMessage(e)})})(t)});const s=()=>{this._clients.delete(t),this._kernelClients.get(e)?.delete(t)};r.disposed.connect(s),n.onclose=s},d=t??c.UUID.uuid4(),u=r.URLExt.join(p.WS_BASE_URL,i.KernelAPI.KERNEL_SERVICE_URL,encodeURIComponent(d),"channels"),_=this._kernels.get(d);if(_)return{id:_.id,name:_.name};const w=await o({id:d,sendMessage:e=>{const t=e.header.session,n=this._clients.get(t);if(!n)return void console.warn(`Trying to send message on removed socket for kernel ${d}`);const r=(0,a.serialize)(e,g);if("iopub"===e.channel){const e=this._kernelClients.get(d);return void e?.forEach(e=>{this._clients.get(e)?.send(r)})}n.send(r)},name:n,location:s});this._kernels.set(d,w),this._kernelClients.set(d,new Set);const y=new m.Server(u,{mock:!1,selectProtocol:()=>g});return y.on("connection",e=>{const t=new URL(e.url).searchParams.get("session_id")??"";l(d,t,e)}),y.on("close",()=>{this._clients.keys().forEach(e=>{const t=this._clients.get(e);t?.readyState===WebSocket.CLOSED&&(this._clients.delete(e),this._kernelClients.get(d)?.delete(e))})}),w.disposed.connect(()=>{y.close(),this._kernels.delete(d),this._kernelClients.delete(d)}),{id:w.id,name:w.name}}async restart(e){const t=this._kernels.get(e);if(!t)throw Error(`Kernel ${e} does not exist`);const{id:n,name:r,location:s}=t;return t.dispose(),this.startNew({id:n,name:r,location:s})}async list(){return[...this._kernels.values()].map(e=>({id:e.id,name:e.name}))}async shutdown(e){this._kernels.delete(e)?.dispose()}async get(e){return this._kernels.get(e)}_kernels=new s.ObservableMap;_clients=new s.ObservableMap;_kernelClients=new s.ObservableMap;_kernelspecs;_changed=new h.Signal(this)}!function(e){e.WS_BASE_URL=r.PageConfig.getBaseUrl().replace(/^http/,"ws")}(p||(p={}))},12859(e,t,n){"use strict";n.d(t,{A:()=>a});var r=n(63343),s=n(64053),i=n(67262);class a{constructor(e){this._kernels=e.kernels,this._kernels.changed.connect((e,t)=>{switch(t.type){case"remove":{const e=t.oldValue?.id;if(!e)return;const n=this._sessions.find(t=>t.kernel?.id===e);if(!n)return;this._pendingRestarts.add(e),setTimeout(async()=>{this._pendingRestarts.has(e)&&(this._pendingRestarts.delete(e),await this.shutdown(n.id))},100);break}case"add":{const e=t.newValue?.id;if(!e)return;this._pendingRestarts.delete(e);break}}})}async get(e){const t=this._sessions.find(t=>t.id===e);if(!t)throw Error(`Session ${e} not found`);return t}async list(){return this._sessions}async patch(e){const{id:t,path:n,name:s,kernel:a}=e,o=this._sessions.findIndex(e=>e.id===t),c=this._sessions[o];if(!c)throw Error(`Session ${t} not found`);const h={...c,path:n??c.path,name:s??c.name};if(a)if(a.id){const e=this._sessions.find(e=>e.kernel?.id===a?.id);e&&(h.kernel=e.kernel)}else if(a.name){const e=await this._kernels.startNew({id:i.UUID.uuid4(),name:a.name,location:r.PathExt.dirname(h.path)});e&&(h.kernel=e),this._handleKernelShutdown({kernelId:e.id,sessionId:c.id})}return this._sessions[o]=h,h}async startNew(e){const{path:t,name:n}=e,s=this._sessions.find(e=>e.name===n);if(s)return s;const a=e.kernel?.name??"",o=e.id??i.UUID.uuid4(),c=e.name??e.path,h=r.PathExt.dirname(e.name)||r.PathExt.dirname(e.path),l=c.includes(":")?c.split(":")[0]:"",d=h.includes(l)?h:`${l}:${h}`,u=await this._kernels.startNew({id:o,name:a,location:d}),f={id:o,path:t,name:n??t,type:"notebook",kernel:{id:u.id,name:u.name}};return this._sessions.push(f),this._handleKernelShutdown({kernelId:o,sessionId:f.id}),f}async shutdown(e){const t=this._sessions.find(t=>t.id===e);if(!t)throw Error(`Session ${e} not found`);const n=t.kernel?.id;n&&await this._kernels.shutdown(n),s.ArrayExt.removeFirstOf(this._sessions,t)}async _handleKernelShutdown({kernelId:e,sessionId:t}){}_kernels;_sessions=[];_pendingRestarts=new Set}},15398(e,t,n){"use strict";n.d(t,{v:()=>h});var r=n(63343),s=n(42386),i=n(67262);const a="JupyterLite Storage",o=new TextEncoder,c=new TextDecoder("utf-8");class h{constructor(e){this._localforage=e.localforage,this._storageName=e.storageName||a,this._storageDrivers=e.storageDrivers||null,this._ready=new i.PromiseDelegate}async initialize(){await this.initStorage(),this._ready.resolve(void 0)}async initStorage(){this._storage=this.createDefaultStorage(),this._counters=this.createDefaultCounters(),this._checkpoints=this.createDefaultCheckpoints()}get ready(){return this._ready.promise}get storage(){return this.ready.then(()=>this._storage)}get counters(){return this.ready.then(()=>this._counters)}get checkpoints(){return this.ready.then(()=>this._checkpoints)}get defaultStorageOptions(){const e=this._storageDrivers&&this._storageDrivers.length?this._storageDrivers:null;return{version:1,name:this._storageName,...e?{driver:e}:{}}}createDefaultStorage(){return this._localforage.createInstance({description:"Offline Storage for Notebooks and Files",storeName:"files",...this.defaultStorageOptions})}createDefaultCounters(){return this._localforage.createInstance({description:"Store the current file suffix counters",storeName:"counters",...this.defaultStorageOptions})}createDefaultCheckpoints(){return this._localforage.createInstance({description:"Offline Storage for Checkpoints",storeName:"checkpoints",...this.defaultStorageOptions})}async newUntitled(e){const t=e?.path??"",n=e?.type??"notebook",i=(new Date).toISOString();let a=r.PathExt.dirname(t);const c=r.PathExt.basename(t),h=r.PathExt.extname(t),d=await this.get(a);let u,f="";switch(t&&!h&&d?(a=`${t}/`,f=""):a&&c?(a=`${a}/`,f=c):(a="",f=t),n){case"directory":f=`Untitled Folder${await this._incrementCounter("directory")||""}`,u={name:f,path:`${a}${f}`,last_modified:i,created:i,format:"json",mimetype:"",content:null,size:0,writable:!0,type:"directory"};break;case"notebook":{const e=await this._incrementCounter("notebook");f=f||`Untitled${e||""}.ipynb`,u={name:f,path:`${a}${f}`,last_modified:i,created:i,format:"json",mimetype:s.xG.JSON,content:l.EMPTY_NB,size:o.encode(JSON.stringify(l.EMPTY_NB)).length,writable:!0,type:"notebook"};break}default:{const t=e?.ext??".txt",n=await this._incrementCounter("file"),r=s.PW.getType(t)||s.xG.OCTET_STREAM;let o;o=s.PW.hasFormat(t,"text")||-1!==r.indexOf("text")?"text":-1!==t.indexOf("json")||-1!==t.indexOf("ipynb")?"json":"base64",f=f||`untitled${n||""}${t}`,u={name:f,path:`${a}${f}`,last_modified:i,created:i,format:o,mimetype:r,content:"",size:0,writable:!0,type:"file"};break}}const m=u.path;return await(await this.storage).setItem(m,u),u}async copy(e,t){let n=r.PathExt.basename(e);for(t=""===t?"":`${r.PathExt.removeSlash(t)}/`;await this.get(`${t}${n}`,{content:!0});){const e=r.PathExt.extname(n),t=n.replace(e,"");n=`${t} (copy)${e}`}const s=`${t}${n}`;let i=await this.get(e,{content:!0});if(!i)throw Error(`Could not find file with path ${e}`);return i={...i,name:n,path:s},await(await this.storage).setItem(s,i),i}async get(e,t){if(""===(e=decodeURIComponent(e.replace(/^\//,""))))return await this._getFolder(e);const n=await this.storage,i=await n.getItem(e),a=await this._getServerContents(e,t),o=i||a;if(!o)return null;if(!t?.content)return{size:0,...o,content:null};if("directory"===o.type){const t=new Map;await n.iterate((n,r)=>{r===`${e}/${n.name}`&&t.set(n.name,n)});const i=a?a.content:Array.from((await this._getServerDirectory(e)).values());for(const e of i)t.has(e.name)||t.set(e.name,e);const c=[...t.values()];return{name:r.PathExt.basename(e),path:e,last_modified:o.last_modified,created:o.created,format:"json",mimetype:s.xG.JSON,content:c,size:0,writable:!0,type:"directory"}}return o}async rename(e,t){const n=decodeURIComponent(e),s=await this.get(n,{content:!0});if(!s)throw Error(`Could not find file with path ${n}`);const i=(new Date).toISOString(),a=r.PathExt.basename(t),o={...s,name:a,path:t,last_modified:i},c=await this.storage;if(await c.setItem(t,o),await c.removeItem(n),await(await this.checkpoints).removeItem(n),"directory"===s.type){let n;for(n of s.content)await this.rename(r.URLExt.join(e,n.name),r.URLExt.join(t,n.name))}return o}async save(e,t={}){e=decodeURIComponent(e);const n=r.PathExt.extname(t.name??""),i=t.chunk,a=!!i&&(i>1||-1===i);let h=await this.get(e,{content:a});if(h||(h=await this.newUntitled({path:e,ext:n,type:"file"})),!h)return null;const l=h.content,d=(new Date).toISOString();if(h={...h,...t,last_modified:d},t.content&&"base64"===t.format){const e=!i||-1===i,r=this._handleUploadChunk(t.content,l,a);if(".ipynb"===n){const t=e?JSON.parse(c.decode(this._binaryStringToBytes(r))):r;h={...h,content:t,format:"json",type:"notebook",size:r.length}}else if(s.PW.hasFormat(n,"json")){const t=e?JSON.parse(c.decode(this._binaryStringToBytes(r))):r;h={...h,content:t,format:"json",type:"file",size:r.length}}else if(s.PW.hasFormat(n,"text")){const t=e?c.decode(this._binaryStringToBytes(r)):r;h={...h,content:t,format:"text",type:"file",size:r.length}}else{const t=e?btoa(r):r;h={...h,content:t,format:"base64",type:"file",size:r.length}}}if(h.content)switch(t.format){case"json":h={...h,size:o.encode(JSON.stringify(h.content)).length};break;case"text":h={...h,size:o.encode(h.content).length};break;case"base64":break;default:h={...h,size:0}}else h={...h,size:0};return await(await this.storage).setItem(e,h),h}async delete(e){const t=`${e=decodeURIComponent(e)}/`,n=(await(await this.storage).keys()).filter(n=>n===e||n.startsWith(t));await Promise.all(n.map(this.forgetPath,this))}async forgetPath(e){await Promise.all([(await this.storage).removeItem(e),(await this.checkpoints).removeItem(e)])}async createCheckpoint(e){const t=await this.checkpoints;e=decodeURIComponent(e);const n=await this.get(e,{content:!0});if(!n)throw Error(`Could not find file with path ${e}`);const r=(await t.getItem(e)??[]).filter(Boolean);return r.push(n),r.length>5&&r.splice(0,r.length-5),await t.setItem(e,r),{id:""+(r.length-1),last_modified:n.last_modified}}async listCheckpoints(e){return(await(await this.checkpoints).getItem(e)||[]).filter(Boolean).map(this.normalizeCheckpoint,this)}normalizeCheckpoint(e,t){return{id:t.toString(),last_modified:e.last_modified}}async restoreCheckpoint(e,t){e=decodeURIComponent(e);const n=(await(await this.checkpoints).getItem(e)||[])[parseInt(t)];await(await this.storage).setItem(e,n)}async deleteCheckpoint(e,t){e=decodeURIComponent(e);const n=await(await this.checkpoints).getItem(e)||[],r=parseInt(t);n.splice(r,1),await(await this.checkpoints).setItem(e,n)}_handleUploadChunk(e,t,n){const r=atob(e);return n?t+r:r}_binaryStringToBytes(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}async _getFolder(e){const t=new Map,n=await this.storage;await n.iterate((e,n)=>{n.includes("/")||t.set(e.path,e)});for(const n of(await this._getServerDirectory(e)).values())t.has(n.path)||t.set(n.path,n);return e&&0===t.size?null:{name:"",path:e,last_modified:new Date(0).toISOString(),created:new Date(0).toISOString(),format:"json",mimetype:s.xG.JSON,content:Array.from(t.values()),size:0,writable:!0,type:"directory"}}async _getServerContents(e,t){const n=r.PathExt.basename(e);let i=(await this._getServerDirectory(r.URLExt.join(e,".."))).get(n);if(!i)return null;if(i=i||{name:n,path:e,last_modified:new Date(0).toISOString(),created:new Date(0).toISOString(),format:"text",mimetype:s.xG.PLAIN_TEXT,type:"file",writable:!0,size:0,content:""},t?.content)if("directory"===i.type){const t=await this._getServerDirectory(e);i={...i,content:Array.from(t.values())}}else{const t=r.URLExt.join(r.PageConfig.getBaseUrl(),"files",e),a=await fetch(t);if(!a.ok)return null;const c=i.mimetype||a.headers.get("Content-Type"),h=r.PathExt.extname(n);if("notebook"===i.type||s.PW.hasFormat(h,"json")||-1!==c?.indexOf("json")||e.match(/\.(ipynb|[^/]*json[^/]*)$/)){const e=await a.text();i={...i,content:JSON.parse(e),format:"json",mimetype:i.mimetype||s.xG.JSON,size:o.encode(e).length}}else if(s.PW.hasFormat(h,"text")||-1!==c.indexOf("text")){const e=await a.text();i={...i,content:e,format:"text",mimetype:c||s.xG.PLAIN_TEXT,size:o.encode(e).length}}else{const e=await a.arrayBuffer(),t=new Uint8Array(e);i={...i,content:btoa(t.reduce(this.reduceBytesToString,"")),format:"base64",mimetype:c||s.xG.OCTET_STREAM,size:t.length}}}return i}reduceBytesToString=(e,t)=>e+String.fromCharCode(t);async _getServerDirectory(e){const t=this._serverContents.get(e)||new Map;if(!this._serverContents.has(e)){const n=r.URLExt.join(r.PageConfig.getBaseUrl(),"api/contents",e,"all.json");try{const e=await fetch(n),r=JSON.parse(await e.text());for(const e of r.content)t.set(e.name,e)}catch(e){console.warn(`don't worry, about ${e}... nothing's broken. If there had been a\n          file at ${n}, you might see some more files.`)}this._serverContents.set(e,t)}return t}async _incrementCounter(e){const t=await this.counters,n=(await t.getItem(e)??-1)+1;return await t.setItem(e,n),n}_serverContents=new Map;_storageName=a;_storageDrivers=null;_ready;_storage;_counters;_checkpoints;_localforage}var l;!function(e){e.EMPTY_NB={metadata:{orig_nbformat:4},nbformat_minor:5,nbformat:4,cells:[]}}(l||(l={}))},15669(e,t,n){"use strict";n.d(t,{AP:()=>m,Lf:()=>u,cS:()=>a,cW:()=>i,kz:()=>f,m3:()=>l,un:()=>d,zw:()=>s});var r=n(23986);const s=":",i="/api/drive.v1",a=4096,o=new TextEncoder,c=new TextDecoder("utf-8"),h={0:!1,1:!0,2:!0,64:!0,65:!0,66:!0,129:!0,193:!0,514:!0,577:!0,578:!0,705:!0,706:!0,1024:!0,1025:!0,1026:!0,1089:!0,1090:!0,1153:!0,1154:!0,1217:!0,1218:!0,4096:!0,4098:!0};class l{fs;constructor(e){this.fs=e}open(e){const t=this.fs.realPath(e.node);this.fs.FS.isFile(e.node.mode)&&(e.file=this.fs.API.get(t))}close(e){if(!this.fs.FS.isFile(e.node.mode)||!e.file)return;const t=this.fs.realPath(e.node),n=e.flags;let r="string"==typeof n?parseInt(n,10):n;r&=8191;let s=!0;r in h&&(s=h[r]),s&&this.fs.API.put(t,e.file),e.file=void 0}read(e,t,n,r,s){if(r<=0||void 0===e.file||s>=(e.file.data.length||0))return 0;const i=Math.min(e.file.data.length-s,r);return t.set(e.file.data.subarray(s,s+i),n),i}write(e,t,n,r,s){if(r<=0||void 0===e.file)return 0;if(e.node.timestamp=Date.now(),s+r>(e.file?.data.length||0)){const t=e.file.data?e.file.data:new Uint8Array;e.file.data=new Uint8Array(s+r),e.file.data.set(t)}return e.file.data.set(t.subarray(n,n+r),s),r}llseek(e,t,n){let s=t;if(n===r.kL)s+=e.position;else if(n===r.j6&&this.fs.FS.isFile(e.node.mode)){if(void 0===e.file)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM);s+=e.file.data.length}if(s<0)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EINVAL);return s}}class d{fs;constructor(e){this.fs=e}node(e){return(0,r.D_)(e)?e.node:e}getattr(e){const t=this.node(e);return{...this.fs.API.getattr(this.fs.realPath(t)),mode:t.mode,ino:t.id}}setattr(e,t){const n=this.node(e);for(const[e,r]of Object.entries(t))switch(e){case"mode":n.mode=r;break;case"timestamp":n.timestamp=r;break;case"size":{const e=r,t=this.fs.realPath(n);if(this.fs.FS.isFile(n.mode)&&e>=0){const n=this.fs.API.get(t),r=n.data?n.data:new Uint8Array;e!==r.length&&(e<r.length?n.data=n.data.slice(0,e):(n.data=new Uint8Array(e),n.data.set(r)),this.fs.API.put(t,n))}else console.warn("setattr size of",e,"on",n,"not yet implemented");break}default:console.warn("setattr",e,"of",r,"on",n,"not yet implemented")}}lookup(e,t){const n=this.node(e),r=this.fs.PATH.join2(this.fs.realPath(n),t),s=this.fs.API.lookup(r);if(!s.ok)throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.ENOENT);return this.fs.createNode(n,t,s.mode,0)}mknod(e,t,n,r){const s=this.node(e),i=this.fs.PATH.join2(this.fs.realPath(s),t);return this.fs.API.mknod(i,n),this.fs.createNode(s,t,n,r)}rename(e,t,n){const r=this.node(e),s=this.node(t);this.fs.API.rename(r.parent?this.fs.PATH.join2(this.fs.realPath(r.parent),r.name):r.name,this.fs.PATH.join2(this.fs.realPath(s),n)),r.name=n,r.parent=s}unlink(e,t){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(e)),t))}rmdir(e,t){this.fs.API.rmdir(this.fs.PATH.join2(this.fs.realPath(this.node(e)),t))}readdir(e){return this.fs.API.readdir(this.fs.realPath(this.node(e)))}symlink(e,t,n){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}readlink(e){throw new this.fs.FS.ErrnoError(this.fs.ERRNO_CODES.EPERM)}}class u{constructor(e,t,n,r){this._driveName=e,this._mountpoint=t,this.FS=n,this.ERRNO_CODES=r}lookup(e){return this.request({method:"lookup",path:this.normalizePath(e)})}getmode(e){return this.request({method:"getmode",path:this.normalizePath(e)})}mknod(e,t){return this.request({method:"mknod",path:this.normalizePath(e),data:{mode:t}})}rename(e,t){return this.request({method:"rename",path:this.normalizePath(e),data:{newPath:this.normalizePath(t)}})}readdir(e){const t=this.request({method:"readdir",path:this.normalizePath(e)});return t.push("."),t.push(".."),t}rmdir(e){return this.request({method:"rmdir",path:this.normalizePath(e)})}get(e){const t=this.request({method:"get",path:this.normalizePath(e)});if(!t)throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT);const n=t.content,r=t.format;switch(r){case"json":case"text":return{data:o.encode(n),format:r};case"base64":{const e=atob(n),t=e.length,s=new Uint8Array(t);for(let n=0;n<t;n++)s[n]=e.charCodeAt(n);return{data:s,format:r}}default:throw new this.FS.ErrnoError(this.ERRNO_CODES.ENOENT)}}put(e,t){switch(t.format){case"json":case"text":return this.request({method:"put",path:this.normalizePath(e),data:{format:t.format,data:c.decode(t.data)}});case"base64":{let n="";for(let e=0;e<t.data.byteLength;e++)n+=String.fromCharCode(t.data[e]);return this.request({method:"put",path:this.normalizePath(e),data:{format:t.format,data:btoa(n)}})}}}getattr(e){const t=this.request({method:"getattr",path:this.normalizePath(e)});return t.atime&&(t.atime=new Date(t.atime)),t.mtime&&(t.mtime=new Date(t.mtime)),t.ctime&&(t.ctime=new Date(t.ctime)),t.size=t.size||0,t}normalizePath(e){return e.startsWith(this._mountpoint)&&(e=e.slice(this._mountpoint.length)),this._driveName&&(e=`${this._driveName}${s}${e}`),e}_driveName;_mountpoint;FS;ERRNO_CODES}class f extends u{constructor(e,t,n,r,s){super(t,n,r,s),this._baseUrl=e}request(e){const t=new XMLHttpRequest;t.open("POST",encodeURI(this.endpoint),!1);try{t.send(JSON.stringify(e))}catch(e){console.error(e)}if(t.status>=400)throw new this.FS.ErrnoError(this.ERRNO_CODES.EINVAL);return JSON.parse(t.responseText)}get endpoint(){return`${this._baseUrl}api/drive`}_baseUrl}class m{FS;API;PATH;ERRNO_CODES;driveName;constructor(e){this.FS=e.FS,this.PATH=e.PATH,this.ERRNO_CODES=e.ERRNO_CODES,this.API=this.createAPI(e),this.driveName=e.driveName,this.node_ops=new d(this),this.stream_ops=new l(this)}node_ops;stream_ops;createAPI(e){return new f(e.baseUrl,e.driveName,e.mountpoint,e.FS,e.ERRNO_CODES)}mount(e){return this.createNode(null,e.mountpoint,511|r._j,0)}createNode(e,t,n,r){const s=this.FS;if(!s.isDir(n)&&!s.isFile(n))throw new s.ErrnoError(this.ERRNO_CODES.EINVAL);const i=s.createNode(e,t,n,r);return i.node_ops=this.node_ops,i.stream_ops=this.stream_ops,i}getMode(e){return this.API.getmode(e)}realPath(e){const t=[];let n=e;for(t.push(n.name);n.parent!==n;)n=n.parent,t.push(n.name);return t.reverse(),this.PATH.join.apply(null,t)}}},23986(e,t,n){"use strict";n.d(t,{D_:()=>o,_j:()=>r,j6:()=>a,kL:()=>i,rE:()=>s});const r=16895,s=33206,i=1,a=2;function o(e){return"node"in e}},31637(e,t,n){"use strict";n.d(t,{Y:()=>i});var r=n(15669),s=n(78532);class i{isDisposed=!1;constructor(e){this._contents=e.contents,this._driveContentsProcessor=new s.l({contentsManager:this._contents})}get enabled(){return this._enabled}enable(){this._channel?console.warn("BroadcastChannel already created and enabled"):(this._channel=new BroadcastChannel(r.cW),this._channel.addEventListener("message",this._onMessage),this._enabled=!0)}disable(){this._channel&&(this._channel.removeEventListener("message",this._onMessage),this._channel=null),this._enabled=!1}dispose(){this.isDisposed||(this.disable(),this.isDisposed=!0)}_onMessage=async e=>{if(!this._channel)return;const t=e.data,n=t?.receiver;if("broadcast.ts"!==n)return;const r=await this._driveContentsProcessor.processDriveRequest(t);this._channel.postMessage(r)};_channel=null;_contents;_driveContentsProcessor;_enabled=!1}},39768(e,t,n){"use strict";n.d(t,{L:()=>r});const r=new(n(67262).Token)("@jupyterlite/session:ISessions")},40820(e){e.exports=function(){"use strict";function e(t){return e.result||(t&&"function"==typeof t.getSerializer||Promise.reject(new Error("localforage.getSerializer() was not available! localforage v1.4+ is required!")),e.result=t.getSerializer()),e.result}function t(e,t){t&&e.then(function(e){t(null,e)},function(e){t(e)})}var n={};return{_driver:"memoryStorageDriver",_initStorage:function(t){var r={};if(t)for(var s in t)r[s]=t[s];var i=n[r.name]=n[r.name]||{},a=i[r.storeName]=i[r.storeName]||{};return r.db=a,this._dbInfo=r,e(this).then(function(e){r.serializer=e})},iterate:function(e,n){var r=this,s=r.ready().then(function(){var t=r._dbInfo.db,n=1;for(var s in t)if(t.hasOwnProperty(s)){var i=t[s];if(i&&(i=r._dbInfo.serializer.deserialize(i)),void 0!==(i=e(i,s,n++)))return i}});return t(s,n),s},getItem:function(e,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=r.ready().then(function(){var t=r._dbInfo.db[e];return t&&(t=r._dbInfo.serializer.deserialize(t)),t});return t(s,n),s},setItem:function(e,n,r){var s=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var i=s.ready().then(function(){void 0===n&&(n=null);var t=n;return function(e){return new Promise(function(t,n){s._dbInfo.serializer.serialize(e,function(e,r){r?n(r):t(e)})})}(n).then(function(n){return s._dbInfo.db[e]=n,t})});return t(i,r),i},removeItem:function(e,n){var r=this;"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e));var s=r.ready().then(function(){var t=r._dbInfo.db;t.hasOwnProperty(e)&&delete t[e]});return t(s,n),s},clear:function(e){var n=this,r=n.ready().then(function(){var e=n._dbInfo.db;for(var t in e)e.hasOwnProperty(t)&&delete e[t]});return t(r,e),r},length:function(e){var n=this.keys().then(function(e){return e.length});return t(n,e),n},key:function(e,n){var r=this,s=r.ready().then(function(){var t=r._dbInfo.db,n=null,s=0;for(var i in t)if(t.hasOwnProperty(i)){if(e===s){n=i;break}s++}return n});return t(s,n),s},keys:function(e){var n=this,r=n.ready().then(function(){var e=n._dbInfo.db,t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t});return t(r,e),r}}}()},59798(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.supportedKernelWebSocketProtocols=void 0,t.createMessage=function(e){var t,n,s,i,a,o;return{buffers:null!==(t=e.buffers)&&void 0!==t?t:[],channel:e.channel,content:e.content,header:{date:(new Date).toISOString(),msg_id:null!==(n=e.msgId)&&void 0!==n?n:r.UUID.uuid4(),msg_type:e.msgType,session:e.session,username:null!==(s=e.username)&&void 0!==s?s:"",subshell_id:null!==(i=e.subshellId)&&void 0!==i?i:null,version:"5.2"},metadata:null!==(a=e.metadata)&&void 0!==a?a:{},parent_header:null!==(o=e.parentHeader)&&void 0!==o?o:{}}},t.isStreamMsg=function(e){return"stream"===e.header.msg_type},t.isDisplayDataMsg=function(e){return"display_data"===e.header.msg_type},t.isUpdateDisplayDataMsg=function(e){return"update_display_data"===e.header.msg_type},t.isExecuteInputMsg=function(e){return"execute_input"===e.header.msg_type},t.isExecuteResultMsg=function(e){return"execute_result"===e.header.msg_type},t.isErrorMsg=function(e){return"error"===e.header.msg_type},t.isStatusMsg=function(e){return"status"===e.header.msg_type},t.isClearOutputMsg=function(e){return"clear_output"===e.header.msg_type},t.isDebugEventMsg=function(e){return"debug_event"===e.header.msg_type},t.isCommOpenMsg=function(e){return"comm_open"===e.header.msg_type},t.isCommCloseMsg=function(e){return"comm_close"===e.header.msg_type},t.isCommMsgMsg=function(e){return"comm_msg"===e.header.msg_type},t.isInfoRequestMsg=function(e){return"kernel_info_request"===e.header.msg_type},t.isExecuteReplyMsg=function(e){return"execute_reply"===e.header.msg_type},t.isDebugRequestMsg=function(e){return"debug_request"===e.header.msg_type},t.isDebugReplyMsg=function(e){return"debug_reply"===e.header.msg_type},t.isInputRequestMsg=function(e){return"input_request"===e.header.msg_type},t.isInputReplyMsg=function(e){return"input_reply"===e.header.msg_type};const r=n(67262);var s;!function(e){e.v1KernelWebsocketJupyterOrg="v1.kernel.websocket.jupyter.org"}(s||(t.supportedKernelWebSocketProtocols=s={}))},64182(e,t,n){"use strict";n.d(t,{K:()=>i});var r=n(63343),s=n(25915);class i{get specs(){return 0===this._specs.size?null:{default:this.defaultKernelName,kernelspecs:Object.fromEntries(this._specs)}}get defaultKernelName(){let e=r.PageConfig.getOption("defaultKernelName");if(!e&&this._specs.size){const t=Array.from(this._specs.keys());t.sort(),e=t[0]}return e||s.PN}get factories(){return this._factories}register(e){const{spec:t,create:n}=e;this._specs.set(t.name,t),this._factories.set(t.name,n)}_specs=new Map;_factories=new Map}},74090(e,t,n){"use strict";n.d(t,{J:()=>o});var r=n(67262),s=n(74602),i=n(63343);const a=i.PageConfig.getOption("appVersion");class o{constructor(e){const t=i.URLExt.join(i.PageConfig.getOption("serviceWorkerUrl")),n=new URL(t);n.searchParams.set("enableCache","true"),this.initialize(n.href).catch(console.warn)}get registrationChanged(){return this._registrationChanged}get enabled(){return null!==this._registration}get ready(){return this._ready.promise}unregisterOldServiceWorkers=async e=>{const t=`${e}-version`,n=localStorage.getItem(t);if(n&&n!==a||!n){console.info("New version, unregistering existing service workers.");const e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(e=>e.unregister())),console.info("All existing service workers have been unregistered.")}localStorage.setItem(t,a)};async initialize(e){const{serviceWorker:t}=navigator;let n=null;if(t){if(t.controller){const e=t.controller.scriptURL;await this.unregisterOldServiceWorkers(e),n=await t.getRegistration(e)||null,console.info("JupyterLite ServiceWorker was already registered")}}else console.warn("ServiceWorkers not supported in this browser");if(!n&&t)try{console.info("Registering new JupyterLite ServiceWorker",e),n=await t.register(e),console.info("JupyterLite ServiceWorker was sucessfully registered")}catch(e){console.warn(e),console.warn(`JupyterLite ServiceWorker registration unexpectedly failed: ${e}`)}this._setRegistration(n),n?(this._ready.resolve(void 0),setTimeout(this._pingServiceWorker,2e4)):this._ready.reject(void 0)}_pingServiceWorker=async()=>{const e=await fetch("/api/service-worker-heartbeat");"ok"===await e.text()&&setTimeout(this._pingServiceWorker,2e4)};_setRegistration(e){this._registration=e,this._registrationChanged.emit(this._registration)}_registration=null;_registrationChanged=new s.Signal(this);_ready=new r.PromiseDelegate}},78532(e,t,n){"use strict";n.d(t,{l:()=>a});var r=n(63343),s=n(15669),i=n(23986);class a{contentsManager;constructor(e){this.contentsManager=e.contentsManager}async processDriveRequest(e){switch(e.method){case"readdir":return this.readdir(e);case"rmdir":return this.rmdir(e);case"rename":return this.rename(e);case"getmode":return this.getmode(e);case"lookup":return this.lookup(e);case"mknod":return this.mknod(e);case"getattr":return this.getattr(e);case"get":return this.get(e);case"put":return this.put(e)}throw`Drive request ${e.method} does not exist.`}async readdir(e){const t=await this.contentsManager.get(e.path,{content:!0});let n=[];return"directory"===t.type&&t.content&&(n=t.content.map(e=>e.name)),n}async rmdir(e){return await this.contentsManager.delete(e.path),null}async rename(e){return await this.contentsManager.rename(e.path,e.data.newPath),null}async getmode(e){let t;return t="directory"===(await this.contentsManager.get(e.path)).type?i._j:i.rE,t}async lookup(e){let t;try{t={ok:!0,mode:"directory"===(await this.contentsManager.get(e.path)).type?i._j:i.rE}}catch(e){t={ok:!1}}return t}async mknod(e){const t=await this.contentsManager.newUntitled({path:r.PathExt.dirname(e.path),type:e.data.mode===i._j?"directory":"file",ext:r.PathExt.extname(e.path)});return await this.contentsManager.rename(t.path,e.path),null}async getattr(e){const t=await this.contentsManager.get(e.path),n=new Date(0).toISOString();return{dev:1,nlink:1,uid:0,gid:0,rdev:0,size:t.size||0,blksize:s.cS,blocks:Math.ceil(t.size||0/s.cS),atime:t.last_modified||n,mtime:t.last_modified||n,ctime:t.created||n,timestamp:0}}async get(e){const t=await this.contentsManager.get(e.path,{content:!0});let n;return"directory"!==t.type&&(n={content:"json"===t.format?JSON.stringify(t.content):t.content,format:t.format}),n}async put(e){return await this.contentsManager.save(e.path,{content:"json"===e.data.format?JSON.parse(e.data.data):e.data.data,type:"file",format:e.data.format}),null}}},85551(e,t,n){"use strict";n.d(t,{n:()=>r});const r=new(n(67262).Token)("@jupyterlite/localforge:ILocalForage")},93962(e,t,n){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var s=Object.getOwnPropertyDescriptor(t,n);s&&!("get"in s?!t.__esModule:s.writable||s.configurable)||(s={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,s)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),s=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return s(t,e),t};Object.defineProperty(t,"__esModule",{value:!0}),t.serialize=function(e,t=""){return t===a.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg?o.serializeV1KernelWebsocketJupyterOrg(e):o.serializeDefault(e)},t.deserialize=function(e,t=""){return t===a.supportedKernelWebSocketProtocols.v1KernelWebsocketJupyterOrg?o.deserializeV1KernelWebsocketJupyterOrg(e):o.deserializeDefault(e)};const a=i(n(59798));var o;!function(e){e.deserializeV1KernelWebsocketJupyterOrg=function(e){let t;const n=new DataView(e),r=Number(n.getBigUint64(0,!0));let s=[];for(let e=0;e<r;e++)s.push(Number(n.getBigUint64(8*(e+1),!0)));const i=new TextDecoder("utf8"),a=i.decode(e.slice(s[0],s[1])),o=JSON.parse(i.decode(e.slice(s[1],s[2]))),c=JSON.parse(i.decode(e.slice(s[2],s[3]))),h=JSON.parse(i.decode(e.slice(s[3],s[4]))),l=JSON.parse(i.decode(e.slice(s[4],s[5])));let d=[];for(let t=5;t<s.length-1;t++)d.push(new DataView(e.slice(s[t],s[t+1])));return t={channel:a,header:o,parent_header:c,metadata:h,content:l,buffers:d},t},e.serializeV1KernelWebsocketJupyterOrg=function(e){const t=JSON.stringify(e.header),n=null==e.parent_header?"{}":JSON.stringify(e.parent_header),r=JSON.stringify(e.metadata),s=JSON.stringify(e.content),i=void 0!==e.buffers?e.buffers:[],a=5+i.length+1;let o=[];o.push(8*(1+a)),o.push(e.channel.length+o[o.length-1]);const c=new TextEncoder,h=c.encode(e.channel),l=c.encode(t),d=c.encode(n),u=c.encode(r),f=c.encode(s),m=new Uint8Array(h.length+l.length+d.length+u.length+f.length);m.set(h),m.set(l,h.length),m.set(d,h.length+l.length),m.set(u,h.length+l.length+d.length),m.set(f,h.length+l.length+d.length+u.length);for(let e of[l.length,d.length,u.length,f.length])o.push(e+o[o.length-1]);let g=0;for(let e of i){let t=e.byteLength;o.push(t+o[o.length-1]),g+=t}const p=new Uint8Array(8*(1+a)+m.byteLength+g),_=new ArrayBuffer(8),w=new DataView(_);w.setBigUint64(0,BigInt(a),!0),p.set(new Uint8Array(_),0);for(let e=0;e<o.length;e++)w.setBigUint64(0,BigInt(o[e]),!0),p.set(new Uint8Array(_),8*(e+1));p.set(m,o[0]);for(let e=0;e<i.length;e++){const t=i[e];p.set(new Uint8Array(ArrayBuffer.isView(t)?t.buffer:t),o[5+e])}return p.buffer},e.deserializeDefault=function(e){let t;return t="string"==typeof e?JSON.parse(e):function(e){const t=new DataView(e),n=t.getUint32(0),r=[];if(n<2)throw new Error("Invalid incoming Kernel Message");for(let e=1;e<=n;e++)r.push(t.getUint32(4*e));const s=new Uint8Array(e.slice(r[0],r[1])),i=JSON.parse(new TextDecoder("utf8").decode(s));i.buffers=[];for(let t=1;t<n;t++){const n=r[t],s=r[t+1]||e.byteLength;i.buffers.push(new DataView(e.slice(n,s)))}return i}(e),t},e.serializeDefault=function(e){var t;let n;return n=(null===(t=e.buffers)||void 0===t?void 0:t.length)?function(e){const t=[],n=[],r=new TextEncoder;let s=[];void 0!==e.buffers&&(s=e.buffers,delete e.buffers);const i=r.encode(JSON.stringify(e));n.push(i.buffer);for(let e=0;e<s.length;e++){const t=s[e];n.push(ArrayBuffer.isView(t)?t.buffer:t)}const a=n.length;t.push(4*(a+1));for(let e=0;e+1<n.length;e++)t.push(t[t.length-1]+n[e].byteLength);const o=new Uint8Array(t[t.length-1]+n[n.length-1].byteLength),c=new DataView(o.buffer);c.setUint32(0,a);for(let e=0;e<t.length;e++)c.setUint32(4*(e+1),t[e]);for(let e=0;e<n.length;e++)o.set(new Uint8Array(n[e]),t[e]);return o.buffer}(e):JSON.stringify(e),n}}(o||(o={}))},98346(e,t,n){"use strict";n.d(t,{n:()=>i});var r=n(40820),s=n.n(r);async function i(e){return await e.defineDriver(s())}}}]);