var L=Object.defineProperty;var t=(K,c)=>L(K,"name",{value:c,configurable:!0});import{bq as V,E as S,c as k,d as u,F as N,y as R,z as l,q as x,k as n,A as h,u as f,br as s,r as b,du as G,h as J,j as $,l as Q,e as r,I as W,s as X}from"./vendor-other-BxP-0xn6.js";import{w as U,u as Y,ad as Z,ae as w,y as P,e as ee,s as ie,af as ae}from"./vendor-primevue-rR0TB_Js.js";import{u as ne}from"./vendor-vue-BEnTqVKr.js";import{bs as le,z as se,n as te,_ as p,S as de,dl as oe,cz as re,cy as ue,d as ce}from"./index-FoJ8Eu4a.js";import{u as ye}from"./keybindingService-D_lPZZ7u.js";import"./vendor-xterm-CWYFmgbN.js";import"./vendor-three-BsnVSA6y.js";import"./vendor-tiptap-4vvRsqpM.js";const be={key:0,class:"px-2"},fe=V({__name:"KeyComboDisplay",props:{keyCombo:{},isModified:{type:Boolean,default:!1}},setup(K){const c=S(()=>K.keyCombo.getKeySequences());return(d,m)=>(u(),k("span",null,[(u(!0),k(N,null,R(c.value,(_,C)=>(u(),k(N,{key:C},[l(s(U),{severity:d.isModified?"info":"secondary"},{default:n(()=>[h(f(_),1)]),_:2},1032,["severity"]),C<c.value.length-1?(u(),k("span",be,"+")):x("",!0)],64))),128))]))}}),me={class:"actions invisible flex flex-row"},ge=["title"],ve={key:1},pe={class:"overflow-hidden text-ellipsis"},ke=V({__name:"KeybindingPanel",setup(K){const c=b({global:{value:"",matchMode:ae.CONTAINS}}),d=le(),m=ye(),_=se(),{t:C}=ne(),q=S(()=>Object.values(_.commands).map(e=>({id:e.id,label:C(`commands.${te(e.id)}.label`,e.label??""),keybinding:d.getKeybindingByCommandId(e.id),source:e.source}))),B=b(null),g=b(!1),o=b(null),y=b(null),E=b(null),v=S(()=>!y.value||y.value.keybinding?.combo?.equals(o.value)||!o.value?null:d.getKeybinding(o.value));function z(e){y.value=e,o.value=e.keybinding?e.keybinding.combo:null,g.value=!0}t(z,"editKeybinding"),G(()=>{g.value&&setTimeout(()=>{E.value?.$el?.focus()},300)});async function F(e){e.keybinding&&(d.unsetKeybinding(e.keybinding),await m.persistUserKeybindings())}t(F,"removeKeybinding");async function T(e){if(!e.shiftKey&&!e.altKey&&!e.ctrlKey&&!e.metaKey)switch(e.key){case"Escape":I();return;case"Enter":await A();return}const a=re.fromEvent(e);o.value=a}t(T,"captureKeybinding");function I(){g.value=!1,y.value=null,o.value=null}t(I,"cancelEdit");async function A(){y.value&&o.value&&d.updateKeybindingOnCommand(new ue({commandId:y.value.id,combo:o.value}))&&await m.persistUserKeybindings(),I()}t(A,"saveKeybinding");async function D(e){d.resetKeybindingForCommand(e.id)?await m.persistUserKeybindings():console.warn(`No changes made when resetting keybinding for command: ${e.id}`)}t(D,"resetKeybinding");const O=Y();async function j(){d.resetAllKeybindings(),await m.persistUserKeybindings(),O.add({severity:"info",summary:"Info",detail:"All keybindings reset",life:3e3})}return t(j,"resetAllKeybindings"),(e,a)=>{const H=J("tooltip");return u(),$(oe,{value:"Keybinding",class:"keybinding-panel"},{header:n(()=>[l(de,{modelValue:c.value.global.value,"onUpdate:modelValue":a[0]||(a[0]=i=>c.value.global.value=i),placeholder:e.$t("g.searchKeybindings")+"..."},null,8,["modelValue","placeholder"])]),default:n(()=>[l(s(Z),{selection:B.value,"onUpdate:selection":a[1]||(a[1]=i=>B.value=i),value:q.value,"global-filter-fields":["id","label"],filters:c.value,"selection-mode":"single","striped-rows":"",pt:{header:"px-0"},onRowDblclick:a[2]||(a[2]=i=>z(i.data))},{default:n(()=>[l(s(w),{field:"actions",header:""},{body:n(i=>[r("div",me,[l(p,{variant:"textonly",size:"icon","aria-label":e.$t("g.edit"),onClick:t(M=>z(i.data),"onClick")},{default:n(()=>a[4]||(a[4]=[r("i",{class:"pi pi-pencil"},null,-1)])),_:2},1032,["aria-label","onClick"]),l(p,{variant:"textonly",size:"icon","aria-label":e.$t("g.reset"),disabled:!s(d).isCommandKeybindingModified(i.data.id),onClick:t(M=>D(i.data),"onClick")},{default:n(()=>a[5]||(a[5]=[r("i",{class:"pi pi-replay"},null,-1)])),_:2},1032,["aria-label","disabled","onClick"]),l(p,{variant:"textonly",size:"icon","aria-label":e.$t("g.delete"),disabled:!i.data.keybinding,onClick:t(M=>F(i.data),"onClick")},{default:n(()=>a[6]||(a[6]=[r("i",{class:"pi pi-trash"},null,-1)])),_:2},1032,["aria-label","disabled","onClick"])])]),_:1}),l(s(w),{field:"id",header:e.$t("g.command"),sortable:"",class:"max-w-64 2xl:max-w-full"},{body:n(i=>[r("div",{class:"truncate",title:i.data.id},f(i.data.label),9,ge)]),_:1},8,["header"]),l(s(w),{field:"keybinding",header:e.$t("g.keybinding")},{body:n(i=>[i.data.keybinding?(u(),$(fe,{key:0,"key-combo":i.data.keybinding.combo,"is-modified":s(d).isCommandKeybindingModified(i.data.id)},null,8,["key-combo","is-modified"])):(u(),k("span",ve,"-"))]),_:1},8,["header"]),l(s(w),{field:"source",header:e.$t("g.source")},{body:n(i=>[r("span",pe,f(i.data.source||"-"),1)]),_:1},8,["header"])]),_:1},8,["selection","value","filters"]),l(s(P),{visible:g.value,"onUpdate:visible":a[3]||(a[3]=i=>g.value=i),class:"min-w-96",modal:"",header:y.value?.label,onHide:I},{footer:n(()=>[l(p,{variant:v.value?"destructive":"primary",autofocus:"",onClick:A},{default:n(()=>[r("i",{class:X(v.value?"pi pi-pencil":"pi pi-check")},null,2),h(" "+f(v.value?e.$t("g.overwrite"):e.$t("g.save")),1)]),_:1},8,["variant"])]),default:n(()=>[r("div",null,[l(s(ee),{ref_key:"keybindingInput",ref:E,class:"mb-2 text-center","model-value":o.value?.toString()??"",placeholder:e.$t("g.pressKeysForNewBinding"),autocomplete:"off",fluid:"",onKeydown:W(T,["stop","prevent"])},null,8,["model-value","placeholder"]),v.value?(u(),$(s(ie),{key:0,severity:"warn"},{default:n(()=>[h(f(e.$t("g.keybindingAlreadyExists"))+" ",1),l(s(U),{severity:"secondary",value:v.value.commandId},null,8,["value"])]),_:1})):x("",!0)])]),_:1},8,["visible","header"]),Q((u(),$(p,{class:"mt-4 w-full",variant:"destructive-textonly",onClick:j},{default:n(()=>[a[7]||(a[7]=r("i",{class:"pi pi-replay"},null,-1)),h(" "+f(e.$t("g.resetAll")),1)]),_:1})),[[H,e.$t("g.resetAllKeybindingsTooltip")]])]),_:1})}}}),Ee=ce(ke,[["__scopeId","data-v-06049058"]]);export{Ee as default};
//# sourceMappingURL=KeybindingPanel-pmyMPZHn.js.map
