config:
    # Force init
    buildenvInitForce: False

    # Backend legacy mode
    backendLegacy:
        __resolver__: nmk_base.backends.BackendLegacyResolver

    # Buildenv subfolder (for legacy backend)
    buildenvFolder:
      __resolver__: nmk_base.backends.BuildenvFolderResolver
      params:
        is_legacy: ${backendLegacy}

    # Ignore buildenv temporary folder (for legacy backend)
    gitIgnoredFiles:
      - ${buildenvFolder}

    # Enable buildenv scripts refresh
    buildenvRefresh: ${backendLegacy}

tasks:
    # Buildenv init
    buildenv:
        description: Generate "buildenv" scripts
        emoji: rocket
        appendToDeps: setup
        deps:
          - py.venv
          - git.ignore
          - git.attributes
        input: ${venvState}
        output:
          - ${PROJECTDIR}/buildenv.sh
          - ${PROJECTDIR}/buildenv.cmd
          - ${PROJECTDIR}/buildenv-loader.py
        builder: nmk_base.buildenv.BuildenvInitBuilder
        params:
            force: ${buildenvInitForce}
        if: ${buildenvRefresh}
