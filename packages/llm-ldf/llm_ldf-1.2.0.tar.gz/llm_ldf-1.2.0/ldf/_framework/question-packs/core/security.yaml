# Security Question-Pack
# Questions about authentication, authorization, and secrets

domain: security
description: "Authentication, authorization, and secrets management"
critical: true

questions:
  authentication:
    - question: "What authentication method will be used?"
      critical: true
      options:
        - "JWT with Bearer token"
        - "OAuth 2.0 / OpenID Connect"
        - "Session cookies"
        - "API keys"
        - "Multiple methods"
      follow_ups:
        - "What is the token/session expiry time?"
        - "Where are credentials stored (client-side)?"

    - question: "What authentication provider will be used?"
      critical: true
      options:
        - "Custom implementation"
        - "Auth0"
        - "Firebase Auth"
        - "AWS Cognito"
        - "Okta"
        - "Other provider"
      examples:
        - "Auth0 for B2B, custom for B2C"
        - "AWS Cognito with social login"

    - question: "Is multi-factor authentication required?"
      critical: false
      options:
        - "Required for all users"
        - "Optional, user choice"
        - "Required for sensitive operations only"
        - "Not needed"
      follow_ups:
        - "What MFA methods are supported (TOTP, SMS, WebAuthn)?"

  authorization:
    - question: "What authorization strategy will be used?"
      critical: true
      options:
        - "Role-Based Access Control (RBAC)"
        - "Attribute-Based Access Control (ABAC)"
        - "Resource-based permissions"
        - "Simple user/admin"
      follow_ups:
        - "What roles/permissions are defined?"
        - "How are permissions checked?"

    - question: "Is multi-tenancy involved?"
      critical: true
      options:
        - "No - single tenant"
        - "Yes - organization-based"
        - "Yes - user-based isolation"
        - "Yes - with shared resources"
      follow_ups:
        - "How is tenant isolation enforced?"
        - "Is Row-Level Security (RLS) needed?"

  secrets:
    - question: "How are secrets managed?"
      critical: true
      options:
        - "Environment variables"
        - "AWS Secrets Manager"
        - "HashiCorp Vault"
        - "Azure Key Vault"
        - "GCP Secret Manager"
      follow_ups:
        - "How are secrets rotated?"

    - question: "What sensitive data is handled?"
      critical: true
      options:
        - "Passwords only"
        - "API keys"
        - "PII (names, emails, addresses)"
        - "Financial data"
        - "Health information (PHI)"
      follow_ups:
        - "What encryption is required?"
        - "What compliance requirements apply?"

  input_validation:
    - question: "How is input validation handled?"
      critical: true
      options:
        - "Schema validation (Pydantic, Zod)"
        - "Manual validation"
        - "Framework validation"
      examples:
        - "Pydantic models for all request bodies"
        - "Zod schemas shared with frontend"

    - question: "What XSS prevention measures are needed?"
      critical: false
      options:
        - "Output encoding"
        - "Content Security Policy"
        - "Sanitization library"
        - "Framework handles it"

  csrf:
    - question: "Is CSRF protection needed?"
      critical: false
      options:
        - "Yes - cookie-based auth"
        - "No - token-based auth only"
        - "Yes - both cookie and token"
      follow_ups:
        - "What CSRF strategy (double-submit, synchronizer token)?"

  rate_limiting:
    - question: "Is rate limiting required?"
      critical: false
      options:
        - "Yes - per IP"
        - "Yes - per user"
        - "Yes - per API key"
        - "Yes - tiered by plan"
        - "Not needed"
      follow_ups:
        - "What are the rate limits?"
        - "What happens when limit exceeded?"
