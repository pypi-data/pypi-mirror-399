Metadata-Version: 2.4
Name: livekit-plugins-difyai
Version: 1.3.0
Summary: LiveKit Agent Plugins for Dify
Author-email: wangmengdi <790990241@qq.com>
Keywords: audio,livekit,realtime,video,webrtc
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3 :: Only
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Topic :: Multimedia :: Sound/Audio
Classifier: Topic :: Multimedia :: Video
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Requires-Python: >=3.9
Requires-Dist: livekit-agents==1.2.9
Description-Content-Type: text/markdown

# livekit-plugins-dify

[![PyPI version](https://badge.fury.io/py/livekit-plugins-dify.svg)](https://pypi.org/project/livekit-plugins-dify/)
[![Python 3.9+](https://img.shields.io/badge/python-3.9+-blue.svg)](https://www.python.org/downloads/)
[![License](https://img.shields.io/badge/License-Apache%202.0-green.svg)](https://opensource.org/licenses/Apache-2.0)

Dify.aiæœåŠ¡ä¸“ç”¨çš„ [LiveKit Agents](https://github.com/livekit/agents) æ’ä»¶ï¼Œæä¾›AIåº”ç”¨é›†æˆè§£å†³æ–¹æ¡ˆã€‚

## âœ¨ ç‰¹æ€§

- ğŸ¤– **å¤§è¯­è¨€æ¨¡å‹ (LLM)** - æ”¯æŒDify.aiå¹³å°çš„åº”ç”¨é›†æˆ
- ğŸ”§ **çµæ´»é…ç½®** - æ”¯æŒè‡ªå®šä¹‰APIç«¯ç‚¹å’Œå¯†é’¥
- ğŸ“¦ **å¼€ç®±å³ç”¨** - å®Œæ•´çš„ Python åŒ…æ”¯æŒ

## ğŸ“‹ æ”¯æŒçš„æœåŠ¡

| æœåŠ¡ | æè¿° | æ–‡æ¡£é“¾æ¥ |
|------|------|----------|
| LLM | å¤§è¯­è¨€æ¨¡å‹ | [Dify.aiæ–‡æ¡£](https://docs.dify.ai/)

## ğŸ› ï¸ å®‰è£…

### ä½¿ç”¨ pip å®‰è£…

```bash
pip install livekit-plugins-dify
```

### ä»æºç å®‰è£…

```bash
git clone https://github.com/your-repo/livekit-plugins-volcengine.git
cd livekit-plugins-volcengine
pip install -e ./livekit-plugins/livekit-plugins-dify
```

### ç³»ç»Ÿè¦æ±‚

- Python >= 3.9
- LiveKit Agents >= 1.2.9

## âš™ï¸ é…ç½®

### ç¯å¢ƒå˜é‡

åœ¨ä½¿ç”¨æ’ä»¶å‰ï¼Œè¯·é…ç½®ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š

| ç¯å¢ƒå˜é‡ | æè¿° | é»˜è®¤å€¼ |
|----------|------|--------|
| `DIFY_API_KEY` | Dify APIå¯†é’¥ | å¿…éœ€ |
| `DIFY_API_BASE` | Dify APIåŸºç¡€URL | https://api.dify.ai/v1 |

### .env æ–‡ä»¶ç¤ºä¾‹

```bash
# .env
DIFY_API_KEY=your_api_key_here
DIFY_API_BASE=https://api.dify.ai/v1
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åŸºç¡€ä½¿ç”¨

```python
from livekit.agents import Agent, AgentSession, JobContext, cli, WorkerOptions
from livekit.plugins import dify
from dotenv import load_dotenv

async def entry_point(ctx: JobContext):
    agent = Agent(instructions="You are a helpful assistant.")

    # åˆ›å»ºDify LLMå®ä¾‹
    llm = dify.LLM(user="your_user_id")

    session = AgentSession(llm=llm)

    await session.start(agent=agent, room=ctx.room)
    await ctx.connect()

    # æ”¯æŒDifyå¼€åœºè¯
    opening_words = await llm.get_opening_words()
    if opening_words:
        await session.say(opening_words)

if __name__ == "__main__":
    load_dotenv()
    cli.run_app(WorkerOptions(entrypoint_fnc=entry_point))
```

### å®Œæ•´é…ç½®ç¤ºä¾‹

```python
from livekit.agents import Agent, AgentSession, JobContext, cli, WorkerOptions
from livekit.plugins import dify, volcengine
from dotenv import load_dotenv

async def entry_point(ctx: JobContext):
    agent = Agent(instructions="You are a helpful assistant.")

    # Dify LLMé…ç½®
    llm = dify.LLM(
        user="your_user_id",
        api_key="your_api_key",      # å¯é€‰ï¼Œä»ç¯å¢ƒå˜é‡è·å–
        api_base="your_api_base"     # å¯é€‰ï¼Œä»ç¯å¢ƒå˜é‡è·å–
    )

    session = AgentSession(
        stt=volcengine.STT(app_id="your_stt_app_id", cluster="your_cluster"),
        llm=llm,
        tts=volcengine.TTS(app_id="your_tts_app_id", cluster="your_cluster")
    )

    await session.start(agent=agent, room=ctx.room)
    await ctx.connect()

if __name__ == "__main__":
    load_dotenv()
    cli.run_app(WorkerOptions(entrypoint_fnc=entry_point))
```

## ğŸ”§ API å‚è€ƒ

### LLM (å¤§è¯­è¨€æ¨¡å‹)

```python
dify.LLM(
    user: str,                     # ç”¨æˆ·ID
    api_key: str = None,           # APIå¯†é’¥ (ä»ç¯å¢ƒå˜é‡è·å–)
    api_base: str = None,          # APIåŸºç¡€URL (ä»ç¯å¢ƒå˜é‡è·å–)
    conversation_id: str = None    # ä¼šè¯ID (å¯é€‰)
)
```

#### ç‰¹æ®Šæ–¹æ³•

- `get_opening_words()` - è·å–å¼€åœºè¯
- `say(text)` - å‘é€è¯­éŸ³æ¶ˆæ¯

## â“ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•è·å–Dify APIå¯†é’¥ï¼Ÿ

A: è¯·è®¿é—®[Dify.aiå¹³å°](https://dify.ai/)ï¼Œåˆ›å»ºåº”ç”¨å¹¶è·å–APIå¯†é’¥ã€‚

### Q: å¦‚ä½•é…ç½®è‡ªå®šä¹‰APIç«¯ç‚¹ï¼Ÿ

A: å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ `DIFY_API_BASE` æˆ–å‚æ•° `api_base` é…ç½®è‡ªå®šä¹‰APIç«¯ç‚¹ã€‚

### Q: å¦‚ä½•ä½¿ç”¨å¼€åœºè¯åŠŸèƒ½ï¼Ÿ

A: Difyæ’ä»¶æ”¯æŒè‡ªåŠ¨è·å–å’Œæ’­æ”¾å¼€åœºè¯ï¼š
```python
opening_words = await llm.get_opening_words()
if opening_words:
    await session.say(opening_words)
```

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.2.9
- æ”¯æŒDify.aiå¹³å°çš„åº”ç”¨é›†æˆ
- æ”¯æŒå¼€åœºè¯åŠŸèƒ½
- æ”¯æŒè‡ªå®šä¹‰APIç«¯ç‚¹é…ç½®
- å®Œå–„çš„APIæ–‡æ¡£å’Œä½¿ç”¨ç¤ºä¾‹

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ Apache 2.0 è®¸å¯è¯ã€‚

## ğŸ™ è‡´è°¢

- [LiveKit](https://github.com/livekit/agents) - ä¼˜ç§€çš„å®æ—¶é€šä¿¡æ¡†æ¶
- [Dify.ai](https://dify.ai/) - å¼ºå¤§çš„AIåº”ç”¨å¹³å°

