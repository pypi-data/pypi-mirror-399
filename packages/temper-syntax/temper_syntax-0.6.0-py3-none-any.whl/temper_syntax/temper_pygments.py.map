{ "version": 3, "file": "py/temper-syntax/temper_syntax/temper_pygments.py", "sourceRoot": "-work/temper-syntax/temper-pygments/", "sources": [ "temper-pygments.temper.md", "tempermd-pygments.temper.md" ], "sourcesContent": [ "# Temper Pygments Lexer\n\n## Lexer class\n\nWe can't easily access backend classes, so we can't subclass\n`pygments.lexer.RegexLexer`, but we can define a separate class that can then\nbe subclassed in Python or elsewhere.\n\nTODO Maybe define an independent Lexer type and just create an instance here?\n\n    export class TemperLexer {\n\nThese indicators seems somewhat redundant to me, but they follow the examples in\nthe [Pygments documentation][pygments-lexer-docs].\n\n      public name: String = \u0022Temper\u0022;\n      public aliases: List\u003cString\u003e = [\u0022temper\u0022];\n      public filenames: List\u003cString\u003e = [\u0022*.temper\u0022];\n\n### Token rules\n\nMain thing, though, is the list of rules for definition tokens.\n\n      public tokens: Map\u003cString, List\u003cRuleOption\u003e\u003e = new Map([\n\n#### Root\n\n        new Pair(\u0022root\u0022, List.of\u003cRuleOption\u003e(\n          include(\u0022commentsandwhitespace\u0022),\n          new Rule(\n            words(\u0022false\u0022, \u0022NaN\u0022, \u0022null\u0022, \u0022true\u0022, \u0022void\u0022),\n            Kind.keywordConstant,\n          ),\n          new Rule(\n            words(\n              \u0022class\u0022, \u0022interface\u0022, \u0022let\u0022, \u0022private\u0022, \u0022public\u0022, \u0022sealed\u0022, \u0022var\u0022,\n            ),\n            Kind.keywordDeclaration,\n          ),\n          new Rule(\n            words(\n              \u0022do\u0022, \u0022else\u0022, \u0022export\u0022, \u0022extends\u0022, \u0022fn\u0022, \u0022if\u0022, \u0022import\u0022, \u0022is\u0022,\n              \u0022when\u0022, \u0022new\u0022, \u0022orelse\u0022,\n            ),\n            Kind.keyword,\n          ),\n          new Rule(words(\u0022return\u0022, \u0022yield\u0022), Kind.keyword, \u0022slashstartsregex\u0022),\n          new Rule(\n            words(\n              \u0022AnyValue\u0022, \u0022Boolean\u0022, \u0022Bubble\u0022, \u0022Float64\u0022, \u0022Function\u0022, \u0022Int\u0022,\n              \u0022List\u0022, \u0022ListBuilder\u0022, \u0022Listed\u0022, \u0022Map\u0022, \u0022MapBuilder\u0022, \u0022MapKey\u0022,\n              \u0022Mapped\u0022, \u0022Null\u0022, \u0022String\u0022, \u0022StringIndex\u0022, \u0022Void\u0022,\n            ),\n            Kind.nameBuiltin,\n          ),\n          new Rule(raw\u0022(?\u003c=\\brgx)\u0024{\u0022\\\u0022\u0022}\u0022, Kind.stringRegex, \u0022stringregex\u0022),\n          new Rule(\u0022\\\u0022\\\u0022\\\u0022\u0022, Kind.stringPlain, \u0022stringmulti\u0022),\n          new Rule(\u0022\\\u0022\u0022, Kind.stringPlain, \u0022string\u0022),\n          new Rule(\u0022[-=+*\u0026|\u003c\u003e]+|/=?\u0022, Kind.operator, \u0022slashstartsregex\u0022),\n          new Rule(\u0022[{}();:.,]\u0022, Kind.punctuation, \u0022slashstartsregex\u0022),\n          new Rule(raw\u0022\\d+\\.?\\d*|\\.\\d+\u0022, Kind.number),\n          new Rule(\u0022@\u0024{nameRegex}\u0022, Kind.nameDecorator),\n          new Rule(nameRegex, Kind.nameKind),\n        )),\n\n#### Comments and Whitespace\n\n        new Pair(\u0022commentsandwhitespace\u0022, List.of\u003cRuleOption\u003e(\n          new Rule(raw\u0022\\s+\u0022, Kind.whitespace),\n          new Rule(\u0022//.*?\u0024\u0022, Kind.commentSingleline),\n          new Rule(raw\u0022/\\*\u0022, Kind.commentMultiline, \u0022nestedcomment\u0022),\n        )),\n\n#### Multiline/Nested Comments\n\nWe plan to support nested comments soon, so just implement that already here.\nThe technique here is based on the `nestedcomment` for the [D Language lexer for\nPygments][dlang-nestedcomment].\n\n        new Pair(\u0022nestedcomment\u0022, List.of\u003cRuleOption\u003e(\n          new Rule(raw\u0022[^*/]+\u0022, Kind.commentMultiline),\n          new Rule(raw\u0022/\\*\u0022, Kind.commentMultiline, \u0022#push\u0022),\n          new Rule(raw\u0022\\*/\u0022, Kind.commentMultiline, \u0022#pop\u0022),\n          new Rule(raw\u0022[*/]\u0022, Kind.commentMultiline),\n        )),\n\n#### Regex Literals\n\n        new Pair(\u0022slashstartsregex\u0022, List.of\u003cRuleOption\u003e(\n          include(\u0022commentsandwhitespace\u0022),\n          new Rule(\n            // Copied from pygments js lexer.\n            raw\u0022/(\\\\.|[^[/\\\\\\n]|\\[(\\\\.|[^\\]\\\\\\n])*])+/([gimuysd]+\\b|\\B)\u0022,\n            Kind.stringRegex,\n            \u0022#pop\u0022,\n          ),\n          default(\u0022#pop\u0022),\n        )),\n\n#### Strings\n\n        new Pair(\u0022interpolation\u0022, List.of\u003cRuleOption\u003e(\n          new Rule(\u0022}\u0022, Kind.stringInterpol, \u0022#pop\u0022),\n          include(\u0022root\u0022),\n        )),\n        stringish(\u0022string\u0022, Kind.stringPlain),\n        new Pair(\u0022stringline\u0022, List.of\u003cRuleOption\u003e(\n          new Rule(raw\u0022\\\u0024\\{\u0022, Kind.stringInterpol, \u0022interpolation\u0022),\n          new Rule(\u0022.+\u0022, Kind.stringPlain),\n          new Rule(\u0022\u0024\u0022, Kind.stringPlain, \u0022#pop\u0022),\n        )),\n        new Pair(\u0022stringmulti\u0022, List.of\u003cRuleOption\u003e(\n          include(\u0022commentsandwhitespace\u0022),\n          new Rule(\u0022\\\u0022\u0022, Kind.stringPlain, \u0022stringline\u0022),\n          new Rule(\u0022(?=.)\u0022, Kind.stringPlain, \u0022#pop\u0022),\n        )),\n        stringish(\u0022stringregex\u0022, Kind.stringRegex),\n\n      ]);\n\n    }\n\n## Helper functions and values\n\n### Names\n\nBe sloppy with names for now. TODO More complete Unicode support.\n\n    let nameRegex = \u0022[_\u003c\u003cLu\u003e\u003e\u003c\u003cLl\u003e\u003e][_\u003c\u003cLu\u003e\u003e\u003c\u003cLl\u003e\u003e0-9]*\u0022;\n\n### String support\n\nAnd use a support function to customise the token kind for `rgx` strings.\n\n    let stringish(\n      key: String,\n      kind: TokenKind,\n    ): Pair\u003cString, List\u003cRuleOption\u003e\u003e {\n\nI'm not sure if order matters here. Seems simpler, but if I don't exclude `\u0024{`\nfrom core string chars, I don't get interp.\n\n      new Pair(key, List.of\u003cRuleOption\u003e(\n        new Rule(\u0022\\\u0022\u0022, kind, \u0022#pop\u0022),\n        new Rule(raw\u0022\\\u0024\\{\u0022, Kind.stringInterpol, \u0022interpolation\u0022),\n        new Rule(\u0022(?:[^\\\u0022\u0024]|\\\\\u0024[^{])+\u0022, kind),\n      ))\n    }\n\n### Word lists\n\n    let words(...names: List\u003cString\u003e): String {\n      \u0022\\\\b(?:\u0024{names.join(\u0022|\u0022) { x =\u003e x }})\\\\b\u0022\n    }\n\n## Imports and links\n\n    let { ... } = import(\u0022../pygments\u0022);\n\n[dlang-nestedcomment]: https://github.com/pygments/pygments/blob/d0acfff1121f9ee3696b01a9077ebe9990216634/pygments/lexers/d.py#L242\n[issue1631]: https://github.com/temper-lang/temper/issues/1631\n[pygments-lexer-docs]: https://pygments.org/docs/lexerdevelopment/\n", "# Temper Markdown Pygments Lexer Info\n\nThere's less to do here than for the core Temper lexer, but keeping core\nmetadata central to the Temper Syntax library is still nice.\n\n    export class TemperMdLexer {\n      public name: String = \u0022TemperMarkdown\u0022;\n      public aliases: List\u003cString\u003e = [\u0022temper.md\u0022, \u0022tempermd\u0022];\n      public filenames: List\u003cString\u003e = [\u0022*.temper.md\u0022, \u0022*.tempermd\u0022];\n\n      public tokens: Map\u003cString, List\u003cRuleOption\u003e\u003e = new Map([\n        new Pair(\u0022root\u0022, List.of\u003cRuleOption\u003e(\n\nTo find indentation, use relatively simple 4 spaces from start for now. I don't\nthink Pygment's MarkdownLexer even recognizing indented code blocks at all right\nnow, so we get it to ourselves.\n\nTODO Recognize indentation relative to previous, such as outlines.\n\n          new Rule(raw\u0022^\\s*\\n {4}\u0022, Kind.whitespace, \u0022indented\u0022),\n          inherit,\n        )),\n\n        new Pair(\u0022indented\u0022, List.of\u003cRuleOption\u003e(\n          new Rule(\n\nThis seems to recognize the end of indented sections ok for the moment, limited\nto 4-space indentation from line start for now.\n\n            raw\u0022(?s)(.*?)(?=\\Z|\\n(?: {1,3}[^ ]|[^ ]|\u0024))\u0022,\n            bygroups([using(\u0022Temper\u0022)]),\n            \u0022#pop\u0022,\n          ),\n        )),\n      ]);\n    }\n" ], "names": [ "include", "default", "bygroups", "using", "inherit", "RuleOption", "Rule", "Kind", "TokenKind", "str", "Sequence", "MappingProxyType", "Pair", "map_constructor", "str_cat", "list_join", "Pair#358", "map_constructor#359", "str_cat#360", "list_join#361", "TemperLexer", "name", "aliases", "filenames", "tokens", "this", "t#146", "t#148", "t#348", "words", "stringish", "TemperMdLexer", "t#131", "t#133", "t#289", "names", "fn", "x", "key", "kind", "t#353" ], "mappings": "ADuBqB,IDsIR,8BDAK,CDAAA,ODAA,IDAAA,UDAA,EDAAC,ODAA,IDAAA,UDAA,EDAAC,QDAA,IDAAA,WDAA,EDAAC,KDAA,IDAAA,QDAA,EDAAC,ODAA,IDAAA,UDAA,CDAA,ADtIG,CDAAC,UDA6B,CDMpC,CDAAC,IDAI,CDEN,CDAAC,IDAI,CD8HN,CDAAC,SDAQ;A,qB,G,I;A,mB,Q,I;A,kB,gB,I;A,wB,I,I,K,E,e,I,gB,E,O,I,Q,E,S,I;A,mC,U,E,I,E;ADlINQ,QDAI,EDAA,ADAJ,CDAAJ,KDAI;ADJyCK,mBDAG,EDAA,ADAH,CDAAJ;ADiInDK,WDAA,GDAAJ;ADAeK,aDAI,EDAA,ADAJ,CDAAJ,UDAI;AD9IR,MDAAK,WDAA;ADKJ,IDAAC,ODAI,CDAE;ADCN,IDAAC,UDAO,CDAE;ADCT,IDAAC,YDAS,CDAE;ADMX,IDAAC,SDAM,CDAE,mDD+Fb;AD5GS,aD4GT,EDAA,AD5GS,EDKJ,SDAuB,CDCvB,aDAkC,CDClC,eDAsC,CDMtC,YD+FL,CDAA;AD5GS,ODAY,UDAAC,MDAA;ADKhB,QDAAA,MDAA,CDAuBJ,ODAA,EDAA,ADAR;ADCmB,QDAAK,KDAA,qBDAA,ADAV,EDAC,QDAQ,EDAC;ADAlC,QDAAD,MDAA,CDAkCH,UDAA,EDAA,ADAV,CDAAI;ADCc,QDAAC,KDAA,qBDAA,ADAZ,EDAC,UDAU,EDAC;ADAtC,QDAAF,MDAA,CDAsCF,YDAA,EDAA,ADAZ,CDAAI;ADMc,QDAAC,KD+F7C,CDAA,AD/F6C,mDD+F7C,EDAA,AD/FiD,CDAAX,mBDAG,CDAC,CDIjDD,QDAI,CDAC,MDAM,CDAE,EDCfhB,UDAO,CDAC,uBDAuB,CDAC,CDC5B,CDAAM,IDAI,CDCNuB,ODAK,CDAC,ODAO,CDAE,MDAK,CDAE,ODAM,CDAE,ODAM,CDAE,ODAM,CDAC,CDC7C,CDAAtB,IDAI,CDAgB,iBDCrB,CDCG,CDAAD,IDAI,CDCNuB,ODAK,CDCH,ODAO,CDAE,YDAW,CDAE,MDAK,CDAE,UDAS,CDAE,SDAQ,CDAE,SDAQ,CDAE,MDAK,CDClE,CDCD,CDAAtB,IDAI,CDAmB,oBDCxB,CDCG,CDAAD,IDAI,CDCNuB,ODAK,CDCH,IDAI,CDAE,ODAM,CDAE,SDAQ,CDAE,UDAS,CDAE,KDAI,CDAE,KDAI,CDAE,SDAQ,CDAE,KDAI,CDC7D,ODAM,CDAE,MDAK,CDAE,SDAQ,CDCxB,CDCD,CDAAtB,IDAI,CDAQ,QDCb,CDCG,CDAAD,IDAI,CDACuB,ODAK,CDAC,QDAQ,CDAE,QDAO,CDAC,CDAE,CDAAtB,IDAI,CDAQ,QDAE,mBDAkB,CDAC,CDChE,CDAAD,IDAI,CDCNuB,ODAK,CDCH,UDAU,CDAE,UDAS,CDAE,SDAQ,CDAE,UDAS,CDAE,WDAU,CDAE,MDAK,CDC7D,ODAM,CDAE,cDAa,CDAE,SDAQ,CDAE,MDAK,CDAE,aDAY,CDAE,SDAQ,CDC9D,SDAQ,CDAE,ODAM,CDAE,SDAQ,CDAE,cDAa,CDAE,ODAM,CDClD,CDCD,CDAAtB,IDAI,CDAY,aDCjB,CDCG,CDAAD,IDAI,CDAC,cDAsB,CDAE,CDAAC,IDAI,CDAY,aDAE,cDAa,CDAC,CDC7D,CDAAD,IDAI,CDAC,KDAQ,CDAE,CDAAC,IDAI,CDAY,aDAE,cDAa,CDAC,CDC/C,CDAAD,IDAI,CDAC,GDAI,CDAE,CDAAC,IDAI,CDAY,aDAE,SDAQ,CDAC,CDCtC,CDAAD,IDAI,CDAC,iBDAiB,CDAE,CDAAC,IDAI,CDAS,SDAE,mBDAkB,CDAC,CDC1D,CDAAD,IDAI,CDAC,YDAY,CDAE,CDAAC,IDAI,CDAY,YDAE,mBDAkB,CDAC,CDCxD,CDAAD,IDAI,CDAC,sBDAoB,CDAE,CDAAC,IDAI,CDAO,ODAC,CDCvC,CDAAD,IDAI,CDAC,qCDAe,CDAE,CDAAC,IDAI,CDAc,eDAC,CDCzC,CDAAD,IDAI,CDAC,oCDAS,CDAE,CDAAC,IDAI,CDAS,UDAC,CDCnC,CDAC,CDIE,CDAAS,QDAI,CDAC,uBDAuB,CDAE,EDC5BV,IDAI,CDAC,MDAQ,CDAE,CDAAC,IDAI,CDAW,WDAC,CDC/B,CDAAD,IDAI,CDAC,QDAQ,CDAE,CDAAC,IDAI,CDAkB,mBDAC,CDCtC,CDAAD,IDAI,CDAC,MDAQ,CDAE,CDAAC,IDAI,CDAiB,kBDAE,gBDAe,CDAC,CDC3D,CDAC,CDQE,CDAAS,QDAI,CDAC,eDAe,CDAE,EDCpBV,IDAI,CDAC,QDAW,CDAE,CDAAC,IDAI,CDAiB,kBDAC,CDCxC,CDAAD,IDAI,CDAC,MDAQ,CDAE,CDAAC,IDAI,CDAiB,kBDAE,QDAO,CDAC,CDC9C,CDAAD,IDAI,CDAC,MDAQ,CDAE,CDAAC,IDAI,CDAiB,kBDAE,ODAM,CDAC,CDC7C,CDAAD,IDAI,CDAC,MDAS,CDAE,CDAAC,IDAI,CDAiB,kBDAC,CDC3C,CDAC,CDIE,CDAAS,QDAI,CDAC,kBDAkB,CDAE,EDC3BhB,UDAO,CDAC,uBDAuB,CDAC,CDC5B,CDAAM,IDAI,CDEN,uEDA4D,CDC5D,CDAAC,IDAI,CDAY,aDChB,ODAM,CDCP,CDCD,CDAAN,UDAO,CDAC,MDAM,CDAC,CDChB,CDAC,CDIE,CDAAe,QDAI,CDAC,eDAe,CDAE,EDCpBV,IDAI,CDAC,GDAG,CDAE,CDAAC,IDAI,CDAe,gBDAE,ODAM,CDAC,CDC1C,CDAAP,UDAO,CDAC,MDAM,CDAC,CDChB,CDAC,CDCF,CDAA8B,WDAS,CDAC,QDAQ,CDAE,CDAAvB,IDAI,CDAY,aDAC,CDCjC,CDAAS,QDAI,CDAC,YDAY,CDAE,EDCjBV,IDAI,CDAC,QDAS,CDAE,CDAAC,IDAI,CDAe,gBDAE,gBDAe,CDAC,CDCrD,CDAAD,IDAI,CDAC,IDAI,CDAE,CDAAC,IDAI,CDAY,aDAC,CDC5B,CDAAD,IDAI,CDAC,GDAG,CDAE,CDAAC,IDAI,CDAY,aDAE,ODAM,CDAC,CDCxC,CDAC,CDCE,CDAAS,QDAI,CDAC,aDAa,CDAE,EDCtBhB,UDAO,CDAC,uBDAuB,CDAC,CDC5B,CDAAM,IDAI,CDAC,GDAI,CDAE,CDAAC,IDAI,CDAY,aDAE,aDAY,CDAC,CDC1C,CDAAD,IDAI,CDAC,ODAO,CDAE,CDAAC,IDAI,CDAY,aDAE,ODAM,CDAC,CDC5C,CDAC,CDCF,CDAAuB,WDAS,CDAC,aDAa,CDAE,CDAAvB,IDAI,CDAY,aDAC,CDE3C,CDAC;AD/FK,QDAAkB,MDAA,CD+FLD,SDAA,EDAA,AD/F6C,CDAAI,KD+F7C;ADvGK;ADAA,aDAAH,ODAA;ADAA,eDAAA,ODAA,CDAAJ;ADCA;ADAA,gBDAAI,ODAA;ADAA,eDAAA,ODAA,CDAAH;ADCA;ADAA,kBDAAG,ODAA;ADAA,eDAAA,ODAA,CDAAF;ADMA;ADAA,eDAAE,ODAA;ADAA,eDAAA,ODAA,CDAAD,SD+FL;ADjHS,MDAAO,aDAA;ADCJ,IDAAV,ODAI,CDAE;ADCN,IDAAC,UDAO,CDAE;ADCT,IDAAC,YDAS,CDAE;ADEX,IDAAC,SDAM,CDAE,mDDwBb;AD7BS,aD6BT,EDAA,AD7BS,EDCJ,SDA+B,CDC/B,aDAiD,CDCjD,eDAuD,CDEvD,YDwBL,CDAA;AD7BS,ODAc,UDAAC,MDAA;ADClB,QDAAA,MDAA,CDA+BJ,ODAA,EDAA,ADAhB;ADCkC,QDAAW,KDAA,qBDAA,ADAzB,EDAC,WDAW,CDAE,WDAU,CDAC;ADAjD,QDAAP,MDAA,CDAiDH,UDAA,EDAA,ADAzB,CDAAU;ADC+B,QDAAC,KDAA,qBDAA,ADA7B,EDAC,aDAa,CDAE,aDAY,CDAC;ADAvD,QDAAR,MDAA,CDAuDF,YDAA,EDAA,ADA7B,CDAAU;ADEc,QDAAC,KDwB7C,CDAA,ADxB6C,mDDwB7C,EDAA,ADxBiD,CDAAjB,mBDAG,CDAC,CDCjDD,QDAI,CDAC,MDAM,CDAE,EDQXV,IDAI,CDAC,cDAe,CDAE,CDAAC,IDAI,CDAW,WDAE,WDAU,CDAC,CDCtD,CDAAH,UDAO,CDCR,CDAC,CDEE,CDAAY,QDAI,CDAC,UDAU,CDAE,EDCfV,IDAI,CDKN,2CDA4C,CDC5C,CDAAJ,WDAQ,CDAC,CDACC,QDAK,CDAC,QDAQ,CDAC,EDAC,CDAC,CDC3B,ODAM,CDCP,EDCF,CDAC,CDCH,CDAC;ADxBK,QDAAsB,MDAA,CDwBLD,SDAA,EDAA,ADxB6C,CDAAU,KDwB7C;AD5BK;ADAA,aDAAT,ODAA;ADAA,eDAAA,ODAA,CDAAJ;ADCA;ADAA,gBDAAI,ODAA;ADAA,eDAAA,ODAA,CDAAH;ADCA;ADAA,kBDAAG,ODAA;ADAA,eDAAA,ODAA,CDAAF;ADEA;ADAA,eDAAE,ODAA;ADAA,eDAAA,ODAA,CDAAD,SDwBL;ADqHJ,GDAI,CDAAK,ODAK,CDAA,ADAC,CDAGM,QDAK,CDAA,ADAR,ODET,IDAA,ADFkC,ODAM;ADCd,QDAAC,MDAA,CDAEC,IDAC,CDAA,ADAD,ODAQ,IDAA,ADAH;ADAA,eDAAA,IDAC;ADAjC,WDAAnB,WDAA,CDAC,IDAE,QDAI,CDAQ,CDAAC,aDAI,CDAA,ADAVgB,QDAK,CDAM,IDAG,CDAE,CDAAC,MDAU,EDAC,IDAC,MDAE,KDAC,CDCzC;ADnBD,GDAI,CDAAN,WDAS,CDAA,ADCXQ,MDAG,CDAE,ODAM,CDCX,CDAAC,ODAI,CDAE,YDWP,IDAA,ADVE,uCDA8B;ADKjB,IDAAC,KDIb,CDAA,ADJa,wBDIb,EDAA,ADJa,EDCRlC,IDAI,CDAC,GDAI,CDAE,CDAAiC,ODAI,CDAE,ODAM,CDAC,CDCxB,CDAAjC,IDAI,CDAC,QDAS,CDAE,CDAAC,IDAI,CDAe,gBDAE,gBDAe,CDAC,CDCrD,CDAAD,IDAI,CDAC,oBDAqB,CDAE,CDAAiC,ODAI,CDAC,CDCtC;ADJD,UDAI,CDAAvB,QDAI,CDACsB,MDAG,CDAE,CDAAE,KDIb,CDCF" }