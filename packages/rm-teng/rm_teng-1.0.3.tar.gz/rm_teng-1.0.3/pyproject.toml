[project]
name = "rm-teng"
version = "1.0.3"
description = "Add your description here"
readme = "README.md"
authors = [
    { name = "geo7", email = "georgelenton@gmail.com" }
]
requires-python = ">=3.14"
dependencies = []

[project.scripts]
rm-teng = "rm_teng:main"

[build-system]
requires = ["uv_build>=0.9.21,<0.10.0"]
build-backend = "uv_build"

[dependency-groups]
dev = [
    "pre-commit>=4.5.0",
    "pytest>=9.0.2",
    "pytest-cov>=7.0.0",
    "python-semantic-release>=10.5.3",
    "ruff>=0.14.8",
    "ty>=0.0.1a33",
]

[tool.ruff]
line-length = 100

[tool.ruff.lint]
select = ["ALL"]
ignore = [

"ANN003",  # Missing type annotation for `**kwargs`
"COM812",  # Trailing comma missing (conflicts with the formatter)
"D203",    # 1 blank line required before class docstring (conflicts with D211)
"D213",    # Multi-line docstring summary at second line (conflicts with D212)
"D401",    # First line of docstring should be in imperative mood: "Method to handle these args."
"DTZ005",  # `datetime.datetime.now()` called without a `tz` argument
"FIX002",  # Line contains TODO, consider resolving the issue
"T201",    # `print` found
"TD002",   # Missing author in TODO; try: `# TODO(<author_name>): ...` or `# TODO @<author_name>: ...`
"TD003",   # Missing issue link for this TODO

]
fixable = ["ALL"]
unfixable = []

[tool.ruff.lint.per-file-ignores]
"__init__.py" = ["F401"]
"tests/*" = [
    "ANN001",  # Missing type annotation for function argument `monkeypatch`
    "ANN003",  # Missing type annotation for `**kwargs`
    "ANN201",  # Missing return type annotation for public function `test_rm_rf_happy_path`
    "ARG001",  # Unused function argument: `kwargs`
    "ARG005",  # Unused lambda argument: `kwargs`
    "D103",    # Missing docstring in public function
    "D104",    # Missing docstring in public package
    "PLR2004", # Magic value used in comparison, consider replacing `2` with a constant variable
    "S101",    # Use of `assert` detected
    "S105",    # Possible hardcoded password assigned to: "POSTGRES_PREFECT_PASSWORD"
    "S106",    # Possible hardcoded password assigned to argument: "secret_id"
    "S603",    # `subprocess` call: check for execution of untrusted input
    "TRY002",  # Create your own exception
]

[tool.ruff.lint.isort]
section-order = ["future", "standard-library", "third-party", "first-party", "local-folder"]
case-sensitive = true
combine-as-imports = true

[tool.semantic_release]
version_toml = [
    "pyproject.toml:project.version"
]
build_command = """
    uv lock --upgrade-package "$PACKAGE_NAME"
    git add uv.lock
    uv build
"""
commit_message = "chore(release): v{version}"

# v9 uses specific subsections for "tag" and "commit" behavior
[tool.semantic_release.commit_author]
env = "GIT_COMMIT_AUTHOR"
default = "semantic-release <semantic-release>"

[tool.semantic_release.changelog]
exclude_commit_patterns = [
  '''chore\(deps\): .+''',  # Exclude dependency updates from the changelog
]

mode = "update"
insertion_flag = "All versions below are listed in reverse chronological order."

[tool.semantic_release.branches.main]
match = "(main|master)"
prerelease = false
