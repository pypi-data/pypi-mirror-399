name: "mist_train"
seed: 1234

loss_type: MSE # or QCQR

architecture:
  max_input_dim: 64 # length of maximum expected vector (n_dim. 64 means that the max n_dim is 32 in order to compare two samples)
  n_phi_layers: 3
  n_dec_layers: 1
  phi_hidden_dim: 256
  n_phi_heads: 8
  phi_dim_forward: 512
  phi_activation_fun: gelu
  n_rho_layers: 2
  rho_hidden_dim: 256
  n_inds: 64
  phi_model: set_transformer
  quantile_conditioned: False # for QCQR must be True
  sab_stack_layers: 2
  n_seeds: 5

optimizer:
  eps: 8e-9
  lr: 1e-4
  swa_lr: null
  weight_decay: 7e-5
  scheduler:
    name: on_plateau
    mode: min
    metric: train_loss
    patience: 3
    min_lr: 5e-6

datamodule:
  train_folder: data/train_data
  val_folder: data/val_grid
  test_folder: data/test_imd_data
  batch_size: 128


trainer:
  max_epochs: 1
  gradient_clip_val: 0.5