# Tabelog TUI - 使用指南

## 啟動 TUI

使用以下命令啟動互動式 TUI 介面:

```bash
# 使用 uv
uv run tabelog tui

# 或直接使用 Python
python -m tabelog.tui
```

## 介面說明

TUI 介面分為四個主要區域:

### 1. 標題列 (Header)
- 顯示應用程式名稱和狀態

### 2. 搜尋面板 (Search Panel)
**第一行 - 搜尋輸入**:
- **地區輸入框**: 輸入要搜尋的地區 (例如: 東京、大阪)
  - 💡 提示：輸入地區名稱後按 `F2` 查看建議選項
  - 支援都道府縣、車站、地區自動建議
- **關鍵字輸入框**: 輸入搜尋關鍵字 (例如: 寿司、ラーメン)
  - 💡 提示：按 `F3` 開啟智慧型關鍵字建議（新！）
    - 關鍵字為空 → 顯示 45+ 種料理類別完整列表
    - 關鍵字有內容 → 呼叫 API 顯示動態建議（料理類型、餐廳名稱、組合關鍵字）
  - 💡 提示：輸入自然語言後按 `F4` 使用 AI 解析
  - 自動識別料理名稱並轉換為精確過濾

**第二行 - 排序選項**:
- **排序方式單選按鈕**: 直接點選排序方式（使用方向鍵或滑鼠）
  - ◉ 評分排名 (預設)
  - ○ 評論數
  - ○ 新開幕
  - ○ 標準

**第三行**:
- **搜尋按鈕**: 點擊或在輸入框按 Enter 執行搜尋

### 3. 雙欄式布局 (2 Columns)

**左側 - 結果列表 (Results Table)**:
- 顯示搜尋結果的餐廳列表
- 欄位包括:
  - 餐廳名稱
  - 評分
  - 評論數
  - 地區
  - 類型

**右側 - 詳細資訊面板 (Detail Panel)**:
- 顯示選中餐廳的詳細資訊
- 包括:
  - 餐廳名稱
  - 評分和評論數
  - 儲存數
  - 地區和車站資訊
  - 料理類型
  - 午餐/晚餐價格
  - 餐廳 URL

### 4. 底部列 (Footer)
- 顯示可用的鍵盤快捷鍵

## 鍵盤快捷鍵

| 快捷鍵 | 功能 |
|--------|------|
| `q` | 退出應用程式 |
| `s` | 聚焦到搜尋輸入框 |
| `r` | 聚焦到結果列表 |
| `d` | 聚焦到詳細資訊面板 |
| `F2` | 顯示地區建議（需先輸入地區關鍵字） |
| `F3` | 智慧型關鍵字建議（關鍵字為空：顯示料理類別；有內容：動態 API 建議）（新！） |
| `F4` | 使用 AI 解析自然語言輸入（需先輸入自然語言） |
| `↑` / `↓` | 在結果列表/建議選項中上下移動 |
| `Tab` | 在元件間切換 |
| `Enter` | 在搜尋框中執行搜尋 / 在建議選項中確認選擇 |
| `Esc` | 關閉地區建議/料理類別彈窗 |

## 使用流程

### 基本流程
1. 啟動 TUI: `uv run tabelog tui`
2. 在「地區」輸入框中輸入地區名稱 (例如: 東京)
3. 按 `Tab` 移到「關鍵字」輸入框，輸入關鍵字 (例如: 寿司)
4. 按 `Tab` 移到排序選項，使用方向鍵選擇排序方式（預設為「評分排名」）
5. 點擊「搜尋」按鈕或在輸入框按 `Enter` 執行搜尋
6. 等待搜尋完成，結果會顯示在左側的結果列表中
7. 使用方向鍵 `↑`/`↓` 或點擊選擇餐廳
8. 詳細資訊會自動顯示在右側的詳細資訊面板中
9. 可以隨時修改搜尋條件並重新搜尋（會自動取消前一次搜尋）
10. 按 `q` 退出應用程式

### 使用地區建議（推薦）
1. 啟動 TUI: `uv run tabelog tui`
2. 在「地區」輸入框中輸入地區關鍵字 (例如: 東京、伊勢)
3. 按 `F2` 開啟地區建議彈窗
4. 使用 `↑`/`↓` 方向鍵選擇建議的地區或車站
5. 按 `Enter` 確認選擇（或按 `Esc` 取消）
6. 選擇的地區會自動填入輸入框
7. 繼續輸入關鍵字並搜尋

**為什麼要使用地區建議？**
- ✅ 確保地區名稱正確，避免搜尋失敗
- ✅ 自動提供都道府縣、主要車站、地區選項
- ✅ 支援地區過濾，只顯示該地區的餐廳（不會顯示全國結果）

### 使用智慧型關鍵字建議（推薦，新！）

F3 鍵提供兩種模式，根據關鍵字輸入框內容自動切換：

**模式 1：關鍵字為空 → 料理類別完整列表**
1. 啟動 TUI: `uv run tabelog tui`
2. 確保關鍵字輸入框為空
3. 按 `F3` 開啟料理類別選擇彈窗
4. 使用 `↑`/`↓` 方向鍵瀏覽 45+ 種料理類型
5. 按 `Enter` 確認選擇（或按 `Esc` 取消）
6. 選擇的料理名稱會自動填入關鍵字輸入框
7. 系統會自動使用料理類別代碼進行精確過濾

**模式 2：關鍵字有內容 → 動態 API 建議（新！）**
1. 在關鍵字輸入框輸入部分關鍵字（例如：「すき」）
2. 按 `F3` 呼叫 Tabelog API 取得建議
3. 系統會顯示相關建議，包含：
   - 🍜 料理類型（例如：すき焼き、寿司）
   - 🏪 餐廳名稱（例如：和田金）
   - 🔖 組合關鍵字（例如：すき焼き ランチ）
4. 使用 `↑`/`↓` 方向鍵選擇建議項目
5. 按 `Enter` 確認選擇
6. 選擇的內容會自動填入關鍵字輸入框

**為什麼要使用智慧型關鍵字建議？**
- ✅ **精確過濾**：只顯示該料理類型的專門店（例如搜尋すき焼き只顯示すき焼き專門店）
- ✅ **探索選項**：關鍵字為空時瀏覽所有 45+ 種料理類型
- ✅ **動態建議**：輸入時取得即時建議（料理、餐廳、組合）
- ✅ **避免錯字**：從列表選擇，確保名稱正確
- ✅ **自動轉換**：系統自動將料理名稱轉換為 Tabelog 的料理代碼（例如 すき焼き → RC0107）

**直接輸入料理名稱也可以：**
- 在關鍵字輸入框直接輸入料理名稱（例如：すき焼き、寿司、ラーメン）
- 系統會自動識別並轉換為精確過濾
- 支援所有 45+ 種料理類別的自動識別

### 使用 AI 解析自然語言（智慧型）
1. 啟動 TUI: `uv run tabelog tui`
2. 在關鍵字輸入框輸入自然語言（例如：「我想吃三重的壽喜燒」）
3. 按 `F4` 使用 AI 解析
4. 系統會自動解析地區和關鍵字並填入對應欄位
5. **如果地區有值**：自動觸發地區建議（F2）
6. **如果關鍵字有值**：自動觸發料理類別建議（F3）
7. 確認或調整後執行搜尋

**AI 解析的優點：**
- ✅ 自然語言輸入：用自己習慣的方式描述需求
- ✅ 自動分類：AI 會自動分離地區和料理類型
- ✅ 智慧建議：解析完成後自動觸發相關建議功能
- ✅ 快速搜尋：一次輸入完成所有欄位填寫

## 範例搜尋

### 搜尋東京的壽司店（評分排名）
- 地區: `東京`
- 關鍵字: `寿司`
- 排序: `評分排名`

### 搜尋大阪的拉麵店（評論數排序）
- 地區: `大阪`
- 關鍵字: `ラーメン`
- 排序: `評論數排序`

### 搜尋京都的和食（新開幕）
- 地區: `京都`
- 關鍵字: `和食`
- 排序: `新開幕`

### 搜尋三重的すき焼き專門店（使用料理類別）
- 方法 1：使用 F3 選擇器
  1. 按 `F3` 開啟料理類別選擇器
  2. 選擇「すき焼き」
  3. 輸入地區：`三重`
  4. 執行搜尋
- 方法 2：直接輸入
  1. 地區: `三重`
  2. 關鍵字: `すき焼き`（系統自動識別並精確過濾）
  3. 執行搜尋
- 方法 3：使用 AI 解析（最快）
  1. 關鍵字: `三重的すき焼き`
  2. 按 `F4` 使用 AI 解析
  3. 系統自動填入地區和關鍵字，並觸發建議功能
  4. 執行搜尋
- **結果**: 只顯示 20 家すき焼き專門店（例如和田金、牛銀本店等），不會顯示其他類型餐廳

## 注意事項

- **地區過濾限制**：
  - ✅ 支援：47 個都道府縣（東京都、大阪府、京都府等）
  - ❌ 不支援：市級、町村級、車站級的精確過濾
  - 💡 建議：使用地區建議（F2）選擇都道府縣以確保過濾有效
- 搜尋可能需要幾秒鐘時間，請耐心等待
- 確保有網路連線
- 搜尋結果依賴 Tabelog 網站的可用性
- 建議使用較大的終端機視窗（至少 80x24）以獲得最佳體驗
- 重新搜尋會自動取消前一次搜尋，避免並發問題
- 所有搜尋結果都使用 Tabelog 的原生排序（不是客戶端排序）

## 已完成功能

✅ **核心功能**:
- 基本搜尋功能（地區、關鍵字、料理類別）
- 4 種排序方式（評分排名、評論數、新開幕、標準）
- **地區建議功能（F2）**：智慧型地區/車站建議
- **智慧型關鍵字建議（F3）**（新！）：
  - 關鍵字為空 → 45+ 種日本料理類型完整列表
  - 關鍵字有內容 → 動態 API 建議（料理類型、餐廳名稱、組合關鍵字）
- **AI 自然語言解析（F4）**：使用 AI 解析自然語言輸入
- **自動料理識別**：自動偵測並轉換料理名稱為精確過濾
- **地區過濾**：支援 47 個都道府縣的準確過濾
- **料理過濾**：使用料理代碼（RC codes）精確過濾專門店
- 雙欄式結果顯示（列表 + 詳細資訊）
- 即時搜尋結果更新
- 鍵盤導航支援

✅ **使用體驗**:
- 單選按鈕式排序選擇（直接可見）
- 自動取消前次搜尋（避免卡住）
- **彈窗式地區建議選擇器**：視覺化回饋（🗺️ 圖標、載入動畫）
- **智慧型關鍵字建議彈窗**（新！）：
  - 靜態料理列表（🍽️ 圖標）
  - 動態 API 建議（🍜 料理、🏪 餐廳、🔖 組合）
- **智慧型料理識別**：直接輸入料理名稱自動精確過濾
- 簡潔美觀的深色主題
- 響應式布局

## 未來可能添加的功能

- [ ] 進階過濾選項（價格範圍、預約時間、派對人數）
- [ ] 多頁結果瀏覽
- [ ] 評論/菜單/套餐詳細資訊查看
- [ ] 匯出功能（JSON/CSV）
- [ ] 搜尋歷史和收藏功能
- [ ] 快捷鍵自訂

## 問題回報

如遇到問題,請到 GitHub Issues 回報:
https://github.com/narumiruna/tabelog/issues
