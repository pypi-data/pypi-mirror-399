# -*- coding: utf-8 -*-


# =============================================================================
# Project Configuration
# =============================================================================

[tool.poetry]
name = "rite"
version = "0.2.4"
description = "Python Utility Package"
authors = ["Scape Agency <info@scape.agency>"]
license = "MIT License"
readme = "README.md"
homepage = "https://www.pyrites.dev"
repository = "https://github.com/scape-agency/rite"
documentation = "https://github.com/scape-agency/rite/docs"
keywords = ["rite"]
classifiers = [
  "Development Status :: 3 - Alpha",
  "Intended Audience :: Developers",
  "License :: OSI Approved :: MIT License",
  "Programming Language :: Python :: 3.12",
  "Programming Language :: Python :: 3.13",
  "Topic :: Software Development :: Libraries :: Python Modules",
  "Typing :: Typed",
]
include = [
  "src/rite/**",
  "src/rite/py.typed",
  "README.md",
  "LICENSE",
  "docs/**",           # Include documentation in the package
]
packages = [{ include = "rite", from = "src" }]


# =============================================================================
# Dependencies
# =============================================================================

[tool.poetry.dependencies]
python = ">=3.12,<4.0"

# Windows-specific dependency for timezone data
tzdata = { version = ">=2024.1", markers = "sys_platform == 'win32'" }


# =============================================================================
# Development Dependencies
# =============================================================================

[tool.poetry.group.dev.dependencies]
pytest = "^9.0.2"                                  # Framework for testing
pytest-cov = "^7.0.0"                              # Code coverage for tests
pytest-benchmark = "^5.2.0"                        # Performance benchmarking
coverage = "^7.13.0"                               # Coverage measurement
urllib3 = "^2.6.2"                                 # HTTP client (transitive, pinned for security)
black = "^25.12.0"                                 # Code formatter
flake8 = "^7.1.0"                                  # Linter for code quality
mypy = "^1.19.1"                                   # Static type checker
isort = "^7.0.0"                                   # Import sorter
tox = "^4.4.6"                                     # Testing multiple environments
pre-commit = "^4.5.1"                              # Pre-commit hooks for linting and formatting
pylint = "^4.0.4"                                  # Static code analyzer
bandit = { extras = ["toml"], version = "^1.7.5" } # Security linter

# =============================================================================
# Documentation Dependencies
# =============================================================================

[tool.poetry.group.doc.dependencies]
mkdocs = "^1.6.1"
mkdocs-material = "^9.7.1"
mkdocstrings = { extras = ["python"], version = "^1.0.0" }
pymdown-extensions = "^10.13.1"
markdown = "^3.7.0"
pygments = "^2.18.0"
sphinx = "^8.1.0"
sphinx-rtd-theme = "^3.0.2"
sphinx-autodoc-typehints = "^3.5.2"
myst-parser = "^4.0.0"


# =============================================================================
# Build System
# =============================================================================

[build-system]
requires = ["poetry-core>=1.5.0"]
build-backend = "poetry.core.masonry.api"


# =============================================================================
# Scripts
# =============================================================================

[tool.poetry.scripts]
rite = "rite.__main__:main" # Entry point for the package
# test = "pytest --cov=rite tests/:main" # Run tests with coverage
# lint = "flake8 src/rite/:main"            # Run linter on source files
# format = "black src/rite/:main"           # Format source files
# type-check = "mypy src/rite/:main"        # Type-check source files


# =============================================================================
# Tox Configuration
# =============================================================================

[tool.tox]
envlist = ["py310", "py311", "py312", "lint", "type-check"]

[tool.tox.default]
description = "Run all test environments."

[tool.tox.env.py310]
description = "Run tests with Python 3.10."
deps = ["pytest", "pytest-cov"]
commands = ["pytest --cov=rite tests/"]

[tool.tox.env.py311]
description = "Run tests with Python 3.11."
deps = ["pytest", "pytest-cov"]
commands = ["pytest --cov=rite tests/"]

[tool.tox.env.py312]
description = "Run tests with Python 3.12."
deps = ["pytest", "pytest-cov"]
commands = ["pytest --cov=rite tests/"]

[tool.tox.env.lint]
description = "Run linting with flake8."
deps = ["flake8"]
commands = ["flake8 src/"]

[tool.tox.env.type-check]
description = "Run type-checking with mypy."
deps = ["mypy"]
commands = ["mypy src/"]


# =============================================================================
# Tool Configuration References
# =============================================================================
# This file now contains only Poetry metadata and dependencies.
# Tool configurations have been moved to dedicated files:
#
# - Black:        No separate config needed (uses sensible defaults)
# - isort:        .isort.cfg
# - Flake8:       .flake8
# - Pylint:       .pylintrc
# - Mypy:         mypy.ini
# - Pytest:       pytest.ini
# - Coverage:     .coveragerc
# - Tox:          tox.ini
# - EditorConfig: .editorconfig
# - Pre-commit:   .pre-commit-config.yaml
# - VS Code:      .vscode/settings.json
# - Git:          .gitignore
# - Bandit:       See [tool.bandit] below

# =============================================================================
# Black Configuration
# =============================================================================
# Black uses sensible defaults. Command-line usage:
#   poetry run black --line-length=88 --target-version=py310 src/

[tool.black]
line-length = 79
target-version = ["py312", "py313"]
extend-exclude = '(\.eggs|\.git|\.hg|\.mypy_cache|\.tox|\.venv|_build|buck-out|build|dist|htmlcov|bup|wip)'


# =============================================================================
# Bandit Security Configuration
# =============================================================================
# Single point of truth for security linting
# Note: Bandit requires configuration in pyproject.toml

[tool.bandit]
targets = ["src"]
exclude_dirs = [
  "/test",
  "*/test_*.py",
  "*/tests/*",
  "*/tst/*",
  "*/bup/*",
  "*/wip/*",
]
skips = [
  "B101", # assert_used - we use asserts in tests
  "B301", # pickle - we provide pickle utilities (documented risk)
  "B310", # urllib_urlopen - URL utilities need to open URLs
  "B311", # random - used for non-cryptographic purposes (text styling)
  "B318", # xml.dom.minidom.parseString - XML parsing utilities
  "B324", # hashlib weak hash - we provide MD5/SHA1 for compatibility
  "B403", # pickle import - we provide pickle serialization utilities
  "B404", # subprocess import - required for process management
  "B406", # xml.sax - XML parsing utilities (documented risk)
  "B408", # xml.dom.minidom - XML parsing utilities (documented risk)
  "B601", # paramiko_calls - not applicable
  "B603", # subprocess_without_shell - shell=False is intentional
  "B608", # hardcoded_sql - SQL utilities use parameterized queries
]
