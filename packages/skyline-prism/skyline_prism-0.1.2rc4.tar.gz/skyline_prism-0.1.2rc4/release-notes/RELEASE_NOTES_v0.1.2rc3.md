# Skyline-PRISM v0.1.2rc3 Release Notes

## Overview

This release significantly enhances the Quality Control (QC) report with better visualizations, improved metadata tracking, and fixes for raw data scale issues in plots. The RT-Lowess normalization plots have been refined for clarity and readability.

## Improvements

### QC Report Enhancements
- **Rich Metadata Header**: Added a comprehensive summary section at the top of the report detailing:
  - Dataset statistics (counts for peptides, proteins, samples, and breakdown by experimental/ref/qc types)
  - Pipeline metadata (version, processing date, computer name)
  - Source file list
  - Complete processing parameters used for the run
- **Improved Correlation Heatmaps**:
  - **Simplified Labels**: Replaced long filenames with concise type-based labels (e.g., `Ref_001`, `QC_001`) for better readability.
  - **Refined Clustering**: Removed visual dendrograms to reduce clutter while preserving hierarchical clustering order.
  - **Better Color Scaling**: Updated colormap to a Red-Blue scale where Red=1.0 (perfect correlation) and Blue=minimum value, making structure easier to see.
- **Pipeline Summary**: Moved the processing steps log to the top of the report for immediate visibility.

### Configuration
- **Cleaned Config Template**: Removed the deprecated `rt_correction` option from the default configuration template generated by `prism config-template`.
- **Updated Validation**: Added `rt_correction` and `boxplot_comparison` to the known configuration keys to prevent false-positive "unknown key" warnings.

## Bug Fixes

- **QC Plot Data Scaling**: Fixed an issue where "Before Normalization" QC plots (distributions, boxplots) appeared distorted because they were plotting linear-scale raw data against log2-scale normalized data. The pipeline now automatically detects linear-scale raw data (median > 100) and converts it to log2 specifically for the QC plots, ensuring valid visual comparisons.

## Testing

- Verified QC report generation with new metadata and visualization features.
- Confirmed correct automatic handling of linear vs log2 data in plotting functions.
- Validated simplified correlation plot labeling and clustering.

## Installation

```bash
pip install skyline-prism==0.1.2rc3
```

Or install from source:

```bash
git clone https://github.com/maccoss/skyline-prism.git
cd skyline-prism
pip install -e ".[viz]"
```

## Full Changelog

See commits since v0.1.2rc2: https://github.com/maccoss/skyline-prism/compare/v0.1.2rc2...v0.1.2rc3
