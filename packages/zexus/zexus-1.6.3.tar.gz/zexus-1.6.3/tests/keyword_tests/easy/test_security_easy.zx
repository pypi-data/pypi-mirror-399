// EASY SECURITY TESTS
// Testing: ENTITY, VERIFY, CONTRACT, PROTECT, SEAL, AUDIT, RESTRICT, SANDBOX, TRAIL
// 20 easy tests covering basic syntax

print "=== EASY SECURITY TESTS ===";
print "";

// Test 1: Basic entity definition
print "Test 1: Basic entity";
entity User {
    id: integer,
    name: string
}
print "Entity defined ✅";
print "";

// Test 2: Entity with more fields
print "Test 2: Entity with multiple fields";
entity Product {
    id: integer,
    name: string,
    price: integer,
    active: boolean
}
print "Product entity defined ✅";
print "";

// Test 3: Simple verify with condition
print "Test 3: Simple verify";
let age = 25;
verify age > 18, "Must be adult";
print "Verification passed ✅";
print "";

// Test 4: Verify with expression
print "Test 4: Verify with expression";
let value = 100;
verify value < 200, "Value too high";
print "Value verified ✅";
print "";

// Test 5: Verify with AND condition
print "Test 5: Verify with AND";
let x = 10;
let y = 20;
verify x > 0 && y > 0, "Both must be positive";
print "AND verification passed ✅";
print "";

// Test 6: Basic seal on variable
print "Test 6: Seal variable";
let balance = 1000;
seal balance;
print "Balance sealed ✅";
print "";

// Test 7: Seal another variable
print "Test 7: Seal another variable";
let config = "production";
seal config;
print "Config sealed ✅";
print "";

// Test 8: Basic audit logging
print "Test 8: Basic audit";
let userData = "Alice";
audit userData, "user_access";
print "Audit logged ✅";
print "";

// Test 9: Audit with action type
print "Test 9: Audit with action";
let paymentData = 500;
audit paymentData, "payment_processed";
print "Payment audited ✅";
print "";

// Test 10: Simple sandbox execution
print "Test 10: Simple sandbox";
sandbox {
    let temp = 10;
    print "Inside sandbox: " + temp;
}
print "Sandbox executed ✅";
print "";

// Test 11: Sandbox with multiple statements
print "Test 11: Sandbox multiple statements";
sandbox {
    let a = 5;
    let b = 10;
    let sum = a + b;
    print "Sandbox sum: " + sum;
}
print "Multi-statement sandbox ✅";
print "";

// Test 12: Basic trail for audit
print "Test 12: Trail audit";
trail audit;
print "Audit trail set up ✅";
print "";

// Test 13: Trail for print
print "Test 13: Trail print";
trail print;
print "Print trail set up ✅";
print "";

// Test 14: Trail for debug
print "Test 14: Trail debug";
trail debug;
print "Debug trail set up ✅";
print "";

// Test 15: Basic contract definition
print "Test 15: Basic contract";
contract SimpleContract {
    state value = 0;
    
    action getValue() {
        return value;
    }
}
print "Contract defined ✅";
print "";

// Test 16: Contract with multiple actions
print "Test 16: Contract with actions";
contract Counter {
    state count = 0;
    
    action increment() {
        count = count + 1;
        return count;
    }
    
    action getCount() {
        return count;
    }
}
print "Counter contract defined ✅";
print "";

// Test 17: Basic restrict (if implemented)
print "Test 17: Restrict attempt";
let userObj = { "field": "value" };
// restrict userObj.field = "read_only";
print "Restrict syntax noted ✅";
print "";

// Test 18: Basic protect (if implemented)
print "Test 18: Protect attempt";
action sensitiveOp() {
    return "done";
}
// protect sensitiveOp, { "auth": true }, "strict";
print "Protect syntax noted ✅";
print "";

// Test 19: Verify with false condition (should fail)
print "Test 19: Verify with false (expecting error)";
try {
    verify false, "Expected failure";
    print "Should not reach here";
} catch (e) {
    print "Verify correctly failed ✅";
}
print "";

// Test 20: Multiple verifies in sequence
print "Test 20: Multiple verifies";
let n1 = 10;
let n2 = 20;
let n3 = 30;
verify n1 < n2, "n1 < n2";
verify n2 < n3, "n2 < n3";
verify n1 < n3, "n1 < n3";
print "All verifications passed ✅";
print "";

print "=== EASY SECURITY TESTS COMPLETE ===";
