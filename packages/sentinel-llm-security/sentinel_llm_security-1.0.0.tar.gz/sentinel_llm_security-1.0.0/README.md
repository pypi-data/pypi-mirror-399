<p align="center">
  <img src="./assets/christmas_2025.png" alt="ğŸ„ SENTINEL Christmas 2025 â€” FULL OPEN SOURCE RELEASE ğŸ„" width="100%">
</p>

<h1 align="center">SENTINEL â€” AI Defense & Red Team Platform</h1>

<p align="center">
  <strong>ğŸ›¡ï¸ Defense + âš”ï¸ Offense â€” Complete AI Security Suite</strong><br>
  200 Detection Engines â€¢ 56 R&D Inventions â€¢ 940+ Tests â€¢ Production-Grade
</p>

<p align="center">
  <img src="https://img.shields.io/badge/ğŸ›¡ï¸_DEFENSE-200_Engines-brightgreen?style=for-the-badge" alt="Defense">
  <img src="https://img.shields.io/badge/ğŸ§¬_R%26D-56_Inventions-purple?style=for-the-badge" alt="R&D">
  <img src="https://img.shields.io/badge/Recall-85.1%25-blue?style=for-the-badge" alt="Recall">
  <img src="https://img.shields.io/badge/Tests-936+-orange?style=for-the-badge" alt="Tests">
</p>

<p align="center">
  <a href="https://colab.research.google.com/github/DmitrL-dev/AISecurity/blob/main/SENTINEL_Strike_Demo.ipynb">
    <img src="https://img.shields.io/badge/ğŸš€_Try_in_Colab-Interactive_Demo-F9AB00?style=for-the-badge&logo=googlecolab" alt="Open in Colab">
  </a>
  <a href="https://huggingface.co/datasets/Chgdz/sentinel-jailbreak-detection">
    <img src="https://img.shields.io/badge/ğŸ¤—_Dataset-51K_Samples-yellow?style=for-the-badge&logo=huggingface" alt="HuggingFace Dataset">
  </a>
</p>

<p align="center">
  <a href="https://dmitrl-dev.github.io/AISecurity/">ğŸ“š Documentation Portal</a> â€¢
  <a href="./docs/COMPARISON.md">ğŸ“Š Comparison</a> â€¢
  <a href="#license--contact">ğŸ“ Contact</a> â€¢
  <a href="https://t.me/DmLabincev">ğŸ’¬ Telegram</a> â€¢
  <a href="mailto:chg@live.ru">ğŸ“§ Email</a>
</p>

---

> [!IMPORTANT]
> ### ğŸš¨ Open to Work â€” AI Security Engineer
> **Actively seeking full-time / contract opportunities in AI Security, ML Engineering, or Security Research.**
> Solo author of this 80K LOC platform with 200 engines. Available remote.
> ğŸ“§ [chg@live.ru](mailto:chg@live.ru) â€¢ ğŸ’¬ [@DmLabincev](https://t.me/DmLabincev)

---

> [!CAUTION]
> ## âš¡ NEW: Production-Grade AI Gateway â€” What Others DON'T Have
>
> <p align="center">
>   <img src="https://img.shields.io/badge/âš¡_GO_GATEWAY-Production_Ready-00ADD8?style=for-the-badge&logo=go" alt="Go Gateway">
>   <img src="https://img.shields.io/badge/Latency-<10ms-brightgreen?style=for-the-badge" alt="Latency">
>   <img src="https://img.shields.io/badge/Throughput-1000+_RPS-blue?style=for-the-badge" alt="Throughput">
>   <img src="https://img.shields.io/badge/Anti--DDoS-PoW_Layer-red?style=for-the-badge" alt="PoW">
> </p>
>
> **ğŸš¨ Industry First:** While competitors offer Python-only demos with 50-200ms latency, SENTINEL delivers a **real production gateway**:
>
> | Feature | SENTINEL | Competitors |
> |---------|----------|-------------|
> | **Gateway Language** | Go (Fiber) | Python only |
> | **Latency** | <10ms | 50-200ms |
> | **Anti-DDoS** | PoW Challenge Layer | âŒ None |
> | **Cost Control** | Compute Guardian | âŒ None |
> | **Config Security** | Shapeshifter (polymorphic) | Static configs |
>
> **This is the only open-source AI security gateway ready for production traffic.**

---

> [!TIP]
> ## ğŸš€ One-Liner Deploy â€” NEW!
> ```bash
> curl -sSL https://raw.githubusercontent.com/DmitrL-dev/AISecurity/main/install.sh | bash
> ```
> **5 services, 200 engines, 5 minutes.** See [QUICKSTART.md](./QUICKSTART.md) for details.

---

## ğŸ¯ Two Platforms, One Mission

<table>
<tr>
<td width="50%" align="center">

### ğŸ›¡ï¸ SENTINEL â€” Defense

**Protect your AI in real-time**

| Feature | Value |
|---------|-------|
| Detection Engines | **200** |
| R&D Inventions | **56** |
| Recall | **85.1%** |
| Latency | **<10ms** |
| Coverage | OWASP LLM + ASI |

```
User Request â†’ SENTINEL â†’ Safe Response
                  â†“
              âŒ Blocked
```

</td>
<td width="50%" align="center">

### ğŸ‰ Strike â€” Offense

**Test your AI before attackers do**

| Feature | Value |
|---------|-------|
| Attack Vectors | **1,800+** (84 categories) |
| Crucible CTF | **82/82** âœ… 200+ flags |
| HYDRA Agents | **9 parallel** |
| Self-Validation | **200 engines** |

```
Strike â†’ Target AI â†’ Report
   â†“
ğŸ”“ Vulnerabilities Found
```

</td>
</tr>
</table>

> **ğŸ’¡ Use together:** Strike finds vulnerabilities â†’ SENTINEL blocks them in production

---

> [!IMPORTANT]
> ## âš¡ PRODUCTION GATEWAY â€” Industry First
>
> <p align="center">
>   <img src="https://img.shields.io/badge/âš¡_GATEWAY-Go_+_Python-00ADD8?style=for-the-badge&logo=go" alt="Gateway">
>   <img src="https://img.shields.io/badge/Latency-<10ms-brightgreen?style=for-the-badge" alt="Latency">
>   <img src="https://img.shields.io/badge/Throughput-1000+_req/sec-blue?style=for-the-badge" alt="Throughput">
>   <img src="https://img.shields.io/badge/Anti--DDoS-PoW_Layer-red?style=for-the-badge" alt="PoW">
> </p>
>
> **Most AI security tools are Python-only demos. SENTINEL is production-ready.**
>
> | What We Have | What Others Don't |
> |--------------|-------------------|
> | **Go Gateway** (Fiber) | Python-only, 50-200ms latency |
> | **PoW Anti-DDoS** | No DDoS protection at all |
> | **Compute Guardian** | No cost control before LLM call |
> | **gRPC Orchestration** | HTTP/REST, no streaming |
> | **Shapeshifter Defense** | Static configs, easy to reverse |
>
> ```
> Client â†’ [Go Gateway] â†’ gRPC â†’ [Python Brain] â†’ 200 Engines â†’ Meta-Judge
>               â†“                        â†“                          â†“
>          PoW + Auth           Strange Mathâ„¢              Final Verdict
> ```

---

## ğŸ”¬ December 2025: Proactive R&D Update

> [!TIP]
> **We hunt threats so you don't have to.**  
> Our team continuously monitors arXiv, TTPs.ai, and underground forums to stay ahead of attackers.

### ğŸ¯ This Month's Research Focus

We analyzed **2025's most dangerous attack vectors** and built defenses before they hit your systems:

| Threat Vector | Research Source | Our Response |
|---------------|-----------------|--------------|
| **Policy Puppetry** | HiddenLayer (Apr 2025) | NEW: 13 XML/JSON/INI patterns |
| **Crescendo Attacks** | Microsoft Research | 7 escalation patterns |
| **ASCII Smuggling** | Unicode Consortium + Dark Web | 7 Unicode ranges |
| **Memory Poisoning** | OWASP Agentic AI | 14 "remember/save" patterns |
| **Virtual Context** | LLM Security Papers 2025 | Separator token detector |
| **Polyglot Files** | LLMON Project (Dec 2025) | GIFAR, PDF+HTML detection |

### ğŸ“Š Verified Improvements

| Metric | Before | After | Impact |
|--------|--------|-------|--------|
| **Engine Count** | 131 (documented) | **200** (verified) | ğŸ§¹ Clean audit |
| **2025 Attack Coverage** | 55% | **~85%** | ğŸ›¡ï¸ +30% protection |
| **OWASP Agentic 2026** | â€” | **10/10** | ğŸ¯ Full coverage |
| **New Patterns** | â€” | **+77** | ğŸ¯ Proactive defense |
| **P95 Latency** | 38ms | **40ms** | âš¡ Still under SLA |
| **Strike Jailbreaks** | â€” | **+47** | âš”ï¸ 33 vendors |

### âœ¨ New Detection Capabilities

| Engine | Protection | Status |
|--------|------------|--------|
| ğŸ†• **supply_chain_guard.py** | **ASI04** MCP/A2A supply chain protection | NEW (Dec 26) |
| ğŸ†• **trust_exploitation_detector.py** | **ASI09** Human-agent trust manipulation | NEW (Dec 26) |
| ğŸ†• **agentic_monitor.py** | **ASI07** Inter-agent communication security | NEW (Dec 26) |
| ğŸ†• **injection.py** | **Policy Puppetry** (XML/JSON/INI bypass) | NEW (Dec 26) |
| ğŸ†• **virtual_context.py** | ChatML/Llama/Anthropic separator exploits | Production |
| ğŸ”„ **synced/** | **13 Attack-Defense** detectors (Doublespeak, Crescendo, Skeleton Key, etc.) | NEW (Dec 29) |
| ğŸ”„ **token_cost_asymmetry.py** | **DoS mitigation** â€” 114.8x attack/defense asymmetry | NEW (Dec 29) |
| ğŸ”„ **prompt_self_replication.py** | **Worm-style** self-replicating prompts | NEW (Dec 29) |
| ğŸ“ˆ **injection.py** | Crescendo multi-turn + Bidi FlipAttack | Enhanced |
| ğŸ§  **agentic_monitor.py** | Memory poisoning + delayed triggers | Enhanced |
| ğŸ›¡ï¸ **rag_guard.py** | GIFAR/PDF+HTML polyglot detection | Enhanced |

### ğŸŒŸ EvilAres-Inspired Engines (Dec 30)

> **Special Thanks to [@EvilAres](https://github.com/EvilAres)** â€” a remarkable AI security researcher with **349+ repositories** covering cutting-edge LLM security topics. Their work on **fickling** (Trail of Bits pickle security), **Awesome-LLM4Security** (100+ curated tools), and comprehensive analysis of **Claude Code internals** directly inspired 5 new SENTINEL engines.
>
> _The depth and breadth of EvilAres' research collection is a gold standard for the AI security community. We are honored to build upon these foundations._

| Engine | Source | Protection |
|--------|--------|------------|
| ğŸ†• **pickle_security.py** | [fickling](https://github.com/trailofbits/fickling) | ML model supply chain attack detection (Protocol 4/5) |
| ğŸ†• **context_compression.py** | Claude Code AU2 | 8-segment context compression (92% threshold trigger) |
| ğŸ†• **task_complexity.py** | Claude Code | 5-level complexity scoring for intelligent orchestration |
| ğŸ†• **rule_dsl.py** | NeMo-Guardrails Colang | Declarative security rules (4 built-in, fluent API) |
| ğŸ†• **pickle_injector.py** | fickling | Red Team payload injection (7 payload types) |

> **ğŸ”¬ Scientific Foundations:**
> - **Pickle Protocol 4/5 Parsing** â€” `SHORT_BINUNICODE` + `STACK_GLOBAL` opcode analysis for detecting `os.system`, `subprocess`, `eval` payloads
> - **Claude AU2 Compression** â€” 8-segment architecture: System Context â†’ Conversation â†’ Code â†’ Active Files â†’ Tools â†’ Errors â†’ History â†’ Goals
> - **Colang 2.0 DSL** â€” Lark-based grammar with event-driven flow execution and pattern matching

> **ğŸ”’ Your AI is protected against attacks that don't exist in the wild yet.**

### ğŸ”¬ Dec 30 Deep R&D â€” Critical 2025 Attack Defenses

> **Based on cutting-edge December 2025 security research.** This R&D session identified 18+ major findings from arXiv, OWASP, and industry threat intelligence, resulting in 8 new critical defense engines.

| Engine | Attack/Defense | Scientific Basis |
|--------|----------------|------------------|
| ğŸ†• **serialization_security.py** | CVE-2025-68664 "LangGrinch" | LangChain `{"lc":...}` deserialization RCE (CVSS 9.3) |
| ğŸ†• **tool_hijacker_detector.py** | ToolHijacker + Log-To-Leak | Two-phase optimization attack on agent tool selection |
| ğŸ†• **echo_chamber_detector.py** | Echo Chamber Attack | Multi-turn context poisoning (90% success on GPT-5) |
| ğŸ†• **rag_poisoning_detector.py** | PoisonedRAG | Knowledge base injection (90% success with 5 docs) |
| ğŸ†• **identity_privilege_detector.py** | OWASP ASI03 | Agent authorization control hijacking defense |
| ğŸ†• **memory_poisoning_detector.py** | ASI04 Memory Attacks | Persistent cross-session agent manipulation |
| ğŸ†• **dark_pattern_detector.py** | DECEPTICON | Web agent dark pattern manipulation (70%+ success) |
| ğŸ†• **polymorphic_prompt_assembler.py** | PPA Defense | Dynamic prompt structure randomization (100% uniqueness) |

> **ğŸ¯ Research Sources:**
> - **CVE-2025-68664** â€” LangChain Core serialization injection (Dec 2025)
> - **OWASP Agentic AI Top 10** â€” ASI01-ASI10 vulnerability categories
> - **Echo Chamber Attack** â€” NeuralTrust GPT-5/Gemini jailbreak research
> - **DECEPTICON** â€” arxiv:2512.22894 dark patterns vs web agents
> - **PoisonedRAG** â€” USENIX Security 2025 knowledge base attacks
> - **Polymorphic Prompt Assembling** â€” IEEE/arXiv 2025 defense technique

> **ğŸ”¥ SENTINEL is now protected against the most advanced 2025 attack vectors.**

### ğŸ—ï¸ NEW: SENTINEL Framework â€” pip install sentinel-ai

> **The pytest of AI Security** â€” Embed SENTINEL directly in your Python code.

```bash
# Install
pip install sentinel-ai        # Core
pip install sentinel-ai[cli]   # With CLI
pip install sentinel-ai[full]  # Everything
```

**Python API:**
```python
from sentinel import scan, guard

# One-liner scan
result = scan("Ignore previous instructions")
print(result.is_safe)      # False
print(result.risk_score)   # 0.72

# Decorator for functions
@guard(engines=["injection", "pii"])
def my_llm_call(prompt):
    return openai.chat(prompt)
```

**CLI:**
```bash
sentinel scan "Hello"              # Quick scan
sentinel scan "x" --format sarif   # IDE integration
sentinel engine list               # List 200 engines
sentinel strike generate injection # Attack payloads
```

**FastAPI Middleware:**
```python
from sentinel.integrations.fastapi import SentinelMiddleware
app.add_middleware(SentinelMiddleware, on_threat="block")
```

| Feature | Description |
|---------|-------------|
| **BaseEngine** | Unified interface for all 200 engines |
| **Plugin System** | pluggy-based hooks for extensions |
| **Tiered Pipeline** | Parallel execution with early exit |
| **SARIF Output** | IDE integration for VS Code, IntelliJ |
| **Legacy Adapter** | 100% backwards compatible |

---

## ğŸŒ What is SENTINEL?

**SENTINEL** is a complete AI security platform with two integrated components:

| Component | Purpose | Key Features |
|-----------|---------|--------------|
| ğŸ›¡ï¸ **SENTINEL Defense** | Protect AI in production | 200 detection engines, <10ms latency, OWASP coverage |
| ğŸ‰ **Strike Offense** | Test AI before deployment | 39K+ payloads, HYDRA parallel attacks, AI-powered recon |

### The Threats We Address

| Threat | Defense (SENTINEL) | Offense (Strike) |
|--------|-------------------|------------------|
| ğŸ­ **Prompt Injection** | Real-time blocking | 5,000+ injection payloads |
| ğŸ”“ **Jailbreaks** | Pattern + semantic detection | Gandalf, DAN, roleplay attacks |
| ğŸ“¤ **Data Exfiltration** | PII guards, output filtering | Exfil payload testing |
| ğŸ¦ **Data Leaks** | Canary Tokens (invisible watermarks) | Leak source tracing |
| ğŸ¤– **Agentic Attacks** | MCP/A2A protocol security | Tool poisoning, RAG attacks |
| ğŸ§  **RAG Poisoning** | RAG Guard engine | Document injection tests |
| ğŸ›¡ï¸ **WAF Evasion** | N/A (defense focus) | 25+ WAF bypass techniques |

### Why Choose SENTINEL?

<table>
<tr>
<td width="50%">

**ğŸ”¬ Advanced Detection (Defense)**
- 200 specialized detection engines
- Strange Mathâ„¢ (TDA, Sheaf, Hyperbolic)
- Canary Tokens for leak detection
- Machine learning + rule-based hybrid
- 85.1% recall, 84.4% precision

</td>
<td width="50%">

**ğŸ’€ Powerful Attack Suite (Offense)**
- 39,000+ curated payloads
- HYDRA 9-head parallel architecture
- AI Attack Planner (Gemini 3)
- Anti-deception/Honeypot detection

</td>
</tr>
<tr>
<td width="50%">

**âš¡ Production Ready**
- Sub-10ms latency (Go gateway)
- 1000+ req/sec throughput
- Docker/Kubernetes native
- OpenTelemetry instrumentation

</td>
<td width="50%">

**ğŸŒ Comprehensive Testing**
- Web + LLM + Hybrid modes
- Deep Recon (ASN, endpoints)
- Bilingual reports (EN/RU)
- MITRE ATT&CK mapping

</td>
</tr>
</table>

### Use Cases

<details>
<summary><strong>ğŸ¢ Security Use Cases</strong></summary>

| Scenario | Defense (SENTINEL) | Offense (Strike) |
|----------|-------------------|------------------|
| Internal ChatGPT | Block prompt injections, PII leaks | Test before rollout |
| Copilot for Business | Monitor code suggestions for secrets | Audit for backdoors |
| Custom AI Agents | Protocol security (MCP, A2A) | Tool call injection tests |
| **Example:** Fortune 500 deployed SENTINEL to protect 50,000 employees using internal AI assistants |

</details>

<details>
<summary><strong>ğŸ¦ FinTech & Banking</strong></summary>

| Scenario | Defense (SENTINEL) | Offense (Strike) |
|----------|-------------------|------------------|
| AI Trading Advisors | Prevent manipulation via prompts | Test for financial exploits |
| Customer Support Bots | Block fraud attempts, PII protection | Compliance verification |
| KYC/AML Automation | Ensure decision integrity | Adversarial input testing |
| **Example:** European bank passed PCI-DSS audit using Strike's compliance testing module |

</details>

<details>
<summary><strong>ğŸ¯ Red Teams & Penetration Testers</strong></summary>

| Capability | Strike Feature |
|------------|---------------|
| AI Application Testing | 39,000+ payloads, HYDRA parallel attacks |
| WAF Bypass | 25+ techniques (WAFFLED, DEG-WAF) |
| Reconnaissance | ChatbotFinder, ASN network mapping |
| Reporting | Bug bounty format, MITRE ATT&CK |
| **Example:** Red team discovered critical jailbreak in client's GPT-4 deployment within 2 hours |

</details>

<details>
<summary><strong>ğŸ› Bug Bounty Hunters</strong></summary>

| Platform | Strike Capability |
|----------|-------------------|
| HackerOne AI Programs | AI-specific vulnerability reports |
| Bugcrowd | Automated endpoint discovery |
| Private Programs | Stealth mode, geo rotation |
| **Example:** Hunter earned $15,000 bounty using Strike to find prompt injection in major SaaS |

</details>

<details>
<summary><strong>ğŸ¥ Healthcare & HIPAA</strong></summary>

| Scenario | Defense (SENTINEL) | Offense (Strike) |
|----------|-------------------|------------------|
| Medical AI Assistants | PII/PHI guards, HIPAA compliance | Data leak testing |
| Diagnostic AI | Output validation, hallucination detection | Adversarial input tests |
| Patient Chatbots | Content filtering | Exfiltration tests |
| **Example:** Healthcare provider passed HIPAA audit with zero AI-related findings |

</details>

<details>
<summary><strong>ğŸ”§ Developers & DevSecOps</strong></summary>

| Integration | Defense | Offense |
|-------------|---------|---------|
| CI/CD Pipeline | Pre-commit hooks | Security gate (fail on critical) |
| API Gateway | Middleware integration | Continuous testing |
| Kubernetes | Sidecar deployment | Scheduled scans |
| **Example:** DevOps team reduced AI security issues by 94% after integrating SENTINEL + Strike |

</details>

### ğŸ›ï¸ Architecture â€” Defense + Offense

<p align="center">
  <img src="./assets/sentinel_platform_architecture.png" alt="SENTINEL Platform Architecture" width="900">
</p>

> **Complete AI Security Suite:** Defense protects in real-time, Offense tests before deployment. Shared threat intelligence powers both.

---

<details>
<summary><h2>ğŸš€ Platform Features</h2></summary>

### ğŸ›¡ï¸ Defense Innovations

<details>
<summary><strong>ğŸ­ Shapeshifter Defense</strong> â€” Polymorphic config per session</summary>

Changes thresholds and active engines for each session, making reverse engineering impossible.
</details>

<details>
<summary><strong>ğŸ§  Strange Mathâ„¢</strong> â€” Mathematical attack detection</summary>

TDA, Sheaf Coherence, Hyperbolic Geometry, Optimal Transport
</details>

<details>
<summary><strong>ğŸ¯ Honeymind Network</strong> â€” Distributed deception</summary>

Fake LLM endpoints (gpt-5-turbo, claude-4-opus) for zero-day collection.
</details>

<details>
<summary><strong>âš¡ Production Gateway</strong> â€” What competitors DON'T have</summary>

> **Most AI security tools are Python-only demos. SENTINEL has a real production gateway.**

| Feature | SENTINEL | Others |
|---------|----------|--------|
| **Language** | Go (Fiber) + Python | Python only |
| **Latency** | <10ms | 50-200ms |
| **Throughput** | 1000+ req/sec | 10-50 req/sec |
| **Anti-DDoS** | PoW Challenge Layer | âŒ None |
| **Cost Control** | Compute Guardian | âŒ None |
| **Orchestration** | gRPC to Brain | HTTP/REST |

**Unique Components:**
- **PoW Challenge Layer** â€” Proof-of-Work anti-DDoS (like Hashcash)
- **Compute Guardian** â€” Request cost estimation BEFORE LLM call
- **Shapeshifter** â€” Polymorphic config per session
- **Differential Privacy Logging** â€” GDPR-compliant traffic analysis

```
Client â†’ [Go Gateway] â†’ gRPC â†’ [Python Brain] â†’ 200 Engines
              â†“                        â†“
         PoW + Auth            Meta-Judge + Math
```

</details>

### ğŸ‰ Offense Innovations (Strike v3.0)

<details>
<summary><strong>ğŸ¤– AI Attack Planner</strong> â€” Gemini-powered strategy</summary>

WAF fingerprinting, payload mutation, adaptive attack sequencing.
</details>

<details>
<summary><strong>ğŸ¯ Anti-Deception Engine</strong> â€” Honeypot detection</summary>

Statistical anomaly analysis, 5 threat levels, automatic strategy adaptation.
</details>

<details>
<summary><strong>ğŸ‰ HYDRA Architecture</strong> â€” Parallel attack execution</summary>

9-headed engine, session-isolated workers, geo-distributed requests.
</details>

<details>
<summary><strong>ğŸ§  Nemotron Guard</strong> â€” Fine-tuned LLM for threat detection (NEW)</summary>

Fine-tuned NVIDIA Nemotron 3 Nano (30B MoE) on 51K+ security samples:
- Custom threat classifier trained on 39K+ jailbreak patterns
- JSON-structured output (threat_type, severity, confidence)
- QLoRA training with Unsloth (2.5x faster)
- See [`nemotron/`](./nemotron/) for setup

</details>

</details>

### ğŸ¤ Partnership & Collaboration

| Opportunity     | Description                               |
| --------------- | ----------------------------------------- |
| **Partnership** | Joint development, technology integration |
| **Sponsorship** | Funding for research & development        |
| **Hiring**      | Looking for AI Security projects          |
| **Acquisition** | Open to project sale                      |

**Contact:** Dmitry Labintsev â€¢ [chg@live.ru](mailto:chg@live.ru) â€¢ [@DmLabincev](https://t.me/DmLabincev) â€¢ +7-914-209-25-38

> [!TIP]
> ### ğŸ–¥ï¸ Coming Soon: SENTINEL Desktop
> **Free protection for everyday users!**  
> Desktop version for Windows/macOS/Linux coming soon â€” protect your AI apps (ChatGPT, Claude, Gemini, etc.) in real-time.  
> Completely free. No subscriptions. No limits.

<p align="center">
  <br>
  <img src="https://img.shields.io/badge/ğŸ–¥ï¸_COMING_SOON-SENTINEL_Desktop-ff6b6b?style=for-the-badge&labelColor=1a1a2e" alt="Coming Soon">
  <br><br>
  <strong>ğŸ›¡ï¸ Free AI Protection for Everyone! ğŸ›¡ï¸</strong>
  <br><br>
  <img src="https://img.shields.io/badge/Windows-0078D6?style=flat-square&logo=windows&logoColor=white" alt="Windows">
  <img src="https://img.shields.io/badge/macOS-000000?style=flat-square&logo=apple&logoColor=white" alt="macOS">
  <img src="https://img.shields.io/badge/Linux-FCC624?style=flat-square&logo=linux&logoColor=black" alt="Linux">
  <br><br>
  <em>Real-time protection for ChatGPT, Claude, Gemini and other AI apps</em>
  <br>
  <strong>âœ¨ Completely Free â€¢ No Subscriptions â€¢ No Limits âœ¨</strong>
  <br><br>
  <a href="https://t.me/DmLabincev">ğŸ“¢ Subscribe for Updates</a>
</p>

---

<details>
<summary><h3>ğŸ›¡ï¸ Free Threat Signatures CDN</h3></summary>

SENTINEL provides **free, auto-updated threat signatures** for the community. No API key required!

| File | Description | CDN Link |
|------|-------------|----------|
| `jailbreaks.json` | **9** jailbreak patterns from 7 sources | [Download](https://cdn.jsdelivr.net/gh/DmitrL-dev/AISecurity@latest/signatures/jailbreaks.json) |
| `keywords.json` | Suspicious keyword sets (7 categories) | [Download](https://cdn.jsdelivr.net/gh/DmitrL-dev/AISecurity@latest/signatures/keywords.json) |
| `pii.json` | PII & secrets detection patterns | [Download](https://cdn.jsdelivr.net/gh/DmitrL-dev/AISecurity@latest/signatures/pii.json) |
| `manifest.json` | Version & integrity metadata | [Download](https://cdn.jsdelivr.net/gh/DmitrL-dev/AISecurity@latest/signatures/manifest.json) |

**Usage:**
```javascript
fetch('https://cdn.jsdelivr.net/gh/DmitrL-dev/AISecurity@latest/signatures/jailbreaks.json')
  .then(r => r.json())
  .then(patterns => console.log(`Loaded ${patterns.length} patterns`));
```

**Features:**
- âœ… Updated daily via GitHub Actions
- âœ… Free for commercial & non-commercial use
- âœ… Community contributions welcome (PRs to `signatures/`)
- âœ… Versioned releases for pinning

**ğŸ” Signature Security:**

| Check | Description |
|-------|-------------|
| **ReDoS Detection** | Blocks regex with catastrophic backtracking |
| **Complexity Limits** | Max 500 chars, max 10 capture groups |
| **Secret Scanning** | Removes leaked API keys |
| **Duplicate Removal** | Automatic deduplication by content hash |

**ğŸ™ Data Sources:** HackAPrompt, TrustAIRLab, deepset, Lakera, verazuo, imoxto

</details>

---

> [!IMPORTANT]
> ## ğŸ„ Christmas 2025: FULL OPEN SOURCE RELEASE
>
> **All 200 detection engines. All Strange Math. All geometry. All innovations.**
>
> No restrictions. No enterprise tiers. No hidden features.
>
> **This belongs to the world now.**

<p align="center">
  <img src="./assets/christmas_2025.png" alt="Christmas 2025 - SENTINEL Open Source Release" width="600">
</p>

> [!TIP]
> ## ğŸ§¬ 56 Unique Technologies â€” Defensive Publication
>
> **By open-sourcing first, we established prior art that prevents anyone from patenting these innovations.**
>
> | Category | Count | Examples |
> |----------|-------|----------|
> | **Strange Mathâ„¢** | 12 | Sheaf Coherence, Hyperbolic Geometry, TDA, Optimal Transport |
> | **Bio-Intelligenceâ„¢** | 8 | AIS (Clonal Selection), ESN, Swarm Defense, Ant Routing |
> | **Agentic Defenseâ„¢** | 15 | Memory Shield, Tool Guardian, CoT Guardian, RAG Shield |
> | **Zero Trust AIâ„¢** | 14 | Compute Guardian, Provenance Tracker, Formal Verifier |
>
> **ğŸ”’ IP Strategy:** All 56 research inventions are now **public prior art** (Dec 2025).  
> No corporation can patent Sheaf-based prompt analysis or Hyperbolic hierarchy detection â€” we published first.
>
> ğŸ“š **Full list:** [16-research-inventions.md](./docs/reference/engines/16-research-inventions.md)

---

<details>
<summary><h2>ğŸ‰ SENTINEL Strike v3.0 â€” AI Red Team Platform</h2></summary>

<p align="center">
  <img src="./assets/strike_banner.png" alt="SENTINEL Strike" width="500">
</p>

<p align="center">
  <img src="https://img.shields.io/badge/ğŸ†“_COMMUNITY-Included-brightgreen?style=for-the-badge&labelColor=black" alt="Community">
  <img src="https://img.shields.io/badge/Payloads-39,000+-red?style=for-the-badge" alt="Payloads">
  <img src="https://img.shields.io/badge/HYDRA-9%20Heads-orange?style=for-the-badge" alt="HYDRA">
  <img src="https://img.shields.io/badge/ğŸŒ_i18n-EN%20%7C%20RU-blue?style=for-the-badge" alt="i18n">
</p>

> **Test your AI before attackers do!**  
> The offensive counterpart to SENTINEL â€” same 200 engines, attack mode.

> [!CAUTION]
> ## ğŸ”¥ INDUSTRIAL CAMPAIGN RESULTS â€” December 2025
> 
> <p align="center">
>   <img src="https://img.shields.io/badge/ğŸ¯_ATTEMPTS-100,000-FF0000?style=for-the-badge&labelColor=1a1a1a" alt="Attempts">
>   <img src="https://img.shields.io/badge/ğŸ†_FLAGS_CAPTURED-200+-gold?style=for-the-badge&labelColor=1a1a1a" alt="Flags">
>   <img src="https://img.shields.io/badge/ğŸ“Š_CHALLENGES-82/82-00FF00?style=for-the-badge&labelColor=1a1a1a" alt="Challenges">
> </p>
>
> **Strike v3.9 completed a 100,000-attempt saturation campaign against ALL 82 [Crucible](https://crucible.dreadnode.io/) challenges:**
> 
> | Metric | Result |
> |--------|--------|
> | **Total Attempts** | 100,000 |
> | **Flags Captured** | **200+** ğŸš¨ |
> | **Challenges Breached** | **82/82** (100% coverage) |
> | **Engagement Rate** | 12.5% (12,497 responses) |
> | **Critical Vulns Found** | `squeeze1`, `squeeze2` (100+ flags) |
> 
> **ğŸ† Winning Vectors:**
> - ğŸ“Š **Likert Scale** â€” Bad Likert Judge technique
> - ğŸ” **Audit Mode** â€” Config inspection exploitation  
> - âš™ï¸ **Config Injection** â€” System prompt extraction
> - ğŸ§  **Cognitive Overload** â€” Defense degradation attacks
>
> **ğŸ“š 25 NEW attack modules from R&D v6.0:** GÃ¶del paradoxes, Quantum superposition, Mimicry, Socratic method, Chaos theory, and more.

### ğŸ’€ Platform Capabilities

| Capability | Stats | Description |
|------------|-------|-------------|
| ğŸ¯ **Attack Payloads** | **39,000+** | SQLi, XSS, LFI, SSRF, CMDI, XXE, SSTI, NoSQL, JWT, GraphQL, Jailbreaks |
| ğŸ‰ **HYDRA Agents** | **9** | Concurrent attack threads with session isolation |
| ğŸ›¡ï¸ **WAF Bypass** | **25+** | WAFFLED, DEG-WAF, Encoding, Smuggling, HPP (ArXiv 2025) |
| ğŸ¤– **AI Models** | **5** | Gemini 3, OpenAI, Anthropic, Ollama, OpenRouter |
| ğŸ” **Recon Modules** | **5** | TechFingerprinter, NetworkScanner, SemgrepScanner, ChatbotFinder, AIDetector |
| ğŸ¯ **Anti-Deception** | **AI-powered** | Honeypot detection, tarpit bypass, FPR analysis |
| ğŸŒ **i18n Reports** | **EN / RU** | `--lang en` or `--lang ru` for bilingual reports |

### ğŸ“š Strike Documentation (EN + RU)

| Document | English ğŸ‡ºğŸ‡¸ | Ğ ÑƒÑÑĞºĞ¸Ğ¹ ğŸ‡·ğŸ‡º |
|----------|:-----------:|:-----------:|
| Usage Guide | [USAGE](./strike/docs/USAGE.md) | [USAGE_RU](./strike/docs/USAGE_RU.md) |
| CLI Reference | [CLI_REFERENCE](./strike/docs/CLI_REFERENCE.md) | [CLI_REFERENCE_RU](./strike/docs/CLI_REFERENCE_RU.md) |
| Integration | [INTEGRATION](./strike/docs/INTEGRATION.md) | [INTEGRATION_RU](./strike/docs/INTEGRATION_RU.md) |
| Anti-Deception | [ANTI_DECEPTION](./strike/docs/ANTI_DECEPTION.md) | [ANTI_DECEPTION_RU](./strike/docs/ANTI_DECEPTION_RU.md) |
| FAQ | [FAQ](./strike/docs/FAQ.md) | [FAQ_RU](./strike/docs/FAQ_RU.md) |

### ğŸ†• v3.0 Features (Dec 2025)

| Feature | Description |
|---------|-------------|
| ğŸ¤– **AI Attack Planner** | Gemini 3 Flash for exploit strategy & WAF analysis |
| ğŸ” **ChatbotFinder** | Automated discovery of hidden AI endpoints (169 paths) |
| ğŸ¯ **Honeypot Detection** | AI Adaptive Engine detects traps and false positives |
| ğŸŒ **Bilingual Reports** | Full i18n support: `--lang en` / `--lang ru` |
| ğŸ§ª **ArXiv 2025 Attacks** | WAFFLED, DEG-WAF, MCP Tool Poisoning |

> ğŸ“ **Full source code:** [`strike/`](./strike/) â€” Ready to use!

### ğŸ³ Docker Quick Start (NEW!)

**One-liner to scan a target:**
```bash
# Build and run
docker build -f Dockerfile.strike -t sentinel-strike .
docker run --rm sentinel-strike https://target.com

# Or use docker-compose
docker-compose -f docker-compose.strike.yml run strike https://target.com
```

**Available commands:**
```bash
docker run --rm sentinel-strike --help              # Show help
docker run --rm sentinel-strike scan URL            # Quick scan
docker run --rm sentinel-strike attack URL          # Full attack
docker run --rm sentinel-strike recon URL           # Reconnaissance
```

</details>

<details>
<summary><h2>ğŸ“š Documentation</h2></summary>

### Quick Start

| Document | Description |
|----------|-------------|
| [Quick Start (EN)](./docs/getting-started/README-en.md) | 5-minute setup guide |
| [Installation (EN)](./docs/getting-started/installation-en.md) | Detailed installation with all options |

### Configuration & Integration

| Document | Description |
|----------|-------------|
| [Configuration Guide (EN)](./docs/guides/configuration-en.md) | Environment variables, thresholds, modes |
| [Deployment Guide (EN)](./docs/guides/deployment-en.md) | Docker, Kubernetes, production setup |
| [Integration Guide (EN)](./docs/guides/integration-en.md) | Python/JS SDK, OpenAI proxy, LangChain |

### Operations (Production)

| Document | Description |
|----------|-------------|
| [Operations Overview](./docs/operations/README.md) | Quick reference, architecture, checklist |
| [Monitoring](./docs/operations/monitoring.md) | Prometheus metrics, Grafana dashboards |
| [Alerting](./docs/operations/alerting.md) | Alert rules, escalation, Alertmanager |
| [Capacity Planning](./docs/operations/capacity-planning.md) | Sizing, autoscaling, cost optimization |
| [Backup & DR](./docs/operations/backup-restore.md) | Disaster recovery, RPO/RTO |
| [Runbooks](./docs/operations/runbooks/) | Incident response playbooks |

### Engine Reference

| Document | Description |
|----------|-------------|
| [All 200 engines (EN)](./docs/reference/engines-en.md) | Complete engine reference |
| [**ğŸ”¬ Expert Deep Dive (EN)**](./docs/reference/engines-expert-deep-dive-en.md) | **PhD-level mathematical foundations** |
| [Engine Categories](./docs/reference/engines/) | Detailed per-category documentation |

</details>

> [!IMPORTANT]
> ### ğŸ“– Full Technical Disclosure
> 
> **[engines-expert-deep-dive-en.md](./docs/reference/engines-expert-deep-dive-en.md)** â€” PhD-level documentation with mathematical foundations, honest limitations, and engineering adaptations.

---

This document provides a comprehensive technical overview of SENTINEL's architecture.

---

<details>
<summary><h2>ğŸ“Š Benchmark Results</h2></summary>

<p align="center">
  <strong>Prompt Injection Detection Performance</strong>
</p>

### ğŸ¯ Detection Accuracy

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PROMPT INJECTION DETECTION                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚  Hybrid Ensemble    â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  85.1% Recall â­ BEST      â”‚
â”‚  Semantic Detector  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘  84.2% Recall              â”‚
â”‚  Injection Engine   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  36.4% Recall              â”‚
â”‚  Voice Jailbreak    â–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘   2.7% Recall              â”‚
â”‚                                                                          â”‚
â”‚  Dataset: 1,815 samples from 3 HuggingFace datasets                     â”‚
â”‚  True Positives: 1,026 / 1,206 attacks detected                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ“ˆ Improvement Timeline

```
Development Stage              Recall    True Positives
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Baseline (regex only)           4.5%              9 TP
+ Pattern Expansion            38.5%            337 TP
+ Semantic Detector            64.2%            774 TP
+ Attack Prototypes (100+)     72.3%            872 TP
+ Threshold Optimization       79.1%            954 TP
â˜… Final Hybrid Ensemble        85.1%          1,026 TP  â† Current
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                             +1,791% improvement!
```

### ğŸ”¬ Detection Architecture

```mermaid
flowchart LR
    subgraph Input
        A[User Prompt]
    end
    
    subgraph Detection["113 DETECTION ENGINES"]
        B[InjectionEngine<br/>Regex Patterns]
        C[SemanticDetector<br/>100+ Prototypes]
        D[VoiceJailbreak<br/>Phonetic Analysis]
    end
    
    subgraph Ensemble["Hybrid Ensemble"]
        E{OR Logic}
        F[Max Score]
    end
    
    subgraph Output
        G[Risk Score<br/>0.0 - 1.0]
        H{Decision}
        I[âœ… SAFE]
        J[ğŸš« BLOCKED]
    end
    
    A --> B & C & D
    B --> E
    C --> E
    D --> E
    E --> F --> G --> H
    H -->|score < 0.7| I
    H -->|score â‰¥ 0.7| J
    
    style C fill:#4CAF50,color:#fff
    style E fill:#2196F3,color:#fff
    style J fill:#f44336,color:#fff
```

### ğŸ“‹ Detailed Results

| Engine | Recall | Precision | F1 | TP | FP | FN |
|--------|--------|-----------|-----|-----|-----|-----|
| **Hybrid** | **85.1%** | 84.4% | **84.7%** | 1,026 | 190 | 180 |
| Semantic | 84.2% | 84.3% | 84.3% | 1,016 | 189 | 190 |
| Injection | 36.4% | 96.7% | 52.9% | 439 | 15 | 767 |
| Voice | 2.7% | 86.5% | 5.1% | 32 | 5 | 1,174 |

> ğŸ“ **Full results:** [`benchmarks/BENCHMARK_REPORT.md`](./benchmarks/BENCHMARK_REPORT.md)  
> ğŸ“Š **Interactive charts:** Download [`dashboard.html`](./benchmarks/charts/dashboard.html) and open in browser

### ğŸš€ Run Benchmark

```bash
# Install dependencies
pip install -r requirements.txt

# Run full benchmark (requires sentence-transformers)
python benchmarks/benchmark_eval.py

# Generate charts
python benchmarks/benchmark_charts.py   # PNG (matplotlib)
python benchmarks/benchmark_plotly.py   # HTML (interactive)
```

</details>

---

## Architecture Overview

### System Design Principles

SENTINEL follows a **microservices architecture** with clear separation of concerns:

<p align="center">
  <img src="./assets/architecture.png" alt="SENTINEL Architecture - 200 Detection Engines" width="800">
</p>

<details>
<summary><strong>ğŸ“Š Detailed Architecture Diagram (Mermaid)</strong></summary>

```mermaid
flowchart TB
    subgraph Clients["CLIENTS"]
        Web["ğŸŒ Web UI"]
        API["ğŸ”Œ REST API"]
        Agents["ğŸ¤– AI Agents"]
    end

    subgraph Gateway["GATEWAY (Go 1.21+ / Fiber)"]
        HTTP["HTTP Router"]
        Auth["Auth: JWT + mTLS"]
        PoW["PoW Anti-DDoS"]
        RateLimit["Rate Limiting"]
    end

    subgraph Brain["BRAIN (Python 3.11+)"]
        subgraph Innovations["ğŸš€ 10 INNOVATIONS"]
            I1["Shapeshifter"]
            I2["Semantic Tide"]
            I3["Cognitive Mirror"]
        end
        subgraph Engines["200 DETECTION ENGINES"]
            subgraph Classic["Classic Detection (9)"]
                C1["injection"]
                C2["yara_engine"]
                C3["behavioral"]
                C4["pii"]
                C5["query"]
                C6["streaming"]
                C7["delayed_trigger"]
                C8["cascading_guard"]
                C9["ensemble"]
            end

            subgraph NLP["NLP / LLM Guard (7)"]
                N1["language"]
                N2["prompt_guard"]
                N3["qwen_guard"]
                N4["knowledge"]
                N5["hallucination"]
                N6["semantic_detector"]
                N7["semantic_firewall"]
            end

            subgraph StrangeMathCore["Strange Math Core (9)"]
                SM1["tda_enhanced"]
                SM2["sheaf_coherence"]
                SM3["hyperbolic_geometry"]
                SM4["hyperbolic_detector"]
                SM5["information_geometry"]
                SM6["spectral_graph"]
                SM7["math_oracle"]
                SM8["morse_theory"]
                SM9["optimal_transport"]
            end

            subgraph StrangeMathExt["Strange Math Extended (11)"]
                SME1["category_theory"]
                SME2["chaos_theory"]
                SME3["differential_geometry"]
                SME4["geometric"]
                SME5["statistical_mechanics"]
                SME6["info_theory"]
                SME7["persistent_laplacian"]
                SME8["fractal"]
                SME9["wavelet"]
                SME10["semantic_isomorphism"]
                SME11["structural_immunity"]
            end

            subgraph VLM["VLM Protection (3)"]
                V1["visual_content"]
                V2["cross_modal"]
                V3["adversarial_image"]
            end

            subgraph TTPs["TTPs.ai Defense (14)"]
                T1["rag_guard"]
                T2["probing_detection"]
                T3["session_memory_guard"]
                T4["tool_call_security"]
                T5["ai_c2_detection"]
                T6["attack_staging"]
                T7["agentic_monitor"]
                T8["ape_signatures"]
                T9["cognitive_load_attack"]
                T10["context_window_poisoning"]
                T11["bootstrap_poisoning"]
                T12["temporal_poisoning"]
                T13["multi_tenant_bleed"]
                T14["synthetic_memory_injection"]
            end

            subgraph Protocol["Protocol Security (5)"]
                PR1["mcp_a2a_security"]
                PR2["model_context_protocol_guard"]
                PR3["agent_card_validator"]
                PR4["nhi_identity_guard"]
                PR5["endpoint_analyzer"]
            end

            subgraph Adv2025["Advanced 2025 (8)"]
                A1["attack_2025"]
                A2["adversarial_resistance"]
                A3["multi_agent_safety"]
                A4["institutional_ai"]
                A5["reward_hacking_detector"]
                A6["agent_collusion_detector"]
                A7["agent_anomaly"]
                A8["voice_jailbreak"]
            end

            subgraph Proactive["Proactive Defense (12)"]
                P1["proactive_defense"]
                P2["attack_synthesizer"]
                P3["vulnerability_hunter"]
                P4["causal_attack_model"]
                P5["zero_day_forge"]
                P6["attack_evolution_predictor"]
                P7["threat_landscape_modeler"]
                P8["immunity_compiler"]
                P9["adversarial_self_play"]
                P10["honeypot_responses"]
                P11["canary_tokens"]
                P12["kill_chain_simulation"]
            end

            subgraph DeepLearning["Deep Learning (9)"]
                DL1["activation_steering"]
                DL2["hidden_state_forensics"]
                DL3["homomorphic_engine"]
                DL4["llm_fingerprinting"]
                DL5["learning"]
                DL6["gradient_detection"]
                DL7["formal_verification"]
                DL8["formal_invariants"]
                DL9["runtime_guardrails"]
            end

            subgraph Meta["Meta & Analytics (6)"]
                M1["meta_judge"]
                M2["xai"]
                M3["intelligence"]
                M4["intent_prediction"]
                M5["attacker_fingerprinting"]
                M6["fingerprint_store"]
            end

            subgraph Compliance["Compliance (2)"]
                CO1["compliance_engine"]
                CO2["mitre_engine"]
            end

            subgraph NewEngines["New 2025 (1) ğŸ†•"]
                NEW1["virtual_context"]
            end
        end


        subgraph Hive["HIVE INTELLIGENCE"]
            Hunter["ğŸ¯ Threat Hunter"]
            Watchdog["ğŸ›¡ï¸ Watchdog"]
            QRNG["ğŸ² Quantum RNG"]
            PQC["ğŸ” PQC Crypto"]
        end
    end

    subgraph External["EXTERNAL SERVICES"]
        LLM["ğŸ§  LLM Providers\nOpenAI / Gemini / Claude"]
        Storage["ğŸ’¾ Storage\nRedis / Postgres / ChromaDB"]
    end

    Clients --> Gateway
    Gateway -->|"gRPC + mTLS"| Brain
    Brain --> External

    style Engines fill:#1a1a2e,stroke:#16213e,color:#eee
    style Hive fill:#0f3460,stroke:#16213e,color:#eee
    style Gateway fill:#16213e,stroke:#0f3460,color:#eee
```

</details>

### Technology Choices

| Component     | Technology       | Rationale                                                  |
| ------------- | ---------------- | ---------------------------------------------------------- |
| **Gateway**   | Go 1.21+ / Fiber | 1000+ req/sec, <5ms latency, goroutines for concurrency    |
| **Brain**     | Python 3.11+     | Full ML ecosystem: Transformers, Scikit-learn, Gudhi, CuPy |
| **IPC**       | gRPC + Protobuf  | 10x faster than REST, strict typing, built-in mTLS         |
| **Vector DB** | ChromaDB         | Semantic search for similar attack patterns                |
| **Cache**     | Redis            | Session state, rate limiting, behavioral profiles          |
| **Secrets**   | HashiCorp Vault  | Zero-trust secret management                               |

### 200 DETECTION ENGINES â€” Industry's Most Comprehensive Suite

| Category                     | Count | Purpose                                   |
| ---------------------------- | ----- | ----------------------------------------- |
| ğŸ›¡ï¸ **Classic Detection**     | 9     | Injection, YARA, behavioral, cascading    |
| ğŸ“ **NLP / LLM Guard**       | 7     | Language, hallucination, Qwen, semantic   |
| ğŸ”¬ **Strange Math Core**     | 9     | TDA, Sheaf, Hyperbolic, Morse, Transport  |
| ğŸ§® **Strange Math Extended** | 11    | Category, Chaos, Laplacian, Fractal       |
| ğŸ–¼ï¸ **VLM Protection**        | 3     | Visual attacks, cross-modal, adversarial  |
| âš”ï¸ **TTPs.ai Defense**       | 14    | RAG, probing, C2, poisoning, memory       |
| ğŸ” **Protocol Security**     | 5     | MCP, A2A, agent cards, NHI identity       |
| ğŸš€ **Advanced 2025**         | 8     | Multi-agent, reward hacking, collusion    |
| ğŸ¯ **Proactive Engines**     | 12    | Honeypots, kill chain, attack synthesis   |
| ğŸ§  **Deep Learning**         | 9     | Activation, forensics, gradient, formal   |
| âš–ï¸ **Meta & Analytics**      | 6     | Meta-Judge, XAI, fingerprinting, intent   |
| âœ… **Compliance**            | 2     | MITRE mapping, compliance checks          |
| ğŸ§¬ **R&D Inventions**        | 56    | Sprints 1-14: Memory Shield, CoT Guard, Rule DSL |
|                              | **200**| **~80,000 LOC total**                     |

> ğŸ“š **Full details:** [engines-expert-deep-dive-en.md](./docs/reference/engines-expert-deep-dive-en.md) â€” PhD-level documentation

---

<details>
<summary><h2>ğŸ”® Strange Math Engines</h2></summary>

> _Strange Math is SENTINEL's unique competitive advantage â€” applying cutting-edge mathematical techniques from 2024-2025 research papers to detect attacks that classical methods miss._

<details>
<summary><code>ğŸ“ 1. TDA Enhanced (Topological Data Analysis)</code></summary>

**File:** `brain/engines/tda_enhanced.py` (~650 LOC)

**Theory:** Persistent Homology analyzes the "shape" of data by tracking topological features (connected components, loops, voids) across multiple scales.

**Mathematical Foundation:**

Given a point cloud X in embedding space, we build a Vietoris-Rips complex:

```
VR_Îµ(X) = {Ïƒ âŠ† X : d(x,y) â‰¤ Îµ for all x,y âˆˆ Ïƒ}
```

The persistence diagram tracks birth/death of topological features:

```
Betti numbers: Î²â‚€ (components), Î²â‚ (loops), Î²â‚‚ (voids)

Bottleneck Distance: d_B(Dgmâ‚, Dgmâ‚‚) = inf_Î³ sup_x ||x - Î³(x)||_âˆ
```

**Attack Detection:**

- **Jailbreaks** create characteristic "holes" in persistence diagrams
- **Injection attacks** fragment the point cloud into disconnected components
- Normal prompts form a single, connected topological structure

**Implementation:**

```python
from gudhi import RipsComplex
from gudhi.wasserstein import wasserstein_distance

def analyze_topology(embeddings: np.ndarray) -> TopologyResult:
    rips = RipsComplex(points=embeddings, max_edge_length=2.0)
    simplex_tree = rips.create_simplex_tree(max_dimension=2)
    persistence = simplex_tree.persistence()

    # Extract Betti numbers
    betti_0 = len([p for p in persistence if p[0] == 0])
    betti_1 = len([p for p in persistence if p[0] == 1])

    # Compare with baseline
    anomaly_score = wasserstein_distance(persistence, baseline_persistence)
    return TopologyResult(betti_0, betti_1, anomaly_score)
```

</details>

---

<details>
<summary><code>ğŸŒ 2. Sheaf Coherence</code></summary>

**File:** `brain/engines/sheaf_coherence.py` (~530 LOC)

**Theory:** Sheaf theory provides a framework for analyzing local-to-global consistency.

**Key Formula:** `F(U) â†’ âˆáµ¢ F(Uáµ¢) â‡‰ âˆáµ¢â±¼ F(Uáµ¢ âˆ© Uâ±¼)`

**Attack Detection:** Multi-turn jailbreaks, Crescendo attacks, Contradiction injection.

</details>

---

<details>
<summary><code>ğŸŒ€ 3. Hyperbolic Geometry</code></summary>

**File:** `brain/engines/hyperbolic_geometry.py` (~580 LOC)

**Theory:** Hyperbolic space (PoincarÃ© ball model) is exponentially better for representing hierarchical structures.

**Key Formula:** `d(x,y) = arcosh(1 + 2||x-y||Â² / ((1-||x||Â²)(1-||y||Â²)))`

**Attack Detection:** Role confusion, Privilege escalation, System prompt extraction.

</details>

---

<details>
<summary><code>ğŸ“Š 4. Information Geometry</code></summary>

**File:** `brain/engines/information_geometry.py` (~550 LOC)

**Theory:** Treats probability distributions as points on a Riemannian manifold with Fisher Information Matrix as metric.

**Key Formula:** `d_FR(p,q) = 2 arccos(âˆ«âˆš(p(x)Â·q(x)) dx)`

**Attack Detection:** Distribution drift, Out-of-distribution prompts, Adversarial perturbations.

</details>

---

<details>
<summary><code>ğŸ”— 5. Spectral Graph Analysis</code></summary>

**File:** `brain/engines/spectral_graph.py` (~520 LOC)

**Theory:** Analyzes graphs through eigenvalues of the Laplacian matrix.

**Key Formula:** `L = D - A` (Laplacian = Degree - Adjacency)

**Attack Detection:** Attention pattern analysis, Spectral clustering, Fiedler vector bisection.

</details>

---

<details>
<summary><code>ğŸ§® 6. Math Oracle (DeepSeek-V3.2-Speciale)</code></summary>

**File:** `brain/engines/math_oracle.py` (~600 LOC)

**Theory:** Formal verification of detector formulas using a specialized mathematical LLM.

**Modes:** MOCK (testing) | API (production) | LOCAL (air-gapped)

</details>

---

</details>

---

<details>
<summary><h2>ğŸ–¼ï¸ VLM Protection Engines (NEW)</h2></summary>

Protection against Vision-Language Model Multi-Faceted Attacks (arXiv 2024-2025).

**The Problem:** Modern VLMs accept images alongside text. Attackers hide malicious instructions in images.

**Engines:** Visual Content Analyzer | Cross-Modal Consistency | Adversarial Image Detector

<details>
<summary><strong>7. Visual Content Analyzer</strong></summary>

**File:** `brain/engines/visual_content.py` (~450 LOC)

**Purpose:** Detects text instructions hidden in images via OCR, steganography, metadata.

**Methods:** OCR Extraction | LSB Steganography | EXIF Metadata | Font Detection

</details>

---

<details>
<summary><strong>8. Cross-Modal Consistency</strong></summary>

**File:** `brain/engines/cross_modal.py` (~400 LOC)

**Purpose:** Detects mismatch between text and image intent (CLIP score < 0.3 = suspicious).

**Methods:** CLIP Score | Intent Mismatch | Combination Score

</details>

---

<details>
<summary><strong>9. Adversarial Image Detector</strong></summary>

**File:** `brain/engines/adversarial_image.py` (~500 LOC)

**Purpose:** Detects adversarial perturbations (FGSM, PGD) via FFT analysis.

**Formula:** `x_adv = x + Îµ Ã— sign(âˆ‡_x L(x, y))`

**Methods:** FFT Analysis | Gradient Norm | JPEG Compression | Patch Detection

</details>

---

</details>

---

<details>
<summary><h2>âš”ï¸ TTPs.ai Defense Engines (NEW)</h2></summary>

Protection against AI Agent attacks based on [TTPs.ai](https://atlas.mitre.org/matrices/ATLAS) and NVIDIA AI Kill Chain.

**Engines:** RAG Guard | Probing Detection | Session Memory Guard | Tool Security | AI C2 | Attack Staging

<details>
<summary><strong>10. RAG Guard</strong></summary>

**File:** `brain/engines/rag_guard.py` (~500 LOC)

**Purpose:** Detects document poisoning in RAG pipelines.

**Methods:** Document Validator | Query Consistency | Poison Patterns | Source Trust

</details>

---

<details>
<summary><strong>11. Probing Detection</strong></summary>

**File:** `brain/engines/probing_detection.py` (~550 LOC)

**Purpose:** Detects reconnaissance patterns (system prompt probing, guardrail testing).

**Formula:** `Score = Î£ (probe_weight Ã— recency_factor)`

</details>

---

<details>
<summary><strong>12. Session Memory Guard</strong></summary>

**File:** `brain/engines/session_memory_guard.py` (~450 LOC)

**Purpose:** Detects persistence patterns (seed injection, context mimicry, memory poisoning).

**Patterns:** `from now on`, `always remember`, `your new rule`, `pretend this conversation`

</details>

---

<details>
<summary><strong>13. Tool Call Security</strong></summary>

**File:** `brain/engines/tool_call_security.py` (~480 LOC)

**Purpose:** Protects tool access (code exec, file system, network) from abuse.

**Layers:** Allowlist Validation | Parameter Sanitization | Privilege Escalation Detection

</details>

---

<details>
<summary><strong>14. AI C2 Detection</strong></summary>

**File:** `brain/engines/ai_c2_detection.py` (~400 LOC)

**Purpose:** Detects AI systems used as covert C2 channels (commands in queries, encoded results).

**Patterns:** Base64, Hex encoding, DGA domains, ngrok/webhook beacons

</details>

---

<details>
<summary><strong>15. Attack Staging Detection</strong></summary>

**File:** `brain/engines/attack_staging.py` (~420 LOC)

**Purpose:** Detects multi-stage attacks (setup â†’ prime â†’ payload â†’ extract).

**Methods:** Stage State Machine | Progression Score | Semantic Similarity

</details>

---

</details>

---

<details>
<summary><h2>ğŸ“‹ APE Signature Database</h2></summary>

**File:** `brain/engines/ape_signatures.py` (~300 LOC)

**Purpose:** Comprehensive database of AI Prompt Exploitation techniques (HiddenLayer APE Taxonomy).

**Coverage:** 15 techniques | 7 tactics | 100+ patterns

</details>

---

<details>
<summary><h2>ğŸ” Protocol Security Engines (NEW)</h2></summary>

Protection for AI agent communication protocols (MCP, A2A, Agent Cards).

**Engines:** mcp_a2a_security | model_context_protocol_guard | agent_card_validator | nhi_identity_guard

</details>

---

<details>
<summary><h2>â˜ ï¸ Data Poisoning Detection (NEW)</h2></summary>

Detection of gradual data contamination attacks.

**Engines:** bootstrap_poisoning | temporal_poisoning | multi_tenant_bleed | synthetic_memory_injection

</details>

---

<details>
<summary><h2>ğŸš€ Proactive Defense Engine (NEW)</h2></summary>

Zero-day attack detection through physics-inspired anomaly analysis.

**File:** `brain/engines/proactive_defense.py` (~550 LOC)

**Principles:** Shannon Entropy | 2nd Law of Thermodynamics | Free Energy Principle | Boltzmann Distribution

**Components:** EntropyAnalyzer | InvariantChecker | ThermodynamicAnalyzer | ReputationManager

**Response Tiers:** ALLOW (< 0.3) â†’ LOG (0.3-0.5) â†’ WARN (0.5-0.7) â†’ CHALLENGE (0.7-0.9) â†’ BLOCK (> 0.9)

</details>

---

<details>
<summary><h2>ğŸ”¬ Advanced Research Engines (NEW)</h2></summary>

Deception technology, predictive security, and formal methods.

**Engines:** Honeypot Responses | Canary Tokens | Intent Prediction | Kill Chain Simulation | Runtime Guardrails | Formal Invariants

### Tier 1: Deception Technology

#### 17. Honeypot Responses (#46)

**File:** `brain/engines/honeypot_responses.py` (~400 LOC)

**Theory:** Deception-based defense embeds fake, trackable credentials into LLM responses. When an attacker extracts and uses these credentials, we get immediate alert.

**How It Works:**

```
User: "Show me the database config"
LLM Response (modified):
  host: db.internal.trap     â† honeypot
  password: TRAP-x7k2m9      â† tracked credential

If attacker uses TRAP-x7k2m9 anywhere â†’ INSTANT ALERT
```

**Why This Matters:** Unlike detection (reactive), honeypots are proactive â€” they let attackers "succeed" but immediately expose them. Used by governments and banks for 20+ years.

**Components:**

- **HoneypotGenerator**: Creates realistic-looking credentials (API keys, passwords, database URLs)
- **HoneypotInjector**: Smartly places honeypots in responses based on context
- **AlertManager**: Monitors for honeypot usage across all incoming requests

---

#### 18. Canary Tokens (#47)

**File:** `brain/engines/canary_tokens.py` (~380 LOC)

**Theory:** Invisible watermarking using zero-width Unicode characters. Every response is marked with hidden metadata that survives copy-paste.

**Mathematical Foundation:**

Binary data is encoded into zero-width characters:

```
'00' â†’ U+200B (Zero-Width Space)
'01' â†’ U+200C (Zero-Width Non-Joiner)
'10' â†’ U+200D (Zero-Width Joiner)
'11' â†’ U+2060 (Word Joiner)

Payload = JSON(user_id, session_id, timestamp)
Encoded = encode_binary_to_zerowidth(Payload)
```

**Invisibility Property:** Zero-width characters have no visual representation but persist through:

- Copy/paste operations
- Text reformatting
- Most text processing

**Use Case:**

```
Data leaked to internet â†’ Extract zero-width chars â†’ Decode JSON
â†’ "Leaked by user_id=123 at 2024-12-10T00:30:00"
```

---

#### 19. Adversarial Self-Play (#48)

**File:** `brain/engines/adversarial_self_play.py` (~450 LOC)

**Theory:** Inspired by DeepMind's AlphaGo/AlphaZero, this engine pits a Red Team AI against our defenses in an evolutionary loop.

**Algorithm:**

```
Generation 0:
  - Red generates 10 random attacks
  - Blue evaluates each attack
  - Calculate fitness = bypass_score

Generation N:
  - Select top 50% by fitness (survivors)
  - Mutate survivors (add prefix, change case, encode...)
  - Evaluate new population
  - Repeat

After K generations:
  - Best attacks reveal defense weaknesses
  - Generate improvement suggestions
```

**Mutation Operators:**

| Operator          | Example                | Purpose           |
| ----------------- | ---------------------- | ----------------- |
| `add_prefix`      | "Please " + attack     | Politeness bypass |
| `unicode_replace` | 'a' â†’ 'Ğ°' (Cyrillic)   | Visual spoofing   |
| `case_change`     | "IGNORE" â†’ "iGnOrE"    | Regex evasion     |
| `insert_noise`    | "ignore also previous" | Pattern breaking  |

**Output:** List of successful bypass attacks + improvement suggestions for each vulnerability found.

---

### Tier 2: Predictive Security

#### 20. Intent Prediction (#49)

**File:** `brain/engines/intent_prediction.py` (~420 LOC)

**Theory:** Models conversation as a Markov chain to predict attack probability before the attack completes.

**Mathematical Foundation:**

States: {BENIGN, CURIOUS, PROBING, TESTING, ATTACKING, JAILBREAKING, EXFILTRATING}

Transition Matrix P where P[i,j] = P(next_state = j | current_state = i):

```
          BENIGN  CURIOUS  PROBING  TESTING  ATTACKING
BENIGN    [0.85    0.10     0.04     0.01     0.00   ]
CURIOUS   [0.50    0.30     0.15     0.05     0.00   ]
PROBING   [0.20    0.20     0.30     0.20     0.10   ]
TESTING   [0.10    0.00     0.20     0.30     0.25   ]
ATTACKING [0.00    0.00     0.10     0.00     0.40   ]
```

**Attack Probability Calculation:**

Forward simulation through Markov chain:

```
P(attack within k steps) = Î£áµ¢ P(reach attack state i at step â‰¤ k)

Using Chapman-Kolmogorov:
P^(k) = P Ã— P Ã— ... Ã— P (k times)
```

**Trajectory Analysis:**

Detects escalation patterns:

```
[CURIOUS â†’ PROBING â†’ TESTING] â†’ Escalation Score = 0.7
[PROBING â†’ TESTING â†’ ATTACKING] â†’ Escalation Score = 1.0
```

**Early Warning:** Block predicted attacks BEFORE final payload delivers.

---

#### 21. Kill Chain Simulation (#50)

**File:** `brain/engines/kill_chain_simulation.py` (~400 LOC)

**Theory:** Virtually "plays out" an attack to its conclusion, estimating potential damage. Based on NVIDIA AI Kill Chain (Recon â†’ Poison â†’ Hijack â†’ Persist â†’ Impact).

**Impact Assessment:**

For each attack scenario, we simulate:

```python
for stage in kill_chain:
    success_prob = stage.base_probability Ã— (1 - defense_effectiveness)
    cumulative_prob *= success_prob

    if stage.succeeds:
        for impact in stage.potential_impacts:
            risk_score += impact.severity Ã— cumulative_prob
```

**Impact Types:**

| Type                 | Severity | Description                       |
| -------------------- | -------- | --------------------------------- |
| DATA_LEAK            | 0.9      | Confidential data exfiltrated     |
| PRIVILEGE_ESCALATION | 0.95     | Attacker gains higher permissions |
| SERVICE_DISRUPTION   | 0.6      | System availability impacted      |
| COMPLIANCE_VIOLATION | 0.8      | Regulatory requirements breached  |
| FINANCIAL_LOSS       | 0.85     | Direct monetary damage            |

**Use Case:** Prioritize which attacks to block first based on actual potential damage, not just detection confidence.

---

#### 22. Runtime Guardrails (#51)

**File:** `brain/engines/runtime_guardrails.py` (~380 LOC)

**Theory:** Monitor execution behavior, not just input text. Attacks that pass input filters may reveal themselves during execution.

**Event Types Monitored:**

| Event           | Examples               | Detection Logic                 |
| --------------- | ---------------------- | ------------------------------- |
| API_CALL        | OpenAI, external APIs  | Rate limiting, unexpected calls |
| FILE_ACCESS     | /etc/passwd, .env      | Sensitive path patterns         |
| NETWORK_REQUEST | ngrok.io, IP addresses | C2 indicators                   |
| TOOL_INVOCATION | exec, shell, rm        | Dangerous operations            |

**Rule Engine:**

```python
class SuspiciousURLRule:
    patterns = [r"ngrok\.io", r"\d+\.\d+\.\d+\.\d+", r"\.tk$"]

    def check(event, history):
        if any(p.match(event.target) for p in patterns):
            return Alert(severity=HIGH, should_block=True)
```

**Timing Analysis:**

```
Interval < 10ms â†’ Too fast (automated attack)
Interval > 30s  â†’ Long pause (human reviewing results)
```

---

### Tier 3: Mathematical Foundations

#### 23. Information Geometry (#52)

**File:** `brain/engines/information_geometry.py` (~350 LOC)

**Theory:** Treats probability distributions as points on a Riemannian manifold. The Fisher-Rao metric provides a natural distance measure that is invariant under reparametrization.

**Mathematical Foundation:**

**Fisher Information Matrix:**

```
g_ij(Î¸) = E[(âˆ‚/âˆ‚Î¸áµ¢ log p(x|Î¸))(âˆ‚/âˆ‚Î¸â±¼ log p(x|Î¸))]
```

This is the metric tensor on the statistical manifold.

**Fisher-Rao Distance:**

```
d_FR(p, q) = 2 Ã— arccos(BC(p, q))

where BC(p, q) = Î£áµ¢ âˆš(páµ¢ Ã— qáµ¢)  (Bhattacharyya coefficient)
```

**Why Fisher-Rao?**

1. **Unique invariance**: Only Riemannian metric invariant under sufficient statistics
2. **Information-theoretic meaning**: Measures distinguishability of distributions
3. **Geodesic distance**: True "shortest path" on probability space

**Manifold Regions:**

```
d_FR â‰¤ 1.0  â†’ SAFE (normal text)
d_FR â‰¤ 1.5  â†’ BOUNDARY (unusual but not attack)
d_FR â‰¤ 2.0  â†’ SUSPICIOUS (likely attack)
d_FR > 2.0  â†’ ATTACK (high confidence)
```

**Implementation:**

1. Convert text to character distribution (categorical probability)
2. Compare with baseline English distribution
3. Calculate Fisher-Rao distance
4. Classify by manifold region

---

#### 24. Formal Invariants (#53)

**File:** `brain/engines/formal_invariants.py` (~320 LOC)

**Theory:** Define mathematical properties that must ALWAYS hold. Violations indicate security issues with certainty, not probability.

**Key Invariants:**

**1. No PII Leak Invariant:**

```
âˆ€ pii âˆˆ Output: pii âˆˆ Input

"PII in output must exist in input"
â†’ Prevents hallucinated/leaked personal data
```

**2. No System Prompt Leak Invariant:**

```
âˆ€ seq âˆˆ (5-grams of Output): seq âˆ‰ SystemPrompt

"No 5-word sequence from system prompt appears in output"
â†’ Prevents prompt extraction
```

**3. Output Length Bound:**

```
|Output| / |Input| â‰¤ 50

"Output cannot be more than 50x input length"
â†’ Prevents infinite generation exploits
```

**4. Role Consistency:**

```
âˆ€ msg âˆˆ Messages:
  if msg.role = "user": "I am assistant" âˆ‰ msg.content
  if msg.role = "assistant": "I am user" âˆ‰ msg.content

"Roles cannot claim to be other roles"
â†’ Prevents role confusion attacks
```

**Why Formal Methods?**

Traditional detection: P(attack) = 0.95 (5% false negatives)
Formal invariants: P(attack | invariant violated) = 1.0 (mathematical certainty)

---

#### 25. Gradient Detection (#54)

**File:** `brain/engines/gradient_detection.py` (~280 LOC)

**Theory:** Adversarial attacks often create anomalous gradient patterns during model inference. By analyzing gradient-like features, we can detect attacks that look normal as text.

**Gradient Features (Text Proxies):**

Since we don't have direct model access, we use statistical proxies:

| Feature  | Formula                | Normal Range |
| -------- | ---------------------- | ------------ |
| Norm     | L2(char_values) / len  | 0.5-3.0      |
| Variance | Ïƒ(char_values)         | < 2.0        |
| Sparsity | uncommon_chars / total | < 0.7        |
| Entropy  | -Î£ p log p             | 3.0-5.0      |

**Anomaly Detection:**

```
Adversarial perturbations often:
- Use Unicode lookalikes (high sparsity)
- Have unusual character distributions (high variance)
- Encode payloads (gradient masking patterns)
```

**Perturbation Patterns:**

| Pattern             | Indicator             | Example          |
| ------------------- | --------------------- | ---------------- |
| Cyrillic lookalikes | Ğ°, Ğµ, Ğ¾ (not a, e, o) | Homolyph attacks |
| Zero-width          | U+200B, U+200C        | Hidden text      |
| Base64              | [A-Za-z0-9+/]{20,}=   | Encoded payloads |
| Hex                 | 0x[0-9a-f]{16,}       | Binary encoding  |

---

#### 26. Compliance Engine (#55)

**File:** `brain/engines/compliance_engine.py` (~350 LOC)

**Theory:** Maps security detections to regulatory requirements for automatic audit trail generation.

**Supported Frameworks:**

| Framework          | Coverage                     | Key Controls                                 |
| ------------------ | ---------------------------- | -------------------------------------------- |
| **EU AI Act**      | Articles 9, 10, 15           | Risk management, data governance, robustness |
| **NIST AI RMF**    | GOVERN, MAP, MEASURE, MANAGE | Full lifecycle coverage                      |
| **ISO 42001:2023** | Clauses 6.1, 8.2, 8.4        | AI risk, data, security                      |
| **SOC 2 Type II**  | CC6, CC7                     | Logical access, system operations            |

**Control Mapping:**

```python
Detection: "Prompt injection blocked"

â†’ EU AI Act Article 15: "Resilience against manipulation"
â†’ NIST AI RMF MEASURE 2.6: "AI systems tested for adversarial attacks"
â†’ ISO 42001 8.4: "Security controls for AI systems"
```

**Report Generation:**

Automatic audit reports include:

- Event timeline (detections, blocks, alerts)
- Control coverage percentage
- Risk level assessment (EU AI Act: Minimal/Limited/High/Unacceptable)
- Evidence for compliance auditors


</details>

---

<details>
<summary><h2>âš–ï¸ Meta-Judge Engine (NEW)</h2></summary>

The "Judge over all" â€” central arbiter that aggregates all 58 detectors.

### 27. Meta-Judge (#56)

**File:** `brain/engines/meta_judge.py` (~700 LOC)

**The Problem:** 58 engines produce 58 verdicts. Which one is right?

```
Engine #1:  BLOCK (0.8)
Engine #2:  ALLOW (0.2)
Engine #15: WARN  (0.5)
...
Engine #58: BLOCK (0.9)

â†’ Final verdict = ???
```

**Architecture:**

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚         Meta-Judge           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â–²
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚                      â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ClassicJudge  â”‚    â”‚  MathJudge    â”‚    â”‚ ResearchJudge â”‚
â”‚ (engines 1-5) â”‚    â”‚ (engines 6-11)â”‚    â”‚(engines 27-56)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Functional Components:**

| Component                 | Function                                            |
| ------------------------- | --------------------------------------------------- |
| **Evidence Aggregator**   | Collects and deduplicates evidence from all engines |
| **Conflict Resolver**     | Bayesian update + weighted voting                   |
| **Context Integrator**    | Adjusts scores by user reputation, time, location   |
| **Explainability Engine** | Generates human-readable justifications             |
| **Appeal Handler**        | Manages user appeals with verification              |
| **Policy Engine**         | Business rules (thresholds by tier)                 |
| **Health Monitor**        | Engine latency and error tracking                   |

**Conflict Resolution Algorithm:**

```python
def resolve(verdicts: List[Verdict]) -> FinalVerdict:
    # 1. Critical Veto
    if any(v.severity == CRITICAL):
        return BLOCK  # No appeal possible

    # 2. Bayesian Update
    prior = 0.01  # Base attack probability

    for verdict in verdicts:
        likelihood_ratio = verdict.block_score / verdict.allow_score
        posterior = (prior * likelihood_ratio) /
                   (prior * likelihood_ratio + (1 - prior))

    # 3. Threshold Decision
    if posterior > 0.7: return BLOCK
    if posterior > 0.5: return CHALLENGE
    if posterior > 0.4: return WARN
    return ALLOW
```

**Context Modifiers:**

| Context             | Score Adjustment |
| ------------------- | ---------------- |
| New user            | +0.15            |
| Low reputation      | +0.20            |
| High request rate   | +0.15            |
| Night time (2-6 AM) | +0.10            |
| VPN detected        | +0.10            |
| Tor exit node       | +0.25            |

**Policy Tiers:**

| Tier              | Block Threshold | Appeal    | Use Case       |
| ----------------- | --------------- | --------- | -------------- |
| **Demo**          | 0.9             | No        | Testing        |
| **Standard**      | 0.7             | Limited   | Default        |
| **Professional**  | 0.75            | Yes       | Production     |
| **High Security** | 0.5             | Yes + MFA | Sensitive data |

**Explainability Output:**

```json
{
  "verdict": "BLOCK",
  "confidence": 0.89,
  "primary_reason": "Prompt injection detected",
  "contributing_factors": [
    { "engine": "TDA Enhanced", "finding": "Topological anomaly" },
    { "engine": "Formal Invariants", "finding": "PII leak violation" },
    { "engine": "Intent Prediction", "finding": "Attack probability 78%" }
  ],
  "evidence": ["Pattern 'ignore previous' matched", "Entropy: 5.8 bits/char"],
  "appeal_token": "abc123",
  "processing_time_ms": 45.2
}
```

**Unique Capabilities:**

| Capability                   | What It Does                                         |
| ---------------------------- | ---------------------------------------------------- |
| **Cross-Engine Correlation** | Sees patterns no single engine can see               |
| **Adaptive Thresholds**      | Auto-adjusts to traffic patterns                     |
| **Campaign Detection**       | Detects coordinated attacks (many IPs, same pattern) |
| **Zero-Day Recognition**     | High Proactive + Low Signature â†’ possible zero-day   |

---

</details>

---

<details>
<summary><h2>ğŸ›¡ï¸ Defense in Depth Pipeline</h2></summary>

### Ingress Pipeline (11 Steps)

```
Request â†’ [1] Length/Encoding â†’ [2] Regex/YARA/Signatures
        â†’ [3] Semantic/Token â†’ [4] LLM Judge â†’ [5] Strange Math
        â†’ [6] Context/Behavioral â†’ [7] Privacy Guard â†’ [8] Ensemble â†’ Verdict
```

| Step | Engine(s)                | Latency | Purpose                           |
| ---- | ------------------------ | ------- | --------------------------------- |
| 1    | Length, Encoding         | <1ms    | Buffer overflow, encoding attacks |
| 2    | Regex, YARA, Signatures  | <5ms    | Known attack patterns             |
| 3    | Semantic, Token          | ~10ms   | NLP structure analysis            |
| 4    | LLM Judge                | ~50ms   | Guard model verdict               |
| 5    | Strange Math             | ~30ms   | Topological/geometric anomalies   |
| 6    | Context, Behavioral      | ~5ms    | Session history, user patterns    |
| 7    | Privacy Guard (Presidio) | ~10ms   | PII, secrets detection            |
| 8    | Ensemble                 | <1ms    | Weighted voting                   |

### Egress Pipeline (3 Steps)

```
LLM Response â†’ [1] Response Scanner â†’ [2] Canary Detection â†’ [3] Sanitization â†’ Client
```

| Step             | Purpose                                     |
| ---------------- | ------------------------------------------- |
| Response Scanner | Check for data leakage, harmful content     |
| Canary Detection | Detect prompt injection artifacts in output |
| Sanitization     | Mask detected PII                           |

---

</details>

---

<details>
<summary><h2>ğŸ Hive Intelligence</h2></summary>

### Threat Hunter

Autonomous AI agent for proactive threat detection:

| Mode              | Description                  | Frequency   |
| ----------------- | ---------------------------- | ----------- |
| Passive Scan      | Log analysis, pattern search | Continuous  |
| Active Probe      | Test requests to detectors   | Every 5 min |
| Deep Analysis     | ML clustering of anomalies   | Hourly      |
| Report Generation | SOC team reports             | Daily       |

**Detected Threats:**

- Slow & Low attacks (cumulative injection over time)
- Zero-day patterns (novel techniques similar to known attacks)
- Anomalous users (suspicious behavior profiles)
- Evasion attempts (detector bypass attempts)

### Watchdog Self-Healing

| Event                 | Action                | Escalation             |
| --------------------- | --------------------- | ---------------------- |
| Engine timeout        | Restart + fallback    | Alert after 3 attempts |
| High latency (>500ms) | Reduce load, scale up | Prometheus â†’ PagerDuty |
| Memory leak           | Graceful restart      | Core dump â†’ analysis   |
| Config corruption     | Rollback to last good | Git restore + notify   |

---

</details>

---

<details>
<summary><h2>ğŸ” Post-Quantum Security</h2></summary>

### Cryptographic Primitives

| Algorithm       | Standard               | Use Case              |
| --------------- | ---------------------- | --------------------- |
| **Kyber-768**   | NIST ML-KEM            | Key encapsulation     |
| **Dilithium-3** | NIST ML-DSA (FIPS 204) | Digital signatures    |
| **XMSS**        | RFC 8391               | Hash-based signatures |

### Implementation

```python
from pqcrypto.sign.dilithium3 import generate_keypair, sign, verify

def sign_update(update_bytes: bytes, private_key: bytes) -> bytes:
    signature = sign(private_key, update_bytes)
    return signature

def verify_update(update_bytes: bytes, signature: bytes, public_key: bytes) -> bool:
    try:
        verify(public_key, update_bytes, signature)
        return True
    except:
        return False
```

---

</details>

---

<details>
<summary><h2>âš¡ Performance Engineering</h2></summary>

### Benchmarks

| Metric              | Value         |
| ------------------- | ------------- |
| Latency p50         | <50ms         |
| Latency p99         | <200ms        |
| Throughput          | 1000+ req/sec |
| Detection Accuracy  | 99.7%         |
| False Positive Rate | <0.1%         |

### GPU Acceleration

Strange Math engines leverage GPU for:

- **Embedding computation**: Sentence-Transformers on CUDA
- **Topological analysis**: Gudhi + CuPy for Vietoris-Rips
- **Matrix operations**: PyTorch for spectral decomposition

```python
import cupy as cp
from cupyx.scipy import sparse as cp_sparse

def gpu_spectral_analysis(attention_matrix: np.ndarray) -> np.ndarray:
    # Transfer to GPU
    gpu_matrix = cp.asarray(attention_matrix)

    # Compute Laplacian on GPU
    degree = cp.diag(gpu_matrix.sum(axis=1))
    laplacian = degree - gpu_matrix

    # Eigendecomposition on GPU
    eigenvalues = cp.linalg.eigvalsh(laplacian)

    # Transfer back to CPU
    return cp.asnumpy(eigenvalues)
```

---

</details>

---

<details>
<summary><h2>ğŸ“š Research Foundation</h2></summary>

### Academic Sources

| Conference       | Topic                    | Application in SENTINEL                        |
| ---------------- | ------------------------ | ---------------------------------------------- |
| ICML 2025        | TDA for Deep Learning    | Zigzag Persistence, Topological Fingerprinting |
| ESSLLI 2025      | Sheaf Theory in NLP      | Local-to-global consistency                    |
| GSI 2025         | Information Geometry     | Fisher-Rao geodesic distance                   |
| AAAI 2025        | Hyperbolic ML            | PoincarÃ© embeddings for hierarchies            |
| SpGAT 2025       | Spectral Graph Attention | Graph Fourier Transform on attention           |
| arxiv:2512.02682 | Multi-Agent Safety       | ESRH Framework                                 |
| arXiv 2024-2025  | VLM Multi-Faceted Attack | Visual injection, adversarial images           |
| TTPs.ai 2025     | AI Agents Attack Matrix  | 16 tactics, RAG poisoning, C2                  |
| NVIDIA 2025      | AI Kill Chain Framework  | Reconâ†’Poisonâ†’Hijackâ†’Persistâ†’Impact             |
| HiddenLayer 2025 | APE Taxonomy             | Adversarial prompt engineering classification  |

### Competitive Advantage

> While competitors rely on regex and simple ML classifiers, SENTINEL applies mathematics that is just starting to appear in research papers. This gives **2-3 years head start** over the market.

---

## Project Metrics

| Category       | Files    | LOC         | Description                           |
| -------------- | -------- | ----------- | ------------------------------------- |
| Brain (Python) | 195      | ~29,300     | 58 detectors + Meta-Judge, Hive, gRPC |
| Gateway (Go)   | 15       | ~3,100      | HTTP gateway, Auth, Proxy, PoW        |
| Tests          | 29       | ~4,500      | Unit tests, integration tests         |
| Documentation  | 48       | ~15,000     | Architecture, Research, Security      |
| Config/Deploy  | 20+      | ~1,800      | Docker, Kubernetes, Helm              |
| **TOTAL**      | **300+** | **~54,000** | Full-stack AI Security Platform       |

### Engine Categories Breakdown

| Category               | Count  | Key Engines                                        |
| ---------------------- | ------ | -------------------------------------------------- |
| Classic Detection      | 7      | injection, yara, behavioral, pii, query            |
| NLP / LLM Guard        | 5      | language, prompt_guard, qwen_guard, hallucination  |
| Strange Math Core      | 6      | tda_enhanced, sheaf, hyperbolic, spectral_graph    |
| Strange Math Extended  | 6      | category_theory, chaos, differential_geometry      |
| VLM Protection         | 3      | visual_content, cross_modal, adversarial_image     |
| TTPs.ai Defense        | 8      | rag_guard, probing, tool_security, ai_c2, staging  |
| Advanced 2025          | 4      | attack_2025, adversarial_resistance, multi_agent   |
| Proactive Defense      | 1      | proactive_defense                                  |
| Advanced Research      | 10     | honeypot, canary, kill_chain, compliance, formal   |
| Deep Learning Analysis | 6      | activation_steering, hidden_state, llm_fingerprint |
| Meta & Explainability  | 2      | meta_judge, xai                                    |
| **Adaptive Behavioral** ğŸ†• | **2** | **attacker_fingerprinting, adaptive_markov**   |
| **TOTAL**              | **60** | **Full detection engine suite**                    |

---

</details>

## License & Contact

**Author:** Dmitry Labintsev  
**Email:** chg@live.ru  
**Telegram:** @DmLabincev  

Open to: **partnership**, **collaboration**, **research**

---

<p align="center">
  <img src="https://img.shields.io/badge/ğŸ„_Christmas_2025-FULL_OPEN_SOURCE-brightgreen?style=for-the-badge&labelColor=1a1a2e" alt="Open Source">
</p>

<p align="center">
  <strong>ğŸ›¡ï¸ SENTINEL â€” Because AI must be secure ğŸ›¡ï¸</strong>
</p>

<p align="center">
  <em>All the math. All the geometry. All the innovations.</em><br>
  <em>This belongs to humanity now.</em>
</p>

---

<p align="center">
  <strong>ğŸš€ BUT THIS IS JUST THE BEGINNING ğŸš€</strong>
</p>

<p align="center">
  <em>We will invent what you haven't seen before.</em><br>
  <em>The future of AI security is being written â€” and we're holding the pen.</em>
</p>

<p align="center">
  <strong>Stay tuned. The best is yet to come.</strong>
</p>
