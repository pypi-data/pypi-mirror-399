{"version":3,"file":"markdown-worker.ba503b3c49cb908a.js","sources":["webpack://knx-frontend/webpack/runtime/on_chunk_loaded","webpack://knx-frontend/webpack/runtime/startup_chunk_dependencies","webpack://knx-frontend/./homeassistant-frontend/src/resources/markdown-worker.ts","webpack://knx-frontend/webpack/runtime/compat_get_default_export","webpack://knx-frontend/webpack/runtime/define_property_getters","webpack://knx-frontend/webpack/runtime/ensure_chunk","webpack://knx-frontend/webpack/runtime/get javascript chunk filename","webpack://knx-frontend/webpack/runtime/has_own_property","webpack://knx-frontend/webpack/runtime/public_path","webpack://knx-frontend/webpack/runtime/rspack_version","webpack://knx-frontend/webpack/runtime/import_scripts_chunk_loading","webpack://knx-frontend/webpack/runtime/rspack_unique_id"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif (chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor (var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--)\n\t\t\tdeferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\nvar fn = deferred[i][1];\nvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif (\n\t\t\t\t(priority & (1 === 0) || notFulfilled >= priority) &&\n\t\t\t\tObject.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })\n\t\t\t) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif (priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif (fulfilled) {\n\t\t\tdeferred.splice(i--, 1);\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};\n","var next = __webpack_require__.x\n__webpack_require__.x = function() {\n  return Promise.all([__webpack_require__.e(\"4925\"),\n__webpack_require__.e(\"259\")]).then(next);\n}","import { expose } from \"comlink\";\nimport type { MarkedOptions } from \"marked\";\nimport { marked } from \"marked\";\nimport type { IWhiteList } from \"xss\";\nimport { filterXSS, getDefaultWhiteList } from \"xss\";\n\nlet whiteListNormal: IWhiteList | undefined;\nlet whiteListSvg: IWhiteList | undefined;\n\nconst renderMarkdown = async (\n  content: string,\n  markedOptions: MarkedOptions,\n  hassOptions: {\n    // Do not allow SVG on untrusted content, it allows XSS.\n    allowSvg?: boolean;\n    allowDataUrl?: boolean;\n  } = {}\n): Promise<string[]> => {\n  if (!whiteListNormal) {\n    whiteListNormal = {\n      ...getDefaultWhiteList(),\n      input: [\"type\", \"disabled\", \"checked\"],\n      \"ha-icon\": [\"icon\"],\n      \"ha-svg-icon\": [\"path\"],\n      \"ha-alert\": [\"alert-type\", \"title\"],\n      \"ha-qr-code\": [\n        \"data\",\n        \"scale\",\n        \"width\",\n        \"margin\",\n        \"error-correction-level\",\n        \"center-image\",\n      ],\n    };\n  }\n\n  let whiteList: IWhiteList | undefined;\n\n  if (hassOptions.allowSvg) {\n    if (!whiteListSvg) {\n      whiteListSvg = {\n        ...whiteListNormal,\n        svg: [\"xmlns\", \"height\", \"width\"],\n        path: [\"transform\", \"stroke\", \"d\"],\n        img: [\"src\"],\n      };\n    }\n    whiteList = whiteListSvg;\n  } else {\n    whiteList = whiteListNormal;\n  }\n  if (hassOptions.allowDataUrl && whiteList.a) {\n    whiteList.a.push(\"download\");\n  }\n\n  marked.setOptions(markedOptions);\n\n  marked.use({\n    renderer: {\n      table(...args) {\n        const defaultRenderer = new marked.Renderer();\n        // Wrap the table with block element because the property 'overflow'\n        // cannot be applied to elements of display type 'table'.\n        // https://www.w3.org/TR/css-overflow-3/#overflow-control\n        return `<div>${defaultRenderer.table.apply(this, args)}</div>`;\n      },\n    },\n  });\n\n  const tokens = marked.lexer(content);\n  return tokens.map((token) =>\n    filterXSS(marked.parser([token]), {\n      whiteList,\n      onTagAttr: (\n        tag: string,\n        name: string,\n        value: string\n      ): string | undefined => {\n        // Override the default `onTagAttr` behavior to only render\n        // our markdown checkboxes.\n        // Returning undefined causes the default measure to be taken\n        // in the xss library.\n        if (tag === \"input\") {\n          if (\n            (name === \"type\" && value === \"checkbox\") ||\n            name === \"checked\" ||\n            name === \"disabled\"\n          ) {\n            return undefined;\n          }\n          return \"\";\n        }\n        if (\n          hassOptions.allowDataUrl &&\n          tag === \"a\" &&\n          name === \"href\" &&\n          value.startsWith(\"data:\")\n        ) {\n          return `href=\"${value}\"`;\n        }\n        return undefined;\n      },\n    })\n  );\n};\n\nconst api = {\n  renderMarkdown,\n};\n\nexport type Api = typeof api;\n\nexpose(api);\n","// getDefaultExport function for compatibility with non-ESM modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};\n","__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n        if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n            Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n        }\n    }\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = function(chunkId) {\n\treturn Promise.all(\n\t\tObject.keys(__webpack_require__.f).reduce(function(promises, key) {\n\t\t\t__webpack_require__.f[key](chunkId, promises);\n\t\t\treturn promises;\n\t\t}, [])\n\t);\n};","// This function allow to reference chunks\n__webpack_require__.u = function(chunkId) {\n  // return url for filenames not based on template\n  \n  // return url for filenames based on template\n  return \"\" + chunkId + \".\" + {\"259\": \"3866989cad3c3055\",\"4925\": \"a88f1a14b43fb3c7\",}[chunkId] + \".js\"\n}","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","__webpack_require__.p = \"/knx_static/frontend_es5/\";","__webpack_require__.rv = function() { return \"1.6.4\"; }","var installedChunks = {\"5640\": 1,};\n// importScripts chunk loading\nvar installChunk = function(data) {\n    var chunkIds = data[0];\nvar moreModules = data[1];\nvar runtime = data[2];\n    for (var moduleId in moreModules) {\n        if (__webpack_require__.o(moreModules, moduleId)) {\n            __webpack_require__.m[moduleId] = moreModules[moduleId];\n        }\n    }\n    if (runtime) runtime(__webpack_require__);\n    while (chunkIds.length) installedChunks[chunkIds.pop()] = 1;\n    parentChunkLoadingFunction(data);\n};\n\n__webpack_require__.f.i = function(chunkId, promises) {\n    \n    // \"1\" is the signal for \"already loaded\n    if (!installedChunks[chunkId]) {\n        if (true) {\n            \n            importScripts(__webpack_require__.p + __webpack_require__.u(chunkId));\n            \n        }\n    }\n    \n};\n\nvar chunkLoadingGlobal = self[\"webpackChunkknx_frontend\"] = self[\"webpackChunkknx_frontend\"] || [];\nvar parentChunkLoadingFunction = chunkLoadingGlobal.push.bind(chunkLoadingGlobal);\nchunkLoadingGlobal.push = installChunk;","__webpack_require__.ruid = \"bundler=rspack@1.6.4\";\n"],"names":["deferred","next","whiteListNormal","whiteListSvg","renderMarkdown","_ref","_asyncToGenerator","_regenerator","m","_callee","content","markedOptions","hassOptions","whiteList","defaultRenderer","_len","args","_key","tokens","_t","_t2","_args","arguments","w","_context","n","length","undefined","Object","assign","getDefaultWhiteList","input","allowSvg","svg","path","img","allowDataUrl","a","push","marked","table","Array","apply","use","call","renderer","map","token","filterXSS","onTagAttr","tag","name","value","startsWith","_x","_x2","api","expose","__webpack_require__","module","getter","__esModule","d","exports","definition","key","o","defineProperty","enumerable","get","f","e","chunkId","Promise","all","keys","reduce","promises","u","obj","prop","prototype","hasOwnProperty","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","every","splice","r","p","rv","x","then","installedChunks","importScripts","chunkLoadingGlobal","self","parentChunkLoadingFunction","bind","data","moreModules","runtime","moduleId","pop","ruid"],"mappings":"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"}