{"version":3,"file":"5295.db431630fe615141.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/entity/ha-entities-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-entity.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-sortable.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/util/time-cache-function-promise.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/entity_sources.ts"],"sourcesContent":["import { mdiDragHorizontalVariant } from \"@mdi/js\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport { isValidEntityId } from \"../../common/entity/valid_entity_id\";\nimport type { HaEntityPickerEntityFilterFunc } from \"../../data/entity\";\nimport type { HomeAssistant, ValueChangedEvent } from \"../../types\";\nimport \"../ha-sortable\";\nimport \"./ha-entity-picker\";\n\n@customElement(\"ha-entities-picker\")\nclass HaEntitiesPicker extends LitElement {\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ type: Array }) public value?: string[];\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property() public label?: string;\n\n  @property() public placeholder?: string;\n\n  @property() public helper?: string;\n\n  /**\n   * Show entities from specific domains.\n   * @type {string}\n   * @attr include-domains\n   */\n  @property({ type: Array, attribute: \"include-domains\" })\n  public includeDomains?: string[];\n\n  /**\n   * Show no entities of these domains.\n   * @type {Array}\n   * @attr exclude-domains\n   */\n  @property({ type: Array, attribute: \"exclude-domains\" })\n  public excludeDomains?: string[];\n\n  /**\n   * Show only entities of these device classes.\n   * @type {Array}\n   * @attr include-device-classes\n   */\n  @property({ type: Array, attribute: \"include-device-classes\" })\n  public includeDeviceClasses?: string[];\n\n  /**\n   * Show only entities with these unit of measuments.\n   * @type {Array}\n   * @attr include-unit-of-measurement\n   */\n  @property({ type: Array, attribute: \"include-unit-of-measurement\" })\n  public includeUnitOfMeasurement?: string[];\n\n  /**\n   * List of allowed entities to show. Will ignore all other filters.\n   * @type {Array}\n   * @attr include-entities\n   */\n  @property({ type: Array, attribute: \"include-entities\" })\n  public includeEntities?: string[];\n\n  /**\n   * List of entities to be excluded.\n   * @type {Array}\n   * @attr exclude-entities\n   */\n  @property({ type: Array, attribute: \"exclude-entities\" })\n  public excludeEntities?: string[];\n\n  @property({ attribute: false })\n  public entityFilter?: HaEntityPickerEntityFilterFunc;\n\n  @property({ attribute: false, type: Array }) public createDomains?: string[];\n\n  @property({ type: Boolean })\n  public reorder = false;\n\n  protected render() {\n    if (!this.hass) {\n      return nothing;\n    }\n\n    const currentEntities = this._currentEntities;\n    return html`\n      ${this.label ? html`<label>${this.label}</label>` : nothing}\n      <ha-sortable\n        .disabled=${!this.reorder || this.disabled}\n        handle-selector=\".entity-handle\"\n        @item-moved=${this._entityMoved}\n      >\n        <div class=\"list\">\n          ${currentEntities.map(\n            (entityId) => html`\n              <div class=\"entity\">\n                <ha-entity-picker\n                  allow-custom-entity\n                  .curValue=${entityId}\n                  .hass=${this.hass}\n                  .includeDomains=${this.includeDomains}\n                  .excludeDomains=${this.excludeDomains}\n                  .includeEntities=${this.includeEntities}\n                  .excludeEntities=${this.excludeEntities}\n                  .includeDeviceClasses=${this.includeDeviceClasses}\n                  .includeUnitOfMeasurement=${this.includeUnitOfMeasurement}\n                  .entityFilter=${this.entityFilter}\n                  .value=${entityId}\n                  .disabled=${this.disabled}\n                  .createDomains=${this.createDomains}\n                  @value-changed=${this._entityChanged}\n                ></ha-entity-picker>\n                ${this.reorder\n                  ? html`\n                      <ha-svg-icon\n                        class=\"entity-handle\"\n                        .path=${mdiDragHorizontalVariant}\n                      ></ha-svg-icon>\n                    `\n                  : nothing}\n              </div>\n            `\n          )}\n        </div>\n      </ha-sortable>\n      <div>\n        <ha-entity-picker\n          allow-custom-entity\n          .hass=${this.hass}\n          .includeDomains=${this.includeDomains}\n          .excludeDomains=${this.excludeDomains}\n          .includeEntities=${this.includeEntities}\n          .excludeEntities=${this._excludeEntities(\n            this.value,\n            this.excludeEntities\n          )}\n          .includeDeviceClasses=${this.includeDeviceClasses}\n          .includeUnitOfMeasurement=${this.includeUnitOfMeasurement}\n          .entityFilter=${this.entityFilter}\n          .placeholder=${this.placeholder}\n          .helper=${this.helper}\n          .disabled=${this.disabled}\n          .createDomains=${this.createDomains}\n          .required=${this.required && !currentEntities.length}\n          @value-changed=${this._addEntity}\n          .addButton=${currentEntities.length > 0}\n        ></ha-entity-picker>\n      </div>\n    `;\n  }\n\n  private _entityMoved(e: CustomEvent) {\n    e.stopPropagation();\n    const { oldIndex, newIndex } = e.detail;\n    const currentEntities = this._currentEntities;\n    const movedEntity = currentEntities[oldIndex];\n    const newEntities = [...currentEntities];\n    newEntities.splice(oldIndex, 1);\n    newEntities.splice(newIndex, 0, movedEntity);\n    this._updateEntities(newEntities);\n  }\n\n  private _excludeEntities = memoizeOne(\n    (\n      value: string[] | undefined,\n      excludeEntities: string[] | undefined\n    ): string[] | undefined => {\n      if (value === undefined) {\n        return excludeEntities;\n      }\n      return [...(excludeEntities || []), ...value];\n    }\n  );\n\n  private get _currentEntities() {\n    return this.value || [];\n  }\n\n  private async _updateEntities(entities) {\n    this.value = entities;\n\n    fireEvent(this, \"value-changed\", {\n      value: entities,\n    });\n  }\n\n  private _entityChanged(event: ValueChangedEvent<string>) {\n    event.stopPropagation();\n    const curValue = (event.currentTarget as any).curValue;\n    const newValue = event.detail.value;\n    if (\n      newValue === curValue ||\n      (newValue !== undefined && !isValidEntityId(newValue))\n    ) {\n      return;\n    }\n    const currentEntities = this._currentEntities;\n    if (!newValue || currentEntities.includes(newValue)) {\n      this._updateEntities(currentEntities.filter((ent) => ent !== curValue));\n      return;\n    }\n    this._updateEntities(\n      currentEntities.map((ent) => (ent === curValue ? newValue : ent))\n    );\n  }\n\n  private async _addEntity(event: ValueChangedEvent<string>) {\n    event.stopPropagation();\n    const toAdd = event.detail.value;\n    if (!toAdd) {\n      return;\n    }\n    (event.currentTarget as any).value = \"\";\n    if (!toAdd) {\n      return;\n    }\n    const currentEntities = this._currentEntities;\n    if (currentEntities.includes(toAdd)) {\n      return;\n    }\n\n    this._updateEntities([...currentEntities, toAdd]);\n  }\n\n  static override styles = css`\n    div {\n      margin-top: 8px;\n    }\n    label {\n      display: block;\n      margin: 0 0 8px;\n    }\n    .entity {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n    }\n    .entity ha-entity-picker {\n      flex: 1;\n    }\n    .entity-handle {\n      padding: 8px;\n      cursor: move; /* fallback if grab cursor is unsupported */\n      cursor: grab;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-entities-picker\": HaEntitiesPicker;\n  }\n}\n","import type { HassEntity } from \"home-assistant-js-websocket\";\nimport type { PropertyValues } from \"lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { ensureArray } from \"../../common/array/ensure-array\";\nimport { fireEvent } from \"../../common/dom/fire_event\";\nimport type { EntitySources } from \"../../data/entity_sources\";\nimport { fetchEntitySourcesWithCache } from \"../../data/entity_sources\";\nimport type { EntitySelector } from \"../../data/selector\";\nimport {\n  filterSelectorEntities,\n  computeCreateDomains,\n} from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../entity/ha-entities-picker\";\nimport \"../entity/ha-entity-picker\";\n\n@customElement(\"ha-selector-entity\")\nexport class HaEntitySelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: EntitySelector;\n\n  @state() private _entitySources?: EntitySources;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property() public placeholder?: any;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  @state() private _createDomains: string[] | undefined;\n\n  private _hasIntegration(selector: EntitySelector) {\n    return (\n      selector.entity?.filter &&\n      ensureArray(selector.entity.filter).some((filter) => filter.integration)\n    );\n  }\n\n  protected willUpdate(changedProperties: PropertyValues): void {\n    if (changedProperties.get(\"selector\") && this.value !== undefined) {\n      if (this.selector.entity?.multiple && !Array.isArray(this.value)) {\n        this.value = [this.value];\n        fireEvent(this, \"value-changed\", { value: this.value });\n      } else if (!this.selector.entity?.multiple && Array.isArray(this.value)) {\n        this.value = this.value[0];\n        fireEvent(this, \"value-changed\", { value: this.value });\n      }\n    }\n  }\n\n  protected render() {\n    if (this._hasIntegration(this.selector) && !this._entitySources) {\n      return nothing;\n    }\n\n    if (!this.selector.entity?.multiple) {\n      return html`<ha-entity-picker\n        .hass=${this.hass}\n        .value=${this.value}\n        .label=${this.label}\n        .helper=${this.helper}\n        .includeEntities=${this.selector.entity?.include_entities}\n        .excludeEntities=${this.selector.entity?.exclude_entities}\n        .entityFilter=${this._filterEntities}\n        .createDomains=${this._createDomains}\n        .placeholder=${this.placeholder}\n        .disabled=${this.disabled}\n        .required=${this.required}\n        allow-custom-entity\n      ></ha-entity-picker>`;\n    }\n\n    return html`\n      <ha-entities-picker\n        .hass=${this.hass}\n        .value=${this.value}\n        .label=${this.label}\n        .helper=${this.helper}\n        .includeEntities=${this.selector.entity.include_entities}\n        .excludeEntities=${this.selector.entity.exclude_entities}\n        .reorder=${this.selector.entity.reorder ?? false}\n        .entityFilter=${this._filterEntities}\n        .createDomains=${this._createDomains}\n        .placeholder=${this.placeholder}\n        .disabled=${this.disabled}\n        .required=${this.required}\n      ></ha-entities-picker>\n    `;\n  }\n\n  protected updated(changedProps: PropertyValues): void {\n    super.updated(changedProps);\n    if (\n      changedProps.has(\"selector\") &&\n      this._hasIntegration(this.selector) &&\n      !this._entitySources\n    ) {\n      fetchEntitySourcesWithCache(this.hass).then((sources) => {\n        this._entitySources = sources;\n      });\n    }\n    if (changedProps.has(\"selector\")) {\n      this._createDomains = computeCreateDomains(this.selector);\n    }\n  }\n\n  private _filterEntities = (entity: HassEntity): boolean => {\n    if (!this.selector?.entity?.filter) {\n      return true;\n    }\n    return ensureArray(this.selector.entity.filter).some((filter) =>\n      filterSelectorEntities(filter, entity, this._entitySources)\n    );\n  };\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-entity\": HaEntitySelector;\n  }\n}\n","/* eslint-disable lit/prefer-static-styles */\nimport type { PropertyValues } from \"lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { SortableEvent } from \"sortablejs\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport type { SortableInstance } from \"../resources/sortable\";\n\ndeclare global {\n  interface HASSDomEvents {\n    \"item-moved\": {\n      oldIndex: number;\n      newIndex: number;\n    };\n    \"item-added\": {\n      index: number;\n      data: any;\n      item: any;\n    };\n    \"item-removed\": {\n      index: number;\n    };\n    \"drag-start\": undefined;\n    \"drag-end\": undefined;\n  }\n}\n\nexport type HaSortableOptions = Omit<\n  SortableInstance.SortableOptions,\n  \"onStart\" | \"onChoose\" | \"onEnd\" | \"onUpdate\" | \"onAdd\" | \"onRemove\"\n>;\n\n@customElement(\"ha-sortable\")\nexport class HaSortable extends LitElement {\n  private _sortable?: SortableInstance;\n\n  @property({ type: Boolean })\n  public disabled = false;\n\n  @property({ type: Boolean, attribute: \"no-style\" })\n  public noStyle = false;\n\n  @property({ type: String, attribute: \"draggable-selector\" })\n  public draggableSelector?: string;\n\n  @property({ type: String, attribute: \"handle-selector\" })\n  public handleSelector?: string;\n\n  /**\n   * Selectors that do not lead to dragging (String or Function)\n   * https://github.com/SortableJS/Sortable?tab=readme-ov-file#filter-option\n   * */\n  @property({ type: String, attribute: \"filter\" })\n  public filter?: string;\n\n  @property({ type: String })\n  public group?: string | SortableInstance.GroupOptions;\n\n  @property({ type: Boolean, attribute: \"invert-swap\" })\n  public invertSwap = false;\n\n  @property({ attribute: false })\n  public options?: HaSortableOptions;\n\n  @property({ type: Boolean })\n  public rollback = true;\n\n  protected updated(changedProperties: PropertyValues<this>) {\n    if (changedProperties.has(\"disabled\")) {\n      if (this.disabled) {\n        this._destroySortable();\n      } else {\n        this._createSortable();\n      }\n    }\n  }\n\n  // Workaround for connectedCallback just after disconnectedCallback (when dragging sortable with sortable children)\n  private _shouldBeDestroy = false;\n\n  public disconnectedCallback() {\n    super.disconnectedCallback();\n    this._shouldBeDestroy = true;\n    setTimeout(() => {\n      if (this._shouldBeDestroy) {\n        this._destroySortable();\n        this._shouldBeDestroy = false;\n      }\n    }, 1);\n  }\n\n  public connectedCallback() {\n    super.connectedCallback();\n    this._shouldBeDestroy = false;\n    if (this.hasUpdated && !this.disabled) {\n      this._createSortable();\n    }\n  }\n\n  protected createRenderRoot() {\n    return this;\n  }\n\n  protected render() {\n    if (this.noStyle) return nothing;\n    return html`\n      <style>\n        .sortable-fallback {\n          display: none !important;\n        }\n\n        .sortable-ghost {\n          box-shadow: 0 0 0 2px var(--primary-color);\n          background: rgba(var(--rgb-primary-color), 0.25);\n          border-radius: var(--ha-border-radius-sm);\n          opacity: 0.4;\n        }\n\n        .sortable-drag {\n          border-radius: var(--ha-border-radius-sm);\n          opacity: 1;\n          background: var(--card-background-color);\n          box-shadow: 0px 4px 8px 3px #00000026;\n          cursor: grabbing;\n        }\n      </style>\n    `;\n  }\n\n  private async _createSortable() {\n    if (this._sortable) return;\n    const container = this.children[0] as HTMLElement | undefined;\n\n    if (!container) return;\n\n    // eslint-disable-next-line @typescript-eslint/naming-convention\n    const Sortable = (await import(\"../resources/sortable\")).default;\n\n    const options: SortableInstance.Options = {\n      scroll: true,\n      // Force the autoscroll fallback because it works better than the native one\n      forceAutoScrollFallback: true,\n      scrollSpeed: 20,\n      animation: 150,\n      ...this.options,\n      onChoose: this._handleChoose,\n      onStart: this._handleStart,\n      onEnd: this._handleEnd,\n      onUpdate: this._handleUpdate,\n      onAdd: this._handleAdd,\n      onRemove: this._handleRemove,\n    };\n\n    if (this.draggableSelector) {\n      options.draggable = this.draggableSelector;\n    }\n    if (this.handleSelector) {\n      options.handle = this.handleSelector;\n    }\n    if (this.invertSwap !== undefined) {\n      options.invertSwap = this.invertSwap;\n    }\n    if (this.group) {\n      options.group = this.group;\n    }\n    if (this.filter) {\n      options.filter = this.filter;\n    }\n\n    this._sortable = new Sortable(container, options);\n  }\n\n  private _handleUpdate = (evt) => {\n    fireEvent(this, \"item-moved\", {\n      newIndex: evt.newIndex,\n      oldIndex: evt.oldIndex,\n    });\n  };\n\n  private _handleAdd = (evt) => {\n    fireEvent(this, \"item-added\", {\n      index: evt.newIndex,\n      data: evt.item.sortableData,\n      item: evt.item,\n    });\n  };\n\n  private _handleRemove = (evt) => {\n    fireEvent(this, \"item-removed\", { index: evt.oldIndex });\n  };\n\n  private _handleEnd = async (evt) => {\n    fireEvent(this, \"drag-end\");\n    // put back in original location\n    if (this.rollback && (evt.item as any).placeholder) {\n      (evt.item as any).placeholder.replaceWith(evt.item);\n      delete (evt.item as any).placeholder;\n    }\n  };\n\n  private _handleStart = () => {\n    fireEvent(this, \"drag-start\");\n  };\n\n  private _handleChoose = (evt: SortableEvent) => {\n    if (!this.rollback) return;\n    (evt.item as any).placeholder = document.createComment(\"sort-placeholder\");\n    evt.item.after((evt.item as any).placeholder);\n  };\n\n  private _destroySortable() {\n    if (!this._sortable) return;\n    this._sortable.destroy();\n    this._sortable = undefined;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-sortable\": HaSortable;\n  }\n}\n","import type { HomeAssistant } from \"../../types\";\n\ninterface CacheResult<T> {\n  result: T;\n  cacheKey: any;\n}\n\n/**\n * Caches a result of a promise for X time. Allows optional extra validation\n * check to invalidate the cache.\n * @param cacheKey the key to store the cache\n * @param cacheTime the time to cache the result\n * @param func the function to fetch the data\n * @param generateCacheKey optional function to generate a cache key based on current hass + cached result. Cache is invalid if generates a different cache key.\n * @param hass Home Assistant object\n * @param args extra arguments to pass to the function to fetch the data\n * @returns\n */\nexport const timeCachePromiseFunc = async <T>(\n  cacheKey: string,\n  cacheTime: number,\n  func: (hass: HomeAssistant, ...args: any[]) => Promise<T>,\n  generateCacheKey:\n    | ((hass: HomeAssistant, lastResult: T) => unknown)\n    | undefined,\n  hass: HomeAssistant,\n  ...args: any[]\n): Promise<T> => {\n  const anyHass = hass as any;\n  const lastResult: Promise<CacheResult<T>> | CacheResult<T> | undefined =\n    anyHass[cacheKey];\n\n  const checkCachedResult = (result: CacheResult<T>): T | Promise<T> => {\n    if (\n      !generateCacheKey ||\n      generateCacheKey(hass, result.result) === result.cacheKey\n    ) {\n      return result.result;\n    }\n\n    anyHass[cacheKey] = undefined;\n    return timeCachePromiseFunc(\n      cacheKey,\n      cacheTime,\n      func,\n      generateCacheKey,\n      hass,\n      ...args\n    );\n  };\n\n  // If we have a cached result, return it if it's still valid\n  if (lastResult) {\n    return lastResult instanceof Promise\n      ? lastResult.then(checkCachedResult)\n      : checkCachedResult(lastResult);\n  }\n\n  const resultPromise = func(hass, ...args);\n  anyHass[cacheKey] = resultPromise;\n\n  resultPromise.then(\n    // When successful, set timer to clear cache\n    (result) => {\n      anyHass[cacheKey] = {\n        result,\n        cacheKey: generateCacheKey?.(hass, result),\n      };\n      setTimeout(() => {\n        anyHass[cacheKey] = undefined;\n      }, cacheTime);\n    },\n    // On failure, clear cache right away\n    () => {\n      anyHass[cacheKey] = undefined;\n    }\n  );\n\n  return resultPromise;\n};\n","import { timeCachePromiseFunc } from \"../common/util/time-cache-function-promise\";\nimport type { HomeAssistant } from \"../types\";\n\ninterface EntitySource {\n  domain: string;\n}\n\nexport type EntitySources = Record<string, EntitySource>;\n\nconst fetchEntitySources = (hass: HomeAssistant): Promise<EntitySources> =>\n  hass.callWS({ type: \"entity/source\" });\n\nexport const fetchEntitySourcesWithCache = (\n  hass: HomeAssistant\n): Promise<EntitySources> =>\n  timeCachePromiseFunc(\n    \"_entitySources\",\n    // cache for 30 seconds\n    30000,\n    fetchEntitySources,\n    // We base the cache on number of states. If number of states\n    // changes we force a refresh\n    (hass2) => Object.keys(hass2.states).length,\n    hass\n  );\n"],"names":["HaEntitiesPicker","_LitElement","_this","_callSuper","concat","args","disabled","required","reorder","_excludeEntities","memoizeOne","value","excludeEntities","undefined","_toConsumableArray","this","hass","nothing","currentEntities","_currentEntities","html","_t","_","label","_t2","_entityMoved","map","entityId","_t3","includeDomains","excludeDomains","includeEntities","includeDeviceClasses","includeUnitOfMeasurement","entityFilter","createDomains","_entityChanged","_t4","placeholder","helper","length","_addEntity","key","e","stopPropagation","_e$detail","detail","oldIndex","newIndex","movedEntity","newEntities","splice","_updateEntities","get","_updateEntities2","_asyncToGenerator","_regenerator","m","_callee","entities","w","_context","n","fireEvent","a","_x","apply","arguments","event","curValue","currentTarget","newValue","isValidEntityId","includes","ent","filter","_addEntity2","_callee2","toAdd","_context2","_x2","LitElement","styles","css","_t5","attribute","type","Array","Boolean","HaEntitySelector","_filterEntities","entity","_this$selector","selector","ensureArray","some","filterSelectorEntities","_entitySources","_selector$entity","integration","changedProperties","_this$selector$entity","_this$selector$entity2","multiple","isArray","_this$selector$entity3","_this$selector$entity6","_this$selector$entity4","_this$selector$entity5","_hasIntegration","include_entities","exclude_entities","_createDomains","changedProps","_superPropGet","has","fetchEntitySourcesWithCache","then","sources","computeCreateDomains","HaSortable","noStyle","invertSwap","rollback","_shouldBeDestroy","_handleUpdate","evt","_assertThisInitialized","_handleAdd","index","data","item","sortableData","_handleRemove","_handleEnd","_ref","replaceWith","_handleStart","_handleChoose","document","createComment","after","_destroySortable","_createSortable","setTimeout","hasUpdated","_createSortable2","container","Sortable","options","_sortable","children","v","default","Object","assign","scroll","forceAutoScrollFallback","scrollSpeed","animation","onChoose","onStart","onEnd","onUpdate","onAdd","onRemove","draggableSelector","draggable","handleSelector","handle","group","destroy","String","timeCachePromiseFunc","cacheKey","cacheTime","func","generateCacheKey","_len","_key","anyHass","lastResult","checkCachedResult","resultPromise","_args","result","Promise","_x3","_x4","_x5","fetchEntitySources","callWS","hass2","keys","states"],"mappings":"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"}