{"version":3,"file":"4755.2a0f0ee909f87654.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/ha-qr-code.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-qr-code.ts"],"sourcesContent":["import type { PropertyValues } from \"lit\";\nimport { LitElement, css, html, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport QRCode from \"qrcode\";\nimport \"./ha-alert\";\nimport { rgb2hex } from \"../common/color/convert-color\";\n\n@customElement(\"ha-qr-code\")\nexport class HaQrCode extends LitElement {\n  @property() public data?: string;\n\n  @property({ attribute: \"error-correction-level\" })\n  public errorCorrectionLevel: \"low\" | \"medium\" | \"quartile\" | \"high\" =\n    \"medium\";\n\n  @property({ type: Number })\n  public width = 4;\n\n  @property({ type: Number })\n  public scale = 4;\n\n  @property({ type: Number })\n  public margin = 4;\n\n  @property({ attribute: false, type: Number })\n  public maskPattern?: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7;\n\n  @property({ attribute: \"center-image\" }) public centerImage?: string;\n\n  @state() private _error?: string;\n\n  @query(\"canvas\") private _canvas?: HTMLCanvasElement;\n\n  protected willUpdate(changedProperties: PropertyValues): void {\n    super.willUpdate(changedProperties);\n    if (\n      (changedProperties.has(\"data\") ||\n        changedProperties.has(\"scale\") ||\n        changedProperties.has(\"width\") ||\n        changedProperties.has(\"margin\") ||\n        changedProperties.has(\"maskPattern\") ||\n        changedProperties.has(\"errorCorrectionLevel\")) &&\n      this._error\n    ) {\n      this._error = undefined;\n    }\n  }\n\n  updated(changedProperties: PropertyValues) {\n    const canvas = this._canvas;\n    if (\n      canvas &&\n      this.data &&\n      (changedProperties.has(\"data\") ||\n        changedProperties.has(\"scale\") ||\n        changedProperties.has(\"width\") ||\n        changedProperties.has(\"margin\") ||\n        changedProperties.has(\"maskPattern\") ||\n        changedProperties.has(\"errorCorrectionLevel\") ||\n        changedProperties.has(\"centerImage\"))\n    ) {\n      const computedStyles = getComputedStyle(this);\n      const textRgb = computedStyles.getPropertyValue(\n        \"--rgb-primary-text-color\"\n      );\n      const backgroundRgb = computedStyles.getPropertyValue(\n        \"--rgb-card-background-color\"\n      );\n      const textHex = rgb2hex(\n        textRgb.split(\",\").map((a) => parseInt(a, 10)) as [\n          number,\n          number,\n          number,\n        ]\n      );\n      const backgroundHex = rgb2hex(\n        backgroundRgb.split(\",\").map((a) => parseInt(a, 10)) as [\n          number,\n          number,\n          number,\n        ]\n      );\n\n      QRCode.toCanvas(canvas, this.data, {\n        errorCorrectionLevel:\n          this.errorCorrectionLevel || (this.centerImage ? \"Q\" : \"M\"),\n        width: this.width,\n        scale: this.scale,\n        margin: this.margin,\n        maskPattern: this.maskPattern,\n        color: {\n          light: backgroundHex,\n          dark: textHex,\n        },\n      }).catch((err) => {\n        this._error = err.message;\n      });\n\n      if (this.centerImage) {\n        const context = this._canvas!.getContext(\"2d\");\n        const imageObj = new Image();\n        imageObj.src = this.centerImage;\n        imageObj.onload = () => {\n          context?.drawImage(\n            imageObj,\n            canvas.width * 0.375,\n            canvas.height * 0.375,\n            canvas.width / 4,\n            canvas.height / 4\n          );\n        };\n      }\n    }\n  }\n\n  render() {\n    if (!this.data) {\n      return nothing;\n    }\n    if (this._error) {\n      return html`<ha-alert alert-type=\"error\">${this._error}</ha-alert>`;\n    }\n    return html`<canvas></canvas>`;\n  }\n\n  static styles = css`\n    :host {\n      display: block;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-qr-code\": HaQrCode;\n  }\n}\n","import { LitElement, css, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { QRCodeSelector } from \"../../data/selector\";\nimport \"../ha-qr-code\";\n\n@customElement(\"ha-selector-qr_code\")\nexport class HaSelectorQRCode extends LitElement {\n  @property({ attribute: false }) public selector!: QRCodeSelector;\n\n  protected render() {\n    return html`<ha-qr-code\n      .data=${this.selector.qr_code?.data}\n      .scale=${this.selector.qr_code?.scale}\n      .errorCorrectionLevel=${this.selector.qr_code?.error_correction_level}\n      .centerImage=${this.selector.qr_code?.center_image}\n    ></ha-qr-code>`;\n  }\n\n  static styles = css`\n    ha-qr-code {\n      text-align: center;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-qr_code\": HaSelectorQRCode;\n  }\n}\n"],"names":["HaQrCode","_LitElement","_this","_callSuper","concat","args","errorCorrectionLevel","width","scale","margin","changedProperties","_superPropGet","has","_error","this","undefined","key","value","canvas","_canvas","data","computedStyles","getComputedStyle","textRgb","getPropertyValue","backgroundRgb","textHex","rgb2hex","split","map","a","parseInt","backgroundHex","QRCode","centerImage","maskPattern","color","light","dark","catch","err","message","context","getContext","imageObj","Image","src","onload","drawImage","height","html","_t","_","_t2","nothing","LitElement","styles","css","_t3","attribute","type","Number","HaSelectorQRCode","_classCallCheck","arguments","_inherits","_createClass","_this$selector$qr_cod","_this$selector$qr_cod2","_this$selector$qr_cod3","_this$selector$qr_cod4","selector","qr_code","error_correction_level","center_image"],"mappings":"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"}