{"version":3,"file":"2562.4fb983ff1bc7316d.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/common/dom/stop_propagation.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/language/format_language.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-assist-pipeline-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-list.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-menu.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-select.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-assist-pipeline.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/assist_pipeline.ts"],"sourcesContent":["export const stopPropagation = (ev) => ev.stopPropagation();\n","import memoizeOne from \"memoize-one\";\nimport type { FrontendLocaleData } from \"../../data/translation\";\n\nexport const formatLanguageCode = (\n  languageCode: string,\n  locale: FrontendLocaleData\n) => {\n  try {\n    return formatLanguageCodeMem(locale)?.of(languageCode) ?? languageCode;\n  } catch {\n    return languageCode;\n  }\n};\n\nconst formatLanguageCodeMem = memoizeOne(\n  (locale: FrontendLocaleData) =>\n    new Intl.DisplayNames(locale.language, {\n      type: \"language\",\n      fallback: \"code\",\n    })\n);\n","import type { PropertyValueMap } from \"lit\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { stopPropagation } from \"../common/dom/stop_propagation\";\nimport { formatLanguageCode } from \"../common/language/format_language\";\nimport type { AssistPipeline } from \"../data/assist_pipeline\";\nimport { listAssistPipelines } from \"../data/assist_pipeline\";\nimport type { HomeAssistant } from \"../types\";\nimport \"./ha-list-item\";\nimport \"./ha-select\";\nimport type { HaSelect } from \"./ha-select\";\n\nconst PREFERRED = \"preferred\";\nconst LAST_USED = \"last_used\";\n\n@customElement(\"ha-assist-pipeline-picker\")\nexport class HaAssistPipelinePicker extends LitElement {\n  @property() public value?: string;\n\n  @property() public label?: string;\n\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property({ attribute: false }) public includeLastUsed = false;\n\n  @state() _pipelines?: AssistPipeline[];\n\n  @state() _preferredPipeline: string | null = null;\n\n  private get _default() {\n    return this.includeLastUsed ? LAST_USED : PREFERRED;\n  }\n\n  protected render() {\n    if (!this._pipelines) {\n      return nothing;\n    }\n    const value = this.value ?? this._default;\n    return html`\n      <ha-select\n        .label=${this.label ||\n        this.hass!.localize(\"ui.components.pipeline-picker.pipeline\")}\n        .value=${value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        @selected=${this._changed}\n        @closed=${stopPropagation}\n        fixedMenuPosition\n        naturalMenuWidth\n      >\n        ${this.includeLastUsed\n          ? html`\n              <ha-list-item .value=${LAST_USED}>\n                ${this.hass!.localize(\n                  \"ui.components.pipeline-picker.last_used\"\n                )}\n              </ha-list-item>\n            `\n          : null}\n        <ha-list-item .value=${PREFERRED}>\n          ${this.hass!.localize(\"ui.components.pipeline-picker.preferred\", {\n            preferred: this._pipelines.find(\n              (pipeline) => pipeline.id === this._preferredPipeline\n            )?.name,\n          })}\n        </ha-list-item>\n        ${this._pipelines.map(\n          (pipeline) =>\n            html`<ha-list-item .value=${pipeline.id}>\n              ${pipeline.name}\n              (${formatLanguageCode(pipeline.language, this.hass.locale)})\n            </ha-list-item>`\n        )}\n      </ha-select>\n    `;\n  }\n\n  protected firstUpdated(\n    changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>\n  ): void {\n    super.firstUpdated(changedProperties);\n    listAssistPipelines(this.hass).then((pipelines) => {\n      this._pipelines = pipelines.pipelines;\n      this._preferredPipeline = pipelines.preferred_pipeline;\n    });\n  }\n\n  static styles = css`\n    ha-select {\n      width: 100%;\n    }\n  `;\n\n  private _changed(ev): void {\n    const target = ev.target as HaSelect;\n    if (\n      !this.hass ||\n      target.value === \"\" ||\n      target.value === this.value ||\n      (this.value === undefined && target.value === this._default)\n    ) {\n      return;\n    }\n    this.value = target.value === this._default ? undefined : target.value;\n    fireEvent(this, \"value-changed\", { value: this.value });\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-assist-pipeline-picker\": HaAssistPipelinePicker;\n  }\n}\n","import { ListBase } from \"@material/mwc-list/mwc-list-base\";\nimport { styles } from \"@material/mwc-list/mwc-list.css\";\nimport { customElement } from \"lit/decorators\";\n\n@customElement(\"ha-list\")\nexport class HaList extends ListBase {\n  static styles = styles;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-list\": HaList;\n  }\n}\n","import { MenuBase } from \"@material/mwc-menu/mwc-menu-base\";\nimport { styles } from \"@material/mwc-menu/mwc-menu.css\";\nimport { html } from \"lit\";\nimport { customElement } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport \"./ha-list\";\n\n@customElement(\"ha-menu\")\nexport class HaMenu extends MenuBase {\n  protected get listElement() {\n    if (!this.listElement_) {\n      this.listElement_ = this.renderRoot.querySelector(\"ha-list\");\n      return this.listElement_;\n    }\n\n    return this.listElement_;\n  }\n\n  protected renderList() {\n    const itemRoles = this.innerRole === \"menu\" ? \"menuitem\" : \"option\";\n    const classes = this.renderListClasses();\n\n    return html`<ha-list\n      rootTabbable\n      .innerAriaLabel=${this.innerAriaLabel}\n      .innerRole=${this.innerRole}\n      .multi=${this.multi}\n      class=${classMap(classes)}\n      .itemRoles=${itemRoles}\n      .wrapFocus=${this.wrapFocus}\n      .activatable=${this.activatable}\n      @action=${this.onAction}\n    >\n      <slot></slot>\n    </ha-list>`;\n  }\n\n  static styles = styles;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-menu\": HaMenu;\n  }\n}\n","import { SelectBase } from \"@material/mwc-select/mwc-select-base\";\nimport { styles } from \"@material/mwc-select/mwc-select.css\";\nimport { mdiClose } from \"@mdi/js\";\nimport { css, html, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport { classMap } from \"lit/directives/class-map\";\nimport { debounce } from \"../common/util/debounce\";\nimport { nextRender } from \"../common/util/render-status\";\nimport \"./ha-icon-button\";\nimport \"./ha-menu\";\n\n@customElement(\"ha-select\")\nexport class HaSelect extends SelectBase {\n  // @ts-ignore\n  @property({ type: Boolean }) public icon = false;\n\n  @property({ type: Boolean, reflect: true }) public clearable = false;\n\n  @property({ attribute: \"inline-arrow\", type: Boolean })\n  public inlineArrow = false;\n\n  @property() public options;\n\n  protected override render() {\n    return html`\n      ${super.render()}\n      ${this.clearable && !this.required && !this.disabled && this.value\n        ? html`<ha-icon-button\n            label=\"clear\"\n            @click=${this._clearValue}\n            .path=${mdiClose}\n          ></ha-icon-button>`\n        : nothing}\n    `;\n  }\n\n  protected override renderMenu() {\n    const classes = this.getMenuClasses();\n    return html`<ha-menu\n      innerRole=\"listbox\"\n      wrapFocus\n      class=${classMap(classes)}\n      activatable\n      .fullwidth=${this.fixedMenuPosition ? false : !this.naturalMenuWidth}\n      .open=${this.menuOpen}\n      .anchor=${this.anchorElement}\n      .fixed=${this.fixedMenuPosition}\n      @selected=${this.onSelected}\n      @opened=${this.onOpened}\n      @closed=${this.onClosed}\n      @items-updated=${this.onItemsUpdated}\n      @keydown=${this.handleTypeahead}\n    >\n      ${this.renderMenuContent()}\n    </ha-menu>`;\n  }\n\n  protected override renderLeadingIcon() {\n    if (!this.icon) {\n      return nothing;\n    }\n\n    return html`<span class=\"mdc-select__icon\"\n      ><slot name=\"icon\"></slot\n    ></span>`;\n  }\n\n  connectedCallback() {\n    super.connectedCallback();\n    window.addEventListener(\"translations-updated\", this._translationsUpdated);\n  }\n\n  protected async firstUpdated() {\n    super.firstUpdated();\n\n    if (this.inlineArrow) {\n      this.shadowRoot\n        ?.querySelector(\".mdc-select__selected-text-container\")\n        ?.classList.add(\"inline-arrow\");\n    }\n  }\n\n  protected updated(changedProperties) {\n    super.updated(changedProperties);\n\n    if (changedProperties.has(\"inlineArrow\")) {\n      const textContainerElement = this.shadowRoot?.querySelector(\n        \".mdc-select__selected-text-container\"\n      );\n      if (this.inlineArrow) {\n        textContainerElement?.classList.add(\"inline-arrow\");\n      } else {\n        textContainerElement?.classList.remove(\"inline-arrow\");\n      }\n    }\n    if (changedProperties.get(\"options\")) {\n      this.layoutOptions();\n      this.selectByValue(this.value);\n    }\n  }\n\n  disconnectedCallback() {\n    super.disconnectedCallback();\n    window.removeEventListener(\n      \"translations-updated\",\n      this._translationsUpdated\n    );\n  }\n\n  private _clearValue(): void {\n    if (this.disabled || !this.value) {\n      return;\n    }\n    this.valueSetDirectly = true;\n    this.select(-1);\n    this.mdcFoundation.handleChange();\n  }\n\n  private _translationsUpdated = debounce(async () => {\n    await nextRender();\n    this.layoutOptions();\n  }, 500);\n\n  static override styles = [\n    styles,\n    css`\n      :host([clearable]) {\n        position: relative;\n      }\n      .mdc-select:not(.mdc-select--disabled) .mdc-select__icon {\n        color: var(--secondary-text-color);\n      }\n      .mdc-select__anchor {\n        width: var(--ha-select-min-width, 200px);\n      }\n      .mdc-select--filled .mdc-select__anchor {\n        height: var(--ha-select-height, 56px);\n      }\n      .mdc-select--filled .mdc-floating-label {\n        inset-inline-start: var(--ha-space-4);\n        inset-inline-end: initial;\n        direction: var(--direction);\n      }\n      .mdc-select--filled.mdc-select--with-leading-icon .mdc-floating-label {\n        inset-inline-start: 48px;\n        inset-inline-end: initial;\n        direction: var(--direction);\n      }\n      .mdc-select .mdc-select__anchor {\n        padding-inline-start: var(--ha-space-4);\n        padding-inline-end: 0px;\n        direction: var(--direction);\n      }\n      .mdc-select__anchor .mdc-floating-label--float-above {\n        transform-origin: var(--float-start);\n      }\n      .mdc-select__selected-text-container {\n        padding-inline-end: var(--select-selected-text-padding-end, 0px);\n      }\n      :host([clearable]) .mdc-select__selected-text-container {\n        padding-inline-end: var(\n          --select-selected-text-padding-end,\n          var(--ha-space-4)\n        );\n      }\n      ha-icon-button {\n        position: absolute;\n        top: 10px;\n        right: 28px;\n        --mdc-icon-button-size: 36px;\n        --mdc-icon-size: 20px;\n        color: var(--secondary-text-color);\n        inset-inline-start: initial;\n        inset-inline-end: 28px;\n        direction: var(--direction);\n      }\n      .inline-arrow {\n        flex-grow: 0;\n      }\n    `,\n  ];\n}\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-select\": HaSelect;\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { AssistPipelineSelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-assist-pipeline-picker\";\n\n@customElement(\"ha-selector-assist_pipeline\")\nexport class HaAssistPipelineSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: AssistPipelineSelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  protected render() {\n    return html`\n      <ha-assist-pipeline-picker\n        .hass=${this.hass}\n        .value=${this.value}\n        .label=${this.label}\n        .helper=${this.helper}\n        .disabled=${this.disabled}\n        .required=${this.required}\n        .includeLastUsed=${Boolean(\n          this.selector.assist_pipeline?.include_last_used\n        )}\n      ></ha-assist-pipeline-picker>\n    `;\n  }\n\n  static styles = css`\n    ha-conversation-agent-picker {\n      width: 100%;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-assist_pipeline\": HaAssistPipelineSelector;\n  }\n}\n","import type { HomeAssistant } from \"../types\";\nimport type { ConversationResult } from \"./conversation\";\nimport type { SpeechMetadata } from \"./stt\";\n\nexport interface AssistPipeline {\n  id: string;\n  name: string;\n  language: string;\n  conversation_engine: string;\n  conversation_language: string | null;\n  prefer_local_intents?: boolean;\n  stt_engine: string | null;\n  stt_language: string | null;\n  tts_engine: string | null;\n  tts_language: string | null;\n  tts_voice: string | null;\n  wake_word_entity: string | null;\n  wake_word_id: string | null;\n}\n\nexport interface AssistDevice {\n  device_id: string;\n  pipeline_entity: string;\n}\n\nexport interface AssistPipelineMutableParams {\n  name: string;\n  language: string;\n  conversation_engine: string;\n  conversation_language: string | null;\n  prefer_local_intents?: boolean;\n  stt_engine: string | null;\n  stt_language: string | null;\n  tts_engine: string | null;\n  tts_language: string | null;\n  tts_voice: string | null;\n  wake_word_entity: string | null;\n  wake_word_id: string | null;\n}\n\nexport interface AssistRunListing {\n  pipeline_run_id: string;\n  timestamp: string;\n}\n\ninterface PipelineEventBase {\n  timestamp: string;\n}\n\ninterface PipelineRunStartEvent extends PipelineEventBase {\n  type: \"run-start\";\n  data: {\n    pipeline: string;\n    language: string;\n    conversation_id: string;\n    runner_data: {\n      stt_binary_handler_id: number | null;\n      timeout: number;\n    };\n    tts_output?: {\n      token: string;\n      url: string;\n      mime_type: string;\n    };\n  };\n}\ninterface PipelineRunEndEvent extends PipelineEventBase {\n  type: \"run-end\";\n  data: Record<string, never>;\n}\n\ninterface PipelineErrorEvent extends PipelineEventBase {\n  type: \"error\";\n  data: {\n    code: string;\n    message: string;\n  };\n}\n\ninterface PipelineWakeWordStartEvent extends PipelineEventBase {\n  type: \"wake_word-start\";\n  data: {\n    engine: string;\n    metadata: SpeechMetadata;\n  };\n}\n\ninterface PipelineWakeWordEndEvent extends PipelineEventBase {\n  type: \"wake_word-end\";\n  data: { wake_word_output: { ww_id: string; timestamp: number } };\n}\n\ninterface PipelineSTTStartEvent extends PipelineEventBase {\n  type: \"stt-start\";\n  data: {\n    engine: string;\n    metadata: SpeechMetadata;\n  };\n}\ninterface PipelineSTTEndEvent extends PipelineEventBase {\n  type: \"stt-end\";\n  data: {\n    stt_output: { text: string };\n  };\n}\n\ninterface PipelineIntentStartEvent extends PipelineEventBase {\n  type: \"intent-start\";\n  data: {\n    engine: string;\n    language: string;\n    prefer_local_intents: boolean;\n    intent_input: string;\n  };\n}\n\nexport interface ConversationChatLogAssistantDelta {\n  role: \"assistant\";\n  content: string;\n  tool_calls: {\n    id: string;\n    tool_name: string;\n    tool_args: Record<string, unknown>;\n  }[];\n}\n\nexport interface ConversationChatLogToolResultDelta {\n  role: \"tool_result\";\n  agent_id: string;\n  tool_call_id: string;\n  tool_name: string;\n  tool_result: unknown;\n}\ninterface PipelineIntentProgressEvent extends PipelineEventBase {\n  type: \"intent-progress\";\n  data: {\n    tts_start_streaming?: boolean;\n    chat_log_delta?:\n      | Partial<ConversationChatLogAssistantDelta>\n      // These always come in 1 chunk\n      | ConversationChatLogToolResultDelta;\n  };\n}\n\ninterface PipelineIntentEndEvent extends PipelineEventBase {\n  type: \"intent-end\";\n  data: {\n    processed_locally: boolean;\n    intent_output: ConversationResult;\n  };\n}\n\ninterface PipelineTTSStartEvent extends PipelineEventBase {\n  type: \"tts-start\";\n  data: {\n    engine: string;\n    language: string;\n    voice: string;\n    tts_input: string;\n  };\n}\ninterface PipelineTTSEndEvent extends PipelineEventBase {\n  type: \"tts-end\";\n  data: {\n    tts_output: {\n      media_id: string;\n      token: string;\n      url: string;\n      mime_type: string;\n    };\n  };\n}\n\nexport type PipelineRunEvent =\n  | PipelineRunStartEvent\n  | PipelineRunEndEvent\n  | PipelineErrorEvent\n  | PipelineWakeWordStartEvent\n  | PipelineWakeWordEndEvent\n  | PipelineSTTStartEvent\n  | PipelineSTTEndEvent\n  | PipelineIntentStartEvent\n  | PipelineIntentProgressEvent\n  | PipelineIntentEndEvent\n  | PipelineTTSStartEvent\n  | PipelineTTSEndEvent;\n\nexport type PipelineRunOptions = (\n  | {\n      start_stage: \"intent\" | \"tts\";\n      input: { text: string };\n    }\n  | {\n      start_stage: \"stt\";\n      input: { sample_rate: number };\n    }\n  | {\n      start_stage: \"wake_word\";\n      input: {\n        sample_rate: number;\n        timeout?: number;\n        audio_seconds_to_buffer?: number;\n      };\n    }\n) & {\n  end_stage: \"stt\" | \"intent\" | \"tts\";\n  pipeline?: string;\n  conversation_id?: string | null;\n};\n\nexport interface PipelineRun {\n  init_options?: PipelineRunOptions;\n  events: PipelineRunEvent[];\n  stage: \"ready\" | \"wake_word\" | \"stt\" | \"intent\" | \"tts\" | \"done\" | \"error\";\n  run: PipelineRunStartEvent[\"data\"];\n  error?: PipelineErrorEvent[\"data\"];\n  started: Date;\n  finished?: Date;\n  wake_word?: PipelineWakeWordStartEvent[\"data\"] &\n    Partial<PipelineWakeWordEndEvent[\"data\"]> & { done: boolean };\n  stt?: PipelineSTTStartEvent[\"data\"] &\n    Partial<PipelineSTTEndEvent[\"data\"]> & { done: boolean };\n  intent?: PipelineIntentStartEvent[\"data\"] &\n    Partial<PipelineIntentEndEvent[\"data\"]> & { done: boolean };\n  tts?: PipelineTTSStartEvent[\"data\"] &\n    Partial<PipelineTTSEndEvent[\"data\"]> & { done: boolean };\n}\n\nexport const processEvent = (\n  run: PipelineRun | undefined,\n  event: PipelineRunEvent,\n  options?: PipelineRunOptions\n): PipelineRun | undefined => {\n  if (event.type === \"run-start\") {\n    run = {\n      init_options: options,\n      stage: \"ready\",\n      run: event.data,\n      events: [event],\n      started: new Date(event.timestamp),\n    };\n    return run;\n  }\n\n  if (!run) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Received unexpected event before receiving session\", event);\n    return undefined;\n  }\n\n  if (event.type === \"wake_word-start\") {\n    run = {\n      ...run,\n      stage: \"wake_word\",\n      wake_word: { ...event.data, done: false },\n    };\n  } else if (event.type === \"wake_word-end\") {\n    run = {\n      ...run,\n      wake_word: { ...run.wake_word!, ...event.data, done: true },\n    };\n  } else if (event.type === \"stt-start\") {\n    run = {\n      ...run,\n      stage: \"stt\",\n      stt: { ...event.data, done: false },\n    };\n  } else if (event.type === \"stt-end\") {\n    run = {\n      ...run,\n      stt: { ...run.stt!, ...event.data, done: true },\n    };\n  } else if (event.type === \"intent-start\") {\n    run = {\n      ...run,\n      stage: \"intent\",\n      intent: { ...event.data, done: false },\n    };\n  } else if (event.type === \"intent-end\") {\n    run = {\n      ...run,\n      intent: { ...run.intent!, ...event.data, done: true },\n    };\n  } else if (event.type === \"tts-start\") {\n    run = {\n      ...run,\n      stage: \"tts\",\n      tts: { ...event.data, done: false },\n    };\n  } else if (event.type === \"tts-end\") {\n    run = {\n      ...run,\n      tts: { ...run.tts!, ...event.data, done: true },\n    };\n  } else if (event.type === \"run-end\") {\n    run = { ...run, finished: new Date(event.timestamp), stage: \"done\" };\n  } else if (event.type === \"error\") {\n    run = {\n      ...run,\n      finished: new Date(event.timestamp),\n      stage: \"error\",\n      error: event.data,\n    };\n  } else {\n    run = { ...run };\n  }\n\n  run.events = [...run.events, event];\n\n  return run;\n};\n\nexport const runDebugAssistPipeline = (\n  hass: HomeAssistant,\n  callback: (run: PipelineRun) => void,\n  options: PipelineRunOptions\n) => {\n  let run: PipelineRun | undefined;\n\n  const unsubProm = runAssistPipeline(\n    hass,\n    (updateEvent) => {\n      run = processEvent(run, updateEvent, options);\n\n      if (updateEvent.type === \"run-end\" || updateEvent.type === \"error\") {\n        unsubProm.then((unsub) => unsub());\n      }\n\n      if (run) {\n        callback(run);\n      }\n    },\n    options\n  );\n\n  return unsubProm;\n};\n\nexport const runAssistPipeline = (\n  hass: HomeAssistant,\n  callback: (event: PipelineRunEvent) => void,\n  options: PipelineRunOptions\n) =>\n  hass.connection.subscribeMessage<PipelineRunEvent>(callback, {\n    ...options,\n    type: \"assist_pipeline/run\",\n  });\n\nexport const listAssistPipelineRuns = (\n  hass: HomeAssistant,\n  pipeline_id: string\n) =>\n  hass.callWS<{\n    pipeline_runs: AssistRunListing[];\n  }>({\n    type: \"assist_pipeline/pipeline_debug/list\",\n    pipeline_id,\n  });\n\nexport const getAssistPipelineRun = (\n  hass: HomeAssistant,\n  pipeline_id: string,\n  pipeline_run_id: string\n) =>\n  hass.callWS<{\n    events: PipelineRunEvent[];\n  }>({\n    type: \"assist_pipeline/pipeline_debug/get\",\n    pipeline_id,\n    pipeline_run_id,\n  });\n\nexport const listAssistPipelines = (hass: HomeAssistant) =>\n  hass.callWS<{\n    pipelines: AssistPipeline[];\n    preferred_pipeline: string | null;\n  }>({\n    type: \"assist_pipeline/pipeline/list\",\n  });\n\nexport const getAssistPipeline = (hass: HomeAssistant, pipeline_id?: string) =>\n  hass.callWS<AssistPipeline>({\n    type: \"assist_pipeline/pipeline/get\",\n    pipeline_id,\n  });\n\nexport const createAssistPipeline = (\n  hass: HomeAssistant,\n  pipeline: AssistPipelineMutableParams\n) =>\n  hass.callWS<AssistPipeline>({\n    type: \"assist_pipeline/pipeline/create\",\n    ...pipeline,\n  });\n\nexport const updateAssistPipeline = (\n  hass: HomeAssistant,\n  pipeline_id: string,\n  pipeline: AssistPipelineMutableParams\n) =>\n  hass.callWS<AssistPipeline>({\n    type: \"assist_pipeline/pipeline/update\",\n    pipeline_id,\n    ...pipeline,\n  });\n\nexport const setAssistPipelinePreferred = (\n  hass: HomeAssistant,\n  pipeline_id: string\n) =>\n  hass.callWS({\n    type: \"assist_pipeline/pipeline/set_preferred\",\n    pipeline_id,\n  });\n\nexport const deleteAssistPipeline = (hass: HomeAssistant, pipelineId: string) =>\n  hass.callWS<undefined>({\n    type: \"assist_pipeline/pipeline/delete\",\n    pipeline_id: pipelineId,\n  });\n\nexport const fetchAssistPipelineLanguages = (hass: HomeAssistant) =>\n  hass.callWS<{ languages: string[] }>({\n    type: \"assist_pipeline/language/list\",\n  });\n\nexport const listAssistDevices = (hass: HomeAssistant) =>\n  hass.callWS<AssistDevice[]>({\n    type: \"assist_pipeline/device/list\",\n  });\n"],"names":["stopPropagation","ev","formatLanguageCode","languageCode","locale","formatLanguageCodeMem","of","memoizeOne","Intl","DisplayNames","language","type","fallback","PREFERRED","LAST_USED","HaAssistPipelinePicker","LitElement","_default","this","includeLastUsed","render","_pipelines","nothing","value","html","label","hass","localize","required","disabled","_changed","preferred","find","pipeline","id","_preferredPipeline","name","map","firstUpdated","changedProperties","super","listAssistPipelines","then","pipelines","preferred_pipeline","target","undefined","fireEvent","args","styles","css","attribute","Boolean","reflect","HaList","ListBase","HaMenu","MenuBase","listElement","listElement_","renderRoot","querySelector","renderList","itemRoles","innerRole","classes","renderListClasses","innerAriaLabel","multi","classMap","wrapFocus","activatable","onAction","HaSelect","SelectBase","clearable","_clearValue","renderMenu","getMenuClasses","fixedMenuPosition","naturalMenuWidth","menuOpen","anchorElement","onSelected","onOpened","onClosed","onItemsUpdated","handleTypeahead","renderMenuContent","renderLeadingIcon","icon","connectedCallback","window","addEventListener","_translationsUpdated","inlineArrow","shadowRoot","classList","add","updated","has","textContainerElement","remove","get","layoutOptions","selectByValue","disconnectedCallback","removeEventListener","valueSetDirectly","select","mdcFoundation","handleChange","debounce","nextRender","HaAssistPipelineSelector","helper","selector","assist_pipeline","include_last_used","processEvent","run","event","options","init_options","stage","data","events","started","Date","timestamp","wake_word","done","stt","intent","tts","finished","error","console","warn","runAssistPipeline","callback","connection","subscribeMessage","callWS","getAssistPipeline","pipeline_id","createAssistPipeline","updateAssistPipeline","fetchAssistPipelineLanguages"],"mappings":"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"}