{"version":3,"file":"3464.37a8900647c67fb4.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/ha-floor-icon.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-tree-indicator.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/area_floor.ts","webpack://knx-frontend/./homeassistant-frontend/src/common/areas/areas-floor-hierarchy.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/label_registry.ts","webpack://knx-frontend/./homeassistant-frontend/src/data/target.ts"],"sourcesContent":["import {\n  mdiHome,\n  mdiHomeFloor0,\n  mdiHomeFloor1,\n  mdiHomeFloor2,\n  mdiHomeFloor3,\n  mdiHomeFloorNegative1,\n} from \"@mdi/js\";\nimport { LitElement, html, nothing } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { FloorRegistryEntry } from \"../data/floor_registry\";\nimport \"./ha-icon\";\nimport \"./ha-svg-icon\";\n\nexport const floorDefaultIconPath = (\n  floor: Pick<FloorRegistryEntry, \"level\">\n) => {\n  switch (floor.level) {\n    case 0:\n      return mdiHomeFloor0;\n    case 1:\n      return mdiHomeFloor1;\n    case 2:\n      return mdiHomeFloor2;\n    case 3:\n      return mdiHomeFloor3;\n    case -1:\n      return mdiHomeFloorNegative1;\n  }\n  return mdiHome;\n};\n\nexport const floorDefaultIcon = (floor: Pick<FloorRegistryEntry, \"level\">) => {\n  switch (floor.level) {\n    case 0:\n      return \"mdi:home-floor-0\";\n    case 1:\n      return \"mdi:home-floor-1\";\n    case 2:\n      return \"mdi:home-floor-2\";\n    case 3:\n      return \"mdi:home-floor-3\";\n    case -1:\n      return \"mdi:home-floor-negative-1\";\n  }\n  return \"mdi:home\";\n};\n\n@customElement(\"ha-floor-icon\")\nexport class HaFloorIcon extends LitElement {\n  @property({ attribute: false }) public floor?: Pick<\n    FloorRegistryEntry,\n    \"icon\" | \"level\"\n  >;\n\n  @property() public icon?: string;\n\n  protected render() {\n    if (!this.floor) {\n      return nothing;\n    }\n    if (this.floor.icon) {\n      return html`<ha-icon .icon=${this.floor.icon}></ha-icon>`;\n    }\n    const defaultPath = floorDefaultIconPath(this.floor);\n\n    return html`<ha-svg-icon .path=${defaultPath}></ha-svg-icon>`;\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-floor-icon\": HaFloorIcon;\n  }\n}\n","import type { TemplateResult } from \"lit\";\nimport { LitElement, css, html } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\n\n@customElement(\"ha-tree-indicator\")\nexport class HaTreeIndicator extends LitElement {\n  @property({ type: Boolean, reflect: true })\n  public end?: boolean = false;\n\n  protected render(): TemplateResult {\n    return html`\n      <svg width=\"100%\" height=\"100%\" viewBox=\"0 0 48 48\">\n        <line x1=\"24\" y1=\"0\" x2=\"24\" y2=${this.end ? \"24\" : \"48\"}></line>\n        <line x1=\"24\" y1=\"24\" x2=\"36\" y2=\"24\"></line>\n      </svg>\n    `;\n  }\n\n  static styles = css`\n    :host {\n      display: block;\n      width: 48px;\n      height: 48px;\n    }\n    line {\n      stroke: var(--divider-color);\n      stroke-width: 2;\n      stroke-dasharray: 2;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-tree-indicator\": HaTreeIndicator;\n  }\n}\n","import { getAreasFloorHierarchy } from \"../common/areas/areas-floor-hierarchy\";\nimport { computeAreaName } from \"../common/entity/compute_area_name\";\nimport { computeDomain } from \"../common/entity/compute_domain\";\nimport { computeFloorName } from \"../common/entity/compute_floor_name\";\nimport type { HaDevicePickerDeviceFilterFunc } from \"../components/device/ha-device-picker\";\nimport type { PickerComboBoxItem } from \"../components/ha-picker-combo-box\";\nimport type { HomeAssistant } from \"../types\";\nimport type { AreaRegistryEntry } from \"./area_registry\";\nimport {\n  getDeviceEntityDisplayLookup,\n  type DeviceEntityDisplayLookup,\n  type DeviceRegistryEntry,\n} from \"./device_registry\";\nimport type { HaEntityPickerEntityFilterFunc } from \"./entity\";\nimport type { EntityRegistryDisplayEntry } from \"./entity_registry\";\nimport type { FloorRegistryEntry } from \"./floor_registry\";\n\nexport interface FloorComboBoxItem extends PickerComboBoxItem {\n  type: \"floor\" | \"area\";\n  floor?: FloorRegistryEntry;\n  area?: AreaRegistryEntry;\n}\n\nexport interface FloorNestedComboBoxItem extends PickerComboBoxItem {\n  floor?: FloorRegistryEntry;\n  areas: FloorComboBoxItem[];\n}\n\nexport interface UnassignedAreasFloorComboBoxItem extends PickerComboBoxItem {\n  areas: FloorComboBoxItem[];\n}\n\nexport interface AreaFloorValue {\n  id: string;\n  type: \"floor\" | \"area\";\n}\n\nexport const getAreasNestedInFloors = (\n  states: HomeAssistant[\"states\"],\n  haFloors: HomeAssistant[\"floors\"],\n  haAreas: HomeAssistant[\"areas\"],\n  haDevices: HomeAssistant[\"devices\"],\n  haEntities: HomeAssistant[\"entities\"],\n  formatId: (value: AreaFloorValue) => string,\n  includeDomains?: string[],\n  excludeDomains?: string[],\n  includeDeviceClasses?: string[],\n  deviceFilter?: HaDevicePickerDeviceFilterFunc,\n  entityFilter?: HaEntityPickerEntityFilterFunc,\n  excludeAreas?: string[],\n  excludeFloors?: string[]\n) =>\n  getAreasAndFloorsItems(\n    states,\n    haFloors,\n    haAreas,\n    haDevices,\n    haEntities,\n    formatId,\n    includeDomains,\n    excludeDomains,\n    includeDeviceClasses,\n    deviceFilter,\n    entityFilter,\n    excludeAreas,\n    excludeFloors,\n    true\n  ) as (FloorNestedComboBoxItem | UnassignedAreasFloorComboBoxItem)[];\n\nexport const getAreasAndFloors = (\n  states: HomeAssistant[\"states\"],\n  haFloors: HomeAssistant[\"floors\"],\n  haAreas: HomeAssistant[\"areas\"],\n  haDevices: HomeAssistant[\"devices\"],\n  haEntities: HomeAssistant[\"entities\"],\n  formatId: (value: AreaFloorValue) => string,\n  includeDomains?: string[],\n  excludeDomains?: string[],\n  includeDeviceClasses?: string[],\n  deviceFilter?: HaDevicePickerDeviceFilterFunc,\n  entityFilter?: HaEntityPickerEntityFilterFunc,\n  excludeAreas?: string[],\n  excludeFloors?: string[]\n) =>\n  getAreasAndFloorsItems(\n    states,\n    haFloors,\n    haAreas,\n    haDevices,\n    haEntities,\n    formatId,\n    includeDomains,\n    excludeDomains,\n    includeDeviceClasses,\n    deviceFilter,\n    entityFilter,\n    excludeAreas,\n    excludeFloors\n  ) as FloorComboBoxItem[];\n\nconst getAreasAndFloorsItems = (\n  states: HomeAssistant[\"states\"],\n  haFloors: HomeAssistant[\"floors\"],\n  haAreas: HomeAssistant[\"areas\"],\n  haDevices: HomeAssistant[\"devices\"],\n  haEntities: HomeAssistant[\"entities\"],\n  formatId: (value: AreaFloorValue) => string,\n  includeDomains?: string[],\n  excludeDomains?: string[],\n  includeDeviceClasses?: string[],\n  deviceFilter?: HaDevicePickerDeviceFilterFunc,\n  entityFilter?: HaEntityPickerEntityFilterFunc,\n  excludeAreas?: string[],\n  excludeFloors?: string[],\n  nested = false\n): (\n  | FloorComboBoxItem\n  | FloorNestedComboBoxItem\n  | UnassignedAreasFloorComboBoxItem\n)[] => {\n  const floors = Object.values(haFloors);\n  const areas = Object.values(haAreas);\n  const devices = Object.values(haDevices);\n  const entities = Object.values(haEntities);\n\n  let deviceEntityLookup: DeviceEntityDisplayLookup = {};\n  let inputDevices: DeviceRegistryEntry[] | undefined;\n  let inputEntities: EntityRegistryDisplayEntry[] | undefined;\n\n  if (\n    includeDomains ||\n    excludeDomains ||\n    includeDeviceClasses ||\n    deviceFilter ||\n    entityFilter\n  ) {\n    deviceEntityLookup = getDeviceEntityDisplayLookup(entities);\n    inputDevices = devices;\n    inputEntities = entities.filter((entity) => entity.area_id);\n\n    if (includeDomains) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return false;\n        }\n        return deviceEntityLookup[device.id].some((entity) =>\n          includeDomains.includes(computeDomain(entity.entity_id))\n        );\n      });\n      inputEntities = inputEntities!.filter((entity) =>\n        includeDomains.includes(computeDomain(entity.entity_id))\n      );\n    }\n\n    if (excludeDomains) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return true;\n        }\n        return entities.every(\n          (entity) => !excludeDomains.includes(computeDomain(entity.entity_id))\n        );\n      });\n      inputEntities = inputEntities!.filter(\n        (entity) => !excludeDomains.includes(computeDomain(entity.entity_id))\n      );\n    }\n\n    if (includeDeviceClasses) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return false;\n        }\n        return deviceEntityLookup[device.id].some((entity) => {\n          const stateObj = states[entity.entity_id];\n          if (!stateObj) {\n            return false;\n          }\n          return (\n            stateObj.attributes.device_class &&\n            includeDeviceClasses.includes(stateObj.attributes.device_class)\n          );\n        });\n      });\n      inputEntities = inputEntities!.filter((entity) => {\n        const stateObj = states[entity.entity_id];\n        return (\n          stateObj.attributes.device_class &&\n          includeDeviceClasses.includes(stateObj.attributes.device_class)\n        );\n      });\n    }\n\n    if (deviceFilter) {\n      inputDevices = inputDevices!.filter((device) => deviceFilter!(device));\n    }\n\n    if (entityFilter) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return false;\n        }\n        return deviceEntityLookup[device.id].some((entity) => {\n          const stateObj = states[entity.entity_id];\n          if (!stateObj) {\n            return false;\n          }\n          return entityFilter(stateObj);\n        });\n      });\n      inputEntities = inputEntities!.filter((entity) => {\n        const stateObj = states[entity.entity_id];\n        if (!stateObj) {\n          return false;\n        }\n        return entityFilter!(stateObj);\n      });\n    }\n  }\n\n  let outputAreas = areas;\n  let outputFloors = floors;\n\n  let areaIds: string[] | undefined;\n\n  if (inputDevices) {\n    areaIds = inputDevices\n      .filter((device) => device.area_id)\n      .map((device) => device.area_id!);\n  }\n\n  if (inputEntities) {\n    areaIds = (areaIds ?? []).concat(\n      inputEntities\n        .filter((entity) => entity.area_id)\n        .map((entity) => entity.area_id!)\n    );\n  }\n\n  if (areaIds) {\n    outputAreas = outputAreas.filter((area) => areaIds!.includes(area.area_id));\n  }\n\n  if (excludeAreas) {\n    outputAreas = outputAreas.filter(\n      (area) => !excludeAreas!.includes(area.area_id)\n    );\n  }\n\n  if (excludeFloors) {\n    outputAreas = outputAreas.filter(\n      (area) => !area.floor_id || !excludeFloors!.includes(area.floor_id)\n    );\n\n    outputFloors = outputFloors.filter(\n      (floor) => !excludeFloors!.includes(floor.floor_id)\n    );\n  }\n\n  if (\n    entityFilter ||\n    deviceFilter ||\n    includeDomains ||\n    excludeDomains ||\n    includeDeviceClasses\n  ) {\n    // Ensure we only include floors that have areas with the filtered entities/devices\n    const validFloorIds = new Set(\n      outputAreas.map((area) => area.floor_id).filter((id) => id)\n    );\n    outputFloors = outputFloors.filter((floor) =>\n      validFloorIds.has(floor.floor_id)\n    );\n  }\n\n  const hierarchy = getAreasFloorHierarchy(outputFloors, outputAreas);\n\n  const items: (\n    | FloorComboBoxItem\n    | FloorNestedComboBoxItem\n    | UnassignedAreasFloorComboBoxItem\n  )[] = [];\n\n  hierarchy.floors.forEach((f) => {\n    const floor = haFloors[f.id];\n    const floorAreas = f.areas.map((areaId) => haAreas[areaId]);\n\n    const floorName = computeFloorName(floor);\n\n    const areaSearchLabels = floorAreas\n      .map((area) => {\n        const areaName = computeAreaName(area);\n        return [area.area_id, ...(areaName ? [areaName] : []), ...area.aliases];\n      })\n      .flat();\n\n    const floorItem: FloorComboBoxItem | FloorNestedComboBoxItem = {\n      id: formatId({ id: floor.floor_id, type: \"floor\" }),\n      type: \"floor\",\n      primary: floorName,\n      floor: floor,\n      icon: floor.icon || undefined,\n      search_labels: [\n        floor.floor_id,\n        floorName,\n        ...floor.aliases,\n        ...areaSearchLabels,\n      ],\n    };\n\n    items.push(floorItem);\n\n    const floorAreasItems = floorAreas.map((area) => {\n      const areaName = computeAreaName(area);\n      return {\n        id: formatId({ id: area.area_id, type: \"area\" }),\n        type: \"area\" as const,\n        primary: areaName || area.area_id,\n        area: area,\n        icon: area.icon || undefined,\n        search_labels: [\n          area.area_id,\n          ...(areaName ? [areaName] : []),\n          ...area.aliases,\n        ],\n      };\n    });\n\n    if (nested && floor) {\n      (floorItem as unknown as FloorNestedComboBoxItem).areas = floorAreasItems;\n    } else {\n      items.push(...floorAreasItems);\n    }\n  });\n\n  const unassignedAreaItems = hierarchy.areas.map((areaId) => {\n    const area = haAreas[areaId];\n    const areaName = computeAreaName(area) || area.area_id;\n    return {\n      id: formatId({ id: area.area_id, type: \"area\" }),\n      type: \"area\" as const,\n      primary: areaName,\n      area: area,\n      icon: area.icon || undefined,\n      search_labels: [area.area_id, areaName, ...area.aliases],\n    };\n  });\n\n  if (nested && unassignedAreaItems.length) {\n    items.push({\n      areas: unassignedAreaItems,\n    } as UnassignedAreasFloorComboBoxItem);\n  } else {\n    items.push(...unassignedAreaItems);\n  }\n\n  return items;\n};\n","import type { AreaRegistryEntry } from \"../../data/area_registry\";\nimport type { FloorRegistryEntry } from \"../../data/floor_registry\";\n\nexport interface AreasFloorHierarchy {\n  floors: {\n    id: string;\n    areas: string[];\n  }[];\n  areas: string[];\n}\n\nexport const getAreasFloorHierarchy = (\n  floors: FloorRegistryEntry[],\n  areas: AreaRegistryEntry[]\n): AreasFloorHierarchy => {\n  const floorAreas = new Map<string, string[]>();\n  const unassignedAreas: string[] = [];\n\n  for (const area of areas) {\n    if (area.floor_id) {\n      if (!floorAreas.has(area.floor_id)) {\n        floorAreas.set(area.floor_id, []);\n      }\n      floorAreas.get(area.floor_id)!.push(area.area_id);\n    } else {\n      unassignedAreas.push(area.area_id);\n    }\n  }\n\n  const hierarchy: AreasFloorHierarchy = {\n    floors: floors.map((floor) => ({\n      id: floor.floor_id,\n      areas: floorAreas.get(floor.floor_id) || [],\n    })),\n    areas: unassignedAreas,\n  };\n\n  return hierarchy;\n};\n\nexport const getAreasOrder = (hierarchy: AreasFloorHierarchy): string[] => {\n  const order: string[] = [];\n\n  for (const floor of hierarchy.floors) {\n    order.push(...floor.areas);\n  }\n  order.push(...hierarchy.areas);\n\n  return order;\n};\n\nexport const getFloorOrder = (hierarchy: AreasFloorHierarchy): string[] =>\n  hierarchy.floors.map((floor) => floor.id);\n","import { mdiLabel } from \"@mdi/js\";\nimport type { Connection } from \"home-assistant-js-websocket\";\nimport { createCollection } from \"home-assistant-js-websocket\";\nimport type { Store } from \"home-assistant-js-websocket/dist/store\";\nimport { computeDomain } from \"../common/entity/compute_domain\";\nimport { stringCompare } from \"../common/string/compare\";\nimport { debounce } from \"../common/util/debounce\";\nimport type { HaDevicePickerDeviceFilterFunc } from \"../components/device/ha-device-picker\";\nimport type { PickerComboBoxItem } from \"../components/ha-picker-combo-box\";\nimport type { HomeAssistant } from \"../types\";\nimport {\n  getDeviceEntityDisplayLookup,\n  type DeviceEntityDisplayLookup,\n  type DeviceRegistryEntry,\n} from \"./device_registry\";\nimport type { HaEntityPickerEntityFilterFunc } from \"./entity\";\nimport type { EntityRegistryDisplayEntry } from \"./entity_registry\";\nimport type { RegistryEntry } from \"./registry\";\n\nexport interface LabelRegistryEntry extends RegistryEntry {\n  label_id: string;\n  name: string;\n  icon: string | null;\n  color: string | null;\n  description: string | null;\n}\n\nexport interface LabelRegistryEntryMutableParams {\n  name: string;\n  icon?: string | null;\n  color?: string | null;\n  description?: string | null;\n}\n\nexport const fetchLabelRegistry = (conn: Connection) =>\n  conn\n    .sendMessagePromise({\n      type: \"config/label_registry/list\",\n    })\n    .then((labels) =>\n      (labels as LabelRegistryEntry[]).sort((ent1, ent2) =>\n        stringCompare(ent1.name, ent2.name)\n      )\n    );\n\nexport const subscribeLabelRegistryUpdates = (\n  conn: Connection,\n  store: Store<LabelRegistryEntry[]>\n) =>\n  conn.subscribeEvents(\n    debounce(\n      () =>\n        fetchLabelRegistry(conn).then((labels: LabelRegistryEntry[]) =>\n          store.setState(labels, true)\n        ),\n      500,\n      true\n    ),\n    \"label_registry_updated\"\n  );\n\nexport const subscribeLabelRegistry = (\n  conn: Connection,\n  onChange: (labels: LabelRegistryEntry[]) => void\n) =>\n  createCollection<LabelRegistryEntry[]>(\n    \"_labelRegistry\",\n    fetchLabelRegistry,\n    subscribeLabelRegistryUpdates,\n    conn,\n    onChange\n  );\n\nexport const createLabelRegistryEntry = (\n  hass: HomeAssistant,\n  values: LabelRegistryEntryMutableParams\n) =>\n  hass.callWS<LabelRegistryEntry>({\n    type: \"config/label_registry/create\",\n    ...values,\n  });\n\nexport const updateLabelRegistryEntry = (\n  hass: HomeAssistant,\n  labelId: string,\n  updates: Partial<LabelRegistryEntryMutableParams>\n) =>\n  hass.callWS<LabelRegistryEntry>({\n    type: \"config/label_registry/update\",\n    label_id: labelId,\n    ...updates,\n  });\n\nexport const deleteLabelRegistryEntry = (\n  hass: HomeAssistant,\n  labelId: string\n) =>\n  hass.callWS({\n    type: \"config/label_registry/delete\",\n    label_id: labelId,\n  });\n\nexport const getLabels = (\n  hassStates: HomeAssistant[\"states\"],\n  hassAreas: HomeAssistant[\"areas\"],\n  hassDevices: HomeAssistant[\"devices\"],\n  hassEntities: HomeAssistant[\"entities\"],\n  labels?: LabelRegistryEntry[],\n  includeDomains?: string[],\n  excludeDomains?: string[],\n  includeDeviceClasses?: string[],\n  deviceFilter?: HaDevicePickerDeviceFilterFunc,\n  entityFilter?: HaEntityPickerEntityFilterFunc,\n  excludeLabels?: string[],\n  idPrefix = \"\"\n): PickerComboBoxItem[] => {\n  if (!labels || labels.length === 0) {\n    return [];\n  }\n\n  const devices = Object.values(hassDevices);\n  const entities = Object.values(hassEntities);\n\n  let deviceEntityLookup: DeviceEntityDisplayLookup = {};\n  let inputDevices: DeviceRegistryEntry[] | undefined;\n  let inputEntities: EntityRegistryDisplayEntry[] | undefined;\n\n  if (\n    includeDomains ||\n    excludeDomains ||\n    includeDeviceClasses ||\n    deviceFilter ||\n    entityFilter\n  ) {\n    deviceEntityLookup = getDeviceEntityDisplayLookup(entities);\n    inputDevices = devices;\n    inputEntities = entities.filter((entity) => entity.labels.length > 0);\n\n    if (includeDomains) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return false;\n        }\n        return deviceEntityLookup[device.id].some((entity) =>\n          includeDomains.includes(computeDomain(entity.entity_id))\n        );\n      });\n      inputEntities = inputEntities!.filter((entity) =>\n        includeDomains.includes(computeDomain(entity.entity_id))\n      );\n    }\n\n    if (excludeDomains) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return true;\n        }\n        return entities.every(\n          (entity) => !excludeDomains.includes(computeDomain(entity.entity_id))\n        );\n      });\n      inputEntities = inputEntities!.filter(\n        (entity) => !excludeDomains.includes(computeDomain(entity.entity_id))\n      );\n    }\n\n    if (includeDeviceClasses) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return false;\n        }\n        return deviceEntityLookup[device.id].some((entity) => {\n          const stateObj = hassStates[entity.entity_id];\n          if (!stateObj) {\n            return false;\n          }\n          return (\n            stateObj.attributes.device_class &&\n            includeDeviceClasses.includes(stateObj.attributes.device_class)\n          );\n        });\n      });\n      inputEntities = inputEntities!.filter((entity) => {\n        const stateObj = hassStates[entity.entity_id];\n        return (\n          stateObj &&\n          stateObj.attributes.device_class &&\n          includeDeviceClasses.includes(stateObj.attributes.device_class)\n        );\n      });\n    }\n\n    if (deviceFilter) {\n      inputDevices = inputDevices!.filter((device) => deviceFilter!(device));\n    }\n\n    if (entityFilter) {\n      inputDevices = inputDevices!.filter((device) => {\n        const devEntities = deviceEntityLookup[device.id];\n        if (!devEntities || !devEntities.length) {\n          return false;\n        }\n        return deviceEntityLookup[device.id].some((entity) => {\n          const stateObj = hassStates[entity.entity_id];\n          if (!stateObj) {\n            return false;\n          }\n          return entityFilter(stateObj);\n        });\n      });\n      inputEntities = inputEntities!.filter((entity) => {\n        const stateObj = hassStates[entity.entity_id];\n        if (!stateObj) {\n          return false;\n        }\n        return entityFilter!(stateObj);\n      });\n    }\n  }\n\n  let outputLabels = labels;\n  const usedLabels = new Set<string>();\n\n  let areaIds: string[] | undefined;\n\n  if (inputDevices) {\n    areaIds = inputDevices\n      .filter((device) => device.area_id)\n      .map((device) => device.area_id!);\n\n    inputDevices.forEach((device) => {\n      device.labels.forEach((label) => usedLabels.add(label));\n    });\n  }\n\n  if (inputEntities) {\n    areaIds = (areaIds ?? []).concat(\n      inputEntities\n        .filter((entity) => entity.area_id)\n        .map((entity) => entity.area_id!)\n    );\n    inputEntities.forEach((entity) => {\n      entity.labels.forEach((label) => usedLabels.add(label));\n    });\n  }\n\n  if (areaIds) {\n    areaIds.forEach((areaId) => {\n      const area = hassAreas[areaId];\n      area?.labels.forEach((label) => usedLabels.add(label));\n    });\n  }\n\n  if (excludeLabels) {\n    outputLabels = outputLabels.filter(\n      (label) => !excludeLabels!.includes(label.label_id)\n    );\n  }\n\n  if (inputDevices || inputEntities) {\n    outputLabels = outputLabels.filter((label) =>\n      usedLabels.has(label.label_id)\n    );\n  }\n\n  const items = outputLabels.map<PickerComboBoxItem>((label) => ({\n    id: `${idPrefix}${label.label_id}`,\n    primary: label.name,\n    secondary: label.description ?? \"\",\n    icon: label.icon || undefined,\n    icon_path: label.icon ? undefined : mdiLabel,\n    sorting_label: label.name,\n    search_labels: [label.name, label.label_id, label.description].filter(\n      (v): v is string => Boolean(v)\n    ),\n  }));\n\n  return items;\n};\n","import type { HassServiceTarget } from \"home-assistant-js-websocket\";\nimport { computeDomain } from \"../common/entity/compute_domain\";\nimport type { HaDevicePickerDeviceFilterFunc } from \"../components/device/ha-device-picker\";\nimport type { PickerComboBoxItem } from \"../components/ha-picker-combo-box\";\nimport type { HomeAssistant } from \"../types\";\nimport type { FloorComboBoxItem } from \"./area_floor\";\nimport type { AreaRegistryEntry } from \"./area_registry\";\nimport type { DevicePickerItem, DeviceRegistryEntry } from \"./device_registry\";\nimport type { HaEntityPickerEntityFilterFunc } from \"./entity\";\nimport type {\n  EntityComboBoxItem,\n  EntityRegistryDisplayEntry,\n} from \"./entity_registry\";\n\nexport const TARGET_SEPARATOR = \"________\";\n\nexport type TargetType = \"entity\" | \"device\" | \"area\" | \"label\" | \"floor\";\nexport type TargetTypeFloorless = Exclude<TargetType, \"floor\">;\n\nexport interface SingleHassServiceTarget {\n  entity_id?: string;\n  device_id?: string;\n  area_id?: string;\n  floor_id?: string;\n  label_id?: string;\n}\n\nexport interface ExtractFromTargetResult {\n  missing_areas: string[];\n  missing_devices: string[];\n  missing_floors: string[];\n  missing_labels: string[];\n  referenced_areas: string[];\n  referenced_devices: string[];\n  referenced_entities: string[];\n}\n\nexport interface ExtractFromTargetResultReferenced {\n  referenced_areas: string[];\n  referenced_devices: string[];\n  referenced_entities: string[];\n}\n\nexport const extractFromTarget = async (\n  hass: HomeAssistant,\n  target: HassServiceTarget\n) =>\n  hass.callWS<ExtractFromTargetResult>({\n    type: \"extract_from_target\",\n    target,\n  });\n\nexport const getTriggersForTarget = async (\n  callWS: HomeAssistant[\"callWS\"],\n  target: HassServiceTarget,\n  expandGroup = true\n) =>\n  callWS<string[]>({\n    type: \"get_triggers_for_target\",\n    target,\n    expand_group: expandGroup,\n  });\n\nexport const getConditionsForTarget = async (\n  callWS: HomeAssistant[\"callWS\"],\n  target: HassServiceTarget,\n  expandGroup = true\n) =>\n  callWS<string[]>({\n    type: \"get_conditions_for_target\",\n    target,\n    expand_group: expandGroup,\n  });\n\nexport const getServicesForTarget = async (\n  callWS: HomeAssistant[\"callWS\"],\n  target: HassServiceTarget,\n  expandGroup = true\n) =>\n  callWS<string[]>({\n    type: \"get_services_for_target\",\n    target,\n    expand_group: expandGroup,\n  });\n\nexport const areaMeetsFilter = (\n  area: AreaRegistryEntry,\n  devices: HomeAssistant[\"devices\"],\n  entities: HomeAssistant[\"entities\"],\n  deviceFilter?: HaDevicePickerDeviceFilterFunc,\n  includeDomains?: string[],\n  includeDeviceClasses?: string[],\n  states?: HomeAssistant[\"states\"],\n  entityFilter?: HaEntityPickerEntityFilterFunc\n): boolean => {\n  const areaDevices = Object.values(devices).filter(\n    (device) => device.area_id === area.area_id\n  );\n\n  if (\n    areaDevices.some((device) =>\n      deviceMeetsFilter(\n        device,\n        entities,\n        deviceFilter,\n        includeDomains,\n        includeDeviceClasses,\n        states,\n        entityFilter\n      )\n    )\n  ) {\n    return true;\n  }\n\n  const areaEntities = Object.values(entities).filter(\n    (entity) => entity.area_id === area.area_id\n  );\n\n  if (\n    areaEntities.some((entity) =>\n      entityRegMeetsFilter(\n        entity,\n        false,\n        includeDomains,\n        includeDeviceClasses,\n        states,\n        entityFilter\n      )\n    )\n  ) {\n    return true;\n  }\n\n  return false;\n};\n\nexport const deviceMeetsFilter = (\n  device: DeviceRegistryEntry,\n  entities: HomeAssistant[\"entities\"],\n  deviceFilter?: HaDevicePickerDeviceFilterFunc,\n  includeDomains?: string[],\n  includeDeviceClasses?: string[],\n  states?: HomeAssistant[\"states\"],\n  entityFilter?: HaEntityPickerEntityFilterFunc\n): boolean => {\n  const devEntities = Object.values(entities).filter(\n    (entity) => entity.device_id === device.id\n  );\n\n  if (\n    !devEntities.some((entity) =>\n      entityRegMeetsFilter(\n        entity,\n        false,\n        includeDomains,\n        includeDeviceClasses,\n        states,\n        entityFilter\n      )\n    )\n  ) {\n    return false;\n  }\n\n  if (deviceFilter) {\n    return deviceFilter(device);\n  }\n\n  return true;\n};\n\nexport const entityRegMeetsFilter = (\n  entity: EntityRegistryDisplayEntry,\n  includeSecondary = false,\n  includeDomains?: string[],\n  includeDeviceClasses?: string[],\n  states?: HomeAssistant[\"states\"],\n  entityFilter?: HaEntityPickerEntityFilterFunc\n): boolean => {\n  if (entity.hidden || (entity.entity_category && !includeSecondary)) {\n    return false;\n  }\n\n  if (\n    includeDomains &&\n    !includeDomains.includes(computeDomain(entity.entity_id))\n  ) {\n    return false;\n  }\n  if (includeDeviceClasses) {\n    const stateObj = states?.[entity.entity_id];\n    if (!stateObj) {\n      return false;\n    }\n    if (\n      !stateObj.attributes.device_class ||\n      !includeDeviceClasses!.includes(stateObj.attributes.device_class)\n    ) {\n      return false;\n    }\n  }\n\n  if (entityFilter) {\n    const stateObj = states?.[entity.entity_id];\n    if (!stateObj) {\n      return false;\n    }\n    return entityFilter!(stateObj);\n  }\n  return true;\n};\n\nexport const getTargetComboBoxItemType = (\n  item:\n    | PickerComboBoxItem\n    | (FloorComboBoxItem & { last?: boolean | undefined })\n    | EntityComboBoxItem\n    | DevicePickerItem\n) => {\n  if (\n    (item as FloorComboBoxItem).type === \"area\" ||\n    (item as FloorComboBoxItem).type === \"floor\"\n  ) {\n    return (item as FloorComboBoxItem).type;\n  }\n\n  if (\"domain\" in item) {\n    return \"device\";\n  }\n\n  if (\"stateObj\" in item) {\n    return \"entity\";\n  }\n\n  if (item.id === \"___EMPTY_SEARCH___\") {\n    return \"empty\";\n  }\n\n  return \"label\";\n};\n"],"names":["floorDefaultIconPath","floor","level","HaFloorIcon","_LitElement","_classCallCheck","_callSuper","arguments","_inherits","_createClass","key","value","this","nothing","icon","html","_t","_","defaultPath","_t2","LitElement","attribute","HaTreeIndicator","_this","concat","args","end","styles","css","type","Boolean","reflect","getAreasNestedInFloors","states","haFloors","haAreas","haDevices","haEntities","formatId","includeDomains","excludeDomains","includeDeviceClasses","deviceFilter","entityFilter","excludeAreas","excludeFloors","getAreasAndFloorsItems","getAreasAndFloors","inputDevices","inputEntities","nested","length","undefined","floors","Object","values","areas","devices","entities","deviceEntityLookup","getDeviceEntityDisplayLookup","filter","entity","area_id","device","devEntities","id","some","includes","computeDomain","entity_id","every","stateObj","attributes","device_class","areaIds","outputAreas","outputFloors","map","area","floor_id","validFloorIds","Set","has","hierarchy","getAreasFloorHierarchy","_step","floorAreas","Map","unassignedAreas","_iterator","_createForOfIteratorHelper","s","n","done","set","get","push","err","e","f","items","forEach","areaId","floorName","computeFloorName","areaSearchLabels","areaName","computeAreaName","_toConsumableArray","aliases","flat","floorItem","primary","search_labels","floorAreasItems","apply","unassignedAreaItems","fetchLabelRegistry","conn","sendMessagePromise","then","labels","sort","ent1","ent2","stringCompare","name","subscribeLabelRegistryUpdates","store","subscribeEvents","debounce","setState","subscribeLabelRegistry","onChange","createCollection","createLabelRegistryEntry","hass","callWS","assign","updateLabelRegistryEntry","labelId","updates","label_id","getLabels","hassStates","hassAreas","hassDevices","hassEntities","excludeLabels","idPrefix","outputLabels","usedLabels","label","add","_label$description","secondary","description","icon_path","sorting_label","v","TARGET_SEPARATOR","extractFromTarget","_ref","_asyncToGenerator","_regenerator","m","_callee","target","w","_context","a","_x","_x2","getTriggersForTarget","_ref2","_callee2","expandGroup","_args2","_context2","expand_group","_x3","_x4","getConditionsForTarget","_ref3","_callee3","_args3","_context3","_x5","_x6","getServicesForTarget","_ref4","_callee4","_args4","_context4","_x7","_x8","areaMeetsFilter","deviceMeetsFilter","entityRegMeetsFilter","device_id","includeSecondary","hidden","entity_category","getTargetComboBoxItemType","item"],"mappings":"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"}