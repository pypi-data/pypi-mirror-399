{"version":3,"file":"4291.b9ff268fe740ee44.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/components/ha-config-entry-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-config-entry.ts","webpack://knx-frontend/./homeassistant-frontend/src/util/brands-url.ts"],"sourcesContent":["import type { ComboBoxLitRenderer } from \"@vaadin/combo-box/lit\";\nimport { html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { caseInsensitiveStringCompare } from \"../common/string/compare\";\nimport type { ConfigEntry } from \"../data/config_entries\";\nimport { getConfigEntries } from \"../data/config_entries\";\nimport { domainToName } from \"../data/integration\";\nimport type { ValueChangedEvent, HomeAssistant } from \"../types\";\nimport { brandsUrl } from \"../util/brands-url\";\nimport \"./ha-combo-box\";\nimport type { HaComboBox } from \"./ha-combo-box\";\nimport \"./ha-combo-box-item\";\n\nexport interface ConfigEntryExtended extends ConfigEntry {\n  localized_domain_name?: string;\n}\n\n@customElement(\"ha-config-entry-picker\")\nclass HaConfigEntryPicker extends LitElement {\n  public hass!: HomeAssistant;\n\n  @property() public integration?: string;\n\n  @property() public label?: string;\n\n  @property() public value = \"\";\n\n  @property() public helper?: string;\n\n  @state() private _configEntries?: ConfigEntryExtended[];\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @query(\"ha-combo-box\") private _comboBox!: HaComboBox;\n\n  public open() {\n    this._comboBox?.open();\n  }\n\n  public focus() {\n    this._comboBox?.focus();\n  }\n\n  protected firstUpdated() {\n    this._getConfigEntries();\n  }\n\n  private _rowRenderer: ComboBoxLitRenderer<ConfigEntryExtended> = (\n    item\n  ) => html`\n    <ha-combo-box-item type=\"button\">\n      <span slot=\"headline\">\n        ${item.title ||\n        this.hass.localize(\n          \"ui.panel.config.integrations.config_entry.unnamed_entry\"\n        )}\n      </span>\n      <span slot=\"supporting-text\">${item.localized_domain_name}</span>\n      <img\n        alt=\"\"\n        slot=\"start\"\n        src=${brandsUrl({\n          domain: item.domain,\n          type: \"icon\",\n          darkOptimized: this.hass.themes?.darkMode,\n        })}\n        crossorigin=\"anonymous\"\n        referrerpolicy=\"no-referrer\"\n        @error=${this._onImageError}\n        @load=${this._onImageLoad}\n      />\n    </ha-combo-box-item>\n  `;\n\n  protected render() {\n    if (!this._configEntries) {\n      return nothing;\n    }\n    return html`\n      <ha-combo-box\n        .hass=${this.hass}\n        .label=${this.label === undefined && this.hass\n          ? this.hass.localize(\"ui.components.config-entry-picker.config_entry\")\n          : this.label}\n        .value=${this._value}\n        .required=${this.required}\n        .disabled=${this.disabled}\n        .helper=${this.helper}\n        .renderer=${this._rowRenderer}\n        .items=${this._configEntries}\n        item-value-path=\"entry_id\"\n        item-id-path=\"entry_id\"\n        item-label-path=\"title\"\n        @value-changed=${this._valueChanged}\n      ></ha-combo-box>\n    `;\n  }\n\n  private _onImageLoad(ev) {\n    ev.target.style.visibility = \"initial\";\n  }\n\n  private _onImageError(ev) {\n    ev.target.style.visibility = \"hidden\";\n  }\n\n  private async _getConfigEntries() {\n    getConfigEntries(this.hass, {\n      type: [\"device\", \"hub\", \"service\"],\n      domain: this.integration,\n    }).then((configEntries) => {\n      this._configEntries = configEntries\n        .map(\n          (entry: ConfigEntry): ConfigEntryExtended => ({\n            ...entry,\n            localized_domain_name: domainToName(\n              this.hass.localize,\n              entry.domain\n            ),\n          })\n        )\n        .sort((conf1, conf2) =>\n          caseInsensitiveStringCompare(\n            conf1.localized_domain_name + conf1.title,\n            conf2.localized_domain_name + conf2.title,\n            this.hass.locale.language\n          )\n        );\n    });\n  }\n\n  private get _value() {\n    return this.value || \"\";\n  }\n\n  private _valueChanged(ev: ValueChangedEvent<string>) {\n    ev.stopPropagation();\n    const newValue = ev.detail.value;\n\n    if (newValue !== this._value) {\n      this._setValue(newValue);\n    }\n  }\n\n  private _setValue(value: string) {\n    this.value = value;\n    setTimeout(() => {\n      fireEvent(this, \"value-changed\", { value });\n      fireEvent(this, \"change\");\n    }, 0);\n  }\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-config-entry-picker\": HaConfigEntryPicker;\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { ConfigEntrySelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-config-entry-picker\";\n\n@customElement(\"ha-selector-config_entry\")\nexport class HaConfigEntrySelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: ConfigEntrySelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  protected render() {\n    return html`<ha-config-entry-picker\n      .hass=${this.hass}\n      .value=${this.value}\n      .label=${this.label}\n      .helper=${this.helper}\n      .disabled=${this.disabled}\n      .required=${this.required}\n      .integration=${this.selector.config_entry?.integration}\n      allow-custom-entity\n    ></ha-config-entry-picker>`;\n  }\n\n  static styles = css`\n    ha-config-entry-picker {\n      width: 100%;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-config_entry\": HaConfigEntrySelector;\n  }\n}\n","export interface BrandsOptions {\n  domain: string;\n  type: \"icon\" | \"logo\" | \"icon@2x\" | \"logo@2x\";\n  useFallback?: boolean;\n  darkOptimized?: boolean;\n  brand?: boolean;\n}\n\nexport interface HardwareBrandsOptions {\n  category: string;\n  model?: string;\n  manufacturer: string;\n  darkOptimized?: boolean;\n}\n\nexport const brandsUrl = (options: BrandsOptions): string =>\n  `https://brands.home-assistant.io/${options.brand ? \"brands/\" : \"\"}${\n    options.useFallback ? \"_/\" : \"\"\n  }${options.domain}/${options.darkOptimized ? \"dark_\" : \"\"}${\n    options.type\n  }.png`;\n\nexport const hardwareBrandsUrl = (options: HardwareBrandsOptions): string =>\n  `https://brands.home-assistant.io/hardware/${options.category}/${\n    options.darkOptimized ? \"dark_\" : \"\"\n  }${options.manufacturer}${options.model ? `_${options.model}` : \"\"}.png`;\n\nexport const extractDomainFromBrandUrl = (url: string) => url.split(\"/\")[4];\n\nexport const isBrandUrl = (thumbnail: string | \"\"): boolean =>\n  thumbnail.startsWith(\"https://brands.home-assistant.io/\");\n"],"names":["HaConfigEntryPicker","_LitElement","_this","_callSuper","concat","args","value","disabled","required","_rowRenderer","item","_this$hass$themes","html","_t","_","title","hass","localize","localized_domain_name","brandsUrl","domain","type","darkOptimized","themes","darkMode","_onImageError","_onImageLoad","_this$_comboBox","this","_comboBox","open","key","_this$_comboBox2","focus","_getConfigEntries","_configEntries","_t2","undefined","label","_value","helper","_valueChanged","nothing","ev","target","style","visibility","_getConfigEntries2","_asyncToGenerator","_regenerator","m","_callee","w","_context","n","getConfigEntries","integration","then","configEntries","map","entry","Object","assign","domainToName","sort","conf1","conf2","caseInsensitiveStringCompare","locale","language","a","apply","arguments","get","stopPropagation","newValue","detail","_setValue","setTimeout","fireEvent","LitElement","Boolean","HaConfigEntrySelector","_this$selector$config","selector","config_entry","styles","css","attribute","options","brand","useFallback","extractDomainFromBrandUrl","url","split","isBrandUrl","thumbnail","startsWith"],"mappings":"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"}