{"version":3,"file":"3488.1dad603c5e430309.js","sources":["webpack://knx-frontend/./homeassistant-frontend/src/common/language/format_language.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-language-picker.ts","webpack://knx-frontend/./homeassistant-frontend/src/components/ha-selector/ha-selector-language.ts"],"sourcesContent":["import memoizeOne from \"memoize-one\";\nimport type { FrontendLocaleData } from \"../../data/translation\";\n\nexport const formatLanguageCode = (\n  languageCode: string,\n  locale: FrontendLocaleData\n) => {\n  try {\n    return formatLanguageCodeMem(locale)?.of(languageCode) ?? languageCode;\n  } catch {\n    return languageCode;\n  }\n};\n\nconst formatLanguageCodeMem = memoizeOne(\n  (locale: FrontendLocaleData) =>\n    new Intl.DisplayNames(locale.language, {\n      type: \"language\",\n      fallback: \"code\",\n    })\n);\n","import { mdiMenuDown } from \"@mdi/js\";\nimport type { PropertyValues } from \"lit\";\nimport { css, html, LitElement, nothing } from \"lit\";\nimport { customElement, property, query, state } from \"lit/decorators\";\nimport memoizeOne from \"memoize-one\";\nimport { fireEvent } from \"../common/dom/fire_event\";\nimport { formatLanguageCode } from \"../common/language/format_language\";\nimport { caseInsensitiveStringCompare } from \"../common/string/compare\";\nimport type { FrontendLocaleData } from \"../data/translation\";\nimport { translationMetadata } from \"../resources/translations-metadata\";\nimport type { HomeAssistant, ValueChangedEvent } from \"../types\";\nimport \"./ha-button\";\nimport \"./ha-generic-picker\";\nimport type { HaGenericPicker } from \"./ha-generic-picker\";\nimport type { PickerComboBoxItem } from \"./ha-picker-combo-box\";\n\nexport const getLanguageOptions = (\n  languages: string[],\n  nativeName: boolean,\n  noSort: boolean,\n  locale?: FrontendLocaleData\n): PickerComboBoxItem[] => {\n  let options: PickerComboBoxItem[] = [];\n\n  if (nativeName) {\n    const translations = translationMetadata.translations;\n    options = languages.map((lang) => {\n      let primary = translations[lang]?.nativeName;\n      if (!primary) {\n        try {\n          // this will not work if Intl.DisplayNames is polyfilled, it will return in the language of the user\n          primary = new Intl.DisplayNames(lang, {\n            type: \"language\",\n            fallback: \"code\",\n          }).of(lang)!;\n        } catch (_err) {\n          primary = lang;\n        }\n      }\n      return {\n        id: lang,\n        primary,\n        search_labels: [primary],\n      };\n    });\n  } else if (locale) {\n    options = languages.map((lang) => ({\n      id: lang,\n      primary: formatLanguageCode(lang, locale),\n      search_labels: [formatLanguageCode(lang, locale)],\n    }));\n  }\n\n  if (!noSort && locale) {\n    options.sort((a, b) =>\n      caseInsensitiveStringCompare(a.primary, b.primary, locale.language)\n    );\n  }\n  return options;\n};\n\n@customElement(\"ha-language-picker\")\nexport class HaLanguagePicker extends LitElement {\n  @property() public value?: string;\n\n  @property() public label?: string;\n\n  @property({ type: Array }) public languages?: string[];\n\n  @property({ attribute: false }) public hass?: HomeAssistant;\n\n  @property({ type: Boolean, reflect: true }) public disabled = false;\n\n  @property({ type: Boolean }) public required = false;\n\n  @property() public helper?: string;\n\n  @property({ attribute: \"native-name\", type: Boolean })\n  public nativeName = false;\n\n  @property({ type: Boolean, attribute: \"button-style\" })\n  public buttonStyle = false;\n\n  @property({ attribute: \"no-sort\", type: Boolean }) public noSort = false;\n\n  @property({ attribute: \"inline-arrow\", type: Boolean })\n  public inlineArrow = false;\n\n  @state() _defaultLanguages: string[] = [];\n\n  @query(\"ha-generic-picker\", true) public genericPicker!: HaGenericPicker;\n\n  protected firstUpdated(changedProps: PropertyValues) {\n    super.firstUpdated(changedProps);\n    this._computeDefaultLanguageOptions();\n  }\n\n  private _getLanguagesOptions = memoizeOne(getLanguageOptions);\n\n  private _computeDefaultLanguageOptions() {\n    this._defaultLanguages = Object.keys(translationMetadata.translations);\n  }\n\n  private _getItems = () =>\n    this._getLanguagesOptions(\n      this.languages ?? this._defaultLanguages,\n      this.nativeName,\n      this.noSort,\n      this.hass?.locale\n    );\n\n  private _getLanguageName = (lang?: string) =>\n    this._getItems().find((language) => language.id === lang)?.primary;\n\n  private _valueRenderer = (value) =>\n    html`<span slot=\"headline\"\n      >${this._getLanguageName(value) ?? value}</span\n    > `;\n\n  protected render() {\n    const value =\n      this.value ??\n      (this.required && !this.disabled ? this._getItems()[0].id : this.value);\n\n    return html`\n      <ha-generic-picker\n        .hass=${this.hass}\n        .autofocus=${this.autofocus}\n        popover-placement=\"bottom-end\"\n        .notFoundLabel=${this._notFoundLabel}\n        .emptyLabel=${this.hass?.localize(\n          \"ui.components.language-picker.no_languages\"\n        ) || \"No languages available\"}\n        .placeholder=${this.label ??\n        (this.hass?.localize(\"ui.components.language-picker.language\") ||\n          \"Language\")}\n        .value=${value}\n        .valueRenderer=${this._valueRenderer}\n        .disabled=${this.disabled}\n        .helper=${this.helper}\n        .getItems=${this._getItems}\n        @value-changed=${this._changed}\n        hide-clear-icon\n      >\n        ${this.buttonStyle\n          ? html`<ha-button\n              slot=\"field\"\n              .disabled=${this.disabled}\n              @click=${this._openPicker}\n              appearance=\"plain\"\n              variant=\"neutral\"\n            >\n              ${this._getLanguageName(value)}\n              <ha-svg-icon slot=\"end\" .path=${mdiMenuDown}></ha-svg-icon>\n            </ha-button>`\n          : nothing}\n      </ha-generic-picker>\n    `;\n  }\n\n  private _openPicker(ev: Event) {\n    ev.stopPropagation();\n    this.genericPicker.open();\n  }\n\n  static styles = css`\n    ha-generic-picker {\n      width: 100%;\n      min-width: 200px;\n      display: block;\n    }\n  `;\n\n  private _changed(ev: ValueChangedEvent<string>): void {\n    ev.stopPropagation();\n    this.value = ev.detail.value;\n    fireEvent(this, \"value-changed\", { value: this.value });\n  }\n\n  private _notFoundLabel = (search: string) => {\n    const term = html`<b>‘${search}’</b>`;\n    return this.hass\n      ? this.hass.localize(\"ui.components.language-picker.no_match\", {\n          term,\n        })\n      : html`No languages found for ${term}`;\n  };\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-language-picker\": HaLanguagePicker;\n  }\n}\n","import { css, html, LitElement } from \"lit\";\nimport { customElement, property } from \"lit/decorators\";\nimport type { LanguageSelector } from \"../../data/selector\";\nimport type { HomeAssistant } from \"../../types\";\nimport \"../ha-language-picker\";\n\n@customElement(\"ha-selector-language\")\nexport class HaLanguageSelector extends LitElement {\n  @property({ attribute: false }) public hass!: HomeAssistant;\n\n  @property({ attribute: false }) public selector!: LanguageSelector;\n\n  @property() public value?: any;\n\n  @property() public label?: string;\n\n  @property() public helper?: string;\n\n  @property({ type: Boolean }) public disabled = false;\n\n  @property({ type: Boolean }) public required = true;\n\n  protected render() {\n    return html`\n      <ha-language-picker\n        .hass=${this.hass}\n        .value=${this.value}\n        .label=${this.label}\n        .helper=${this.helper}\n        .languages=${this.selector.language?.languages}\n        .nativeName=${Boolean(this.selector?.language?.native_name)}\n        .noSort=${Boolean(this.selector?.language?.no_sort)}\n        .disabled=${this.disabled}\n        .required=${this.required}\n      ></ha-language-picker>\n    `;\n  }\n\n  static styles = css`\n    ha-language-picker {\n      width: 100%;\n    }\n  `;\n}\n\ndeclare global {\n  interface HTMLElementTagNameMap {\n    \"ha-selector-language\": HaLanguageSelector;\n  }\n}\n"],"names":["formatLanguageCode","languageCode","locale","formatLanguageCodeMem","of","memoizeOne","Intl","DisplayNames","language","type","fallback","getLanguageOptions","languages","nativeName","noSort","options","translations","translationMetadata","map","lang","primary","_err","id","search_labels","sort","a","b","caseInsensitiveStringCompare","HaLanguagePicker","LitElement","firstUpdated","changedProps","super","this","_computeDefaultLanguageOptions","_defaultLanguages","Object","keys","render","value","required","disabled","_getItems","html","hass","autofocus","_notFoundLabel","localize","label","_valueRenderer","helper","_changed","buttonStyle","_openPicker","_getLanguageName","mdiMenuDown","nothing","ev","stopPropagation","genericPicker","open","detail","fireEvent","args","inlineArrow","_getLanguagesOptions","find","search","term","styles","css","Array","attribute","Boolean","reflect","HaLanguageSelector","selector","native_name","no_sort"],"mappings":"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"}