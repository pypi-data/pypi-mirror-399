{
  "nats": {
    "servers": ["nats://localhost:4222"],
    "connect_timeout": 10,
    "reconnect_time_wait": 2,
    "max_reconnect_attempts": -1
  },
  "channels": [
    {
      "domain": "cytu.be",
      "channel": "420grindhouse"
    }
  ],
  "personality": {
    "character_name": "CynthiaRothbot",
    "character_description": "legendary martial artist and actress Cynthia Rothrock",
    "personality_traits": [
      "confident",
      "action-oriented",
      "pithy",
      "martial arts expert",
      "straight-talking",
      "no-nonsense"
    ],
    "expertise": [
      "kung fu",
      "martial arts",
      "action movies",
      "B-movies",
      "grindhouse films",
      "1980s action cinema"
    ],
    "response_style": "short and punchy",
    "name_variations": [
      "cynthia",
      "rothrock",
      "cynthiarothbot",
      "rothbot"
    ]
  },
  "llm_providers": {
    "local": {
      "name": "local",
      "type": "openai_compatible",
      "base_url": "http://localhost:1234/v1",
      "api_key": "not-needed",
      "model": "qwen2.5-7b-instruct",
      "max_tokens": 256,
      "temperature": 0.8,
      "timeout_seconds": 30,
      "priority": 1,
      "max_retries": 3,
      "custom_headers": null
    },
    "ollama": {
      "name": "ollama",
      "type": "openai_compatible",
      "base_url": "http://localhost:11434/v1",
      "api_key": "not-needed",
      "model": "llama3.2:3b",
      "max_tokens": 256,
      "temperature": 0.8,
      "timeout_seconds": 30,
      "priority": 2,
      "max_retries": 3,
      "custom_headers": null
    },
    "openrouter": {
      "name": "openrouter",
      "type": "openai_compatible",
      "base_url": "https://openrouter.ai/api/v1",
      "api_key": "${OPENROUTER_API_KEY}",
      "model": "meta-llama/llama-3.2-3b-instruct:free",
      "max_tokens": 256,
      "temperature": 0.8,
      "timeout_seconds": 30,
      "priority": 3,
      "max_retries": 3,
      "custom_headers": {
        "HTTP-Referer": "https://github.com/yourusername/kryten-llm",
        "X-Title": "Kryten LLM Bot"
      }
    }
  },
  "default_provider_priority": ["local", "ollama", "openrouter"],
  "retry_strategy": {
    "initial_delay": 1.0,
    "multiplier": 2.0,
    "max_delay": 30.0
  },
  "auto_participation": {
    "enabled": false,
    "base_message_interval": 20,
    "probability_range": 0.2
  },
  "media_change": {
    "enabled": false,
    "min_duration_minutes": 30,
    "chat_context_depth": 3,
    "transition_explanation": "The media has just changed."
  },
  "triggers": [
    {
      "name": "toddy",
      "patterns": ["toddy", "todd", "god-emperor"],
      "probability": 0.15,
      "cooldown_seconds": 300,
      "context": "Toddy is a running joke in the channel - a semi-divine entity.",
      "max_responses_per_hour": 3,
      "priority": 7,
      "enabled": true,
      "preferred_provider": null
    },
    {
      "name": "kung_fu",
      "patterns": ["kung fu", "martial arts", "karate"],
      "probability": 0.20,
      "cooldown_seconds": 180,
      "context": "User is asking about martial arts or kung fu movies.",
      "max_responses_per_hour": 5,
      "priority": 5,
      "enabled": true,
      "preferred_provider": "local"
    }
  ],
  "rate_limits": {
    "global_max_per_minute": 2,
    "global_max_per_hour": 20,
    "global_cooldown_seconds": 15,
    "user_max_per_hour": 5,
    "user_cooldown_seconds": 60,
    "mention_cooldown_seconds": 120,
    "admin_cooldown_multiplier": 0.5,
    "admin_limit_multiplier": 2.0
  },
  "message_processing": {
    "max_message_length": 240,
    "split_delay_seconds": 2,
    "filter_emoji": false,
    "max_emoji_per_message": 3
  },
  "testing": {
    "dry_run": false,
    "log_responses": true,
    "log_file": "logs/llm-responses.jsonl",
    "send_to_chat": true
  },
  "context": {
    "chat_history_size": 30,
    "context_window_chars": 12000,
    "max_video_title_length": 200,
    "max_chat_history_in_prompt": 10,
    "include_video_context": true,
    "include_chat_history": true
  },
  "formatting": {
    "max_message_length": 255,
    "continuation_indicator": " ...",
    "enable_emoji_limiting": false,
    "max_emoji_per_message": null,
    "remove_self_references": true,
    "remove_llm_artifacts": true,
    "artifact_patterns": [
      "^Here's ",
      "^Let me ",
      "^Sure!\\s*",
      "\\bAs an AI\\b",
      "^I think ",
      "^In my opinion "
    ]
  },
  "validation": {
    "min_length": 10,
    "max_length": 2000,
    "check_repetition": true,
    "repetition_history_size": 10,
    "repetition_threshold": 0.9,
    "check_relevance": false,
    "relevance_threshold": 0.5,
    "inappropriate_patterns": [],
    "check_inappropriate": false
  },
  "spam_detection": {
    "enabled": true,
    "message_windows": [
      {
        "seconds": 60,
        "max_messages": 5
      },
      {
        "seconds": 300,
        "max_messages": 10
      },
      {
        "seconds": 900,
        "max_messages": 20
      }
    ],
    "identical_message_threshold": 3,
    "mention_spam_threshold": 3,
    "mention_spam_window": 30,
    "initial_penalty": 30,
    "penalty_multiplier": 2.0,
    "max_penalty": 600,
    "clean_period": 600,
    "admin_exempt_ranks": [3, 4, 5]
  },
  "error_handling": {
    "enable_fallback_responses": false,
    "fallback_messages": [
      "I'm having trouble thinking right now. Try again later!",
      "My circuits are a bit scrambled. Give me a moment!",
      "ERROR: Brain.exe has stopped responding."
    ],
    "log_full_context": true,
    "generate_correlation_ids": true
  },
  "metrics": {
    "enabled": true,
    "port": 28286,
    "host": "0.0.0.0"
  },
  "service_metadata": {
    "service_name": "llm",
    "heartbeat_interval_seconds": 10,
    "enable_service_discovery": true,
    "enable_heartbeats": true,
    "graceful_shutdown_timeout_seconds": 30
  }
}
