Release Notes v1.2.5
====================

Новые функции
-------------

**Двухфакторная аутентификация (2FA)**
    Добавлена полная поддержка двухфакторной аутентификации с использованием пароля, email-кода и подсказок для восстановления пароля. Теперь возможен вход в аккаунт когда включена 2FA с проверкой пароля.

**Управление паролем аккаунта**
    Новый метод ``set_password()`` позволяет устанавливать, изменять и управлять паролем аккаунта с поддержкой подсказок и email для восстановления.

**Исправления в обработке сокетов**
    Улучшена обработка последовательности сообщений (sequence numbers) для корректной работы с 8-битными числами.

**Улучшения протокола WebSocket**
    Добавлена поддержка версии протокола (ver=11) в сообщениях WebSocket.

Новые методы
------------

MaxClient.set_password(password: str, email: str | None = None, hint: str | None = UNSET)
    Устанавливает пароль для аккаунта с возможностью добавления подсказки и email для восстановления.

Новые типы и перечисления
--------------------------

Capability
    Перечисление для описания возможностей аккаунта в контексте двухфакторной аутентификации.

Payload классы
    ``CheckPasswordChallengePayload`` — для проверки пароля при 2FA
    ``CreateTrackPayload`` — для создания отслеживающего ID
    ``SetPasswordPayload`` — для установки пароля
    ``SetHintPayload`` — для установки подсказки пароля
    ``RequestEmailCodePayload`` — для запроса кода по email
    ``SendEmailCodePayload`` — для отправки email кода
    ``SetTwoFactorPayload`` — для установки параметров 2FA

Исправления и улучшения
------------------------

- Исправлена обработка последовательности сообщений в socket-клиенте (seq % 256)
- Исправлена обработка последовательности сообщений в websocket-клиенте
- Добавлена проверка подключения перед отправкой уведомлений о прочтении
- Улучшена обработка двухфакторной аутентификации при логине
- Исправлена инициализация seq на 255 вместо 0 в core.py
- Добавлена обработка ``SocketNotConnectedError`` в telemetry
- Исправлена обработка ошибок при отправке в socket/websocket

Версия
------

**1.2.5** - выпущена 31 декабря 2025 г.

---

Архив
-----

Предыдущие версии доступны в :doc:`release_notes_archive`.
