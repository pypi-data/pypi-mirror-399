version: '3'

tasks:
  default:
    cmds:
      - uv sync --locked --all-extras --all-groups
    silent: true
  sync:
    cmds:
      - uv sync --all-extras --all-groups
    silent: true
  upgrade:
    cmds:
      - uv lock --upgrade
      - uv sync --locked --all-extras --all-groups
    silent: true
  test:
    deps:
      - default
    cmds:
      - uv run pytest
    silent: true
  test-coverage:
    deps:
      - default
    cmds:
      - uv run coverage run -m pytest
      - uv run coverage html
    silent: true
  docs:
    cmds:
      - uv run mkdocs build
    silent: true
  docs:serve:
    cmds:
      - uv run mkdocs serve
    silent: true
  build:
    cmds:
      - cmd: rm --rf dist
        platforms: [linux, darwin]
      - cmd: rmdir /s /q dist
        platforms: [windows]
      - uv build
    silent: true
  changelog:
    cmds:
      - uv run git cliff -o CHANGELOG.md
      - git add CHANGELOG.md
      - 'git commit -m "chore: update changelog [skip ci]"'
    silent: true
