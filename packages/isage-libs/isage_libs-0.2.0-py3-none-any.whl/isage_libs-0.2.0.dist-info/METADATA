Metadata-Version: 2.4
Name: isage-libs
Version: 0.2.0
Summary: SAGE Libraries - Streaming-Augmented Generative Execution
Author-email: IntelliStream Team <shuhao_zhang@hust.edu.cn>
License: MIT
Project-URL: Homepage, https://github.com/intellistream/SAGE
Project-URL: Documentation, https://intellistream.github.io/SAGE-Pub/
Project-URL: Repository, https://github.com/intellistream/SAGE.git
Project-URL: Bug Tracker, https://github.com/intellistream/SAGE/issues
Keywords: applications,examples,templates,rag,agents,streaming,tutorials,sage
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Topic :: System :: Distributed Computing
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: numpy<2.3.0,>=1.26.0
Requires-Dist: chromadb>=1.0.20
Requires-Dist: pymilvus[model]>=2.4.0
Requires-Dist: kafka-python>=2.0.0
Requires-Dist: redis>=4.0.0
Requires-Dist: datasets>=2.0.0
Requires-Dist: evaluate>=0.4.0
Requires-Dist: rouge>=1.0.0
Requires-Dist: rouge-score>=0.1.0
Requires-Dist: bleu>=0.3.0
Requires-Dist: jupyter>=1.0.0
Requires-Dist: notebook>=6.0.0
Requires-Dist: PyPDF2>=3.0.0
Requires-Dist: python-docx>=0.8.11
Requires-Dist: easyocr>=1.7.0
Requires-Dist: transformers<4.58.0,>=4.52.0
Requires-Dist: tokenizers<0.24.0,>=0.21.0
Requires-Dist: peft<1.0.0,>=0.18.0
Requires-Dist: accelerate<2.0.0,>=1.9.0
Requires-Dist: tensorboard>=2.14.0
Requires-Dist: trl<0.23.0,>=0.22.0
Provides-Extra: sage-deps
Requires-Dist: isage-common>=0.1.0; extra == "sage-deps"
Provides-Extra: all
Requires-Dist: isage-libs[sage-deps]; extra == "all"
Provides-Extra: full
Requires-Dist: isage-libs[sage-deps]; extra == "full"
Requires-Dist: isage-kernel>=0.1.0; extra == "full"
Requires-Dist: isage-libs[llm]; extra == "full"
Requires-Dist: isage-libs[finetune-gpu]; extra == "full"
Requires-Dist: sqlalchemy>=2.0.0; extra == "full"
Requires-Dist: alembic>=1.13.0; extra == "full"
Requires-Dist: prometheus-client>=0.19.0; extra == "full"
Requires-Dist: structlog>=23.0.0; extra == "full"
Provides-Extra: llm
Requires-Dist: vllm<0.13,>=0.10.1; extra == "llm"
Provides-Extra: finetune-gpu
Requires-Dist: bitsandbytes>=0.41.0; extra == "finetune-gpu"
Requires-Dist: wandb>=0.16.0; extra == "finetune-gpu"
Provides-Extra: finetune-distributed
Requires-Dist: isage-libs[finetune-gpu]; extra == "finetune-distributed"
Requires-Dist: deepspeed>=0.12.0; extra == "finetune-distributed"
Provides-Extra: finetune-llamafactory
Requires-Dist: llmtuner>=0.7.0; extra == "finetune-llamafactory"
Provides-Extra: medical
Requires-Dist: huggingface_hub>=0.19.0; extra == "medical"
Requires-Dist: datasets>=2.14.0; extra == "medical"
Requires-Dist: pillow>=10.0.0; extra == "medical"
Requires-Dist: scikit-learn>=1.3.0; extra == "medical"
Provides-Extra: video
Requires-Dist: opencv-python>=4.5.0; extra == "video"
Requires-Dist: torch<3.0.0,>=2.7.0; extra == "video"
Requires-Dist: torchvision<1.0.0,>=0.22.0; extra == "video"
Requires-Dist: transformers<4.58.0,>=4.52.0; extra == "video"
Requires-Dist: Pillow>=9.0.0; extra == "video"
Provides-Extra: amm
Requires-Dist: isage-libamm>=0.1.0; extra == "amm"
Provides-Extra: examples
Requires-Dist: isage-libs[video]; extra == "examples"
Requires-Dist: pyyaml>=6.0; extra == "examples"
Provides-Extra: all-apps
Requires-Dist: isage-libs[medical]; extra == "all-apps"
Requires-Dist: isage-libs[finetune]; extra == "all-apps"
Requires-Dist: isage-libs[examples]; extra == "all-apps"
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: pytest-asyncio>=0.21.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: isort>=5.10.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Provides-Extra: docs
Requires-Dist: sphinx>=7.0.0; extra == "docs"
Requires-Dist: sphinx-rtd-theme>=1.3.0; extra == "docs"
Requires-Dist: myst-parser>=2.0.0; extra == "docs"
Requires-Dist: mkdocs>=1.6.0; extra == "docs"
Requires-Dist: mkdocs-material>=9.6.0; extra == "docs"
Requires-Dist: pymdown-extensions>=10.2.0; extra == "docs"

# SAGE Libraries Package

## ðŸ“‹ Overview

SAGE Libraries æ˜¯åŸºäºŽ SAGE Framework æž„å»ºçš„å¯å¤ç”¨ç»„ä»¶åº“ï¼Œæä¾›äº†ä¸°å¯Œçš„é¢„æž„å»ºåŠŸèƒ½æ¨¡å—æ¥å¸®åŠ©å¼€å‘è€…å¿«é€Ÿæž„å»º AI åº”ç”¨ã€‚

## ðŸ“š Package Contents

### Layered Module Map

| Layer          | Description                                                                   | Modules                                                                                      |
| -------------- | ----------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------- |
| `foundation`   | ä½Žä¾èµ–åº¦å·¥å…·ç®±ï¼šå·¥å…·åŸºç±»ã€IO Source/Sinkã€ä¸Šä¸‹æ–‡åŽ‹ç¼©ã€filters                 | `foundation.tools`, `foundation.io`, `foundation.context`, `foundation.filters` *(å³å°†è¿å…¥)* |
| `agentic`      | LangChain é£Žæ ¼çš„ Agent æ¡†æž¶ + Workflow Optimizer                              | `agentic.agents`, `agentic.workflow`                                                         |
| `rag`          | RAG ç»„ä»¶ï¼ˆloaders/chunkers/retrievers/pipelinesï¼‰ã€‚ç›®å‰æ­£åœ¨ä»Ž middleware å›žè¿ | `rag.loaders`, `rag.chunkers`, ... *(å ä½åŒ…ï¼Œè¿‘æœŸå¡«å……)*                                      |
| `integrations` | ç¬¬ä¸‰æ–¹æœåŠ¡é€‚é…å™¨ï¼ˆLLMã€å‘é‡åº“ã€Observability ç­‰ï¼‰                             | `integrations.llm.openai`, `integrations.vector.milvus`, ...                                 |
| `privacy`      | éšç§/é—å¿˜ç®—æ³•ï¼ˆåŽŸ `unlearning` åŒ…ï¼‰                                           | `privacy.unlearning`                                                                         |

### RAG Building Blocks

`sage.libs.rag` çŽ°å·²æä¾›å¯ç›´æŽ¥å¤ç”¨çš„æ ¸å¿ƒç»„ä»¶ï¼š

- `chunk`ï¼š`CharacterSplitter`, `SentenceTransformersTokenTextSplitter`
- `document_loaders`ï¼š`TextLoader`, `PDFLoader`, `DocxLoader`, `DocLoader`, `MarkdownLoader`,
  `LoaderFactory`
- `pipeline`ï¼šè½»é‡ç‰ˆ `RAGPipeline`
- `types`ï¼š`RAGDocument`, `RAGQuery`, `RAGResponse` åŠè¾…åŠ©å‡½æ•°

Middleware ä»å¯é€šè¿‡åŽŸ import è·¯å¾„è®¿é—®è¿™äº›ç±»ï¼Œä½†æ–°çš„æ–‡æ¡£å’Œç¤ºä¾‹å°†é€æ­¥åˆ‡æ¢åˆ° `sage.libs.rag.*`ã€‚

## ðŸš€ Installation

### Basic Installation

```bash
# åŸºç¡€å®‰è£…ï¼ˆä¸åŒ…å« LibAMMï¼‰
pip install -e packages/sage-libs

# æˆ–ä½¿ç”¨ sage-dev å‘½ä»¤
sage-dev install sage-libs
```

### With LibAMM (Approximate Matrix Multiplication)

LibAMM æ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„è¿‘ä¼¼çŸ©é˜µä¹˜æ³• C++ åº“ï¼Œæä¾› NumPy æŽ¥å£ã€‚

```bash
# ä¸€é”®å®‰è£…ï¼ˆæŽ¨èï¼‰- è‡ªåŠ¨ç¼–è¯‘ LibAMM
pip install -e "packages/sage-libs[amm]"

# æˆ–æ‰‹åŠ¨å®‰è£…
cd packages/sage-libs/src/sage/libs/libamm
pip install .
```

**è¦æ±‚**ï¼š

- CMake >= 3.10
- C++ ç¼–è¯‘å™¨ (g++ æˆ– clang++)
- PyTorch >= 2.0ï¼ˆä¼šè‡ªåŠ¨å®‰è£…ï¼‰

**ç‰¹æ€§**ï¼š

- âœ… é«˜æ€§èƒ½ C++ å®žçŽ°
- âœ… NumPy æŽ¥å£ï¼ˆæ— éœ€ç›´æŽ¥ä½¿ç”¨ PyTorchï¼‰
- âœ… æ”¯æŒ 18+ ç§è¿‘ä¼¼çŸ©é˜µä¹˜æ³•ç®—æ³•
- ðŸ“– è¯¦è§ `src/sage/libs/libamm/DEPENDENCY_ISOLATION.md`

## ðŸ“– Quick Start

```python
from sage_libs.llm import OpenAIAdapter
from sage_libs.vector_stores import FAISSStore
from sage_libs.embeddings import OpenAIEmbeddings

# ä½¿ç”¨ LLM é€‚é…å™¨
llm = OpenAIAdapter(model="gpt-4")
response = llm.generate("Hello, world!")

# ä½¿ç”¨å‘é‡å­˜å‚¨
embeddings = OpenAIEmbeddings()
vector_store = FAISSStore(embeddings)
vector_store.add_texts(["document 1", "document 2"])
```

## ðŸ“„ License

MIT License - see [LICENSE](../../LICENSE) for details.

______________________________________________________________________

## ðŸ¤– Agent Fine-tuning Module

The `sage.libs.finetune.agent` module provides specialized tools for fine-tuning language models on
agent tasks, including tool calling, planning, and timing judgment.

### Quick Start

```python
from sage.libs.finetune.agent import AgentSFTConfig, AgentSFTTrainer

# Basic configuration
config = AgentSFTConfig(
    base_model="Qwen/Qwen2.5-1.5B-Instruct",
    train_data="agent_sft:train",
    num_epochs=1,
)

# Create and run trainer
trainer = AgentSFTTrainer(config)
trainer.train()
```

### Available Training Methods

| Method ID           | Name                | Description              | Key Features                     |
| ------------------- | ------------------- | ------------------------ | -------------------------------- |
| `A_baseline`        | Baseline            | Standard SFT             | No enhancements                  |
| `B3_coreset_hybrid` | Coreset (Hybrid)    | 60% loss + 40% diversity | `coreset_strategy="hybrid"`      |
| `C_continual`       | Continual Learning  | Experience replay buffer | `use_continual=True`             |
| `D_combined`        | Coreset + Continual | Best of both approaches  | Combined                         |
| `E_fireact`         | FireAct             | Trajectory fine-tuning   | `use_trajectory_collection=True` |
| `F_agenttuning`     | AgentTuning         | Multi-task training      | `use_multi_task=True`            |
| `G_dora`            | DoRA                | Weight-decomposed LoRA   | `use_dora=True`                  |
| `H_lora_plus`       | LoRA+               | Differentiated LR        | `use_lora_plus=True`             |

### Key Components

| Component                | Description                   | Import Path                                  |
| ------------------------ | ----------------------------- | -------------------------------------------- |
| `AgentSFTTrainer`        | Main trainer class            | `sage.libs.finetune.agent`                   |
| `CoresetSelector`        | Sample selection (SIAS)       | `sage.libs.sias`                             |
| `OnlineContinualLearner` | Experience replay (SIAS)      | `sage.libs.sias`                             |
| `TrajectoryCollector`    | FireAct trajectory collection | `sage.libs.finetune.agent`                   |
| `MultiTaskMixer`         | AgentTuning data mixing       | `sage.libs.finetune.agent`                   |
| `MethodRegistry`         | Predefined methods            | `sage.benchmark.benchmark_agent.experiments` |

> **Note**: `CoresetSelector` and `OnlineContinualLearner` have been moved to the SIAS module
> (`sage.libs.sias`). They are re-exported from `sage.libs.finetune.agent` for backward
> compatibility.

For detailed API documentation, see
[Agent Fine-tuning API Reference](../../docs/dev-notes/l3-libs/AGENT_FINETUNE_API_REFERENCE.md).
