# encoding: utf-8

import random
import hashlib
import binascii

# 订阅数据类型：1-指数快照，2-证券快照，3-委托队列，4-逐笔委托，5-逐笔成交，5-极速盘口
DATA_CLASS_LIST = [1, 2, 3, 4, 5, 6]
DATA_CLASS_NAMES = ['index', 'stock', 'queue', 'order', 'trans', 'superstock']
# 数据类型：0xf-数据类型，0x0-交易所原始数据，0x1-使用压缩，0xf0-数据类型，0x10-更新补全后的数据
DATA_OP_TYPE = [0xf, 0x0, 0x1, 0xf0, 0x10]
# 订阅操作类型：1-全新订阅，2-取消订阅，3-该市场增加订阅代码，4-该市场删除订阅代码
SUB_OP_TYPE = [1, 2, 3, 4]

# 市场代码
MarketUSHI = "USHI"  # 上海指数
MarketUSHA = "USHA"  # 上海A股
MarketUSHB = "USHB"  # 上海B股
MarketUSHD = "USHD"  # 上海债券
MarketUSHJ = "USHJ"  # 上海基金
MarketUSHP = "USHP"  # 上海退市整理
MarketUSHT = "USHT"  # 上海ST风险警示板
MarketUSZI = "USZI"  # 深圳指数
MarketUSZA = "USZA"  # 深圳A股
MarketUSZB = "USZB"  # 深圳B股
MarketUSZD = "USZD"  # 深圳债券
MarketUSZJ = "USZJ"  # 深圳基金
MarketUSZP = "USZP"  # 深圳退市整理
MarketUSTM = "USTM"  # 北交所


def market_to_market_id(market: str) -> str:
    market_map = {
        "USHI": "16",
        "USHA": "17",
        "USHB": "18",
        "USHD": "19",  # 退市票沪也用这个
        "USHJ": "20",
        "USHT": "22",  # st 沪，优先使用 22（21 被注释掉）
        "USZI": "32",
        "USZA": "33",
        "USZB": "34",
        "USZD": "35",  # 退市票深也用这个
        "USZJ": "36",
        "USZP": "37",
        "URFI": "48",
        "UCFS": "65",
        "UCFF": "66",
        "UCFZ": "67",
        "UFII": "88",
        "UFXB": "97",
        "UHFF": "113",
        "UHFS": "114",
        "UZZI": "120",
        "UIFF": "129",
        "USTM": "151",
        "UEUA": "161",
        "UHKM": "177",
        "UHKG": "178",
        "UNQQ": "185",
        "UNQS": "186",
        "UCMN": "217",
        "UCMS": "219"
    }
    return market_map.get(market, f"{market}_")


# 市场代码列表
MARKETS = ['USHI', 'USHA', 'USHB', 'USHD', 'USHJ', 'USHP', 'USHT', 'USZI', 'USZA', 'USZB', 'USZD', 'USZJ', 'USZP',
           'USOO', 'UZOO', 'UNQQ', 'UNQS', 'UHKM', 'UHKG', 'USTI', 'UFXB', 'UEUA', 'UCFD', 'UCFS', 'UCFZ', 'UGFF',
           'UIFF', 'UDEF']

BLOCK_MARKETS = ['URFI']

CALL_AUCTION_ANOMALY_MAP = {
    68710: "涨停试盘",
    68711: "跌停试盘",
    68712: "涨停撤单",
    68713: "竞价抢筹",
    68714: "竞价砸盘",
    68715: "大幅高开",
    68716: "大幅低开",
    68717: "急速上涨",
    68718: "急速下跌",
    68721: "买一剩余大",
    68722: "卖一剩余大",
    68726: "大买单试盘",
    68727: "大卖单试盘",
}

TIP_CALL_AUCTION_ANOMALY_MAP = {
    68710: "第%d次涨停试盘",
    68711: "第%d次跌停试盘",
    68712: "涨停撤单%.2f%%",
    68713: "单笔放量10%以上抢筹",
    68714: "单笔放量10%以上砸盘",
    68715: "大幅高开%.2f%%",
    68716: "大幅低开%.2f%%",
    68717: "一分钟涨幅大于3%",
    68718: "一分钟跌幅大于3%",
    68721: "买一剩余%.0f万",
    68722: "卖一剩余%.0f万",
    68726: "%.0f万大买单试盘",
    68727: "%.0f万大卖单试盘",
}

# 字段名称映射（已修正重复值问题）
FieldNameMap = {
    1: "时间",
    5: "代码",
    6: "昨收价",
    7: "开盘价",
    8: "最高价",
    9: "最低价",
    10: "价格",
    11: "收盘价",
    12: "成交方向",
    13: "成交量",
    14: "外盘成交量",
    15: "内盘成交量",
    16: "对倒成交量",
    17: "开盘成交量",
    18: "交易笔数",
    19: "总金额",
    20: "委托买入价",
    21: "委托卖出价",
    22: "委买总量",
    23: "委卖总量",
    24: "买1价",
    25: "买1量",
    26: "买2价",
    27: "买2量",
    28: "买3价",
    29: "买3量",
    30: "卖1价",
    31: "卖1量",
    32: "卖2价",
    33: "卖2量",
    34: "卖3价",
    35: "卖3量",
    36: "指数种类",
    37: "股票总数",
    38: "上涨家数",
    39: "下跌家数",
    40: "领先指标",
    41: "上涨趋势",
    42: "下跌趋势",
    43: "最近成交金额",
    44: "证券名称(繁体)",
    45: "五日成交总量",
    46: "证券名称(英文)",
    47: "证券名称(Unicode)",
    48: "涨速",
    49: "当前量",
    50: "代码(港)",
    53: "委比",
    54: "均价(中金所)",
    55: "名称",
    56: "挂单时间",
    60: "H股昨收",
    61: "异动类型1",
    64: "状态",
    65: "持仓",
    66: "昨结",
    69: "涨停价",
    70: "跌停价",
    71: "现增仓",
    72: "今结",
    73: "昨持仓",
    74: "买单ID",
    75: "卖单ID",
    80: "利息",
    82: "撤单时间",
    84: "所属行业",
    85: "盈利情况",
    89: "转让状态参数",
    90: "板块流通市值",
    91: "市盈率",
    92: "板块总市值",
    93: "交易单位",
    95: "52周最高",
    96: "52周最低",
    100: "现价(港)",
    102: "买6价",
    103: "买6量",
    104: "卖6价",
    105: "卖6量",
    106: "买7价",
    107: "买7量",
    108: "卖7价",
    109: "卖7量",
    110: "买8价",
    111: "买8量",
    112: "卖8价",
    113: "卖8量",
    114: "买9价",
    115: "买9量",
    116: "卖9价",
    117: "卖9量",
    118: "买10价",
    119: "买10量",
    120: "卖10价",
    121: "卖10量",
    122: "加权平均买价",
    123: "总委买量",
    124: "加权平均卖价",
    125: "总委卖量",
    130: "总手(港)",
    141: "波动性中断参考价",
    142: "波动性中断虚拟匹配量",
    143: "合约代码",
    144: "标的证券代码",
    145: "标的证券名称",
    146: "标的证券类型",
    147: "期权类型",
    148: "认购认沽",
    149: "合约单位",
    150: "买4价",
    151: "买4量",
    152: "卖4价",
    153: "卖4量",
    154: "买5价",
    155: "买5量",
    156: "卖5价",
    157: "卖5量",
    160: "市场分层",
    191: "买差价",
    192: "卖差价",
    201: "主动买入特大单量",
    202: "主动卖出特大单量",
    203: "主动买入大单量",
    204: "主动卖出大单量",
    205: "主动买入中单量",
    206: "主动卖出中单量",
    207: "被动买入特大单量",
    208: "被动卖出特大单量",
    209: "被动买入大单量",
    210: "被动卖出大单量",
    211: "被动买入中单量",
    212: "被动卖出中单量",
    213: "主动买入小单量",
    214: "主动卖出小单量",
    215: "主动买入特大单笔数",
    216: "主动卖出特大单笔数",
    217: "主动买入大单笔数",
    218: "主动卖出大单笔数",
    219: "被动买入特大单笔数",
    220: "被动卖出特大单笔数",
    221: "被动买入大单笔数",
    222: "被动卖出大单笔数",
    223: "主动买入特大单金额",
    224: "主动卖出特大单金额",
    225: "主动买入大单金额",
    226: "主动卖出大单金额",
    227: "被动买入特大单金额",
    228: "被动卖出特大单金额",
    229: "被动买入大单金额",
    230: "被动卖出大单金额",
    231: "买入单数量",
    232: "卖出单数量",
    233: "资金流入",
    234: "资金流出",
    235: "大单净量正",
    236: "大单净量负",
    237: "主动买入小单金额",
    238: "主动卖出小单金额",
    239: "成交笔数",
    240: "昨日收盘收益率",
    241: "昨日加权平均收益率",
    242: "开盘收益率",
    243: "最高收益率",
    244: "最低收益率",
    245: "最新收益率",
    246: "当日加权平均收益率",
    250: "委托买入前五档金额",
    251: "委托卖出前五档金额",
    252: "委托买入前十档金额",
    253: "委托卖出前十档金额",
    255: "主动买入中单笔数",
    256: "主动卖出中单笔数",
    257: "被动买入中单笔数",
    258: "被动卖出中单笔数",
    259: "主动买入中单金额",
    260: "主动卖出中单金额",
    261: "被动买入中单金额",
    262: "被动卖出中单金额",
    271: "52周最高日期",
    272: "52周最低日期",
    273: "年度最高日期",
    274: "年度最低日期",
    275: "领涨股",
    276: "涨停家数",
    277: "跌停家数",
    278: "盘后最新价",
    279: "港股指数人民币成交金额",
    280: "期权行权价",
    281: "首个交易日",
    282: "最后交易日1",
    283: "期权行权日",
    284: "期权到期日",
    285: "合约版本号",
    286: "行权交割日",
    288: "标的证券前收盘",
    289: "涨跌幅限制类型",
    290: "保证金比例参数1",
    291: "保证金比例参数2",
    292: "单位保证金",
    294: "整手数",
    295: "单笔限价申报下限",
    296: "单笔限价申报上限",
    297: "单笔市价申报下限",
    298: "单笔市价申报上限",
    299: "期权合约状态标签",
    402: "总股本",
    407: "流通股本",
    410: "流通B股",
    471: "权息资料",
    497: "转股价",
    499: "债券余额",
    520: "流动资产",
    543: "资产总计",
    593: "公积金",
    602: "主营收入",
    605: "营业利润",
    615: "利润总额",
    619: "净利润1",
    672: "申购限额(万股)",
    675: "实际涨幅",
    676: "首日振幅",
    873: "引伸波幅",
    874: "对冲值",
    875: "街货占比",
    876: "街货量",
    877: "最后交易日2",
    879: "回收价",
    880: "牛熊证种类",
    881: "标的证券",
    882: "权证类型",
    887: "行使价",
    888: "换股比率1",
    890: "到期日",
    899: "财务数据项",
    900: "流通股变动量",
    981: "港元人民币汇率",
    1002: "每股收益",
    1005: "每股净资产",
    1015: "净资产收益率",
    1024: "债券规模",
    1047: "转股起始日",
    1110: "星级",
    1121: "标记",
    1322: "利率",
    1384: "融资余额",
    1385: "融券余额",
    1386: "融资买入",
    1387: "融券卖出",
    1566: "净利润2",
    1606: "发行价",
    1612: "中签率",
    1670: "股东总数",
    1674: "流通A股",
    2026: "评级",
    2039: "纯债价值",
    2041: "期权价值",
    2570: "卖出信号",
    2579: "机构持股比例",
    2719: "人均持股数",
    2942: "市盈率(动态)1",
    2946: "市盈率(静态)",
    2947: "市净率1",
    3153: "市盈率TTM",
    3250: "5日涨幅",
    3251: "10日涨幅",
    3252: "20日涨幅",
    3397: "净值",
    9810: "溢价率",
    32772: "时间戳",
    68107: "板块主力净量1",
    68166: "板块主力流入",
    68167: "板块主力流出",
    68213: "板块主力净流入",
    68285: "板块主力净量2",
    68759: "板块开盘价",
    133702: "细分行业",
    133778: "基差",
    133964: "日增仓1",
    134071: "市销率TTM",
    134072: "净资产收益率TTM",
    134141: "净利润增长率",
    134143: "营业收入增长率",
    134152: "市盈率(静态)2",
    134160: "换股比率2",
    134162: "折溢率",
    134237: "杠杆比率",
    134238: "溢价",
    199112: "涨幅",
    199643: "大单净量",
    264648: "涨跌",
    330321: "异动类型2",
    330322: "竞价评级1",
    330325: "涨停类型",
    330329: "涨停状态",
    331070: "今日主力增仓占比",
    331077: "2日主力增仓占比",
    331078: "3日主力增仓占比",
    331079: "5日主力增仓占比",
    331080: "10日主力增仓占比",
    331124: "2日主力增仓排名",
    331125: "3日主力增仓排名",
    331126: "5日主力增仓排名",
    331127: "10日主力增仓排名",
    331128: "今日主力增仓排名",
    395720: "委差",
    461256: "委比",
    461346: "年初至今涨幅",
    461438: "涨速(10分钟)",
    461439: "涨速(15分钟)",
    462057: "散户数量",
    526792: "振幅",
    527198: "未知字段527198",
    527526: "涨速(3分钟)",
    527527: "涨速(1分钟)",
    592544: "贡献度",
    592920: "市净率2",
    592741: "机构动向",
    592888: "主力净量",
    592890: "主力净流入",
    592893: "5日大单净量",
    592894: "10日大单净量",
    592946: "多空比",
    625362: "每股公积金",
    625295: "成交笔数2",
    658784: "金叉个数",
    658785: "利好",
    658786: "利空",
    920371: "开盘涨幅",
    920372: "实体涨幅",
    920428: "股票分类标记",
    1149395: "市净率3",
    1378761: "均价",
    1509847: "户均持股数",
    1640904: "手每笔",
    1771976: "量比",
    1968584: "换手率",
    1991120: "涨幅(港)",
    2034120: "市盈率(动态)2",
    2034121: "资产负债率",
    2097453: "流通股",
    2263506: "流通比例",
    2427336: "均笔额",
    2646480: "H股涨跌",
    2820564: "内盘",
    3082712: "涨幅(结算)",
    3475914: "流通市值",
    3541450: "总市值",
    3934664: "板块涨速",
    4065737: "买价",
    4099083: "日增仓2",
    4131273: "卖价",
    4525375: "小单流入",
    4525376: "中单流入",
    4525377: "大单流入",
    7000001: "占基金规模1",
    7000002: "持股变动1",
    7000003: "基金规模1",
    7000004: "代码2",
    7000005: "涨幅百分比",
    7000006: "持股变动2",
    7000007: "占基金规模2",
    7000008: "业绩表现",
    7000009: "近一年收益",
    7000010: "近一周收益",
    7000011: "近一月收益",
    7000012: "近三月收益",
    7000013: "今年以来收益",
    7000014: "成立以来收益",
    7000015: "产品类型",
    7000016: "基金规模2",
    7000017: "基金公司",
    7000018: "投资类型",
    7000019: "基金经理",
    7000020: "资产占比",
    7000021: "较上期",
    8311855: "类别",
    8719679: "小单流出",
    8719680: "中单流出",
    8719681: "大单流出",
    12345671: "A股关联主题",
    12913983: "小单净额",
    12913984: "中单净额",
    12913985: "大单净额",
    17108287: "小单净额占比",
    17108288: "中单净额占比",
    17108289: "大单净额占比",
    18550831: "成分股数",
    20190901: "标签",
    21302591: "小单总额",
    21302592: "中单总额",
    21302593: "大单总额",
    25496895: "小单总额占比",
    25496896: "中单总额占比",
    25496897: "大单总额占比",
    189546735: "计算数据项",
    2018090319: "竞价评级2",
    2018090320: "竞价异动说明",
    2018090410: "异动说明",
    2018090411: "竞价涨幅",

    32773: "ServerDelay",
    34056: "total_count",
}


def rand_account():
    data = "thsgu(st_8t502!(4@!d00365c(1a2(d6ad(0a8bf(b7(85840@4(:!5:57:c2:3d:a2$thsgu(st_(3jvnadc@38656da4ff781((d875210a5d131872!@d2:(d:cb:(1:20:57$thsgu(st_ikxh07kz@6c3!a67d127(b6da65!(6ad8!fd(c582@c(:fa:c6:62:11:!($thsgu(st_l8of433a@!1065354!(cd6f20fb2!f75(1b5a6f06@72:63:25:17:fc:b8$thsgu(st_8y35rh2q@663fc!2b4f7f6((db7c668b8cd1d4823@2(:56:(5:aa:47:d0$thsgu(st_31h0w71(@0f!da(267a(64ffccd7!600d!7(cca((@da:f2:(1:33:48:cc$thsgu(st_guqgh07g@a2f7!01f78cb33abdba2(c!78f(!ab!0@(a:74:cd:5a:83:0($thsgu(st_pxu8d2oh@11a6b58fa026ab1f101fb373277d72!6@c2:f6:1d:bb:26:2f$thsgu(st_jzuod40v@(b1d48b1bfc46f(f68d6ad2b(d!5a85!@d(:f6:!8:c8:d!:aa$thsgu(st_33irhhb4@fb6047(0ada4bca30d6f8c038514aa!(@02:a!:23:bc:ca:c5$thsgu(st_migfy5u1@50dd7cd5(44a2(c3c1265f!b4(5d7c74@7a:6c:1a:d5:67:(d$thsgu(st_h7k6(q!4@caad!6(4!68565710730!6(856(c45bb@a(:78:b7:1c:d7:!7$thsgu(st_x(y!mfi5@(238bfb!fd106f8(4(7c766!c22adbb6@7a:!0:a5:bc:8(:f2$thsgu(st_o4fal3kq@35b!f54d2df3ffbb0c6(42!5f15(56df@32:38:f8:8c:a8:6f$thsgu(st_dq31w1q8@84c21f4b75a(7ab6f30fd45f23b3f1a3@02:ac:8a:(2:!d:40$thsgu(st_x2igm6(v@d224d2!442!a5a!1577f6a181460dfd8@c2:2a:4d:d8:cc:d($thsgu(st_u4fvzss8@7f17a0b7f!13d(356288f10b31(1(dd5@8a:a4:c2:6b:20:02$thsgu(st_x0sf5arr@466d5656225(5558df67bf(422864!6f@2(:6d:(7:75:1b:0a$thsgu(st_oaf(1n7(@600b0a(2755aa!((01!6f15146!7(2!@a6:d!:38:a6:da:a5$thsgu(st_za3txqlm@f27ad4cb855567c65!246c6346164df7@c2:fb:!1:fd:6!:7a$thsgu(st_i5ka!jjp@!bd37b0c27c1(f2c0c(c00!831814f(!@1a:c6:a!:6!:1b:10$thsgu(st_6c1qt04f@f!5b!f721d!1226fb8c86a47ab6!672b@8(:80:a8:64:58:4d$thsgu(st_4fxh7byy@dd(80!c82(53c(36fa(36a01bdb15d88@d2:73:!2:46:2d:f5$thsgu(st_l7y(v!jz@db0abb!(83f1!4f!2bcf84c2(2baf2a4@6a:!2:d0:c4:4a:a!$thsgu(st_o0lm8g8m@b(67(a!037d0f73b4a4cda(8aa4f2a30@1(:43:60:1f:!:d8$thsgu(st_piqhl3z4@!18b(68!6(fadad288(8fd8741872707@8(:86:13:bb:!5:d0$thsgu(st_b!rx0kci@4a!c6755dc240f51c31c6d32c5dd35c3@f2:d5:24:7d:4a:(a$thsgu(st_640yz0du@d25!5328!2a61c62!d0d5(f03c7784d2@26:(!:72:0c:cc:4f$thsgu(st_sla14kfo@0cbd17!327268!600a57!8a2778204b1@ba:fc:b2:25:0c:88$thsgu(st_a8n0!kb!@2d6dab(a5!b7!8ca042885f4(8!2455a@8a:3d:b!:74:1f:0!$thsgu(st_4s76!d!n@(cb361c743(7(61c142a53475fb77!41@32:c(:d7:83:57:23$thsgu(st_o7gmqv7r@bc(425!20f13ca6b(6c0b01cc11a!7!6@22:22:f1:7c:15:81$thsgu(st_6j44b007@2d310dfcd1c8a3457bca750d514fa7d2@4(:3!:4b:d(:86:d0$thsgu(st_o(s!74f7@!4a!684730!d2c66cd501b418!303af6@!(:b7:8!:55:c7:a($thsgu(st_7j1qc8yw@3b42!6f8d23fdd5b2d8b6b84fbc08f(7@76:04:d5:d2:!b:a8$thsgu(st_fciuo7y3@(!425d1848a6!27b(5(1b4614!bd7cdd@32:(5:06:84:c4:40$thsgu(st_81pv8iai@7!d78!5a30f078848f(5c886a7cd31f1@2(:2(:(f:60:26:3f$thsgu(st_65!0rta4@(6b022c732!((d5780cf2dc1f1(dd37f@a6:df:81:af:7(:1f$thsgu(st_cjxmz0lw@4f55(c8ab2f2(728026d768cdbd3c432@76:28:2d:2c:7d:28$thsgu(st_q!1gnst0@36d71c16aa458562!8!(788c0f5(4a7f@f2:3a:06:a6:8a:(f$thsgu(st_yj8jrtbo@b(d11f55(((c1a3(c15af230(6071(bb@a(:3b:cc:(5:70:1d$thsgu(st_aa(r1tj6@3f30536!3(f(67!0844aa8a22a64ab0(@06:24:7!:d(:14:12$thsgu(st_d!v74g3m@0bfc70f1bf4b8(4b886fbb721f2b23!0@26:a5:37:44:b4:8d$thsgu(st_7fgr03yy@231(62d3a3d12d5714c1a007b5(d(0d(@!2:53:2(:2c:f5:4c$thsgu(st_nxxahzd!@(6b4fb8cc352!aa7ac06ba0a618b3d2c@c(:4a:b4:65:06:fa$thsgu(st_xnmcyi5f@c!a!2a((((c500b1a4(44bd(d5cccb6d@82:c7:5c:71:40:25$thsgu(st_!qiwy1ka@fa84a!cfbac0b06d6(6!01f2622c4761@5(:06:a8:21:(!:!6$thsgu(st_(6tz5w!1@2544f(42cd1c0!(8c((2fcaaa47cc557@aa:37:6d:f(:76:a4$thsgu(st_wc7dom0w@a35c35342f!8c8f(d68158!363c3844@a(:18:85:!2:03:d5$thsgu(st_hbfo7a84@bb406623d62(3c(7c(c8aac(!(8576!1@0a:75:b1:(c:82:31"

    parts = data.split("$")
    account = random.choice(parts)
    account = account.replace("(", "e").replace("!", "9")
    account = account.split("@")
    return account[0], account[1], account[2]


def string_to_mac(s: str,
                  format_style: str = "colon_upper",
                  oui_prefix: str = None,
                  hash_algorithm: str = "sha256") -> str:
    """
    将任意字符串确定性地映射为一个 MAC 地址

    参数:
        s: 输入的任意字符串
        format_style: 输出格式 (colon_upper, colon_lower, dash_upper, cisco, no_separator)
        oui_prefix: 可选，强制使用的前3字节(6个十六进制字符)，如 "00:16:3E"
        hash_algorithm: 使用的哈希算法 ("md5", "sha1", "sha256", "sha512"等)
    """
    # 使用指定的哈希算法计算摘要
    hash_func = hashlib.new(hash_algorithm)
    hash_func.update(s.encode('utf-8'))
    digest = hash_func.digest()

    # 取前6个字节作为 MAC 地址基础
    mac_bytes = bytearray(digest[:6])

    # 通常我们希望生成的是单播地址（第一字节最低位为0）
    # 同时把第二位也清零（避免组播/本地位）
    mac_bytes[0] &= 0xFC  # 清零最低两位 → 单播 + 全局

    # 如果指定了 OUI 前缀，则覆盖前3字节
    if oui_prefix:
        prefix_clean = oui_prefix.replace(":", "").replace("-", "").replace(".", "")
        if len(prefix_clean) != 6:
            raise ValueError("OUI 前缀必须是6个十六进制字符")
        prefix_bytes = binascii.unhexlify(prefix_clean)
        mac_bytes[0:3] = prefix_bytes

        # 如果用了固定 OUI，通常也保持单播性质
        mac_bytes[0] &= 0xFE

    # 根据格式输出
    if format_style == "colon_upper":
        return ':'.join(f'{b:02X}' for b in mac_bytes)
    elif format_style == "colon_lower":
        return ':'.join(f'{b:02x}' for b in mac_bytes)
    elif format_style == "dash_upper":
        return '-'.join(f'{b:02X}' for b in mac_bytes)
    elif format_style == "cisco":
        pairs = [int.from_bytes(mac_bytes[i:i + 2], 'big') for i in range(0, 6, 2)]
        return '.'.join(f'{p:04x}' for p in pairs)
    elif format_style == "no_separator":
        return ''.join(f'{b:02X}' for b in mac_bytes)
    else:
        raise ValueError(f"不支持的格式: {format_style}")
