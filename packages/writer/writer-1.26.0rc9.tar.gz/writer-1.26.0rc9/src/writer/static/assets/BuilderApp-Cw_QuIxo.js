function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["./index-BE6RSzCE.js","./index-BKNuk68o.css","./BuilderEmbeddedCodeEditor-B_mePKpd.js","./BuilderEmbeddedCodeEditor-B0bcjlhk.css","./BuilderSidebarToolkit-DrxnwV01.js","./WdsCheckbox-TLlfBAzj.js","./WdsCheckbox-DKvpPA4D.css","./marked.esm-273vDTCT.js","./BuilderSidebarToolkit-CwqbjRv8.css","./BuilderSidebarComponentTree-io7IaEuB.js","./BuilderSidebarComponentTree-DYu1F793.css","./BuilderSettings-CLZnGiL-.js","./WdsDropdownMenu-qgYbo7Yd.js","./WdsDropdownMenu-CzzPN9Wg.css","./WdsTabs-D0Nt85Yz.js","./WdsTabs-DKj7BqI0.css","./WdsFieldWrapper-X0-0L30U.js","./WdsFieldWrapper-CsemOh8D.css","./useKeyValueEditor-C1JO3d2Y.js","./BuilderSettings-BN0g4wlH.css","./ComponentRenderer-Dq2unetb.js","./ComponentRenderer-72hqvEvI.css","./BuilderInsertionOverlay-BMsACrNL.js","./BuilderInsertionOverlay-D2XS0ij9.css","./BuilderInsertionLabel-B8H8vy-V.js","./BuilderInsertionLabel-_YS5WPfq.css","./BuilderVault-Cp6WwWfZ.js","./BuilderVault-Cx6oQSES.css","./BuilderJournal-C61kSD6i.js","./SharedCopyClipboardButton-BzBAVn5j.js","./SharedCopyClipboardButton-BipJKGtz.css","./BuilderJournal-DHv3Pvvm.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}
import{d as F,i as V,a as R,r as O,u as ye,c as w,o as t,f as p,g as d,x as B,y as z,A as q,G as K,R as c,S as $,_ as W,T as Le,U as xe,V as Se,X as Et,Y as De,w as te,q as re,Z as Mt,$ as it,a0 as _t,b as A,a1 as yt,D as j,s as he,v as Ee,t as U,m as ie,a2 as ht,z as L,a3 as we,a4 as Lt,a5 as gt,a6 as Ft,a7 as bt,W as ne,a8 as Be,K as Fe,L as me,a9 as Nt,aa as ot,J as le,ab as Rt,E as ue,ac as Ut,ad as Wt,ae as Ae,af as ct,ag as se,ah as Pe,ai as Oe,aj as at,ak as ke,al as Vt,am as zt,an as lt,ao as ce,Q as pe,ap as kt,aq as wt,ar as St,as as Ot,at as qe,au as qt,av as Kt,aw as Bt,ax as Ne,ay as jt,az as Ht,aA as Gt,aB as Yt,aC as Jt,aD as Ct,aE as rt,aF as Zt,aG as Xt,aH as Qt,aI as ea,aJ as ta,p as pt,aK as aa,aL as na,H as oa,aM as la,aN as nt}from"./index-BE6RSzCE.js";import{W as ra}from"./WdsCheckbox-TLlfBAzj.js";import{marked as sa}from"./marked.esm-273vDTCT.js";const ia={class:"BuilderSwitcher"},ua=F({__name:"BuilderSwitcher",setup(e){const n=V(R.core),a=V(R.builderManager);let l=O(null);const o=ye(n),s={ui:void 0,blueprints:void 0};function i(g){return g==="blueprints"||g==="ui"}function u(g){const m=a.mode.value;if(m!=g){switch(i(m)&&n.activePageId.value&&(s[m]=n.activePageId.value),l.value=g,g){case"ui":o.track("nav_ui_opened");break;case"preview":o.track("nav_preview_opened");break;case"blueprints":o.track("nav_blueprints_opened");break;case"vault":o.track("nav_vault_opened");break;case"journal":o.track("nav_journal_opened");break}a.mode.value=g,i(g)&&s[g]&&n.getComponentById(s[g])&&n.setActivePageId(s[g]),(g=="preview"||m=="blueprints"||g=="blueprints")&&a.setSelection(null)}}const f=w(()=>a.getMode());return(g,m)=>(t(),p("div",ia,[d("button",{"data-automation-action":"set-mode-ui",class:K({active:f.value=="ui"}),type:"button",onClick:m[0]||(m[0]=h=>u("ui"))},[B(z,{name:"frame"}),m[5]||(m[5]=q(" Interface "))],2),d("button",{"data-automation-action":"set-mode-blueprints",class:K({active:f.value=="blueprints"}),type:"button",onClick:m[1]||(m[1]=h=>u("blueprints"))},[B(z,{name:"wds-blueprints"}),m[6]||(m[6]=q(" Blueprints "))],2),c(n).isWriterCloudApp.value?(t(),p("button",{key:0,class:K({active:f.value=="vault"}),"data-automation-action":"set-mode-vault",type:"button",onClick:m[2]||(m[2]=h=>u("vault"))},[B(z,{name:"key-round"}),m[7]||(m[7]=q(" Vault "))],2)):$("",!0),d("button",{class:K({active:f.value=="preview"}),"data-automation-action":"set-mode-preview",type:"button",onClick:m[3]||(m[3]=h=>u("preview"))},[B(z,{name:"view"}),m[8]||(m[8]=q(" Preview "))],2),c(n).isWriterCloudApp.value&&c(n).featureFlags.value.includes("journal")?(t(),p("button",{key:1,class:K({active:f.value=="journal"}),"data-automation-action":"set-mode-journal",type:"button",onClick:m[4]||(m[4]=h=>u("journal"))},[B(z,{name:"scroll-text"}),m[9]||(m[9]=q(" Journal "))],2)):$("",!0)]))}}),da=W(ua,[["__scopeId","data-v-18cb2923"]]),ca={class:"BuilderStateExplorer"},pa=F({__name:"BuilderStateExplorer",setup(e){const n=V(R.core);return(a,l)=>(t(),p("div",ca,[B(Le,{data:c(n).userState.value,"enable-copy-to-json":!0,"initial-depth":1,"hide-root":!0},null,8,["data"])]))}}),va=W(pa,[["__scopeId","data-v-45c6b03e"]]),fa=F({__name:"WdsStateDot",props:{state:{type:String,required:!0}},setup(e){return(n,a)=>(t(),p("div",{class:K(["WdsStateDotState",`WdsStateDotState--${e.state}`])},null,2))}}),$t=W(fa,[["__scopeId","data-v-4eacfc04"]]);function ma(e,n){let a;return()=>{a&&clearTimeout(a),a=setTimeout(e,n)}}function _a(e){const n=xe(),a=ye(e),l=it(),{pushToast:o}=Se(),{writerApi:s,apiBaseUrl:i}=Et({signal:n.signal}),u=w(()=>e.getComponentById("root")),f=O(!1),g=De(),m=De(),h=ma(async()=>{e.isWriterCloudApp.value&&e.mode.value==="edit"&&!C.value&&s.updateApplicationMetadata(e.writerOrgId.value,e.writerAppId.value,{name:S.value}),await e.sendComponentUpdate()},1e3),S=w({get:()=>u.value.content.appName,set:k=>{u.value.content.appName!==k&&(u.value.content.appName=k,h())}});te(()=>u.value.content.appName,h),te(m,()=>{var T;const k=(T=m.value)==null?void 0:T.name;k!==void 0&&(S.value=k)});const r=w(()=>{var D,E;const k=(E=(D=m.value.writer)==null?void 0:D.teamIds)==null?void 0:E[0];if(!k)return;const T=`/organization/${e.writerOrgId.value}/team/${k}/framework/${e.writerAppId.value}`;return new URL(T,i)}),_=w(()=>{if(!(!e.writerOrgId.value||!e.writerAppId.value))return new URL(`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,i)}),C=w(()=>{var k;return(k=m.value)!=null&&k.lastDeployedAt?new Date(m.value.lastDeployedAt):void 0}),y=w(()=>!!(e.isWriterCloudApp.value&&m.value)),b=w(()=>{var k;return((k=m.value)==null?void 0:k.status)==="deployed"});te(e.writerApplication,I,{immediate:!0}),re(()=>{document.addEventListener("visibilitychange",async()=>{document.visibilityState==="visible"&&await I()},{signal:n.signal})});async function I(){if(e.writerApplication.value)try{m.value=await s.fetchApplicationDeployment(e.writerOrgId.value,e.writerAppId.value)}catch(k){l.error("Failed to fetch deployment information",k),m.value=void 0}}async function v(){if(e.writerApplication.value){if(!b.value){const k=`/aistudio/organization/${e.writerOrgId.value}/agent/${e.writerAppId.value}/deploy`,T=new URL(k,i);window.open(T,"_blank");return}f.value=!0,g.value=void 0;try{await s.publishApplication(e.writerOrgId.value,e.writerAppId.value,{applicationVersionId:m.value.applicationVersion.id,applicationVersionDataId:m.value.applicationVersionData.id}),await I();const k=r.value?{label:"See it live",func:()=>window.open(r.value,"_blank"),icon:"open_in_new"}:void 0;o({type:"success",message:"agent deployed",action:k}),a.track("deployment_succeeded")}catch(k){a.track("deployment_failed",{error:String(k)}),g.value=k,l.error("Deploy failed",k),o({type:"error",message:"deploy failed"})}finally{f.value=!1}}}return{name:S,canDeploy:y,writerDeployUrl:_,hasBeenPublished:b,publishApplication:v,isDeploying:Mt(f),lastDeployedAt:C}}const ya=["data-writer-tooltip"],ha=["src","alt"],ga={key:1,class:"SharedWriterAvatar__initials"},ba=F({__name:"SharedWriterAvatar",props:{userId:{type:Number,required:!0},showTooltip:{type:Boolean,required:!1}},setup(e){const n=e,a=w(()=>n.userId),l=O(!1),{user:o,isLoading:s}=_t(a),i=w(()=>{var m;return((m=o.value)==null?void 0:m.avatar)??""}),u=w(()=>{var m;return(((m=o.value)==null?void 0:m.firstName)??"?").at(0)}),f=w(()=>{if(!(!n.showTooltip||!o.value))return`${o.value.firstName??""} ${o.value.lastName??""}`}),g=w(()=>o.value?`Avatar of ${o.value.firstName??""} ${o.value.lastName??""}`:`Avatar of the user ID ${a.value}`);return(m,h)=>(t(),p("div",{class:"SharedWriterAvatar","data-writer-tooltip":f.value},[c(s)||i.value&&!l.value?(t(),A(yt,{key:0,class:"SharedWriterAvatar__loader"})):$("",!0),c(s)?$("",!0):(t(),p(j,{key:1},[i.value?he((t(),p("img",{key:0,src:i.value,alt:g.value,class:"SharedWriterAvatar__img",onLoad:h[0]||(h[0]=S=>l.value=!0)},null,40,ha)),[[Ee,l.value]]):(t(),p("div",ga,U(u.value),1))],64))],8,ya))}}),ut=W(ba,[["__scopeId","data-v-d974552d"]]),ka=["data-writer-tooltip"],wa={key:0,class:"profile"},Sa={key:1,class:"profile"},Ba=F({__name:"BuilderHeaderConnected",setup(e){const n=V(R.collaborationManager),a=w(()=>n.connectedProfiles.value.length),l=w(()=>{var s;return(s=n.connectedProfiles.value)==null?void 0:s[0]}),o=w(()=>"Also editing: "+n.connectedProfiles.value.map(i=>i.displayName).join(", "));return(s,i)=>a.value>0?(t(),p("div",{key:0,class:"BuilderHeaderConnected","data-writer-tooltip":o.value,"data-writer-tooltip-placement":"bottom"},[a.value==1?(t(),p("div",wa,[B(ut,{"user-id":l.value.userId},null,8,["user-id"])])):$("",!0),a.value>1?(t(),p("div",Sa," +"+U(a.value),1)):$("",!0)],8,ka)):$("",!0)}}),Ca=W(Ba,[["__scopeId","data-v-a13cab91"]]),$a=F({__name:"BuilderHeaderMoreDropdown",setup(e){const n=w(()=>[{label:"Import agent .zip file",value:"import",icon:"upload"},{label:"Download agent .zip file",value:"export",icon:"download"},{label:l.preventTasks.value.has("stayAwake")?"Turn off stay awake mode":"Keep session awake",value:"awake",icon:"coffee"}]),a=V(R.core),l=V(R.socketTimeout),o=ie("exportInput"),s=ye(a),i=Se(),u=O(!1),f=O(!1),g=O(!1),m=w(()=>[{disabled:u.value,desc:"Cancel",fn:()=>{g.value=!1,f.value=!1}},{disabled:!g.value,loading:u.value,desc:"Import",fn:S}]);async function h(){if(s.track("nav_export_clicked"),!o.value)return;const _=await fetch("./api/export");if(!_.ok)throw new Error("Failed to connect to export API");const C=await _.blob(),y=window.URL.createObjectURL(C),b=document.createElement("a");b.href=y,b.download="export.zip",document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(y)}async function S(){if(s.track("nav_import_clicked"),!o.value)return;const _=o.value.files[0];if(_){u.value=!0;try{const C=new FormData;if(C.append("file",_),!(await fetch("./api/import",{method:"POST",body:C})).ok)throw new Error("Failed to connect to import API");f.value=!1,i.pushToast({type:"success",message:"Project imported successfully."})}catch(C){i.pushToast({type:"error",message:"Failed to import the project: "+(C instanceof Error?C.message:String(C))})}finally{u.value=!1}}}async function r(_){switch(_){case"export":try{await h()}catch(C){i.pushToast({message:`Failed to export the project: ${C}`,type:"error"})}break;case"import":o.value.value="",o.value.click();break;case"awake":l==null||l.togglePreventTaskId("stayAwake")}}return(_,C)=>(t(),p(j,null,[B(ht,{class:"BuilderHeaderMoreDropdown","trigger-variant":"secondary",options:n.value,onSelect:r},null,8,["options"]),he(d("input",{ref_key:"exportInput",ref:o,type:"file",accept:".zip,application/zip",onChange:C[0]||(C[0]=y=>f.value=!0)},null,544),[[Ee,!1]]),f.value?(t(),A(we,{key:0,actions:m.value,title:"Are you sure you want to continue?",description:"Your current work will be replaced with the agent in the zip file. This includes replacement of current pages, blueprints, local scripts, and custom assets.",size:"normal"},{default:L(()=>[B(ra,{modelValue:g.value,"onUpdate:modelValue":C[1]||(C[1]=y=>g.value=y),label:"Yes, I want to replace the current agent with the imported file"},null,8,["modelValue"])]),_:1},8,["actions"])):$("",!0)],64))}}),Ia=W($a,[["__scopeId","data-v-095be7a9"]]);function Aa(e){const n=Se();let a;function l(i){a?n.pushToast({id:a,...i}):a=n.pushToast(i)}te(e.syncHealth,(i,u)=>{switch(i){case"idle":return l({type:"loading",message:"Connecting to the server",closable:!1,delayMs:1/0});case"connected":return l({message:u==="suspended"?"The server has restarted":"The connection to the server has been restored.",type:"success"});case"offline":return l({type:"loading",message:"Connection was lost due to a network issue or an ongoing update. Please hang tight!",closable:!1,delayMs:1/0});case"suspended":return l({message:"Restarting the server...",type:"loading",closable:!1,delayMs:1/0})}});const o=w(()=>{let i="";switch(e.syncHealth.value){case"offline":i+="Offline. Not syncing.";break;case"connected":i+="Online. Syncing...";break;case"idle":i+="Sync not initialised.";break;case"suspended":i+="Sync suspended.";break}return e.featureFlags.value.length>0&&(i+=` Feature flags: ${e.featureFlags.value.join(", ")}`),i}),s=w(()=>{switch(e.syncHealth.value){case"offline":case"suspended":case"idle":return"error";default:return"deployed"}});return{syncHealthStatus:o,stateDotState:s}}const Ta={class:"BuilderHeader"},Pa={class:"BuilderHeader__logo"},Da=["href"],xa={key:1,src:gt,alt:"Writer Framework logo"},Ea=["disabled"],Ma={class:"BuilderHeader__toolbar"},La={class:"BuilderHeader__toolbar__deployBtn"},Fa=F({__name:"BuilderHeader",setup(e){const n=V(R.core),a=V(R.socketTimeout),l=O(!1),o=O(!1),s=ye(n),i=Se(),u=Lt(),{stateDotState:f,syncHealthStatus:g}=Aa(n),m=w(()=>a==null?void 0:a.preventTasks.value.has("stayAwake"));function h(){a==null||a.togglePreventTaskId("stayAwake")}const{canDeploy:S,isDeploying:r,publishApplication:_,hasBeenPublished:C,lastDeployedAt:y,writerDeployUrl:b,name:I}=_a(n),v=new Intl.DateTimeFormat(void 0,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"});async function k(){s.track("nav_deploy_clicked"),C.value?T.value=!0:await _()}const T=O(!1),D=[{desc:"Cancel",fn:()=>{T.value=!1}},{desc:"Yes, deploy changes",fn:async()=>{T.value=!1,await _()}}],E=w(()=>y.value?`Editor Last saved ${v.format(y.value)}`:void 0),M=w(()=>C.value===!0?"Deploy changes":(C.value===!1,"Configure deployment"));function N(){s.track("nav_state_explorer_opened"),l.value=!0}function Y(){o.value=!0}async function Q(){try{await u.copy(location.href)}catch{i.pushToast({type:"error",message:"Could not copy link."})}}return(X,J)=>(t(),p("div",Ta,[d("div",Pa,[c(b)?(t(),p("a",{key:0,href:c(b).toString(),target:"_blank",class:"BuilderHeader__goBack"},J[3]||(J[3]=[d("img",{src:gt,alt:"Writer Framework logo"},null,-1)]),8,Da)):(t(),p("img",xa)),J[4]||(J[4]=d("hr",null,null,-1)),c(n).isWriterCloudApp.value?he((t(),p("input",{key:2,"onUpdate:modelValue":J[0]||(J[0]=de=>bt(I)?I.value=de:null),type:"text",disabled:!!c(y),class:"BuilderHeader__logo__appTitle"},null,8,Ea)),[[Ft,c(I)]]):$("",!0)]),B(da,{class:"BuilderHeader__switcher"}),d("div",Ma,[J[6]||(J[6]=d("hr",null,null,-1)),B(ne,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"State Explorer","data-writer-tooltip-placement":"bottom",onClick:N},{default:L(()=>[B(z,{name:"compass"})]),_:1}),B(ne,{variant:"secondary",size:"smallIcon","data-writer-tooltip":"Invite collaborators","data-writer-tooltip-placement":"bottom",onClick:Y},{default:L(()=>[B(z,{name:"share-2"})]),_:1}),B(Ia),c(S)?(t(),A(ne,{key:0,size:"small",loading:c(r),"data-writer-tooltip":E.value,"data-writer-tooltip-placement":"bottom","data-automation-key":"deploy",onClick:k},{default:L(()=>[d("span",La,U(M.value),1),T.value?(t(),A(we,{key:0,title:"Are you sure you want to deploy these changes?",size:"normal",actions:D},{default:L(()=>J[5]||(J[5]=[d("p",{class:"BuilderHeader__toolbar__deployModal__text"}," This will replace the current live version of this agent everywhere it is currently deployed. ",-1)])),_:1})):$("",!0)]),_:1},8,["loading","data-writer-tooltip"])):$("",!0),B(Ca),B($t,{state:c(f),"data-writer-tooltip":c(g),"data-writer-tooltip-placement":"left"},null,8,["state","data-writer-tooltip"]),m.value?(t(),A(ne,{key:1,variant:"secondary",size:"smallIcon","data-writer-tooltip":"Turn off stay awake mode that prevents the session from expiring.","data-writer-tooltip-placement":"left",onClick:h},{default:L(()=>[B(z,{name:"coffee"})]),_:1})):$("",!0),l.value?(t(),A(we,{key:2,title:"State Explorer","display-close-button":"",onClose:J[1]||(J[1]=de=>l.value=!1)},{default:L(()=>[B(va)]),_:1})):$("",!0),o.value?(t(),A(we,{key:3,title:"Share edit link with collaborators",description:"All AI Studio builders in your org can edit this agent with you in real time. Copy the link below to point them directly to editing this agent.","display-close-button":"",actions:[{desc:"Close",fn:()=>o.value=!1},{desc:c(u).copied.value?"Copied":"Copy edit link",fn:Q,icon:c(u).copied.value?"check":"clipboard",disabled:c(u).copied.value}],onClose:J[2]||(J[2]=de=>o.value=!1)},null,8,["actions"])):$("",!0)])]))}}),Na=W(Fa,[["__scopeId","data-v-1a28dcd5"]]),Ra={class:"text"},Ua=200,Wa=4,Va=F({__name:"BuilderTooltip",setup(e){const n=ie("rootEl"),a=O(!1),l=O(null);let o=null,s=null;const i=O("top"),u=O({top:0,left:0});async function f(){if(!o||(l.value=o.dataset.writerTooltip,!l.value))return;const r=o.dataset.writerTooltipGap?parseInt(o.dataset.writerTooltipGap):Wa;if(a.value=g(o),!a.value)return;await me();const{x:_,y:C,width:y,height:b}=o.getBoundingClientRect(),{width:I,height:v}=n.value.getBoundingClientRect();switch(i.value){case"top":u.value.top=C-v-r,u.value.left=_+y/2-I/2;break;case"right":u.value.top=C+b/2-v/2,u.value.left=_+y+r;break;case"left":u.value.left=_-I-r,u.value.top=C+b/2-v/2;break;case"bottom":u.value.top=C+b+r,u.value.left=_+y/2-I/2;break}}function g(r){return r.getAttribute("data-writer-tooltip-strategy")==="overflow"?r.scrollWidth>r.clientWidth:!0}function m(r){const C=r.target.closest("[data-writer-tooltip]");if(C)o!==C&&(a.value=!1);else{a.value=!1,o=null;return}o=C,i.value=o.dataset.writerTooltipPlacement??"top",setTimeout(()=>h(C),Ua)}async function h(r){r===o&&(s==null||s.disconnect(),s=new MutationObserver(f),s.observe(o,{attributes:!0,attributeFilter:["data-writer-tooltip","data-writer-tooltip-placement","data-writer-tooltip-strategy"]}),f())}const S=w(()=>{const{top:r,left:_}=u.value;return{top:`${r}px`,left:`${_}px`}});return re(()=>{document.documentElement.addEventListener("mouseover",m)}),Be(()=>{document.documentElement.removeEventListener("mouseover",m),s==null||s.disconnect()}),(r,_)=>he((t(),p("div",{ref_key:"rootEl",ref:n,class:"BuilderTooltip",style:Fe(S.value)},[d("div",{class:K(["arrow",i.value])},null,2),d("div",Ra,U(l.value),1)],4)),[[Ee,a.value]])}}),za=W(Va,[["__scopeId","data-v-7ba01c7c"]]),Oa=""+new URL("art-paper-D70v1WMA.svg",import.meta.url).href,qa={class:"BuilderPanel__collapser"},Ka={class:"BuilderPanel__title"},ja={class:"BuilderPanel__titleCompanion"},Ha=["data-order"],Ga={key:0,class:"BuilderPanel__contents__leftPanel"},Ya={class:"BuilderPanel__actions"},Ja={class:"BuilderPanel__actionsCompanion"},Za=F({__name:"BuilderPanel",props:{panelId:{},name:{},actions:{},contentsTeleportEl:{},scrollable:{type:Boolean},keyboardShortcutKey:{},enableLeftPanel:{type:Boolean},enableDropFile:{type:Boolean},maxFileSizeLimit:{}},emits:{openned:e=>typeof e=="boolean",filesDrop:e=>Array.isArray(e)&&e.length>0},setup(e,{expose:n,emit:a}){const l=V(R.builderManager),o=["code","log"],s=e,i=w(()=>{if(typeof s.maxFileSizeLimit=="number")return`Files can be up to ${Nt(s.maxFileSizeLimit)}`}),u=a,f=ie("mainContents");n({mainContents:f});const g=w(()=>s.enableDropFile&&m.value),m=O(!1);function h(v,k){s.enableDropFile&&(v.preventDefault(),m.value=k)}function S(v){v.preventDefault(),m.value=!1}function r(v){s.enableDropFile&&v.length>0&&u("filesDrop",v)}const _=w(()=>!l.openPanels.value.has(s.panelId)),C=w(()=>o.indexOf(s.panelId));function y(v){if(l.openPanels.value.has(v)){l.openPanels.value.delete(v),u("openned",!1);return}l.openPanels.value.add(v),u("openned",!0)}function b(v){const k=Wt(v);if(k&&v.key==s.keyboardShortcutKey.toLowerCase()){v.preventDefault(),y(s.panelId);return}s.actions.forEach(T=>{if(!T.keyboardShortcut)return;const{key:D,modifierKey:E}=T.keyboardShortcut;D.toLowerCase()==v.key&&(!k&&E||(v.preventDefault(),T.callback()))})}function I(v){if(!v)return"";let k=" (";return v.modifierKey&&(k+=ot()),k+=v.key,k+=")",k}return re(async()=>{document.addEventListener("keydown",b)}),Be(()=>{document.removeEventListener("keydown",b)}),(v,k)=>(t(),p("div",{class:K(["BuilderPanel",{collapsed:_.value}])},[d("div",qa,[B(ne,{variant:"neutral",size:"small","data-automation-action":"toggle-panel","data-automation-key":v.panelId,"data-writer-tooltip":`Toggle ${v.name} (${c(ot)()}${v.keyboardShortcutKey})`,onClick:k[0]||(k[0]=T=>y(v.panelId))},{default:L(()=>[B(z,{name:_.value?"chevron-right":"chevron-up"},null,8,["name"]),d("span",Ka,U(v.name),1)]),_:1},8,["data-automation-key","data-writer-tooltip"])]),d("div",ja,[le(v.$slots,"titleCompanion",{},void 0,!0)]),_.value?$("",!0):(t(),A(Ut,{key:0,to:v.contentsTeleportEl},[d("div",{style:Fe({order:C.value}),"data-order":C.value,class:K(["BuilderPanel__contents",{"BuilderPanel__contents--leftPanel":v.enableLeftPanel,"BuilderPanel__contents--dropingFile":g.value}]),onDrop:S,onDragover:k[1]||(k[1]=T=>h(T,!0)),onDragleave:k[2]||(k[2]=T=>h(T,!1))},[g.value?(t(),A(Rt,{key:0,multiple:"",label:"Drop files here",restrictions:i.value,onDrop:r},null,8,["restrictions"])):(t(),p(j,{key:1},[v.enableLeftPanel?(t(),p("div",Ga,[le(v.$slots,"leftPanel",{},void 0,!0)])):$("",!0),d("div",Ya,[d("div",Ja,[le(v.$slots,"actionsCompanion",{},void 0,!0)]),(t(!0),p(j,null,ue(v.actions,(T,D)=>(t(),A(ne,{key:D,"data-writer-tooltip":T.name+I(T.keyboardShortcut),"data-writer-tooltip-placement":"left",variant:"neutral",size:"smallIcon",disabled:T.isDisabled,onClick:T.callback},{default:L(()=>[B(z,{name:T.icon},null,8,["name"])]),_:2},1032,["data-writer-tooltip","disabled","onClick"]))),128))]),d("div",{ref_key:"mainContents",ref:f,class:"BuilderPanel__mainContents"},[le(v.$slots,"default",{},void 0,!0)],512)],64))],46,Ha)],8,["to"]))],2))}}),It=W(Za,[["__scopeId","data-v-5ccf1c14"]]),st=150;function Xa(e){const n=O(structuredClone(Ae(e.sourceFiles.value)));te(e.sourceFiles,(b,I)=>{let v=!1,k=structuredClone(Ae(n.value));const T=i(I).map(a);for(const D of ct(b)){const E=se(D,I),M=se(D,b);if(Pe(M))continue;if(E===void 0||Oe(M)){k=at(D,k,structuredClone(Ae(M))),v=!0;continue}if(!ke(E))continue;const N=!E.complete&&M.complete,Y=E.complete&&M.complete;if(!N&&!Y)continue;const Q=a(D);if(T.includes(Q))continue;const X=se(D,k);ke(X)&&(v=!0,X.complete=!0,X.content=M.content)}for(const D of Vt(k))se(D,b)===void 0&&(k=zt(D,k),v=!0);v&&(n.value=k)});function a(b){return b.join("/")}const l=De(),o=w(()=>Array.from(ct(n.value))),s=w(()=>i(e.sourceFiles.value));function i(b){return o.value.filter(I=>{const v=se(I,n.value);if(Oe(v))return!1;if(!ke(v))return!0;const k=se(I,b);return ke(k)?!v.complete||!k.complete?!1:v.content!==k.content:!0})}const u=w(()=>{if(l.value!==void 0)return se(l.value,n.value)}),f=w({get(){return ke(u.value)?u.value.content:""},set(b){if(l.value===void 0)return;const I=se(l.value,n.value);ke(I)&&(I.content=b)}});function g(b=1){const I=`new-file-${b}.txt`;return se([I],n.value)?g(b+1):I}async function m(){const b=g();n.value=at([b],Ae(n.value)),r([b]),await e.sendCreateSourceFileRequest([b])}const h=w(()=>{var I;return(I=l.value)!=null&&I.length?l.value.at(-1).split(".").at(-1):""}),S=w(()=>{switch(h.value){case"py":return"python";case"js":case"mjs":return"javascript";case"ts":return"typescript";case"md":case"markdown":return"markdown";default:return h.value}});function r(b){l.value=b,ke(u.value)&&!u.value.complete&&e.requestSourceFileLoading(b)}async function _(b){if(!(!l.value||!u.value)&&(u.value.type==="file"&&await e.sendCodeSaveRequest(f.value,l.value),b)){const I=[...Ae(l.value)];l.value=void 0;try{await e.sendRenameSourceFileRequest(I,b)}catch(v){throw l.value=I,v}r(b)}}function C(b){return new Promise((I,v)=>{const k=new FileReader;k.addEventListener("loadend",T=>{const D=T.target.result;if(D instanceof ArrayBuffer){const E=String.fromCharCode.apply(null,new Uint8Array(D));return I(E)}I(D.split(",")[1])}),k.addEventListener("error",()=>{v()}),k.readAsDataURL(b)})}async function y(b){const I=st*1024*1024;if(b.size>I)throw Error(`Cannot upload file bigger than ${st}mb`);const v=[b.name];if(se(v,e.sourceFiles.value))throw Error(`The file ${b.name} already exists`);n.value=at(v,Ae(n.value),{type:"binary",uploading:!0});const k=await C(b);await e.sendFileUploadRequest(v,k)}return{code:f,sourceFileDraft:n,fileOpen:u,filepathOpen:l,pathsUnsaved:s,openedFileLanguage:S,save:_,upload:y,openFile:r,openNewFile:m,getNewFilename:g}}const Qa={class:"BuilderTree"},en=["draggable","data-automation-key","aria-expanded"],tn=["data-writer-tooltip"],an={key:1,class:"BuilderTree__main__dropdown"},nn=F({__name:"BuilderTree",props:lt({name:{type:String,required:!0},query:{type:String,required:!1,default:void 0},variant:{type:String,required:!1,default:void 0},noNestedSpace:{type:Boolean,required:!1},dataAutomationKey:{type:String,required:!1,default:void 0},hasChildren:{type:Boolean},draggable:{type:Boolean},matched:{type:Boolean},selected:{type:Boolean},disabled:{type:Boolean},dropdownOptions:{type:Array,required:!1,default:void 0},disableCollapse:{type:Boolean,required:!1}},{collapsed:{type:Boolean,required:!1,default:!1},collapsedModifiers:{}}),emits:lt({expandBranch:()=>!0,select:e=>!!e,dragover:e=>!!e,dragstart:e=>!!e,dragend:e=>!!e,drop:e=>!!e,dropdownSelect:e=>typeof e=="string"},["update:collapsed"]),setup(e,{expose:n,emit:a}){const l=ce({loader:()=>pe(()=>import("./index-BE6RSzCE.js").then(S=>S.bL),__vite__mapDeps([0,1]),import.meta.url)}),o=e,s=a;n({expand:m,toggleCollapse:h});const i=kt(e,"collapsed"),u=O(!1),f=w(()=>!o.matched),g=w(()=>!o.hasChildren);function m(){i.value=!1,s("expandBranch")}function h(S){S??(S=!i.value),S!==i.value&&(i.value=S)}return(S,r)=>(t(),p("div",Qa,[d("div",{class:K(["BuilderTree__main",{selected:e.selected,notMatched:f.value,childless:g.value}]),tabindex:"0",draggable:e.draggable,"data-automation-key":e.dataAutomationKey,"aria-expanded":!i.value,onMouseenter:r[2]||(r[2]=_=>u.value=!0),onMouseleave:r[3]||(r[3]=_=>u.value=!1),onClick:r[4]||(r[4]=_=>S.$emit("select",_)),onKeydown:r[5]||(r[5]=St(_=>S.$emit("select",_),["enter"])),onDragover:r[6]||(r[6]=_=>S.$emit("dragover",_)),onDragstart:r[7]||(r[7]=_=>S.$emit("dragstart",_)),onDragend:r[8]||(r[8]=_=>S.$emit("dragend",_)),onDrop:r[9]||(r[9]=_=>S.$emit("drop",_))},[e.hasChildren&&!e.disableCollapse?(t(),A(ne,{key:0,class:"BuilderTree__main__collapser",variant:"neutral",size:"icon",disabled:e.disabled,onClick:r[0]||(r[0]=wt(_=>h(void 0),["stop"]))},{default:L(()=>[B(z,{name:i.value?"chevron-down":"chevron-up"},null,8,["name"])]),_:1},8,["disabled"])):$("",!0),le(S.$slots,"nameLeft",{},void 0,!0),d("span",{class:K(["BuilderTree__main__name",{"BuilderTree__main__name--disabled":e.disabled,"BuilderTree__main__name--root":e.variant==="root"}]),"data-writer-tooltip":e.name,"data-writer-tooltip-strategy":"overflow"},U(e.name),11,tn),le(S.$slots,"nameRight",{},void 0,!0),e.dropdownOptions&&u.value?(t(),p("div",an,[B(c(l),{options:e.dropdownOptions,"trigger-custom-size":"16px",onSelect:r[1]||(r[1]=_=>S.$emit("dropdownSelect",_))},null,8,["options"])])):$("",!0)],42,en),B(Ot,null,{default:L(()=>[he(d("div",{class:K(["BuilderTree__children",{"BuilderTree__children--noNestedSpace":e.noNestedSpace}])},[le(S.$slots,"children",{},void 0,!0)],2),[[Ee,!i.value&&e.hasChildren]])]),_:3})]))}}),on=W(nn,[["__scopeId","data-v-8c085d0a"]]),ln=["width","height","viewBox","aria-valuenow"],rn=["r","cx","cy","stroke","stroke-width"],sn=["r","cx","cy","stroke","stroke-width","stroke-dasharray","stroke-dashoffset"],un=F({__name:"WdsProgressLinear",props:{progress:{type:Number,required:!1,default:100},sizePx:{type:Number,required:!1,default:12},strokeWidth:{type:Number,required:!1,default:2}},setup(e){const n=e,a=w(()=>n.sizePx/2),l=w(()=>n.sizePx/2-n.strokeWidth/2),o=w(()=>2*Math.PI*l.value),s=w(()=>o.value*((100-n.progress)/100)),i=w(()=>`0 0 ${n.sizePx} ${n.sizePx}`);return(u,f)=>(t(),p("svg",{width:e.sizePx,height:e.sizePx,viewBox:i.value,style:{transform:"rotate(-90deg)"},role:"progressbar","aria-valuenow":e.progress,"aria-valuemin":"0","aria-valuemax":"100"},[d("circle",{r:l.value,cx:a.value,cy:a.value,fill:"transparent",stroke:c(qe).Blue1,"stroke-width":e.strokeWidth},null,8,rn),d("circle",{r:l.value,cx:a.value,cy:a.value,fill:"transparent",stroke:c(qe).Blue5,"stroke-width":e.strokeWidth,"stroke-dasharray":o.value,"stroke-dashoffset":s.value},null,8,sn)],8,ln))}}),dn=F({__name:"BuilderCodePanelFileUploading",props:{timeMs:{type:Number,required:!0}},setup(e){const n=e,a=O(0);return re(()=>{let l;const o=s=>{l||(l=s);const i=s-l;a.value=Math.min(i/n.timeMs*100,100),a.value<100&&requestAnimationFrame(o)};requestAnimationFrame(o)}),(l,o)=>(t(),A(un,{class:"BuilderCodePanelFileUploading",progress:a.value,"size-px":12,"stroke-width":2},null,8,["progress"]))}}),cn=W(dn,[["__scopeId","data-v-449f2dac"]]),vt=[{label:"Delete",value:"delete",icon:"trash-2"}],pn=F({__name:"BuilderCodePanelSourceFilesTree",props:{sourceFiles:{type:Object,required:!0},path:{type:Array,default:()=>[]},pathActive:{type:Array,default:()=>[]},pathsUnsaved:{type:Array,default:()=>[]},displayAddFileButton:{type:Boolean}},emits:{select:e=>Array.isArray(e),delete:e=>Array.isArray(e),addFile:()=>!0},setup(e,{emit:n}){const a=e,l=n;function o(r){return r.join("/")}const s=w(()=>o(a.pathActive)),i=w(()=>a.pathsUnsaved.map(o)),u=w(()=>Pe(a.sourceFiles)?Object.entries(a.sourceFiles.children).sort((r,_)=>r[0].localeCompare(_[0])):[]);function f(r){const _=se([...a.path,r],a.sourceFiles);return Oe(_)&&_.uploading}function g(r){const _=o([...a.path,r]);return i.value.includes(_)}function m(r){return o([...a.path,r])===s.value}function h(r){if(!Pe(a.sourceFiles)||f(r))return;const _=a.sourceFiles.children[r];Pe(_)||l("select",[...a.path,r])}function S(r,_){r==="delete"&&l("delete",[...a.path,_])}return(r,_)=>(t(),p("div",null,[(t(!0),p(j,null,ue(u.value,([C,y])=>(t(),A(on,{key:C,name:C,matched:"","has-children":c(Pe)(y),selected:m(C),disabled:f(C),"right-click-options":vt,"dropdown-options":c(Pe)(y)||c(Oe)(y)?vt:void 0,onSelect:b=>h(C),onDropdownSelect:b=>S(b,C)},qt({children:L(()=>[B(At,{"source-files":y,"path-active":e.pathActive,"paths-unsaved":e.pathsUnsaved,path:[...e.path,C],onSelect:_[0]||(_[0]=b=>r.$emit("select",b)),onDelete:_[1]||(_[1]=b=>r.$emit("delete",b))},null,8,["source-files","path-active","paths-unsaved","path"])]),_:2},[f(C)||g(C)?{name:"nameLeft",fn:L(()=>[f(C)?(t(),A(cn,{key:0,"time-ms":2e3})):g(C)?(t(),A($t,{key:1,state:"newDraft"})):$("",!0)]),key:"0"}:void 0]),1032,["name","has-children","selected","disabled","dropdown-options","onSelect","onDropdownSelect"]))),128))]))}}),At=W(pn,[["__scopeId","data-v-13c86c55"]]),vn=["disabled"],fn={class:"WdsButtonLink__text"},mn=F({__name:"WdsButtonLink",props:{variant:{type:String,default:"primary"},weight:{type:String,default:"default"},leftIcon:{type:String,required:!1,default:void 0},rightIcon:{type:String,required:!1,default:void 0},text:{type:String,required:!0},disabled:{type:Boolean}},setup(e){const n=e,a=w(()=>[`WdsButtonLink--variant-${n.variant}`,`WdsButtonLink--weight-${n.weight}`]);return(l,o)=>(t(),p("button",{class:K(["WdsButtonLink",a.value]),disabled:e.disabled,type:"button"},[e.leftIcon?(t(),A(z,{key:0,name:e.leftIcon},null,8,["name"])):$("",!0),d("span",fn,U(e.text),1),e.rightIcon?(t(),A(z,{key:1,name:e.rightIcon},null,8,["name"])):$("",!0)],10,vn))}}),Tt=W(mn,[["__scopeId","data-v-f2cbc67f"]]),_n={class:"BuilderCodePanelFileUploadBtn"},yn=F({__name:"BuilderCodePanelFileUploadBtn",emits:{selected:e=>Array.isArray(e)&&e.length>0},setup(e,{emit:n}){const a=ie("input"),l=n;function o(){const{files:s}=a.value;s instanceof FileList&&s.length>0&&(l("selected",Array.from(s)),a.value.value="")}return(s,i)=>(t(),p("form",_n,[he(d("input",{ref_key:"input",ref:a,type:"file",multiple:"",onChange:o},null,544),[[Ee,!1]]),B(Tt,{"left-icon":"upload",text:"Upload",onClick:i[0]||(i[0]=u=>c(a).click())})]))}}),ft="You have unsaved changes. Are you sure you want to leave?";function hn(e){const n=O(!1),a=O(null);function l(){n.value=!0,e==null||e.preventTasks.value.add("codeUnsaved")}function o(){n.value=!1,e==null||e.preventTasks.value.delete("codeUnsaved")}function s(u){if(n.value)return u.preventDefault(),u.returnValue=ft,ft}re(()=>{a.value=s,window.addEventListener("beforeunload",a.value)}),Be(()=>{a.value&&window.removeEventListener("beforeunload",a.value)});const i=xe();return re(()=>{window.addEventListener("beforeunload",s,{signal:i.signal})}),{enablePrevention:l,disablePrevention:o}}function gn(){const e=De(!1),n=De(null),a=(i,u)=>{e.value=!0,n.value={action:i,description:u}};return{showModal:e,executePendingAction:()=>{n.value&&(n.value.action(),n.value=null),e.value=!1},cancelPendingAction:()=>{n.value=null,e.value=!1},checkUnsavedChanges:(i,u,f)=>i?(a(u,f),!0):!1}}function bn(e){const n=xe();function a(o,s){switch(s){case"ctrl":return o.ctrlKey&&!o.metaKey;case"cmd":return o.metaKey&&!o.ctrlKey;case"alt":return o.altKey;case"shift":return o.shiftKey;default:return!o.ctrlKey&&!o.metaKey&&!o.altKey&&!o.shiftKey}}function l(o){for(const s of e){const i=o.key.toLowerCase()===s.key.toLowerCase(),u=a(o,s.modifier);if(i&&u){s.preventDefault!==!1&&o.preventDefault(),s.handler();return}}}re(()=>{document.addEventListener("keydown",l,{signal:n.signal})})}const kn={class:"UnsavedChangesModal__content"},wn={class:"UnsavedChangesModal__icon"},Sn={class:"UnsavedChangesModal__message"},Bn=F({__name:"UnsavedChangesModal",props:{filename:{type:String,required:!0},isSaving:{type:Boolean,required:!1}},emits:{save:()=>!0,cancel:()=>!0},setup(e,{emit:n}){const a=e,l=n,o=w(()=>[{desc:"Cancel",fn:()=>l("cancel")},{desc:"Save",fn:()=>l("save"),disabled:a.isSaving}]);return(s,i)=>(t(),A(we,{title:"Unsaved Changes",description:"You have unsaved changes. What would you like to do?",actions:o.value,"display-close-button":"",onClose:i[0]||(i[0]=u=>l("cancel"))},{default:L(()=>[d("div",kn,[d("div",wn,[B(z,{name:"alert-triangle"})]),d("div",Sn,[d("p",null,[i[1]||(i[1]=q(" The file ")),d("strong",null,U(e.filename),1),i[2]||(i[2]=q(" has unsaved changes. "))]),i[3]||(i[3]=d("p",null,"Your changes will be lost if you don't save them.",-1))])])]),_:1},8,["actions"]))}}),Cn=W(Bn,[["__scopeId","data-v-7f5bb12c"]]),$n={class:"BuilderCodePanel__tree"},In={class:"BuilderCodePanel__tree__actions"},An={key:1,class:"BuilderCodePanel__noPreview"},Tn={class:"BuilderCodePanel__actionsCompanion"},Pn=F({__name:"BuilderCodePanel",props:{contentsTeleportEl:{}},setup(e){const n=ce({loader:()=>pe(()=>import("./index-BE6RSzCE.js").then(P=>P.bL),__vite__mapDeps([0,1]),import.meta.url)}),a=ce({loader:()=>pe(()=>import("./BuilderEmbeddedCodeEditor-B_mePKpd.js").then(P=>P.B),__vite__mapDeps([2,0,1,3]),import.meta.url)}),l=V(R.core),o=V(R.builderManager),s=[{label:"Rename file",value:"rename",icon:"pencil"},{label:"Delete file",value:"delete",icon:"trash-2",variant:"danger"}],i=ye(l),{sourceFileDraft:u,openFile:f,upload:g,openNewFile:m,code:h,openedFileLanguage:S,filepathOpen:r,fileOpen:_,pathsUnsaved:C,save:y}=Xa(l),b=V(R.socketTimeout),{enablePrevention:I,disablePrevention:v}=hn(b),{showModal:k,checkUnsavedChanges:T,executePendingAction:D,cancelPendingAction:E}=gn();async function M(P){await Promise.all(P.map(N))}async function N(P){try{await g(P),Q({type:"success",message:`File ${P.name} uploaded`})}catch(H){Q({type:"error",message:H.message})}}const Y=w(()=>{var P;return(P=_.value)==null?void 0:P.type}),{pushToast:Q}=Se(),X=it();function J(P){const H=new AbortController;re(()=>{document.addEventListener("keydown",async oe=>{const et=oe.metaKey||oe.ctrlKey,tt=oe.key==="s"||oe.key==="S";!et||!tt||(oe.preventDefault(),await P())},{signal:H.signal})}),Be(()=>H.abort())}J(async()=>{await Ce()}),bn([{key:"w",modifier:"ctrl",handler:Z},{key:"w",modifier:"cmd",handler:Z}]);const de=ie("filenameEl"),ge=O(""),ve=O(!1),_e=w(()=>{var P;return((P=r.value)==null?void 0:P.join("/"))??""}),Ke=w(()=>_e.value!=="main.py"),Re=w(()=>_e.value!==ge.value),je=w(()=>ve.value||_e.value==="main.py"),fe=w(()=>{if(Re.value)return!1;if(r.value===void 0)return!0;const P=C.value.map(oe=>oe.join("/")).includes(_e.value),H=r.value&&!se(r.value,l.sourceFiles.value);return!P&&!H});te(r,()=>{var P;ge.value=((P=r.value)==null?void 0:P.join("/"))??""}),te(l.sessionTimestamp,()=>{ve.value=!1}),Kt(()=>{fe.value?v():I()}),te(()=>o.openPanels.value.has("code"),(P,H)=>{H&&!P&&Qe()});function He(P){P&&(i.track("nav_code_opened"),r.value===void 0&&f(["main.py"]))}async function Ue(){var P;_e.value!=="main.py"&&(await me(),(P=de.value)==null||P.focus())}async function Ge(P){switch(P){case"rename":return Ue();case"delete":await Me(r.value)}}async function We(){await m(),Ue()}async function Me(P){await l.sendDeleteSourceFileRequest(P),Q({type:"success",message:"The file was deleted"}),r.value.join("/").startsWith(P.join("/"))&&f(["main.py"])}async function Ce(){if(r.value===void 0)return Q({type:"error",message:"There is no file open"});if(fe.value)return Q({type:"info",message:"There are no file changes to save"});ve.value=!0;const P=Re.value?ge.value.split("/"):void 0;if(P){const H=Ve(P);if(H)return Q({type:"error",message:H})}try{await y(P),Q({type:"success",message:"The file was saved"}),i.track("nav_code_file_updated",{path:r.value})}catch(H){X.error("The file hasn't been saved.",H),Q({type:"error",message:"The file hasn't been saved"});return}finally{ve.value=!1}}async function Ye(){await Ce(),D()}function Je(){E()}async function Ze(P){T(!fe.value,()=>f(P),"switch file")||f(P)}async function Xe(P){T(!fe.value,()=>Me(P),"delete file")||await Me(P)}function Z(){T(!fe.value,()=>o.openPanels.value.delete("code"),"close panel")||o.openPanels.value.delete("code")}function Qe(){T(!fe.value,()=>{},"close panel")&&me(()=>{o.openPanels.value.add("code")})}function Ve(P){return P[0]===""?"Path should not have a leading slash":P[0]===".wf"?".wf is reserved for Writer Framework":P.some(H=>H==="")?"Invalid path":null}return(P,H)=>(t(),p(j,null,[B(It,{"panel-id":"code",name:"Code","contents-teleport-el":P.contentsTeleportEl,actions:[],scrollable:!1,"enable-left-panel":"","keyboard-shortcut-key":"J",class:"BuilderCodePanel","enable-drop-file":"","max-file-size-limit":c(st)*1e3*1e3,onFilesDrop:M,onOpenned:He},{leftPanel:L(()=>[d("div",$n,[B(At,{"path-active":c(r),"paths-unsaved":c(C),"source-files":c(u),onAddFile:We,onSelect:Ze,onDelete:Xe},null,8,["path-active","paths-unsaved","source-files"]),d("div",In,[B(Tt,{"left-icon":"plus",text:"Add file",onClick:We}),B(yn,{onSelected:M})])])]),actionsCompanion:L(()=>[d("div",Tn,[B(Bt,{ref_key:"filenameEl",ref:de,modelValue:ge.value,"onUpdate:modelValue":H[1]||(H[1]=oe=>ge.value=oe),disabled:!Ke.value,class:"BuilderCodePanel__actionsCompanion__filename",autofocus:"",variant:"ghost",onKeydown:St(Ce,["enter"])},null,8,["modelValue","disabled"]),B(ne,{variant:"primary",size:"small",disabled:ve.value||fe.value,class:"BuilderCodePanel__actionsCompanion__saveBtn",onClick:Ce},{default:L(()=>[B(z,{name:"save"}),H[3]||(H[3]=q(" Save file "))]),_:1},8,["disabled"]),B(c(n),{disabled:je.value,options:s,onSelect:Ge},null,8,["disabled"])])]),default:L(()=>[Y.value==="file"?(t(),A(c(a),{key:0,modelValue:c(h),"onUpdate:modelValue":H[0]||(H[0]=oe=>bt(h)?h.value=oe:null),variant:"full",language:c(S),disabled:ve.value},null,8,["modelValue","language","disabled"])):$("",!0),Y.value==="binary"?(t(),p("div",An,H[2]||(H[2]=[d("img",{class:"BuilderCodePanel__noPreview__img",src:Oa},null,-1),d("p",{class:"BuilderCodePanel__noPreview__title"},"Canâ€™t Preview File",-1),d("p",{class:"BuilderCodePanel__noPreview__desc"}," Non-text files are not available to view here ",-1)]))):$("",!0)]),_:1},8,["contents-teleport-el","max-file-size-limit"]),c(k)?(t(),A(Cn,{key:0,filename:_e.value,"is-saving":ve.value,onSave:Ye,onCancel:Je},null,8,["filename","is-saving"])):$("",!0)],64))}}),Dn=W(Pn,[["__scopeId","data-v-deaca6f9"]]),xn={class:"BuiderLogBlueprintExecutionTrace"},En={key:0,class:"trace"},Mn={class:"type"},Ln={key:0},Fn={key:1},Nn={class:"main"},Rn={key:0},Un={key:1},Wn={key:2},Vn={key:3},zn={class:"details"},On={class:"data","data-automation-key":"result"},qn={key:1,class:"nothing"},Kn={class:"data","data-automation-key":"return-value"},jn={class:"environment"},Hn={class:"data"},Gn={key:1,class:"nothing"},Yn={class:"callStack"},Jn={class:"eyebrow"},Zn=F({__name:"BuilderLogBlueprintExecutionTrace",props:{executionItem:{}},emits:["closeModal"],setup(e,{emit:n}){const a=V(R.core),l=V(R.builderManager),o=ye(a),s=n,{goToComponentParentPage:i}=Ne(a,l),u=e,f=w(()=>{var S;const h=((S=u.executionItem.executionEnvironment)==null?void 0:S.call_stack)??[];return Object.fromEntries(h.map(r=>[r,a.getComponentById(r)]))}),g=w(()=>{var h;return((h=u.executionItem.executionEnvironment)==null?void 0:h.trace)??[]});re(()=>{o.track("blueprints_logs_trace_opened")});async function m(h){s("closeModal"),l.setMode("blueprints"),await me(),i(h),await me(),l.setSelection(h,void 0,"log")}return(h,S)=>{var r,_,C;return t(),p("div",xn,[g.value.length>0?(t(),p("div",En,[(t(!0),p(j,null,ue(g.value,(y,b)=>(t(),p("div",{key:b,class:"traceEntry"},[d("div",Mn,[y.type=="functionCall"?(t(),p("span",Ln,"âš¡ï¸")):$("",!0),y.type=="reasoning"?(t(),p("span",Fn,"ðŸ§ ")):$("",!0)]),d("div",Nn,[y.thought?(t(),p("div",Rn,[S[0]||(S[0]=d("strong",null,"Thought.",-1)),q(" "+U(y.thought),1)])):$("",!0),y.action?(t(),p("div",Un,[S[1]||(S[1]=d("strong",null,"Action.",-1)),q(" "+U(y.action),1)])):$("",!0),y.name?(t(),p("div",Wn,U(y.name),1)):$("",!0),y.parameters?(t(),p("div",Vn,[B(Le,{"hide-root":!0,data:y.parameters,"initial-depth":1,class:"data"},null,8,["data"])])):$("",!0)])]))),128))])):$("",!0),d("div",zn,[d("div",null,[S[2]||(S[2]=d("h3",null,"Result",-1)),S[3]||(S[3]=d("p",null," The value resulting of the execution of this block. This value is added to the execution environment of the direct dependents of this block. There, it's accessible via @{result}. ",-1)),d("div",On,[(r=h.executionItem)!=null&&r.result?(t(),A(Le,{key:0,data:h.executionItem.result,"initial-depth":1},null,8,["data"])):(t(),p("div",qn,"No result."))])]),d("div",null,[S[4]||(S[4]=d("h3",null,"Return value",-1)),S[5]||(S[5]=d("p",null," The value being returned, which is used to determine the result of 'Run blueprint' blocks and 'Chat completion' tool calls. ",-1)),d("div",Kn,[(_=h.executionItem)!=null&&_.returnValue?(t(),A(Le,{key:0,data:h.executionItem.returnValue,"initial-depth":1},null,8,["data"])):(t(),p(j,{key:1},[q(" No return value. ")],64))])])]),d("div",jn,[S[6]||(S[6]=d("h3",null,"Execution environment",-1)),S[7]||(S[7]=d("p",null," The following values were made available to this block during execution time. These values are accessible via the same template syntax i.e. @{my_var}, as state elements. ",-1)),d("div",Hn,[(C=h.executionItem)!=null&&C.executionEnvironment?(t(),A(Le,{key:0,data:h.executionItem.executionEnvironment,"initial-depth":1},null,8,["data"])):(t(),p("div",Gn,"Empty execution environment."))])]),d("div",Yn,[S[8]||(S[8]=d("h3",null,"Call stack",-1)),(t(!0),p(j,null,ue(f.value,(y,b)=>{var I,v,k;return t(),p("div",{key:b,class:K(["component",{active:b==h.executionItem.componentId}])},[d("div",null,[d("div",Jn,[b==h.executionItem.componentId?(t(),p(j,{key:0},[q(" This block Â· ")],64)):$("",!0),q(" "+U(((I=c(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:I.name)??"Unavailable component")+" Â· Id: "+U(b),1)]),q(" "+U(((v=y==null?void 0:y.content)==null?void 0:v.alias)??((k=c(a).getComponentDefinition(y==null?void 0:y.type))==null?void 0:k.name)??"Unavailable component"),1)]),y?(t(),A(ne,{key:0,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:T=>m(b)},{default:L(()=>[B(z,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):$("",!0)],2)}),128))])])}}}),Xn=W(Zn,[["__scopeId","data-v-f98f57c8"]]),Qn={class:"BuilderListItem"},eo=["viewBox"],to=["d","stroke"],ao=["d","stroke"],no={class:"BuilderListItem__content"},oo=F({__name:"BuilderListItem",props:{isLast:{type:Boolean,required:!1},height:{type:Number,required:!1,default:1e3},color:{type:String,required:!1,default:qe.Blue2},colorLast:{type:String,required:!1,default:qe.Blue2}},setup(e){const n=e,a=w(()=>n.height/2),l=w(()=>`0 0 17 ${n.height}`),o=w(()=>["M1 0",`V${a.value-8}`,`C1 ${a.value-4}.4183 4.58172 ${a.value} 9 ${a.value}`,"H17"].join(" ")),s=w(()=>[`M1 ${a.value-8}`,`V${n.height}`].join(" "));return(i,u)=>(t(),p("div",Qn,[(t(),p("svg",{viewBox:l.value,fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMinYMax meet",class:"BuilderListItem__anchor"},[e.isLast?$("",!0):(t(),p("path",{key:0,d:s.value,stroke:e.colorLast,"stroke-width":"1"},null,8,to)),d("path",{d:o.value,stroke:e.color,"stroke-width":"1"},null,8,ao)],8,eo)),d("div",no,[le(i.$slots,"default",{},void 0,!0)])]))}}),lo=W(oo,[["__scopeId","data-v-33f3edcd"]]),ro={class:"BuilderLogBlueprintExecution"},so={class:"name"},io={key:0},uo={class:"eyebrow"},co={class:"outcome"},po={class:"result"},vo={class:"time"},fo={key:0,class:"message markdown"},mo=F({__name:"BuilderLogBlueprintExecution",props:{executionLog:{}},setup(e){const n=V(R.core),a=V(R.builderManager),{goToComponentParentPage:l}=Ne(n,a),o=e,s=O(null),i={in_progress:5,error:4,success:3,stopped:2,skipped:1,none:0},u=w(()=>({summary:[...o.executionLog.summary.filter(h=>!!h.outcome).filter(h=>(i[h.outcome]??i.success)>1).map(h=>({...h,component:n.getComponentById(h.componentId),componentDef:n.getComponentById(h.componentId)?n.getComponentDefinition(n.getComponentById(h.componentId).type):void 0}))]}));async function f(m){a.setMode("blueprints"),await me(),l(m),await me(),a.setSelection(m,void 0,"log")}function g(m){return m<0?"N/A":m<.1?"< 0.1s":`${m.toFixed(2)}s`}return(m,h)=>{const S=jt("dompurify-html");return t(),p("div",ro,[(t(!0),p(j,null,ue(u.value.summary,(r,_)=>(t(),A(lo,{key:_,"is-last":_+1===u.value.summary.length},{default:L(()=>{var C,y,b,I,v,k,T,D,E,M,N,Y;return[d("div",{class:K(["itemWrapper",{"itemWrapper--first":_===0,"itemWrapper--last":_+1===u.value.summary.length}])},[d("div",{class:K(["item",{selected:c(a).isComponentIdSelected(r.componentId)}])},[d("div",so,[(y=(C=r.component)==null?void 0:C.content)!=null&&y.alias?(t(),p("div",io,[d("div",uo,U(((b=r.componentDef)==null?void 0:b.name)??"Unavailable component"),1),q(" "+U((v=(I=r.component)==null?void 0:I.content)==null?void 0:v.alias),1)])):(t(),p(j,{key:1},[q(U(((k=r.componentDef)==null?void 0:k.name)??"Unavailable component"),1)],64)),r.component?(t(),A(ne,{key:2,variant:"neutral",size:"smallIcon","data-writer-tooltip":"Jump to this block",onClick:Q=>f(r.componentId)},{default:L(()=>[B(z,{name:"square-dashed-mouse-pointer"})]),_:2},1032,["onClick"])):$("",!0)]),d("div",co,[r.outcome!=="in_progress"?(t(),p(j,{key:0},[d("div",{class:K(["ball",(E=(D=(T=r.componentDef)==null?void 0:T.outs)==null?void 0:D[r.outcome])==null?void 0:E.style])},null,2),q(" "+U(((Y=(N=(M=r.componentDef)==null?void 0:M.outs)==null?void 0:N[r.outcome])==null?void 0:Y.name)??r.outcome),1)],64)):(t(),p(j,{key:1},[h[1]||(h[1]=d("div",{class:"ballContainer"},[d("div",{class:"ball inProgress"})],-1)),h[2]||(h[2]=q(" In progress... "))],64))]),d("div",po,[s.value==_?(t(),A(we,{key:0,title:"Trace",size:"wide",actions:[{desc:"Done",fn:()=>s.value=null}]},{default:L(()=>[B(Xn,{"execution-item":r,onCloseModal:h[0]||(h[0]=()=>s.value=null)},null,8,["execution-item"])]),_:2},1032,["actions"])):$("",!0),r.result||r.returnValue||r.executionEnvironment?(t(),A(ne,{key:1,variant:"special",size:"small",onClick:()=>s.value=_},{default:L(()=>[B(z,{name:"file-search-2"}),h[3]||(h[3]=q(" Trace "))]),_:2},1032,["onClick"])):$("",!0)]),d("div",vo,U(g(r.executionTimeInSeconds)),1),r.message?he((t(),p("div",fo,null,512)),[[S,c(sa).parse(r.message)]]):$("",!0)],2)],2)]}),_:2},1032,["is-last"]))),128))])}}}),_o=W(mo,[["__scopeId","data-v-a691c27b"]]),yo={class:"BuilderLogIndicator"},ho={key:0,class:"number error"},go={class:"icon"},bo={key:1,class:"number info"},ko={class:"icon"},wo=F({__name:"BuilderLogIndicator",setup(e){const n=V(R.builderManager),a=w(()=>n.getLogEntries().reduce((l,o)=>(o.type in l||(l[o.type]=0),l[o.type]++,l),{}));return(l,o)=>(t(),p("div",yo,[a.value.error>0?(t(),p("div",ho,[d("div",go,[B(z,{name:"triangle-alert"})]),q(" "+U(a.value.error??0),1)])):$("",!0),a.value.info>0?(t(),p("div",bo,[d("div",ko,[B(z,{name:"info"})]),q(" "+U(a.value.info??0),1)])):$("",!0)]))}}),So=W(wo,[["__scopeId","data-v-f0898ae9"]]),Bo={key:0,class:"entries"},Co={class:"icon"},$o={class:"title"},Io={class:"time"},Ao={class:"content"},To={key:0,class:"codeContainer"},Po={key:1,class:"emptyMessage"},Do=F({__name:"BuilderLogPanel",props:{contentsTeleportEl:{}},setup(e){const n=V(R.core),a=V(R.builderManager),l=ie("panel"),o=ye(n);async function s(g){g&&(o.track("nav_logs_opened"),await me(),await f())}const i=[{icon:"trash-2",name:"Clear log",callback:()=>{a.clearLogEntries()},keyboardShortcut:{modifierKey:!0,key:"L"}}],u=w(()=>a.getLogEntries());async function f(){var _;const g=(_=l.value)==null?void 0:_.mainContents;if(!g)return;const m=g.querySelector(".item.selected");if(!m)return;const h=g.getBoundingClientRect(),S=m.getBoundingClientRect(),r=g.scrollTop+(S.top-h.top)-(h.height/2-S.height/2);g.scrollTo({top:r,behavior:"smooth"})}return te(a.selection,async()=>{await me(),await f()}),(g,m)=>(t(),A(It,{ref_key:"panel",ref:l,"panel-id":"log",name:"Log","contents-teleport-el":g.contentsTeleportEl,actions:i,scrollable:!0,"keyboard-shortcut-key":"K",class:"BuilderLogPanel",onOpenned:s},{titleCompanion:L(()=>[B(So)]),default:L(()=>[u.value.length>0?(t(),p("div",Bo,[(t(!0),p(j,null,ue(u.value,(h,S)=>(t(),p(j,{key:S},[d("div",{class:K(["entry",h.type])},[d("div",Co,[B(z,{name:h.type==="error"?"triangle-alert":"info"},null,8,["name"])]),d("div",$o,U(h.title)+U(h.repeated>0?` Â· Repeated ${h.repeated} times`:""),1),d("div",Io,U(h.timestampReceived.toLocaleTimeString()),1),d("div",Ao,[q(U(h.message)+" ",1),h.code?(t(),p("div",To,[d("code",null,U(h.code),1)])):$("",!0)])],2),h.blueprintExecution?(t(),A(_o,{key:0,"execution-log":h.blueprintExecution},null,8,["execution-log"])):$("",!0)],64))),128))])):$("",!0),u.value.length==0?(t(),p("div",Po,m[0]||(m[0]=[d("div",null,[q(" Exceptions and other relevant messages will be shown here."),d("br"),q("Also, you can include print statements in event handlers to create log entries. ")],-1)]))):$("",!0)]),_:1},8,["contents-teleport-el"]))}}),xo=W(Do,[["__scopeId","data-v-5bf9ec81"]]),Eo={class:"switches"},Mo=F({__name:"BuilderPanelSwitcher",setup(e){const n=V(R.builderManager),a=ie("screenEl");return(l,o)=>(t(),p("div",{class:K(["BuilderPanelSwitcher",{openPanels:c(n).openPanels.value.size>0}])},[d("div",{ref_key:"screenEl",ref:a,class:"screen"},null,512),d("div",Eo,[B(Dn,{"contents-teleport-el":c(a)},null,8,["contents-teleport-el"]),B(xo,{"contents-teleport-el":c(a)},null,8,["contents-teleport-el"])])],2))}}),Lo=W(Mo,[["__scopeId","data-v-93f8be10"]]),Fo=["href"],No=["disabled"],Ro=F({__name:"BuilderSidebarButton",props:{icon:{type:String,required:!0},active:{type:Boolean},disabled:{type:Boolean},href:{type:String,required:!1,default:void 0}},setup(e){return(n,a)=>e.href?(t(),p("a",{key:0,class:"BuilderSidebarButton",href:e.href},[B(z,{name:e.icon},null,8,["name"])],8,Fo)):(t(),p("button",{key:1,class:K(["BuilderSidebarButton",{"BuilderSidebarButton--active":e.active}]),role:"button",disabled:e.disabled},[B(z,{name:e.icon},null,8,["name"])],10,No))}}),Te=W(Ro,[["__scopeId","data-v-044cd21a"]]),Uo={class:"BuilderSidebarVersion"},Wo={class:"BuilderSidebarVersion__capsule"},Vo=F({__name:"BuilderSidebarVersion",props:{version:{type:String,required:!0}},setup(e){return(n,a)=>(t(),p("span",Uo,[d("span",Wo," BETA "+U(e.version),1)]))}}),zo=W(Vo,[["__scopeId","data-v-bbae565d"]]),Oo={key:0,class:"BuilderSidebarPanel__inputContainer"},qo={class:"BuilderSidebarPanel__footer"},Ko=F({__name:"BuilderSidebarPanel",props:lt({hideSearchBar:{type:Boolean,required:!1},placeholder:{type:String,required:!1,default:""},searchCount:{type:Number,required:!1,default:void 0}},{modelValue:{type:String,required:!1,default:""},modelModifiers:{}}),emits:["update:modelValue"],setup(e){const n=kt(e,"modelValue"),a=e,l=w(()=>{if(a.searchCount!==void 0)return`${a.searchCount} result${a.searchCount===1?"":"s"}`}),o=O(!1);function s(i){i.target instanceof HTMLElement&&(o.value=i.target.scrollTop>0)}return(i,u)=>(t(),p("div",{class:K(["BuilderSidebarPanel",{"BuilderSidebarPanel--mainScrollSeparator":o.value}])},[e.hideSearchBar?$("",!0):(t(),p("div",Oo,[B(Bt,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=f=>n.value=f),class:"searchInput","left-icon":"search","data-automation-action":"search",placeholder:e.placeholder,"right-text":l.value,"right-icon":n.value?"x":void 0,onRightIconClick:u[1]||(u[1]=f=>n.value="")},null,8,["modelValue","placeholder","right-text","right-icon"])])),d("div",{class:"BuilderSidebarPanel__main",onScroll:s},[le(i.$slots,"default",{},void 0,!0)],32),d("div",qo,[le(i.$slots,"footer",{},void 0,!0)])],2))}}),jo=W(Ko,[["__scopeId","data-v-fcaea8d5"]]),Ho=["data-note-id"],Go={class:"BuilderSidebarNote__header"},Yo={class:"BuilderSidebarNote__header__avatar"},Jo={class:"BuilderSidebarNote__header__avatar__type"},Zo={class:"BuilderSidebarNote__header__info"},Xo={key:1},Qo={key:0,class:"BuilderSidebarNote__header__actions"},el={key:0,class:"BuilderSidebarNote__content"},tl={key:0},al=F({__name:"BuilderSidebarNote",props:{component:{type:Object,required:!0},excerpt:{type:Boolean}},emits:{select:()=>!0,edit:()=>!0,delete:()=>!0},setup(e,{emit:n}){const a=e,{user:l}=Ht(),o=n,s=V(R.notesManager),{createdAtFormatted:i,type:u,content:f,createdBy:g}=s.useNoteInformation(w(()=>a.component)),{user:m,isLoading:h,error:S}=_t(g),r=w(()=>h.value||S.value),_=w(()=>f.value.length<100?f.value:`${f.value.slice(0,100)}...`),C=w(()=>f.value.split(`
`)),y=w(()=>m.value?[m.value.firstName,m.value.lastName].filter(Boolean).join(" "):""),b=w(()=>{var v;if(((v=l.value)==null?void 0:v.id)===g.value)return[{value:"edit",label:"Edit",icon:"pencil"},{value:"delete",label:"Delete",icon:"trash-2",variant:"danger"}]});function I(v){switch(v){case"edit":return o("edit");case"delete":return o("delete")}}return(v,k)=>(t(),p("div",{class:"BuilderSidebarNote","data-note-id":e.component.id,tabindex:"0",onClick:k[0]||(k[0]=T=>v.$emit("select"))},[d("div",Go,[d("div",Yo,[d("div",Jo,[c(u)==="blueprints"?(t(),A(z,{key:0,name:"wds-blueprints"})):c(u)==="ui"?(t(),A(z,{key:1,name:"frame"})):$("",!0)]),B(ut,{"user-id":c(g)},null,8,["user-id"])]),d("div",Zo,[r.value?(t(),A(yt,{key:0,class:"BuilderSidebarNote__header__info__loader"})):(t(),p("p",Xo,U(y.value),1)),d("p",null,U(c(i)),1)]),b.value?(t(),p("div",Qo,[B(ht,{options:b.value,"trigger-custom-size":"16px",onSelect:I},null,8,["options"])])):$("",!0)]),c(f)?(t(),p("div",el,[e.excerpt?(t(),p("p",tl,U(_.value),1)):(t(!0),p(j,{key:1},ue(C.value,(T,D)=>(t(),p("p",{key:D},U(T),1))),128))])):$("",!0)],8,Ho))}}),mt=W(al,[["__scopeId","data-v-4129b8b4"]]),nl={},ol={class:"BuilderSidebarNotesEmpty"};function ll(e,n){return t(),p("div",ol,n[0]||(n[0]=[Gt('<svg width="77" height="77" viewBox="0 0 77 77" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-98d925a1><circle cx="38.5" cy="38.5" r="38.5" fill="#E4E9FF" data-v-98d925a1></circle><path d="M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778V30.1111Z" fill="white" data-v-98d925a1></path><path d="M32.6667 35.4444H43.3333H32.6667Z" fill="white" data-v-98d925a1></path><path d="M38 30.1111V40.7778M32.6667 35.4444H43.3333M54 44.3333C54 45.2763 53.6254 46.1807 52.9586 46.8475C52.2918 47.5143 51.3874 47.8889 50.4444 47.8889H29.1111L22 55V26.5556C22 25.6126 22.3746 24.7082 23.0414 24.0414C23.7082 23.3746 24.6126 23 25.5556 23H50.4444C51.3874 23 52.2918 23.3746 52.9586 24.0414C53.6254 24.7082 54 25.6126 54 26.5556V44.3333Z" stroke="black" stroke-linecap="round" stroke-linejoin="round" data-v-98d925a1></path></svg><h5 data-v-98d925a1>No Notes</h5><p data-v-98d925a1>Click anywhere on a blueprint or interface to add a note</p>',3)]))}const rl=W(nl,[["render",ll],["__scopeId","data-v-98d925a1"]]),sl={class:"BuilderSidebarNoteForm"},il=F({__name:"BuilderSidebarNoteForm",props:{component:{type:Object,required:!0},autofocus:{type:Boolean}},emits:{submit:e=>typeof e=="string"},setup(e){const n=e,a=V(R.notesManager),l=O(a.getNoteContent(n.component));return(o,s)=>(t(),p("div",sl,[B(Yt,{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=i=>l.value=i),class:"BuilderSidebarNoteForm__input",autofocus:e.autofocus},null,8,["modelValue","autofocus"]),B(ne,{class:"BuilderSidebarNoteForm__submit",variant:"secondary",size:"smallIcon",disabled:!l.value,onClick:s[1]||(s[1]=i=>o.$emit("submit",l.value))},{default:L(()=>[B(z,{name:"send"})]),_:1},8,["disabled"])]))}}),ul=W(il,[["__scopeId","data-v-157847b0"]]),dl={key:0,class:"BuilderSidebarNotes__note"},cl={key:2,class:"BuilderSidebarNotes__notes"},pl=F({__name:"BuilderSidebarNotes",setup(e){const n=V(R.core),a=V(R.builderManager),{selectedNote:l,selectNote:o,selectedNoteMode:s,selectedNoteId:i,getAllNotes:u,searchNotes:f,deleteNote:g,hoveredNoteId:m,useNoteInformation:h}=V(R.notesManager),{createAndInsertComponent:S}=Ne(n,a),r=Jt({componentId:i,fieldKey:"content"}),_=O(""),C=w(()=>Array.from(u()).toSorted(I)),y=w(()=>Array.from(f(_.value)).toSorted(I)),b=w(()=>!!(l.value||C.value.length===0));function I(T,D){const E=h(T).createdAt.value,M=h(D).createdAt.value;return new Date(M).getTime()-new Date(E).getTime()}function v(T){return h(T).state.value}function k(T){n.getComponentById(i.value)?r.value=T:S(l.value.type,l.value.parentId,void 0,{content:{...l.value.content,content:T},x:l.value.x,y:l.value.y}),o(void 0)}return(T,D)=>(t(),A(jo,{modelValue:_.value,"onUpdate:modelValue":D[4]||(D[4]=E=>_.value=E),class:"BuilderSidebarNotes","hide-search-bar":b.value},{default:L(()=>[c(l)?(t(),p("div",dl,[c(s)==="edit"?(t(),A(ul,{key:0,component:c(l),autofocus:"",onSubmit:k},null,8,["component"])):(t(),A(mt,{key:1,component:c(l),onGoBack:D[0]||(D[0]=E=>c(o)(void 0)),onEdit:D[1]||(D[1]=E=>c(o)(c(i),"edit")),onDelete:D[2]||(D[2]=E=>c(g)(c(i)))},null,8,["component"]))])):y.value.length===0?(t(),A(rl,{key:1})):(t(),p("div",cl,[(t(!0),p(j,null,ue(y.value,E=>(t(),A(mt,{key:E.id,component:E,class:K(["BuilderSidebarNotes__notes__note",{"BuilderSidebarNotes__notes__note--hover":v(E)==="hover"}]),excerpt:"",onSelect:M=>c(o)(E.id,"show"),onEdit:M=>c(o)(E.id,"edit"),onDelete:M=>c(g)(E.id),onMouseenter:M=>m.value=E.id,onMouseleave:D[3]||(D[3]=M=>m.value=void 0)},null,8,["component","class","onSelect","onEdit","onDelete","onMouseenter"]))),128))]))]),_:1},8,["modelValue","hide-search-bar"]))}}),vl=W(pl,[["__scopeId","data-v-3dc5600c"]]),fl={class:"BuilderSidebar"},ml={class:"BuilderSidebar__toolbar"},_l={key:0,class:"BuilderSidebar__toolbar__top"},yl={key:1,class:"BuilderSidebar__toolbar__center"},hl={class:"BuilderSidebar__toolbar__bottom"},gl={key:0,class:"BuilderSidebar__pane"},bl={key:1},kl=F({__name:"BuilderSidebar",emits:{activePaneChanged:e=>e===void 0||typeof e=="string"},setup(e,{emit:n}){const a=ce({loader:()=>pe(()=>import("./BuilderSidebarToolkit-DrxnwV01.js"),__vite__mapDeps([4,0,1,5,6,7,8]),import.meta.url)}),l=ce({loader:()=>pe(()=>import("./BuilderSidebarComponentTree-io7IaEuB.js"),__vite__mapDeps([9,0,1,5,6,7,10]),import.meta.url)});function o(M){return typeof M=="string"&&["layers","add"].includes(M)}const s=V(R.core),i=V(R.builderManager),u=V(R.notesManager),f=n,g=w(()=>S()),{undo:m,redo:h,getUndoRedoSnapshot:S}=Ne(s,i),r=w(()=>i.mode.value==="preview"),_="1.26.0rc9",C=Ct("activePane",o),y=O(r.value?void 0:C.value),b=w(()=>y.value!=="notes"?!1:u.selectedNoteId.value!==void 0);function I(){y.value==="notes"&&u.selectNote(void 0)}te(y,()=>{u.isAnnotating.value=y.value==="notes"},{immediate:!0}),te(r,()=>{r.value&&y.value}),te(u.selectedNoteId,()=>{u.selectedNoteId.value&&(y.value="notes")});const v=w(()=>({layers:i.mode.value==="ui"?"Interface Layers":"Blueprint Layers",add:"Add block",notes:"Notes"})),k=ot();async function T(M){if(!(!(rt()?M.metaKey:M.ctrlKey)||M.target.closest("textarea, input, select")))switch(M.key){case"l":M.preventDefault(),y.value="layers";break;case"Enter":M.preventDefault(),y.value="add";break}}const D=new AbortController;re(()=>{document.addEventListener("keydown",T,{signal:D.signal})}),Be(()=>D.abort());function E(M){y.value=y.value===M?void 0:M,C.value=y.value,u.selectNote(void 0),f("activePaneChanged",M)}return(M,N)=>(t(),p("div",fl,[d("div",ml,[r.value?$("",!0):(t(),p("div",_l,[N[6]||(N[6]=d("hr",null,null,-1)),B(Te,{icon:"layers","data-writer-tooltip-placement":"right","data-writer-tooltip":`${v.value.layers} (${c(k)}L)`,active:y.value==="layers","data-automation-action":"sidebar-layers",onClick:N[0]||(N[0]=Y=>E("layers"))},null,8,["data-writer-tooltip","active"]),B(Te,{icon:"wds-blocks","data-writer-tooltip-placement":"right","data-writer-tooltip":`${v.value.add} (${c(k)}Enter)`,active:y.value==="add","data-automation-action":"sidebar-add",onClick:N[1]||(N[1]=Y=>E("add"))},null,8,["data-writer-tooltip","active"]),c(s).isWriterCloudApp.value?(t(),A(Te,{key:0,icon:"message-square","data-writer-tooltip-placement":"right","data-writer-tooltip":`${v.value.notes}`,active:y.value==="notes","data-automation-action":"sidebar-notes",onClick:N[2]||(N[2]=Y=>E("notes"))},null,8,["data-writer-tooltip","active"])):$("",!0)])),r.value?$("",!0):(t(),p("div",yl,[N[7]||(N[7]=d("hr",null,null,-1)),B(Te,{icon:"undo-2","data-automation-key":"undo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Undo (${c(k)}Z)`,disabled:!g.value.isUndoAvailable,onClick:N[3]||(N[3]=Y=>c(m)())},null,8,["data-writer-tooltip","disabled"]),B(Te,{"data-automation-key":"redo","data-writer-tooltip-placement":"right","data-writer-tooltip":`Redo (${c(k)}Y)`,icon:"redo-2",disabled:!g.value.isRedoAvailable,onClick:N[4]||(N[4]=Y=>c(h)())},null,8,["data-writer-tooltip","disabled"])])),d("div",hl,[c(_)?(t(),A(zo,{key:0,version:c(_)},null,8,["version"])):$("",!0),N[8]||(N[8]=d("hr",null,null,-1)),B(Te,{target:"_blank",href:"https://dev.writer.com/agent-builder/overview",icon:"circle-question-mark","data-writer-tooltip-placement":"right","data-writer-tooltip":"Docs"})])]),y.value&&!r.value?(t(),p("div",gl,[d("div",{class:K(["BuilderSidebar__pane__header",{"BuilderSidebar__pane__header--goBack":b.value}])},[b.value?(t(),p(j,{key:0},[B(ne,{variant:"neutral",size:"smallIcon",onClick:I},{default:L(()=>[B(z,{name:"arrow-left"})]),_:1}),N[9]||(N[9]=d("h2",null,"Back",-1))],64)):(t(),p("h2",bl,U(v.value[y.value]),1)),B(ne,{variant:"neutral",size:"smallIcon",onClick:N[5]||(N[5]=Y=>y.value=void 0)},{default:L(()=>[B(z,{name:"arrow-left-to-line"})]),_:1})],2),y.value==="add"?(t(),A(c(a),{key:0})):$("",!0),y.value==="layers"?(t(),A(c(l),{key:1})):$("",!0),y.value==="notes"?(t(),A(vl,{key:2})):$("",!0)])):$("",!0)]))}}),wl=W(kl,[["__scopeId","data-v-bf0b63b3"]]),Sl={class:"WdsToast__icon"},Bl=F({__name:"WdsToast",props:{type:{type:String,required:!0},message:{type:String,required:!0},closable:{type:Boolean},action:{type:Object,required:!1,default:void 0}},emits:{close:()=>!0},setup(e){const n=e,a=w(()=>{switch(n.type){case"info":return"info";case"success":return"check";case"error":return"x";default:return"circle-question-mark"}});return(l,o)=>(t(),p("div",{class:K(["WdsToast",`WdsToast--${e.type}`])},[d("div",Sl,[e.type==="loading"?(t(),A(Zt,{key:0,size:18,color:"white"})):e.type==="info"?(t(),p(j,{key:1},[q("i")],64)):(t(),A(z,{key:2,name:a.value},null,8,["name"]))]),d("p",null,U(e.message),1),e.action?(t(),p("button",{key:0,class:"WdsToast__action",onClick:o[0]||(o[0]=(...s)=>e.action.func&&e.action.func(...s))},[q(U(e.action.label)+" ",1),e.type==="info"?(t(),p(j,{key:0},[q("i")],64)):(t(),A(z,{key:1,name:e.action.icon},null,8,["name"]))])):$("",!0),e.closable?(t(),A(ne,{key:1,class:"WdsToast__close",variant:"neutral",size:"smallIcon",onClick:o[1]||(o[1]=s=>l.$emit("close"))},{default:L(()=>[B(z,{name:"x"})]),_:1})):$("",!0)],2))}}),Cl=W(Bl,[["__scopeId","data-v-aa18760d"]]),$l={class:"BuilderToasts"},Il=F({__name:"BuilderToasts",setup(e){const{toasts:n,removeToast:a}=Se();return(l,o)=>(t(),p("div",$l,[B(Xt,{name:"list",tag:"div"},{default:L(()=>[(t(!0),p(j,null,ue(c(n),s=>(t(),A(Cl,{key:s.id,class:"BuilderToasts__toast",closable:s.closable,message:s.message,type:s.type,action:s.action,onClick:i=>s.closable!==!1?c(a)(s.id):void 0},null,8,["closable","message","type","action","onClick"]))),128))]),_:1})]))}}),Al=W(Il,[["__scopeId","data-v-915650dd"]]),Tl=200,Pl=36,Dl=F({__name:"BuilderInstanceTracker",props:{instancePath:{},matchSize:{type:Boolean},verticalOffsetPixels:{},isOffBoundsAllowed:{type:Boolean},preventSettingsBarOverlap:{type:Boolean}},setup(e,{expose:n}){const a=e,{instancePath:l,matchSize:o,verticalOffsetPixels:s,isOffBoundsAllowed:i,preventSettingsBarOverlap:u}=Qt(a),f=De({});let g=0;const m=ie("rootEl");function h(y){const b=document.querySelector(".ComponentRenderer"),{top:I,left:v}=y.getBoundingClientRect(),{clientHeight:k}=document.body,{clientWidth:T}=b,{left:D}=b.getBoundingClientRect(),E=document.querySelector(".BuilderSettings"),{left:M}=(E==null?void 0:E.getBoundingClientRect())||{left:1/0};let{clientHeight:N,clientWidth:Y}=(o!=null&&o.value?y:m.value)??{};if(N===void 0||Y===void 0)return;let Q=s!=null&&s.value?s.value:0,X=v,J=I+Q;if(i.value||(X=Math.max(D,X),X=Math.min(D+T-Y,X),J=Math.max(Pl,J),J=Math.min(k-N,J)),u.value){let de=0;X+Y>M&&(de=Math.max(X-(M-Y),0)),X-=de}f.value={display:"block",top:`${J}px`,left:`${X}px`,width:`${Y}px`,height:`${N}px`}}function S(){f.value={display:"none"}}function r(){let y=document.querySelector(`.ComponentRenderer [data-writer-instance-path="${l.value}"]`);if(!y){S();return}const b=getComputedStyle(y);if(!b){S();return}if(b.display=="contents"&&(y=y.querySelector("[data-writer-id]")),!y){S();return}h(y)}function _(){g=requestAnimationFrame(async()=>{r(),!C.signal.aborted&&(await new Promise(y=>setTimeout(y,Tl)),_())})}const C=xe();return n({refresh:r}),re(async()=>{window.addEventListener("scroll",r,{signal:C.signal}),_()}),Be(()=>{cancelAnimationFrame(g)}),(y,b)=>(t(),p("div",{ref_key:"rootEl",ref:m,class:"BuilderInstanceTracker",style:Fe(f.value)},[le(y.$slots,"default",{},void 0,!0)],4))}}),ze=W(Dl,[["__scopeId","data-v-c3e9e555"]]),xl={ref:"rootEl",class:"BuilderCollaborationTracker"},El={class:"bubble"},Ml={class:"main"},Ll=F({__name:"BuilderCollaborationTracker",setup(e){const n=V(R.collaborationManager);function a(l){return!(ea(l).length<=2)}return(l,o)=>(t(),p("div",xl,[(t(!0),p(j,null,ue(c(n).connectedUsersByInstancePath.value,(s,i)=>(t(),p(j,{key:i},[a(i)?(t(),A(ze,{key:0,"is-off-bounds-allowed":!1,"instance-path":i,"vertical-offset-pixels":-32,class:"instanceTracker"},{default:L(()=>[d("div",El,[d("div",Ml,[(t(!0),p(j,null,ue(s,u=>(t(),A(ut,{key:u,"show-tooltip":!0,"user-id":u},null,8,["user-id"]))),128))]),o[0]||(o[0]=d("div",{class:"triangle"},null,-1))])]),_:2},1032,["instance-path"])):$("",!0)],64))),128))],512))}}),Fl=W(Ll,[["__scopeId","data-v-15c19d63"]]),Nl={class:"ShareResizeVertical__top"},Rl={class:"ShareResizeVertical__divider"},Ul={class:"ShareResizeVertical__bottom"},Wl=F({__name:"ShareResizeVertical",props:{initialBottomSize:{type:Number,required:!0},disabled:{type:Boolean,required:!1}},setup(e){const n=e,a=ie("root"),l=xe(),o=ta(n,"initialBottomSize");let s=O(o.value);te(o,()=>s.value=o.value);const i=w(()=>({gridTemplateRows:`minmax(0px, 1fr) 1px ${s.value}px`}));function u(){if(!a.value)return;document.addEventListener("mousemove",g,{signal:l.signal}),document.addEventListener("mouseup",m,{signal:l.signal});const f=a.value.getBoundingClientRect();function g(h){s.value=f.bottom-h.clientY}function m(){document.removeEventListener("mouseup",m),document.removeEventListener("mousemove",g)}}return(f,g)=>(t(),p("div",{ref_key:"root",ref:a,class:"ShareResizeVertical",style:Fe(i.value)},[d("div",Nl,[le(f.$slots,"top",{},void 0,!0)]),d("div",Rl,[e.disabled?$("",!0):(t(),p("div",{key:0,class:"ShareResizeVertical__divider__hand",onMousedown:wt(u,["prevent"])},null,32))]),d("div",Ul,[le(f.$slots,"bottom",{},void 0,!0)])],4))}}),Vl=W(Wl,[["__scopeId","data-v-0de30584"]]),zl=F({__name:"BuilderAppSocketTimeoutModal",setup(e){const n=V(R.socketTimeout),a=w(()=>[{desc:"Keep session awake",loading:n.reconnecting.value,fn:()=>{n.preventTasks.value.add("stayAwake"),n.reconnect()}},{desc:"Reconnect",loading:n.reconnecting.value,fn:()=>{n.reconnect()}}]),l=`Youâ€™ve been disconnected because you were inactive for ${n.timeoutMin} minutes. Click below to reconnect and pick up where you left off.`;return(o,s)=>c(n).socketClosed.value?(t(),A(we,{key:0,title:"Session Expired",description:l,actions:a.value},null,8,["actions"])):$("",!0)}}),Ol=4e3;function ql(e,n){const a=n*60*1e3,l=it(),o=xe();let s;const i=O(!1),u=O(!1),f=Ct("useSocketTimeout_preventTasks",v=>Array.isArray(v)&&v.every(k=>typeof k=="string")),g=O(new Set),m=w(()=>g.value.size>0);function h(v){g.value.has(v)?g.value.delete(v):g.value.add(v)}const S=new Set(["collaborationPing","listResources","keepAlive"]),r=w(()=>{for(const v of e.frontendMessageMap.value.values())if(!S.has(v.type))return!0;return!1}),_=w(()=>!m.value&&!r.value);function C(){return!_.value||document.visibilityState!=="hidden"?!1:(y(),l.log(`[SocketTimeout] planning timeout in ${n}min`),s=setTimeout(()=>{_.value&&(l.warn(`[SocketTimeout] Closing socket after ${n} minutes of inactivity (tab hidden)`),e.stopSync(Ol),i.value=!0,l.info("[SocketTimeout] Socket closed"))},a),!0)}function y(){s&&(l.log("[SocketTimeout] canceling timeout "),clearTimeout(s),s=void 0)}te(_,()=>{_.value?document.visibilityState==="hidden"&&C():y()}),te(g,()=>{f.value=[...g.value]},{deep:!0}),te(r,(v,k)=>{k&&!v&&document.visibilityState==="hidden"&&(l.log("[SocketTimeout] Preventing socket to be closed due to finished task in background..."),g.value.add("pendingMessageInBackground"))});async function b(){l.info("[SocketTimeout] Attempting to reconnect socket..."),u.value=!0;try{await e.init(),i.value=!1,l.info("[SocketTimeout] Socket reconnected successfully")}catch(v){l.error("[SocketTimeout] Failed to reconnect socket, reloading page",v),window.location.reload()}finally{u.value=!1}}function I(){document.visibilityState==="visible"?(g.value.delete("pendingMessageInBackground"),y()):_.value&&C()}return re(()=>{f&&(g.value=new Set(f.value)),document.addEventListener("visibilitychange",I,{signal:o.signal})}),{timeoutMin:n,socketClosed:i,reconnecting:u,prevent:m,preventTasks:g,togglePreventTaskId:h,onVisibilityChange:I,clearSchedule:y,schedule:C,reconnect:b}}const Kl={class:"builderMain"},jl=F({__name:"BuilderApp",setup(e){pt(R.isAutogenModalShown,O(!1));const n=ce({loader:()=>pe(()=>import("./BuilderSettings-CLZnGiL-.js").then(x=>x.a),__vite__mapDeps([11,0,1,12,5,6,13,14,15,16,17,18,19]),import.meta.url)}),a=ce({loader:()=>pe(()=>import("./ComponentRenderer-Dq2unetb.js"),__vite__mapDeps([20,0,1,21]),import.meta.url)}),l=ce({loader:()=>pe(()=>import("./BuilderInsertionOverlay-BMsACrNL.js"),__vite__mapDeps([22,0,1,23]),import.meta.url)}),o=ce({loader:()=>pe(()=>import("./BuilderInsertionLabel-B8H8vy-V.js"),__vite__mapDeps([24,0,1,25]),import.meta.url)}),s=ce({loader:()=>pe(()=>import("./BuilderVault-Cp6WwWfZ.js"),__vite__mapDeps([26,18,0,1,16,17,27]),import.meta.url)}),i=ce({loader:()=>pe(()=>import("./BuilderJournal-C61kSD6i.js"),__vite__mapDeps([28,0,1,14,15,29,12,5,6,13,30,31]),import.meta.url)}),u=V(R.core),f=V(R.builderManager),g=V(R.notesManager),m=V(R.collaborationManager),h=ye(u),S=Se(),r=Number(localStorage.getItem("socketTimeoutMin"))||10;pt(R.socketTimeout,ql(u,r));const _=ie("noteEl"),C=ie("rendererEl"),y=ie("rendererWrapperEl");function b(){if(_.value!=null&&typeof _.value[Symbol.iterator]=="function")for(const ee of _.value)ee.refresh()}const{candidateId:I,candidateInstancePath:v,isCandidacyConfirmed:k,dropComponent:T,assignInsertionCandidacy:D,removeInsertionCandidacy:E}=la(u),{createAndInsertComponent:M,undo:N,redo:Y,moveComponent:Q,moveComponentUp:X,moveComponentDown:J,cutComponent:de,isPasteAllowed:ge,isCopyAllowed:ve,isCutAllowed:_e,isDeleteAllowed:Ke,isGoToParentAllowed:Re,isGoToChildAllowed:je,isGoToNextSiblingAllowed:fe,isGoToPrevSiblingAllowed:He,pasteComponent:Ue,copyComponent:Ge,removeComponentsSubtree:We,goToParent:Me,goToChild:Ce,goToNextSibling:Ye,goToPrevSibling:Je,moveComponentToParent:Ze,moveComponentInsideNextSibling:Xe}=Ne(u,f,h),Z=f.mode,Qe=f.firstSelectedId,Ve=w(()=>f.openPanels.value.size>0),P=w(()=>Array.from(g.getNotes(u.activePageId.value)).map(x=>({...x,parentInstancePath:g.useNoteInformation(x).parentInstancePath.value})).filter(x=>x.parentInstancePath!==void 0));async function H(x){if(x.key==="Escape"){f.setSelection(null);return}const ee=rt()?x.metaKey:x.ctrlKey;if(x.target.closest("textarea, input, select, [contenteditable]"))return;if(x.key==="z"&&ee){x.preventDefault(),N();return}if(x.key==="y"&&ee){x.preventDefault(),Y();return}if(!f.isSingleSelectionActive.value||!f.firstSelectedItem.value)return;const{componentId:G,instancePath:$e}=f.firstSelectedItem.value;if(x.key===(rt()?"Backspace":"Delete")){const be=f.selection.value.filter(Ie=>Ke(Ie.componentId)).map(Ie=>Ie.componentId);We(...be);return}if(ee)if(x.shiftKey)switch(x.key){case"ArrowDown":x.preventDefault(),fe(G)&&Ye(G);break;case"ArrowUp":x.preventDefault(),He(G)&&Je(G);break;case"ArrowLeft":x.preventDefault(),Re(G)&&Me(G,$e);break;case"ArrowRight":x.preventDefault(),je(G)&&Ce(G);break}else switch(x.key){case"ArrowDown":x.preventDefault(),J(G);break;case"ArrowUp":x.preventDefault(),X(G);break;case"ArrowLeft":x.preventDefault(),Ze(G);break;case"ArrowRight":x.preventDefault(),Xe(G);break;case"v":if(!ge(G))return;try{await Ue(G)}catch(be){S.pushToast({type:"error",message:String(be)})}break;case"c":ve(G)&&Ge(G);break;case"x":_e(G)&&de(G);break}}function oe(x){Z.value!=="preview"&&D(x)}function et(x){if(Z.value==="preview")return;f.setSelection(null);const ee=T(x);if(!ee)return;const{draggedType:ae,draggedId:G,parentId:$e,position:be}=ee;G?Q(G,$e,be):M(ae,$e,be)}function tt(x){if(Z.value==="preview"||x.target.closest("[data-writer-unselectable]"))return;if(Z.value==="blueprints"&&f.selectionStatus.value===nt.Multiple){const Ie=x.target.closest("[data-writer-id]");if(Ie&&f.isComponentIdSelected(Ie.dataset.writerId)){x.preventDefault(),x.stopPropagation();return}}const ae=x.target.closest("[data-writer-id]");if(!ae)return;const G=ae.dataset.writerId,$e=ae.dataset.writerInstancePath;f.isComponentIdSelected(G)&&f.selectionStatus.value!==nt.Multiple||g.isAnnotating.value||(x.preventDefault(),x.stopPropagation(),f.handleSelectionFromEvent(x,G,$e,"click"))}function Pt(){f.isSettingsBarCollapsed.value=!1}const Dt=x=>{if(Z.value==="preview")return;const ee=x.target.closest("[data-writer-id]");if(!ee)return;const ae=ee.dataset.writerId;if(!ae)return;const{type:G}=u.getComponentById(ae);f.selectionStatus.value===nt.Multiple&&(f.setSelection(ae,void 0,"click"),f.isSettingsBarCollapsed.value=!0),x.dataTransfer.setData(`application/json;writer=${G},${ae}`,"{}")};function xt(x){f.setSelection(null),E(x)}const dt=new AbortController;return te(f.selection,()=>{m&&(m.updateOutgoingPing({action:"select",selection:f.selection.value}),m.sendCollaborationPing())}),re(()=>{document.addEventListener("keydown",H,{signal:dt.signal})}),Be(()=>{dt.abort()}),(x,ee)=>(t(),p("div",{class:"BuilderApp",tabindex:"-1",style:Fe(c(oa))},[d("div",{class:K(["mainGrid",{openPanels:c(f).openPanels.value.size>0}])},[B(Na,{class:"builderHeader"}),he(B(wl,{class:"sidebar",onActivePaneChanged:b},null,512),[[Ee,c(Z)==="ui"||c(Z)==="blueprints"]]),B(Vl,{"initial-bottom-size":Ve.value?440:48,disabled:!Ve.value,class:K({"mainGrid--fullWidth":c(Z)==="preview"||c(Z)==="vault"||c(Z)==="journal"})},{top:L(()=>[d("div",Kl,[c(Z)==="vault"?(t(),A(c(s),{key:0})):$("",!0),(t(),A(aa,null,[c(Z)==="journal"?(t(),A(c(i),{key:0})):$("",!0)],1024)),c(Z)!=="vault"&&c(Z)!=="journal"?(t(),p("div",{key:1,ref_key:"rendererWrapperEl",ref:y,class:K(["rendererWrapper",{addNoteCursor:c(g).isAnnotating.value&&c(f).mode.value!=="preview"}]),onScroll:b},[B(c(a),{ref_key:"rendererEl",ref:C,class:K(["componentRenderer",{settingsOpen:c(f).isSingleSelectionActive}]),onDragover:oe,onDragstart:Dt,onDragend:xt,onDrop:et,onClickCapture:tt,onDblclick:Pt},null,8,["class"])],34)):$("",!0),c(f).isSingleSelectionActive&&c(Z)!=="journal"&&c(Z)!=="vault"?(t(),A(c(n),{key:c(Qe)??"noneSelected"})):$("",!0)])]),bottom:L(()=>[B(Lo,{class:"panelSwitcher"})]),_:1},8,["initial-bottom-size","disabled","class"])],2),c(Z)!=="preview"?(t(),p(j,{key:0},[B(Fl,{class:"collaborationTracker"}),c(I)&&!c(k)?(t(),p(j,{key:0},[(t(),A(ze,{key:c(v),class:"insertionOverlayTracker","is-off-bounds-allowed":!0,"instance-path":c(v),"match-size":!0},{default:L(()=>[B(c(l))]),_:1},8,["instance-path"])),(t(),A(ze,{key:c(v),class:"insertionLabelTracker","instance-path":c(v),"vertical-offset-pixels":-48},{default:L(()=>[B(c(o),null,{default:L(()=>[q(U(c(u).getComponentDefinition(c(u).getComponentById(c(I)).type).name),1)]),_:1})]),_:1},8,["instance-path"]))],64)):$("",!0)],64)):$("",!0),c(Z)==="ui"?(t(!0),p(j,{key:1},ue(P.value,ae=>(t(),A(ze,{key:ae.id,ref_for:!0,ref_key:"noteEl",ref:_,class:"BuilderApp__noteTracker","is-off-bounds-allowed":!0,"instance-path":ae.parentInstancePath,"match-size":!0},{default:L(()=>[B(na,{class:"BuilderApp__noteTracker__note","component-id":ae.id},null,8,["component-id"])]),_:2},1032,["instance-path"]))),128)):$("",!0),ee[0]||(ee[0]=d("div",{id:"modal"},null,-1)),ee[1]||(ee[1]=d("div",{id:"drawer"},null,-1)),B(zl),B(za,{id:"tooltip"}),B(Al)],4))}}),Hl=W(jl,[["__scopeId","data-v-713da3b8"]]),Zl=Object.freeze(Object.defineProperty({__proto__:null,default:Hl},Symbol.toStringTag,{value:"Module"}));export{jo as B,Tt as W,on as a,lo as b,Zl as c,ma as u};
//# sourceMappingURL=BuilderApp-Cw_QuIxo.js.map
