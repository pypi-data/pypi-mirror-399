{"version":3,"file":"deployment-form-BIq0pioc.js","sources":["../../src/components/global-concurrency-limit/global-concurrency-limit-select/global-concurrency-limit-select.tsx","../../src/components/ui/markdown-input.tsx","../../src/components/work-pools/work-pool-select/work-pool-select.tsx","../../src/components/deployments/deployment-form/limit-collision-strategy-select.tsx","../../src/components/deployments/deployment-form/use-deployment-form.ts","../../src/components/deployments/deployment-form/deployment-form.tsx"],"sourcesContent":["import { useSuspenseQuery } from \"@tanstack/react-query\";\nimport { Suspense, useDeferredValue, useMemo, useState } from \"react\";\nimport { buildListGlobalConcurrencyLimitsQuery } from \"@/api/global-concurrency-limits\";\nimport {\n\tCombobox,\n\tComboboxCommandEmtpy,\n\tComboboxCommandGroup,\n\tComboboxCommandInput,\n\tComboboxCommandItem,\n\tComboboxCommandList,\n\tComboboxContent,\n\tComboboxTrigger,\n} from \"@/components/ui/combobox\";\n\ntype PresetOption = {\n\tlabel: string;\n\tvalue: string | null | undefined;\n};\n\ntype GlobalConcurrencyLimitSelectProps = {\n\tpresetOptions?: Array<PresetOption>;\n\tselected: string | undefined | null;\n\tonSelect: (name: string | undefined | null) => void;\n};\n\nexport const GlobalConcurrencyLimitSelect = ({\n\tpresetOptions = [],\n\tselected,\n\tonSelect,\n}: GlobalConcurrencyLimitSelectProps) => {\n\treturn (\n\t\t<Suspense>\n\t\t\t<GlobalConcurrencyLimitSelectImplementation\n\t\t\t\tpresetOptions={presetOptions}\n\t\t\t\tselected={selected}\n\t\t\t\tonSelect={onSelect}\n\t\t\t/>\n\t\t</Suspense>\n\t);\n};\n\nconst GlobalConcurrencyLimitSelectImplementation = ({\n\tpresetOptions = [],\n\tselected,\n\tonSelect,\n}: GlobalConcurrencyLimitSelectProps) => {\n\tconst [search, setSearch] = useState(\"\");\n\tconst { data } = useSuspenseQuery(buildListGlobalConcurrencyLimitsQuery());\n\n\tconst deferredSearch = useDeferredValue(search);\n\tconst filteredData = useMemo(() => {\n\t\treturn data.filter((globalConcurrencyLimit) =>\n\t\t\tglobalConcurrencyLimit.name\n\t\t\t\t.toLowerCase()\n\t\t\t\t.includes(deferredSearch.toLowerCase()),\n\t\t);\n\t}, [data, deferredSearch]);\n\n\tconst filteredPresetOptions = useMemo(() => {\n\t\treturn presetOptions.filter((option) =>\n\t\t\toption.label.toLowerCase().includes(deferredSearch.toLowerCase()),\n\t\t);\n\t}, [deferredSearch, presetOptions]);\n\n\treturn (\n\t\t<Combobox>\n\t\t\t<ComboboxTrigger\n\t\t\t\tselected={Boolean(selected)}\n\t\t\t\taria-label=\"Select a global concurrency limit\"\n\t\t\t>\n\t\t\t\t{\n\t\t\t\t\tdata.find(\n\t\t\t\t\t\t(globalConcurrencyLimit) => globalConcurrencyLimit.id === selected,\n\t\t\t\t\t)?.name\n\t\t\t\t}\n\t\t\t</ComboboxTrigger>\n\t\t\t<ComboboxContent>\n\t\t\t\t<ComboboxCommandInput\n\t\t\t\t\tvalue={search}\n\t\t\t\t\tonValueChange={setSearch}\n\t\t\t\t\tplaceholder=\"Search for a global concurrency limit...\"\n\t\t\t\t/>\n\t\t\t\t<ComboboxCommandEmtpy>\n\t\t\t\t\tNo global concurrency limit found\n\t\t\t\t</ComboboxCommandEmtpy>\n\t\t\t\t<ComboboxCommandList>\n\t\t\t\t\t<ComboboxCommandGroup>\n\t\t\t\t\t\t{filteredPresetOptions.map((option) => (\n\t\t\t\t\t\t\t<ComboboxCommandItem\n\t\t\t\t\t\t\t\tkey={option.label}\n\t\t\t\t\t\t\t\tselected={selected === option.value}\n\t\t\t\t\t\t\t\tonSelect={() => {\n\t\t\t\t\t\t\t\t\tonSelect(option.value);\n\t\t\t\t\t\t\t\t\tsetSearch(\"\");\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t//nb: Stringifies label so that UX has a hoverable state\n\t\t\t\t\t\t\t\tvalue={String(option.label)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{option.label}\n\t\t\t\t\t\t\t</ComboboxCommandItem>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{filteredData.map((globalConcurrencyLimit) => (\n\t\t\t\t\t\t\t<ComboboxCommandItem\n\t\t\t\t\t\t\t\tkey={globalConcurrencyLimit.id}\n\t\t\t\t\t\t\t\tselected={selected === globalConcurrencyLimit.name}\n\t\t\t\t\t\t\t\tonSelect={(value) => {\n\t\t\t\t\t\t\t\t\tonSelect(value);\n\t\t\t\t\t\t\t\t\tsetSearch(\"\");\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={globalConcurrencyLimit.id}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{globalConcurrencyLimit.name}\n\t\t\t\t\t\t\t</ComboboxCommandItem>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ComboboxCommandGroup>\n\t\t\t\t</ComboboxCommandList>\n\t\t\t</ComboboxContent>\n\t\t</Combobox>\n\t);\n};\n","import { markdown } from \"@codemirror/lang-markdown\";\nimport {\n\ttype BasicSetupOptions,\n\tEditorView,\n\tuseCodeMirror,\n} from \"@uiw/react-codemirror\";\nimport React, { useEffect, useRef } from \"react\";\nimport { toast } from \"sonner\";\nimport { cn } from \"@/utils\";\nimport { Button } from \"./button\";\nimport { Icon } from \"./icons\";\n\nconst extensions = [markdown(), EditorView.lineWrapping];\n\ntype MarkdownInputProps = React.ComponentProps<\"div\"> & {\n\tvalue?: string;\n\tonChange?: (value: string) => void;\n\tonBlur?: () => void;\n\tdisabled?: boolean;\n\tclassName?: string;\n\thideLineNumbers?: boolean;\n\tcopy?: boolean;\n};\n\nexport const MarkdownInput = React.forwardRef<\n\tHTMLDivElement,\n\tMarkdownInputProps\n>(\n\t(\n\t\t{\n\t\t\tclassName,\n\t\t\tvalue,\n\t\t\tonChange,\n\t\t\tcopy = false,\n\t\t\tonBlur,\n\t\t\tdisabled,\n\t\t\thideLineNumbers = false,\n\t\t\t...props\n\t\t},\n\t\tforwardedRef,\n\t) => {\n\t\tconst editor = useRef<HTMLDivElement | null>(null);\n\t\t// Setting `basicSetup` messes up the tab order. We only change the basic setup\n\t\t// if the input is disabled, so we leave it undefined to maintain the tab order.\n\t\tlet basicSetup: BasicSetupOptions | undefined;\n\t\tif (disabled) {\n\t\t\tbasicSetup = {\n\t\t\t\tlineNumbers: !hideLineNumbers,\n\t\t\t\thighlightActiveLine: false,\n\t\t\t\tfoldGutter: false,\n\t\t\t\thighlightActiveLineGutter: false,\n\t\t\t};\n\t\t}\n\t\tconst { setContainer } = useCodeMirror({\n\t\t\tcontainer: editor.current,\n\t\t\textensions,\n\t\t\tvalue,\n\t\t\tonChange,\n\t\t\tonBlur,\n\t\t\tindentWithTab: false,\n\t\t\teditable: !disabled,\n\t\t\tbasicSetup,\n\t\t});\n\n\t\tuseEffect(() => {\n\t\t\tif (editor.current) {\n\t\t\t\tsetContainer(editor.current);\n\t\t\t}\n\t\t}, [setContainer]);\n\n\t\tconst handleCopy = (_value: string) => {\n\t\t\ttoast.success(\"Copied to clipboard\");\n\t\t\tvoid navigator.clipboard.writeText(_value);\n\t\t};\n\n\t\treturn (\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"rounded-md border shadow-xs overflow-hidden focus-within:outline-hidden focus-within:ring-1 focus-within:ring-ring relative\",\n\t\t\t\t\tclassName,\n\t\t\t\t)}\n\t\t\t\tref={(node) => {\n\t\t\t\t\teditor.current = node;\n\t\t\t\t\tif (typeof forwardedRef === \"function\") {\n\t\t\t\t\t\tforwardedRef(node);\n\t\t\t\t\t} else if (forwardedRef) {\n\t\t\t\t\t\tforwardedRef.current = node;\n\t\t\t\t\t}\n\t\t\t\t}}\n\t\t\t\t{...props}\n\t\t\t>\n\t\t\t\t{copy && value && (\n\t\t\t\t\t<Button\n\t\t\t\t\t\tonClick={() => handleCopy(value)}\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tclassName=\"absolute top-0 right-0 z-10\"\n\t\t\t\t\t\taria-label=\"copy\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Icon id=\"Copy\" className=\"size-2\" />\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t);\n\t},\n);\n\nMarkdownInput.displayName = \"MarkdownInput\";\n","import { useSuspenseQuery } from \"@tanstack/react-query\";\nimport { Suspense, useDeferredValue, useMemo, useState } from \"react\";\nimport { buildFilterWorkPoolsQuery } from \"@/api/work-pools\";\nimport {\n\tCombobox,\n\tComboboxCommandEmtpy,\n\tComboboxCommandGroup,\n\tComboboxCommandInput,\n\tComboboxCommandItem,\n\tComboboxCommandList,\n\tComboboxContent,\n\tComboboxTrigger,\n} from \"@/components/ui/combobox\";\n\ntype PresetOption = {\n\tlabel: string;\n\tvalue: string | null | undefined;\n};\n\ntype WorkPoolSelectProps = {\n\tpresetOptions?: Array<PresetOption>;\n\tselected: string | undefined | null;\n\tonSelect: (name: string | undefined | null) => void;\n};\n\nexport const WorkPoolSelect = ({\n\tpresetOptions = [],\n\tselected,\n\tonSelect,\n}: WorkPoolSelectProps) => {\n\treturn (\n\t\t<Suspense>\n\t\t\t<WorkPoolSelectImplementation\n\t\t\t\tpresetOptions={presetOptions}\n\t\t\t\tselected={selected}\n\t\t\t\tonSelect={onSelect}\n\t\t\t/>\n\t\t</Suspense>\n\t);\n};\n\nconst WorkPoolSelectImplementation = ({\n\tpresetOptions = [],\n\tselected,\n\tonSelect,\n}: WorkPoolSelectProps) => {\n\tconst [search, setSearch] = useState(\"\");\n\tconst { data } = useSuspenseQuery(buildFilterWorkPoolsQuery());\n\n\t// nb: because work pools API does not have filtering _like by name, do client-side filtering\n\tconst deferredSearch = useDeferredValue(search);\n\tconst filteredData = useMemo(() => {\n\t\treturn data.filter((workPool) =>\n\t\t\tworkPool.name.toLowerCase().includes(deferredSearch.toLowerCase()),\n\t\t);\n\t}, [data, deferredSearch]);\n\n\tconst filteredPresetOptions = useMemo(() => {\n\t\treturn presetOptions.filter((option) =>\n\t\t\toption.label.toLowerCase().includes(deferredSearch.toLowerCase()),\n\t\t);\n\t}, [deferredSearch, presetOptions]);\n\n\treturn (\n\t\t<Combobox>\n\t\t\t<ComboboxTrigger\n\t\t\t\tselected={Boolean(selected)}\n\t\t\t\taria-label=\"Select a work pool\"\n\t\t\t>\n\t\t\t\t{selected}\n\t\t\t</ComboboxTrigger>\n\t\t\t<ComboboxContent>\n\t\t\t\t<ComboboxCommandInput\n\t\t\t\t\tvalue={search}\n\t\t\t\t\tonValueChange={setSearch}\n\t\t\t\t\tplaceholder=\"Search for a work pool...\"\n\t\t\t\t/>\n\t\t\t\t<ComboboxCommandEmtpy>No work pool found</ComboboxCommandEmtpy>\n\t\t\t\t<ComboboxCommandList>\n\t\t\t\t\t<ComboboxCommandGroup>\n\t\t\t\t\t\t{filteredPresetOptions.map((option) => (\n\t\t\t\t\t\t\t<ComboboxCommandItem\n\t\t\t\t\t\t\t\tkey={option.label}\n\t\t\t\t\t\t\t\tselected={selected === option.value}\n\t\t\t\t\t\t\t\tonSelect={() => {\n\t\t\t\t\t\t\t\t\tonSelect(option.value);\n\t\t\t\t\t\t\t\t\tsetSearch(\"\");\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t//nb: Stringifies label so that UX has a hoverable state\n\t\t\t\t\t\t\t\tvalue={String(option.label)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{option.label}\n\t\t\t\t\t\t\t</ComboboxCommandItem>\n\t\t\t\t\t\t))}\n\t\t\t\t\t\t{filteredData.map((workPool) => (\n\t\t\t\t\t\t\t<ComboboxCommandItem\n\t\t\t\t\t\t\t\tkey={workPool.id}\n\t\t\t\t\t\t\t\tselected={selected === workPool.name}\n\t\t\t\t\t\t\t\tonSelect={(value) => {\n\t\t\t\t\t\t\t\t\tonSelect(value);\n\t\t\t\t\t\t\t\t\tsetSearch(\"\");\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tvalue={workPool.name}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{workPool.name}\n\t\t\t\t\t\t\t</ComboboxCommandItem>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</ComboboxCommandGroup>\n\t\t\t\t</ComboboxCommandList>\n\t\t\t</ComboboxContent>\n\t\t</Combobox>\n\t);\n};\n","import type { components } from \"@/api/prefect\";\nimport {\n\tSelect,\n\tSelectContent,\n\tSelectGroup,\n\tSelectItem,\n\tSelectTrigger,\n\tSelectValue,\n} from \"@/components/ui/select\";\n\ntype LimitCollissionStrategy =\n\tcomponents[\"schemas\"][\"ConcurrencyLimitStrategy\"];\n\nconst LIMIT_COLLISSION_STRATEGIES = {\n\tENQUEUE: \"ENQUEUE\",\n\tCANCEL_NEW: \"CANCEL_NEW\",\n} satisfies Record<LimitCollissionStrategy, LimitCollissionStrategy>;\n\ntype LimitCollissionStrategySelectProps = {\n\tonValueChange: (value: LimitCollissionStrategy | undefined) => void;\n\tvalue: LimitCollissionStrategy | undefined;\n};\n\nexport const LimitCollissionStrategySelect = ({\n\tonValueChange,\n\tvalue,\n}: LimitCollissionStrategySelectProps) => {\n\treturn (\n\t\t<Select\n\t\t\tvalue={value}\n\t\t\tonValueChange={(value) => {\n\t\t\t\tif (value === \"\") {\n\t\t\t\t\tonValueChange(undefined);\n\t\t\t\t} else {\n\t\t\t\t\tonValueChange(value as LimitCollissionStrategy);\n\t\t\t\t}\n\t\t\t}}\n\t\t>\n\t\t\t<SelectTrigger>\n\t\t\t\t<SelectValue placeholder={LIMIT_COLLISSION_STRATEGIES.ENQUEUE} />\n\t\t\t</SelectTrigger>\n\t\t\t<SelectContent>\n\t\t\t\t<SelectGroup>\n\t\t\t\t\t<SelectItem value={LIMIT_COLLISSION_STRATEGIES.ENQUEUE}>\n\t\t\t\t\t\t{LIMIT_COLLISSION_STRATEGIES.ENQUEUE}\n\t\t\t\t\t</SelectItem>\n\t\t\t\t\t<SelectItem value={LIMIT_COLLISSION_STRATEGIES.CANCEL_NEW}>\n\t\t\t\t\t\t{LIMIT_COLLISSION_STRATEGIES.CANCEL_NEW}\n\t\t\t\t\t</SelectItem>\n\t\t\t\t</SelectGroup>\n\t\t\t</SelectContent>\n\t\t</Select>\n\t);\n};\n","import { zodResolver } from \"@hookform/resolvers/zod\";\nimport { useNavigate } from \"@tanstack/react-router\";\nimport { useEffect } from \"react\";\nimport { useForm } from \"react-hook-form\";\nimport { toast } from \"sonner\";\nimport { z } from \"zod\";\nimport {\n\ttype Deployment,\n\tuseCreateDeployment,\n\tuseUpdateDeployment,\n} from \"@/api/deployments\";\nimport { useSchemaForm } from \"@/components/schemas\";\n\ntype FormMode = \"edit\" | \"duplicate\";\n\nconst createFormSchema = (\n\tdeployment: Deployment,\n\t{ mode }: { mode: FormMode },\n) =>\n\tz.object({\n\t\tname: z.string().refine(\n\t\t\t(value) => {\n\t\t\t\tif (mode === \"edit\") {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\treturn value !== deployment.name;\n\t\t\t},\n\t\t\t{ message: \"Name must be different from the original deployment\" },\n\t\t),\n\t\tdescription: z.string().nullable().optional(),\n\t\twork_pool_name: z.string().nullable().optional(),\n\t\twork_queue_name: z.string().nullable().optional(),\n\t\ttags: z.array(z.string()).optional(),\n\t\tconcurrency_options: z\n\t\t\t.object({\n\t\t\t\tcollision_strategy: z.enum([\"ENQUEUE\", \"CANCEL_NEW\"]).optional(),\n\t\t\t})\n\t\t\t.nullable()\n\t\t\t.optional(),\n\t\tjob_variables: z.string().superRefine((val, ctx) => {\n\t\t\ttry {\n\t\t\t\tif (!val) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\treturn JSON.parse(val) as Record<string, unknown>;\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(err);\n\t\t\t\tctx.addIssue({ code: \"custom\", message: \"Invalid JSON\" });\n\t\t\t\treturn z.NEVER;\n\t\t\t}\n\t\t}),\n\t\tenforce_parameter_schema: z.boolean(),\n\t\tparameter_openapi_schema: z\n\t\t\t.record(z.unknown())\n\t\t\t.optional()\n\t\t\t.nullable()\n\t\t\t.readonly(),\n\t\tglobal_concurrency_limit_id: z.string().uuid().optional().nullable(),\n\t});\n\nexport type DeploymentFormSchema = z.infer<ReturnType<typeof createFormSchema>>;\n\nconst DEFAULT_VALUES: DeploymentFormSchema = {\n\tname: \"\",\n\tdescription: \"\",\n\ttags: [],\n\tjob_variables: \"\",\n\tenforce_parameter_schema: true,\n\tglobal_concurrency_limit_id: null,\n};\n\nexport const useDeploymentForm = (\n\tdeployment: Deployment,\n\t{ mode }: { mode: FormMode },\n) => {\n\tconst navigate = useNavigate();\n\tconst form = useForm({\n\t\tresolver: zodResolver(createFormSchema(deployment, { mode })),\n\t\tdefaultValues: DEFAULT_VALUES,\n\t});\n\tconst {\n\t\tvalues: parametersFormValues,\n\t\tsetValues: setParametersFormValues,\n\t\terrors: parameterFormErrors,\n\t\tvalidateForm: validateParametersForm,\n\t} = useSchemaForm();\n\n\tconst { createDeployment } = useCreateDeployment();\n\tconst { updateDeployment } = useUpdateDeployment();\n\n\t// syncs form state to deployment to update\n\tuseEffect(() => {\n\t\tconst {\n\t\t\tname,\n\t\t\tdescription,\n\t\t\twork_pool_name,\n\t\t\twork_queue_name,\n\t\t\ttags,\n\t\t\tconcurrency_options,\n\t\t\tparameter_openapi_schema,\n\t\t\tenforce_parameter_schema,\n\t\t\tjob_variables,\n\t\t\tglobal_concurrency_limit,\n\t\t} = deployment;\n\n\t\t// nb: parameter form state and validation is handled separately using SchemaForm\n\t\t// parameters has poor typings from openAPI\n\t\tsetParametersFormValues(deployment.parameters as Record<string, unknown>);\n\n\t\t// nb: Handle remaining form fields using react-hook-form\n\t\tform.reset({\n\t\t\tdescription,\n\t\t\tname,\n\t\t\twork_pool_name,\n\t\t\twork_queue_name,\n\t\t\ttags,\n\t\t\tconcurrency_options,\n\t\t\tparameter_openapi_schema,\n\t\t\tenforce_parameter_schema,\n\t\t\tjob_variables: job_variables ? JSON.stringify(job_variables) : \"\",\n\t\t\tglobal_concurrency_limit_id: global_concurrency_limit?.id,\n\t\t});\n\t}, [form, deployment, setParametersFormValues]);\n\n\tconst onSave = async (values: DeploymentFormSchema) => {\n\t\tconst {\n\t\t\tname,\n\t\t\tjob_variables,\n\t\t\tdescription,\n\t\t\twork_pool_name,\n\t\t\twork_queue_name,\n\t\t\ttags,\n\t\t\tenforce_parameter_schema,\n\t\t\tconcurrency_options,\n\t\t\tparameter_openapi_schema,\n\t\t\tglobal_concurrency_limit_id,\n\t\t} = values;\n\n\t\tconst jobVariablesPayload = job_variables\n\t\t\t? (JSON.parse(job_variables) as Record<string, unknown>)\n\t\t\t: undefined;\n\n\t\tif (parameter_openapi_schema && enforce_parameter_schema) {\n\t\t\ttry {\n\t\t\t\tawait validateParametersForm({ schema: parameter_openapi_schema });\n\t\t\t} catch (err) {\n\t\t\t\tconst message = \"Unknown error while updating validating schema.\";\n\t\t\t\ttoast.error(message);\n\t\t\t\tconsole.error(message, err);\n\t\t\t}\n\t\t}\n\n\t\t// Early exit if there's errors\n\t\tif (parameterFormErrors.length > 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst concurrencyOptions = concurrency_options?.collision_strategy\n\t\t\t? { collision_strategy: concurrency_options.collision_strategy }\n\t\t\t: undefined;\n\n\t\tswitch (mode) {\n\t\t\tcase \"duplicate\":\n\t\t\t\tcreateDeployment(\n\t\t\t\t\t{\n\t\t\t\t\t\tconcurrency_options: concurrencyOptions,\n\t\t\t\t\t\tdescription,\n\t\t\t\t\t\tenforce_parameter_schema,\n\t\t\t\t\t\tflow_id: deployment.flow_id,\n\t\t\t\t\t\tjob_variables: jobVariablesPayload,\n\t\t\t\t\t\tname,\n\t\t\t\t\t\tparameters: parametersFormValues,\n\t\t\t\t\t\tparameter_openapi_schema: parameter_openapi_schema || undefined,\n\t\t\t\t\t\tpaused: deployment.paused,\n\t\t\t\t\t\ttags,\n\t\t\t\t\t\t// If value is \"\", set as null\n\t\t\t\t\t\twork_pool_name: work_pool_name || null,\n\t\t\t\t\t\t// If value is \"\", set as null\n\t\t\t\t\t\twork_queue_name: work_queue_name || null,\n\t\t\t\t\t\tglobal_concurrency_limit_id,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess: ({ id }) => {\n\t\t\t\t\t\t\ttoast.success(\"Deployment created\");\n\t\t\t\t\t\t\tvoid navigate({\n\t\t\t\t\t\t\t\tto: \"/deployments/deployment/$id\",\n\t\t\t\t\t\t\t\tparams: { id },\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonError: (error) => {\n\t\t\t\t\t\t\tconst message =\n\t\t\t\t\t\t\t\terror.message || \"Unknown error while creating deployment.\";\n\t\t\t\t\t\t\tconsole.error(message);\n\t\t\t\t\t\t\ttoast.error(message);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase \"edit\":\n\t\t\t\tupdateDeployment(\n\t\t\t\t\t{\n\t\t\t\t\t\tconcurrency_options: concurrencyOptions,\n\t\t\t\t\t\tdescription,\n\t\t\t\t\t\tenforce_parameter_schema,\n\t\t\t\t\t\tid: deployment.id,\n\t\t\t\t\t\tjob_variables: jobVariablesPayload,\n\t\t\t\t\t\tparameters: parametersFormValues,\n\t\t\t\t\t\tpaused: deployment.paused,\n\t\t\t\t\t\ttags,\n\t\t\t\t\t\t// If value is \"\", set as null\n\t\t\t\t\t\twork_pool_name: work_pool_name || null,\n\t\t\t\t\t\t// If value is \"\", set as null\n\t\t\t\t\t\twork_queue_name: work_queue_name || null,\n\t\t\t\t\t\tglobal_concurrency_limit_id,\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess: () => {\n\t\t\t\t\t\t\ttoast.success(\"Deployment updated\");\n\t\t\t\t\t\t\tvoid navigate({\n\t\t\t\t\t\t\t\tto: \"/deployments/deployment/$id\",\n\t\t\t\t\t\t\t\tparams: { id: deployment.id },\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonError: (error) => {\n\t\t\t\t\t\t\tconst message =\n\t\t\t\t\t\t\t\terror.message || \"Unknown error while updating deployment.\";\n\t\t\t\t\t\t\tconsole.error(message);\n\t\t\t\t\t\t\ttoast.error(message);\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t}\n\t};\n\n\treturn {\n\t\tform,\n\t\tonSave,\n\t\tparametersFormValues,\n\t\tsetParametersFormValues,\n\t\tparameterFormErrors,\n\t};\n};\n","import { Link } from \"@tanstack/react-router\";\nimport type { Deployment } from \"@/api/deployments\";\nimport { GlobalConcurrencyLimitSelect } from \"@/components/global-concurrency-limit/global-concurrency-limit-select\";\nimport { LazySchemaForm, type PrefectSchemaObject } from \"@/components/schemas\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n\tForm,\n\tFormControl,\n\tFormField,\n\tFormItem,\n\tFormLabel,\n\tFormMessage,\n} from \"@/components/ui/form\";\nimport { Input } from \"@/components/ui/input\";\nimport { JsonInput } from \"@/components/ui/json-input\";\nimport { MarkdownInput } from \"@/components/ui/markdown-input\";\nimport { Switch } from \"@/components/ui/switch\";\nimport { TagsInput } from \"@/components/ui/tags-input\";\nimport { Typography } from \"@/components/ui/typography\";\nimport { WorkPoolSelect } from \"@/components/work-pools/work-pool-select\";\nimport { WorkQueueSelect } from \"@/components/work-pools/work-queue-select\";\nimport { LimitCollissionStrategySelect } from \"./limit-collision-strategy-select\";\nimport { useDeploymentForm } from \"./use-deployment-form\";\n\ntype DeploymentFormProps = {\n\tdeployment: Deployment;\n\tmode: \"edit\" | \"duplicate\";\n};\n\nexport const DeploymentForm = ({ deployment, mode }: DeploymentFormProps) => {\n\tconst {\n\t\tform,\n\t\tonSave,\n\t\tparameterFormErrors,\n\t\tsetParametersFormValues,\n\t\tparametersFormValues,\n\t} = useDeploymentForm(deployment, { mode });\n\tconst watchPoolName = form.watch(\"work_pool_name\");\n\tconst parametersOpenAPISchema = form.getValues(\"parameter_openapi_schema\");\n\n\treturn (\n\t\t<Form {...form}>\n\t\t\t<form\n\t\t\t\tonSubmit={(e) => void form.handleSubmit(onSave)(e)}\n\t\t\t\tclassName=\"space-y-4\"\n\t\t\t>\n\t\t\t\t<FormMessage>{form.formState.errors.root?.message}</FormMessage>\n\n\t\t\t\t<Typography variant=\"h3\">General</Typography>\n\n\t\t\t\t<FormField\n\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\tname=\"name\"\n\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t<FormLabel>Name</FormLabel>\n\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t{...field}\n\t\t\t\t\t\t\t\t\tvalue={field.value}\n\t\t\t\t\t\t\t\t\tdisabled={mode === \"edit\"}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t<FormField\n\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\tname=\"description\"\n\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t<FormLabel>Description (Optional)</FormLabel>\n\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t<MarkdownInput\n\t\t\t\t\t\t\t\t\taria-label=\"deployment description input\"\n\t\t\t\t\t\t\t\t\tvalue={field.value ?? \"\"}\n\t\t\t\t\t\t\t\t\tonChange={field.onChange}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t<FormField\n\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\tname=\"work_pool_name\"\n\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t<FormLabel>Work Pool (Optional)</FormLabel>\n\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t<WorkPoolSelect\n\t\t\t\t\t\t\t\t\tpresetOptions={[{ label: \"None\", value: \"\" }]}\n\t\t\t\t\t\t\t\t\tonSelect={field.onChange}\n\t\t\t\t\t\t\t\t\tselected={field.value}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t{watchPoolName && (\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\t\tname=\"work_queue_name\"\n\t\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t\t<FormLabel>Work Queue (Optional)</FormLabel>\n\t\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t\t<WorkQueueSelect\n\t\t\t\t\t\t\t\t\t\tworkPoolName={watchPoolName}\n\t\t\t\t\t\t\t\t\t\tpresetOptions={[{ label: \"None\", value: \"\" }]}\n\t\t\t\t\t\t\t\t\t\tonSelect={field.onChange}\n\t\t\t\t\t\t\t\t\t\tselected={field.value}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\n\t\t\t\t<FormField\n\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\tname=\"tags\"\n\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t<FormLabel>Tags (Optional)</FormLabel>\n\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t<TagsInput {...field} />\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t<FormField\n\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\tname=\"concurrency_options.collision_strategy\"\n\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t<FormLabel>\n\t\t\t\t\t\t\t\t<div className=\"col gap-1 mb-0.5\">\n\t\t\t\t\t\t\t\t\t<Typography variant=\"bodySmall\">\n\t\t\t\t\t\t\t\t\t\tConcurrency Limit Collision Strategy (Optional)\n\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t\t<Typography\n\t\t\t\t\t\t\t\t\t\tvariant=\"bodySmall\"\n\t\t\t\t\t\t\t\t\t\tclassName=\"text-muted-foreground\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\tConfigure behavior for runs once the concurrency limit is\n\t\t\t\t\t\t\t\t\t\treached.\n\t\t\t\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</FormLabel>\n\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t<LimitCollissionStrategySelect\n\t\t\t\t\t\t\t\t\tvalue={field.value}\n\t\t\t\t\t\t\t\t\tonValueChange={field.onChange}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t<FormField\n\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\tname=\"global_concurrency_limit_id\"\n\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t<FormLabel>Global concurrency limit</FormLabel>\n\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t<GlobalConcurrencyLimitSelect\n\t\t\t\t\t\t\t\t\tpresetOptions={[{ label: \"None\", value: null }]}\n\t\t\t\t\t\t\t\t\tonSelect={field.onChange}\n\t\t\t\t\t\t\t\t\tselected={field.value}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t)}\n\t\t\t\t/>\n\n\t\t\t\t<div className=\"pt-4 border-t\">\n\t\t\t\t\t<Typography variant=\"h3\" className=\"mb-4\">\n\t\t\t\t\t\tParameters\n\t\t\t\t\t</Typography>\n\t\t\t\t\t{parametersOpenAPISchema && (\n\t\t\t\t\t\t<LazySchemaForm\n\t\t\t\t\t\t\tschema={parametersOpenAPISchema as unknown as PrefectSchemaObject}\n\t\t\t\t\t\t\terrors={parameterFormErrors}\n\t\t\t\t\t\t\tvalues={parametersFormValues}\n\t\t\t\t\t\t\tonValuesChange={setParametersFormValues}\n\t\t\t\t\t\t\tkinds={[\"json\"]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\t\tname=\"enforce_parameter_schema\"\n\t\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t\t<FormLabel>Enforce Parameter Schema</FormLabel>\n\t\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t\t<Switch\n\t\t\t\t\t\t\t\t\t\tclassName=\"block\"\n\t\t\t\t\t\t\t\t\t\tchecked={field.value}\n\t\t\t\t\t\t\t\t\t\tonCheckedChange={field.onChange}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"pt-4 border-t\">\n\t\t\t\t\t<Typography variant=\"h3\" className=\"mb-4\">\n\t\t\t\t\t\tJob Variables\n\t\t\t\t\t</Typography>\n\t\t\t\t\t<FormField\n\t\t\t\t\t\tcontrol={form.control}\n\t\t\t\t\t\tname=\"job_variables\"\n\t\t\t\t\t\trender={({ field }) => (\n\t\t\t\t\t\t\t<FormItem>\n\t\t\t\t\t\t\t\t<FormLabel>Job Variables (Optional)</FormLabel>\n\t\t\t\t\t\t\t\t<FormControl>\n\t\t\t\t\t\t\t\t\t<JsonInput {...field} />\n\t\t\t\t\t\t\t\t</FormControl>\n\t\t\t\t\t\t\t\t<FormMessage />\n\t\t\t\t\t\t\t</FormItem>\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"flex gap-3 justify-end\">\n\t\t\t\t\t<Link to=\"/deployments/deployment/$id\" params={{ id: deployment.id }}>\n\t\t\t\t\t\t<Button variant=\"secondary\">Cancel</Button>\n\t\t\t\t\t</Link>\n\t\t\t\t\t<Button type=\"submit\">Save</Button>\n\t\t\t\t</div>\n\t\t\t</form>\n\t\t</Form>\n\t);\n};\n"],"names":["GlobalConcurrencyLimitSelect","presetOptions","selected","onSelect","Suspense","jsx","GlobalConcurrencyLimitSelectImplementation","search","setSearch","useState","data","useSuspenseQuery","buildListGlobalConcurrencyLimitsQuery","deferredSearch","useDeferredValue","filteredData","useMemo","globalConcurrencyLimit","filteredPresetOptions","option","Combobox","ComboboxTrigger","ComboboxContent","ComboboxCommandInput","ComboboxCommandEmtpy","ComboboxCommandList","jsxs","ComboboxCommandGroup","ComboboxCommandItem","value","extensions","markdown","EditorView","MarkdownInput","React","className","onChange","copy","onBlur","disabled","hideLineNumbers","props","forwardedRef","editor","useRef","basicSetup","setContainer","useCodeMirror","useEffect","handleCopy","_value","toast","cn","node","Button","Icon","WorkPoolSelect","WorkPoolSelectImplementation","buildFilterWorkPoolsQuery","workPool","LIMIT_COLLISSION_STRATEGIES","LimitCollissionStrategySelect","onValueChange","Select","SelectTrigger","SelectValue","SelectContent","SelectGroup","SelectItem","createFormSchema","deployment","mode","z.object","z.string","z.array","z.enum","val","ctx","err","z.NEVER","z.boolean","z.record","z.unknown","DEFAULT_VALUES","useDeploymentForm","navigate","useNavigate","form","useForm","zodResolver","parametersFormValues","setParametersFormValues","parameterFormErrors","validateParametersForm","useSchemaForm","createDeployment","useCreateDeployment","updateDeployment","useUpdateDeployment","name","description","work_pool_name","work_queue_name","tags","concurrency_options","parameter_openapi_schema","enforce_parameter_schema","job_variables","global_concurrency_limit","values","global_concurrency_limit_id","jobVariablesPayload","message","concurrencyOptions","id","error","DeploymentForm","onSave","watchPoolName","parametersOpenAPISchema","Form","e","FormMessage","Typography","FormField","field","FormItem","FormLabel","FormControl","Input","WorkQueueSelect","TagsInput","LazySchemaForm","Switch","JsonInput","Link"],"mappings":"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"}