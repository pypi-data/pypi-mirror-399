import{j as s,G as g,r as b,L as B,s as k}from"./vendor-tanstack-zpsXWFxg.js";import{B as y,g as v,h as c,br as l,bB as m,bD as S,dS as _,C as N,o as p,u as n,dT as E,cZ as L}from"./index-4D6ue93A.js";import{B as w}from"./block-type-details-DXG59oMI.js";import{u as C,L as P}from"./lazy-schema-form-T24oREiG.js";import"./primitives-DRAYI_UV.js";import"./toggle-group-CtVLGj1O.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-CrLZvj36.js";import"./vendor-recharts-C8e6QlQ9.js";import"./vendor-codemirror-KWel9Npa.js";import"./vendor-forms-DEIP3aGx.js";import"./vendor-date-ByQxM3Xh.js";import"./block-type-logo-CjaFtrJu.js";import"./vendor-markdown-dkNYO1DR.js";const F=({blockDocument:e})=>s.jsx(y,{children:s.jsxs(v,{children:[s.jsx(c,{children:s.jsx(l,{to:"/blocks",className:"text-xl font-semibold",children:"Blocks"})}),s.jsx(m,{}),s.jsx(c,{children:s.jsx(l,{to:"/blocks/block/$id",params:{id:e.id},className:"text-xl font-semibold",children:e.name??e.block_type_name??e.id})}),s.jsx(m,{}),s.jsx(c,{className:"text-xl font-semibold",children:s.jsx(S,{children:"Edit"})})]})}),R=({blockDocument:e})=>{const r=g(),{values:t,setValues:o,errors:x,validateForm:u}=C(),{updateBlockDocument:h,isPending:j}=_();b.useEffect(()=>{e.data&&o(e.data)},[e.data,o]);const f=async i=>{i.preventDefault();try{await u({schema:t}),h({id:e.id,data:t,merge_existing_data:!1},{onSuccess:()=>{n.success("Block updated successfully"),r({to:"/blocks/block/$id",params:{id:e.id}})},onError:d=>{const a="Unknown error while updating block.";n.error(a),console.error(a,d)}})}catch(d){const a="Unknown error while validating block data.";n.error(a),console.error(a,d)}};return s.jsxs("div",{className:"flex flex-col gap-6",children:[s.jsx(F,{blockDocument:e}),s.jsxs(N,{className:" p-6 grid grid-cols-[minmax(0,_1fr)_250px] gap-4 ",children:[s.jsxs("form",{className:"flex flex-col gap-4",onSubmit:i=>{f(i)},children:[s.jsx(P,{values:t,onValuesChange:o,errors:x,kinds:["json"],schema:e?.block_schema?.fields??{}}),s.jsxs("div",{className:"flex gap-3 justify-end",children:[s.jsx(p,{variant:"secondary",children:s.jsx(B,{to:"/blocks/block/$id",params:{id:e.id},children:"Cancel"})}),s.jsx(p,{loading:j,type:"submit",children:"Save"})]})]}),e.block_type&&s.jsx(w,{blockType:e.block_type})]})]})};function M(){const{id:e}=E.useParams(),{data:r}=k(L(e));return s.jsx(R,{blockDocument:r})}export{M as component};
//# sourceMappingURL=block_._id.edit-Dkb5QL80.js.map
