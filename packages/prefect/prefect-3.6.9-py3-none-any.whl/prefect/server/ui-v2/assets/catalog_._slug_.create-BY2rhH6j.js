import{j as e,G as B,L as y,s as h}from"./vendor-tanstack-zpsXWFxg.js";import{B as N,g as v,h as n,br as i,bB as d,bD as _,dP as F,ac as S,C,ai as L,aj as w,ak as E,al as D,am as P,an as R,ao as A,o as b,u,dQ as Q,cX as T,dR as U}from"./index-4D6ue93A.js";import{d as V,b as G,c as I}from"./vendor-forms-DEIP3aGx.js";import{B as z}from"./block-type-details-DXG59oMI.js";import{u as M,L as X}from"./lazy-schema-form-T24oREiG.js";import"./primitives-DRAYI_UV.js";import"./toggle-group-CtVLGj1O.js";import"./vendor-react-Bce9NwRC.js";import"./vendor-radix-CrLZvj36.js";import"./vendor-recharts-C8e6QlQ9.js";import"./vendor-codemirror-KWel9Npa.js";import"./vendor-date-ByQxM3Xh.js";import"./block-type-logo-CjaFtrJu.js";import"./vendor-markdown-dkNYO1DR.js";const $=({blockType:s})=>e.jsx(N,{children:e.jsxs(v,{children:[e.jsx(n,{children:e.jsx(i,{to:"/blocks",className:"text-xl font-semibold",children:"Blocks"})}),e.jsx(d,{}),e.jsx(n,{children:e.jsx(i,{to:"/blocks/catalog",className:"text-xl font-semibold",children:"Catalog"})}),e.jsx(d,{}),e.jsx(n,{children:e.jsx(i,{to:"/blocks/catalog",className:"text-xl font-semibold",children:s.name})}),e.jsx(d,{}),e.jsx(n,{className:"text-xl font-semibold",children:e.jsx(_,{children:"Create"})})]})}),H=/^[a-zA-Z0-9-]+$/,K=G({blockName:I().regex(H,{message:"Name must only contain lowercase letters, numbers, and dashes"})}),O={blockName:""},Z=({blockSchema:s,blockType:a})=>{const l=B(),{values:o,setValues:j,errors:x,validateForm:p}=M(),{createBlockDocument:k,isPending:g}=F(),m=V({resolver:S(K),defaultValues:O}),f=async r=>{try{if(await p({schema:o}),x.length>0)return;k({block_schema_id:s.id,block_type_id:a.id,is_anonymous:!1,data:o,name:r.blockName},{onSuccess:c=>{u.success("Block created successfully"),l({to:"/blocks/block/$id",params:{id:c.id}})},onError:c=>{const t="Unknown error while creating block.";u.error(t),console.error(t,c)}})}catch(c){const t="Unknown error while validating block data.";u.error(t),console.error(t,c)}};return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx($,{blockType:a}),e.jsxs(C,{className:" p-6 grid grid-cols-[minmax(0,_1fr)_250px] gap-4 ",children:[e.jsx(L,{...m,children:e.jsxs("form",{className:"flex flex-col gap-4",onSubmit:r=>{m.handleSubmit(f)(r)},children:[e.jsx(w,{control:m.control,name:"blockName",render:({field:r})=>e.jsxs(E,{children:[e.jsx(D,{children:"Name"}),e.jsx(P,{children:e.jsx(R,{...r,value:r.value})}),e.jsx(A,{})]})}),e.jsx(X,{values:o,onValuesChange:j,errors:x,kinds:["json"],schema:s.fields}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(b,{variant:"secondary",children:e.jsx(y,{to:"/blocks/catalog",children:"Cancel"})}),e.jsx(b,{loading:g,type:"submit",children:"Save"})]})]})}),e.jsx(z,{blockType:a})]})]})};function ie(){const{slug:s}=Q.useParams(),{data:a}=h(T(s)),{data:l}=h(U({block_schemas:{block_type_id:{any_:[a.id]},operator:"and_"},offset:0})),o=l[0];if(!o)throw new Error("Block schema not found");return e.jsx(Z,{blockSchema:o,blockType:a})}export{ie as component};
//# sourceMappingURL=catalog_._slug_.create-BY2rhH6j.js.map
