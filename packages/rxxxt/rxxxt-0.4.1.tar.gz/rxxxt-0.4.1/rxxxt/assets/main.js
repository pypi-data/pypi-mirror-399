(()=>{var Se=Object.defineProperty;var se=Object.getOwnPropertySymbols;var xe=Object.prototype.hasOwnProperty,Ae=Object.prototype.propertyIsEnumerable;var oe=(e,n,t)=>n in e?Se(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,Z=(e,n)=>{for(var t in n||(n={}))xe.call(n,t)&&oe(e,t,n[t]);if(se)for(var t of se(n))Ae.call(n,t)&&oe(e,t,n[t]);return e};var de="rxxxt-on-",le=()=>new Date().getTime(),ue=new WeakMap;function j(e){var t,r,a;let n=ue.get(e);return n===void 0&&(n=JSON.stringify([e.context_id,e.handler_name,(t=e.options.debounce)!=null?t:null,(r=e.options.prevent_default)!=null?r:null,(a=e.options.throttle)!=null?a:null,...Object.entries(e.param_map).sort((d,v)=>d[0].localeCompare(v[0]))]),ue.set(e,n)),n}function _e(e){var t;let n=new Map;for(let r of e.getAttributeNames())if(r.startsWith(de)){let a=r.substring(de.length),d=JSON.parse(atob((t=e.getAttribute(r))!=null?t:""));n.set(a,d)}return n}function Ue(e,n){let t=e;try{for(let r of n.split("."))t=t[r];return typeof t=="string"||typeof t=="number"||typeof t=="boolean"?t:void 0}catch(r){return}}function pe(e){let n=0,t=new WeakMap,r=new WeakMap,a=new Map,d=new Set,v=(i,u)=>{var p,T,g,U,x;let f=(p=t.get(i))!=null?p:[],E=f.filter(m=>d.has(m.descriptor.context_id));E.length!==f.length&&(t.set(i,E),S(i),f=E);for(let m of f.filter(D=>D.event===u.type)){let D=Z(Z({$handler_name:m.descriptor.handler_name},(T=m.descriptor.options.default_params)!=null?T:{}),Object.fromEntries(Object.entries(m.descriptor.param_map).map(P=>[P[0],Ue(u,P[1])])));if(a.set(m.submitId,{context_id:m.descriptor.context_id,data:D}),m.timeoutHandle&&(clearTimeout(m.timeoutHandle),m.timeoutHandle=void 0),m.descriptor.options.prevent_default&&u.preventDefault(),!m.descriptor.options.no_trigger){let P=Math.max(0,(g=m.descriptor.options.debounce)!=null?g:0,((U=m.lastCall)!=null?U:0)+((x=m.descriptor.options.throttle)!=null?x:0)-le());m.timeoutHandle=setTimeout(()=>{a.has(m.submitId)&&(m.lastCall=le(),e())},P)}}},S=i=>{var E,p,T;let u=(E=r.get(i))!=null?E:new Map;r.set(i,u);let f=new Set((T=(p=t.get(i))==null?void 0:p.map(g=>g.event))!=null?T:[]);for(let g of Array.from(u.keys()))f.has(g)||(i.removeEventListener(g,u.get(g)),u.delete(g));for(let g of f)if(!u.has(g)){let U=x=>v(i,x);i.addEventListener(g,U),u.set(g,U)}},A=()=>{let i=new Map(a);return a.clear(),i},O=i=>{var E;i.tagName==="RXXXT-META"&&d.add(i.id);let u=new Map(((E=t.get(i))!=null?E:[]).filter(p=>p.tag=="local").map(p=>[p.event,p])),f=_e(i);for(let p of u.values())f.has(p.event)||b(i,p.event,p.descriptor,"local");for(let p of f.entries())u.has(p[0])?u.get(p[0]).descriptor=p[1]:M(i,p[0],p[1],"local")},_=i=>{i.tagName==="RXXXT-META"&&d.delete(i.id)},M=(i,u,f,E="global")=>{var U;let p=j(f),T=(U=t.get(i))!=null?U:[];t.set(i,T);let g=T.find(x=>x.event===u&&j(x.descriptor)===p&&x.tag==E);g===void 0?T.push({descriptor:f,event:u,submitId:++n,tag:E}):g.descriptor=f,S(i)},b=(i,u,f,E="global")=>{var T;let p=j(f);t.set(i,((T=t.get(i))!=null?T:[]).filter(g=>g.event!=u||j(g.descriptor)!==p||g.tag!==E)),S(i)};return{registerEvent:M,unregisterEvent:b,onElementUpdated:O,onElementDeleted:_,popPendingEvents:A}}function ce(e){let n,t=!1,r=!1,a=!1,d,v=new Map,S=()=>{let b=e.popPendingEvents();for(let i of b)v.set(i[0],i[1]);return b.size},A=()=>{if(t){r=!0;return}t=!0,r=!1,S(),d(Array.from(v.values()))},O=(b,i)=>{v.clear(),e.onUpdate(b,i),t=!1,r&&A()},_=()=>{n==null||n.close(),n=void 0,d=async b=>{var u;let i=await fetch(location.href,{method:"POST",body:JSON.stringify({state_token:e.stateToken,events:b}),headers:{"Content-Type":"application/json"},credentials:"include"});if(i.ok){let f=await i.json();S()>0&&!e.disableHTTPRetry?(console.info("retry http update"),t=!1,A()):(O(f.html_parts,f.events),e.stateToken=(u=f.state_token)!=null?u:e.stateToken)}else throw O([],[]),new Error("Update failed! Server responded with ".concat(i.statusText," (").concat(i.status,")."))}},M=()=>{if(n!==void 0){console.warn("tried to switch to websocket again, despite using it already");return}let b=async u=>n==null?void 0:n.send(JSON.stringify({type:"update",events:u,location:location.href.substring(location.origin.length)})),i=new URL(location.href);i.protocol=location.protocol=="https:"?"wss":"ws",n=new WebSocket(i),n.addEventListener("close",_),n.addEventListener("open",()=>{var u;d=b,n==null||n.send(JSON.stringify({type:"init",state_token:e.stateToken,enable_state_updates:(u=e.enableWebSocketStateUpdates)!=null?u:!1}))}),n.addEventListener("message",u=>{var E;if(typeof u.data!="string")return;let f=JSON.parse(u.data);e.stateToken=(E=f.state_token)!=null?E:e.stateToken,O(f.html_parts,f.events)})};return _(),{useHTTP:_,useWebSocket:M,update:()=>{a||(a=!0,setTimeout(()=>{a=!1,A()},0))}}}var fe=11;function Oe(e,n){var t=n.attributes,r,a,d,v,S;if(!(n.nodeType===fe||e.nodeType===fe)){for(var A=t.length-1;A>=0;A--)r=t[A],a=r.name,d=r.namespaceURI,v=r.value,d?(a=r.localName||a,S=e.getAttributeNS(d,a),S!==v&&(r.prefix==="xmlns"&&(a=r.name),e.setAttributeNS(d,a,v))):(S=e.getAttribute(a),S!==v&&e.setAttribute(a,v));for(var O=e.attributes,_=O.length-1;_>=0;_--)r=O[_],a=r.name,d=r.namespaceURI,d?(a=r.localName||a,n.hasAttributeNS(d,a)||e.removeAttributeNS(d,a)):n.hasAttribute(a)||e.removeAttribute(a)}}var F,ke="http://www.w3.org/1999/xhtml",w=typeof document>"u"?void 0:document,Ne=!!w&&"content"in w.createElement("template"),He=!!w&&w.createRange&&"createContextualFragment"in w.createRange();function Ce(e){var n=w.createElement("template");return n.innerHTML=e,n.content.childNodes[0]}function De(e){F||(F=w.createRange(),F.selectNode(w.body));var n=F.createContextualFragment(e);return n.childNodes[0]}function Ie(e){var n=w.createElement("body");return n.innerHTML=e,n.childNodes[0]}function Me(e){return e=e.trim(),Ne?Ce(e):He?De(e):Ie(e)}function J(e,n){var t=e.nodeName,r=n.nodeName,a,d;return t===r?!0:(a=t.charCodeAt(0),d=r.charCodeAt(0),a<=90&&d>=97?t===r.toUpperCase():d<=90&&a>=97?r===t.toUpperCase():!1)}function Pe(e,n){return!n||n===ke?w.createElement(e):w.createElementNS(n,e)}function Re(e,n){for(var t=e.firstChild;t;){var r=t.nextSibling;n.appendChild(t),t=r}return n}function ee(e,n,t){e[t]!==n[t]&&(e[t]=n[t],e[t]?e.setAttribute(t,""):e.removeAttribute(t))}var ve={OPTION:function(e,n){var t=e.parentNode;if(t){var r=t.nodeName.toUpperCase();r==="OPTGROUP"&&(t=t.parentNode,r=t&&t.nodeName.toUpperCase()),r==="SELECT"&&!t.hasAttribute("multiple")&&(e.hasAttribute("selected")&&!n.selected&&(e.setAttribute("selected","selected"),e.removeAttribute("selected")),t.selectedIndex=-1)}ee(e,n,"selected")},INPUT:function(e,n){ee(e,n,"checked"),ee(e,n,"disabled"),e.value!==n.value&&(e.value=n.value),n.hasAttribute("value")||e.removeAttribute("value")},TEXTAREA:function(e,n){var t=n.value;e.value!==t&&(e.value=t);var r=e.firstChild;if(r){var a=r.nodeValue;if(a==t||!t&&a==e.placeholder)return;r.nodeValue=t}},SELECT:function(e,n){if(!n.hasAttribute("multiple")){for(var t=-1,r=0,a=e.firstChild,d,v;a;)if(v=a.nodeName&&a.nodeName.toUpperCase(),v==="OPTGROUP")d=a,a=d.firstChild;else{if(v==="OPTION"){if(a.hasAttribute("selected")){t=r;break}r++}a=a.nextSibling,!a&&d&&(a=d.nextSibling,d=null)}e.selectedIndex=t}}},W=1,ge=11,me=3,he=8;function C(){}function Le(e){if(e)return e.getAttribute&&e.getAttribute("id")||e.id}function We(e){return function(t,r,a){if(a||(a={}),typeof r=="string")if(t.nodeName==="#document"||t.nodeName==="HTML"||t.nodeName==="BODY"){var d=r;r=w.createElement("html"),r.innerHTML=d}else r=Me(r);else r.nodeType===ge&&(r=r.firstElementChild);var v=a.getNodeKey||Le,S=a.onBeforeNodeAdded||C,A=a.onNodeAdded||C,O=a.onBeforeElUpdated||C,_=a.onElUpdated||C,M=a.onBeforeNodeDiscarded||C,b=a.onNodeDiscarded||C,i=a.onBeforeElChildrenUpdated||C,u=a.skipFromChildren||C,f=a.addChild||function(s,o){return s.appendChild(o)},E=a.childrenOnly===!0,p=Object.create(null),T=[];function g(s){T.push(s)}function U(s,o){if(s.nodeType===W)for(var h=s.firstChild;h;){var l=void 0;o&&(l=v(h))?g(l):(b(h),h.firstChild&&U(h,o)),h=h.nextSibling}}function x(s,o,h){M(s)!==!1&&(o&&o.removeChild(s),b(s),U(s,h))}function m(s){if(s.nodeType===W||s.nodeType===ge)for(var o=s.firstChild;o;){var h=v(o);h&&(p[h]=o),m(o),o=o.nextSibling}}m(t);function D(s){A(s);for(var o=s.firstChild;o;){var h=o.nextSibling,l=v(o);if(l){var c=p[l];c&&J(o,c)?(o.parentNode.replaceChild(c,o),V(c,o)):D(o)}else D(o);o=h}}function P(s,o,h){for(;o;){var l=o.nextSibling;(h=v(o))?g(h):x(o,s,!0),o=l}}function V(s,o,h){var l=v(o);if(l&&delete p[l],!h){var c=O(s,o);if(c===!1||(c instanceof HTMLElement&&(s=c,m(s)),e(s,o),_(s),i(s,o)===!1))return}s.nodeName!=="TEXTAREA"?ye(s,o):ve.TEXTAREA(s,o)}function ye(s,o){var h=u(s,o),l=o.firstChild,c=s.firstChild,R,k,L,$,N;e:for(;l;){for($=l.nextSibling,R=v(l);!h&&c;){if(L=c.nextSibling,l.isSameNode&&l.isSameNode(c)){l=$,c=L;continue e}k=v(c);var K=c.nodeType,H=void 0;if(K===l.nodeType&&(K===W?(R?R!==k&&((N=p[R])?L===N?H=!1:(s.insertBefore(N,c),k?g(k):x(c,s,!0),c=N,k=v(c)):H=!1):k&&(H=!1),H=H!==!1&&J(c,l),H&&V(c,l)):(K===me||K==he)&&(H=!0,c.nodeValue!==l.nodeValue&&(c.nodeValue=l.nodeValue))),H){l=$,c=L;continue e}k?g(k):x(c,s,!0),c=L}if(R&&(N=p[R])&&J(N,l))h||f(s,N),V(N,l);else{var Q=S(l);Q!==!1&&(Q&&(l=Q),l.actualize&&(l=l.actualize(s.ownerDocument||w)),f(s,l),D(l))}l=$,c=L}P(s,c,k);var ie=ve[s.nodeName];ie&&ie(s,o)}var y=t,X=y.nodeType,ae=r.nodeType;if(!E){if(X===W)ae===W?J(t,r)||(b(t),y=Re(t,Pe(r.nodeName,r.namespaceURI))):y=r;else if(X===me||X===he){if(ae===X)return y.nodeValue!==r.nodeValue&&(y.nodeValue=r.nodeValue),y;y=r}}if(y===r)b(t);else{if(r.isSameNode&&r.isSameNode(y))return;if(V(y,r,E),T)for(var q=0,we=T.length;q<we;q++){var Y=p[T[q]];Y&&x(Y,Y.parentNode,!1)}}return!E&&y!==t&&t.parentNode&&(y.actualize&&(y=y.actualize(t.ownerDocument||w)),t.parentNode.replaceChild(y,t)),y}}var Be=We(Oe),Ee=Be;var Ve="root",z=new Map,ne,G={stateToken:"",onUpdate:(e,n)=>{for(let t of e)Te(t);re(n)},popPendingEvents:()=>I.popPendingEvents()},B=ce(G),I=pe(B.update),Te=e=>{let n;if(e===void 0){let t=document.getElementById(Ve);if(t===null)throw new Error("Update target not found!");n=t}else{let t=document.createElement("div");t.innerHTML=e;let r=t.children.item(0);if(r===null||r.tagName!=="rxxxt-meta".toUpperCase())throw new Error("Invalid update root!");let a=document.getElementById(r.id);if(a===null)throw new Error("Update target not found!");n=a,Ee(n,r,{onNodeDiscarded:d=>{d instanceof Element&&I.onElementDeleted(d)}})}for(let t of n.getElementsByTagName("*"))I.onElementUpdated(t)},Xe={custom:e=>{var n;for(let t of(n=z.get(e.name))!=null?n:[])try{t(e.data)}catch(r){console.error(r)}},navigate:e=>{let n=new URL(e.location,location.href);ne===void 0||ne!==n.origin?location.assign(n):(window.history.pushState({},"",e.location),e.requires_refresh&&B.update())},"use-websocket":e=>{e.websocket?B.useWebSocket():B.useHTTP()},"set-cookie":e=>{var t;let n=["".concat(e.name,"=").concat((t=e.value)!=null?t:"")];typeof e.path=="string"&&n.push("path=".concat(e.path)),typeof e.expires=="string"&&n.push("expires=".concat(new Date(e.expires).toUTCString())),typeof e.max_age=="number"&&n.push("max-age=".concat(e.max_age)),typeof e.domain=="string"&&n.push("domain=".concat(e.domain)),e.secure&&n.push("secure"),e.http_only&&n.push("httponly"),document.cookie=n.join(";")},"event-modify-window":e=>{e.mode==="add"?I.registerEvent(window,e.name,e.descriptor):e.mode==="remove"&&I.unregisterEvent(window,e.name,e.descriptor)},"event-modify-query-selector":e=>{let n;if(e.all)n=Array.from(document.querySelectorAll(e.selector));else{let t=document.querySelector(e.selector);n=t===null?[]:[t]}for(let t of n)e.mode==="add"?I.registerEvent(t,e.name,e.descriptor):e.mode==="remove"&&I.unregisterEvent(t,e.name,e.descriptor)}},re=e=>e.forEach(n=>Xe[n.event](n)),be={on:(e,n)=>{var r;let t=(r=z.get(e))!=null?r:new Set;z.set(e,t),t.add(n)},off:(e,n)=>{var r;return((r=z.get(e))!=null?r:new Set).delete(n)},navigate:e=>{re([{event:"navigate",location:new URL(e,location.href).href,requires_refresh:!0}])},init:e=>{ne=new URL(location.href).origin,window.addEventListener("popstate",B.update),G.stateToken=e.state_token,G.enableWebSocketStateUpdates=e.enable_web_socket_state_updates,G.disableHTTPRetry=e.disable_http_update_retry,re(e.events),Te()}};window.rxxxt=be;var te=document.getElementById("rxxxt-init-data");te!=null&&te.textContent!==null?be.init(JSON.parse(te.textContent)):console.warn("failed to initialize rxxxt. init data not found.");})();
