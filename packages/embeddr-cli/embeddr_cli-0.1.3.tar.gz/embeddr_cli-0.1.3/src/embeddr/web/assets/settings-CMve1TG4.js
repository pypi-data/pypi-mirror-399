import{c as v,S as Qe,s as Je,h as oe,g as Xe,n as ue,u as L,r as m,a as Ye,b as Ze,j as e,d as Q,P as M,e as I,f as J,i as me,k as he,l as We,m as pe,o as es,R as g,p as ss,q as ts,t as as,v as f,w as y,x as ie,y as ns,z as rs}from"./index-C0xEQQ8B.js";import{B as x,u as A,X as os,a as X,i as N,w as xe,z as fe,S as ge,N as ve,j as G,c as ye,b as be,l as je,p as Ne,d as $,e as Y,P as is,m as U,F as ls,f as cs,g as H}from"./useSettings-D9uWDXCy.js";const ds=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],us=v("activity",ds);const ms=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],hs=v("brain-circuit",ms);const ps=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xs=v("circle-check",ps);const fs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],le=v("circle-x",fs);const gs=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],vs=v("hard-drive",gs);const ys=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],bs=v("image",ys);const js=[["path",{d:"m16 6 4 14",key:"ji33uf"}],["path",{d:"M12 6v14",key:"1n7gus"}],["path",{d:"M8 8v12",key:"1gg7y9"}],["path",{d:"M4 4v16",key:"6qkkli"}]],Ns=v("library",js);const ws=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Cs=v("loader-circle",ws);const ks=[["path",{d:"M5 5a2 2 0 0 1 3.008-1.728l11.997 6.998a2 2 0 0 1 .003 3.458l-12 7A2 2 0 0 1 5 19z",key:"10ikf1"}]],Ps=v("play",ks);const Ms=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Ss=v("power",Ms);const _s=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],As=v("refresh-cw",_s);const Is=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],$s=v("save",Is);const Es=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Rs=v("trash-2",Es);var Os=class extends Qe{#s;#a=void 0;#e;#t;constructor(s,r){super(),this.#s=s,this.setOptions(r),this.bindMethods(),this.#n()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(s){const r=this.options;this.options=this.#s.defaultMutationOptions(s),Je(this.options,r)||this.#s.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#e,observer:this}),r?.mutationKey&&this.options.mutationKey&&oe(r.mutationKey)!==oe(this.options.mutationKey)?this.reset():this.#e?.state.status==="pending"&&this.#e.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#e?.removeObserver(this)}onMutationUpdate(s){this.#n(),this.#r(s)}getCurrentResult(){return this.#a}reset(){this.#e?.removeObserver(this),this.#e=void 0,this.#n(),this.#r()}mutate(s,r){return this.#t=r,this.#e?.removeObserver(this),this.#e=this.#s.getMutationCache().build(this.#s,this.options),this.#e.addObserver(this),this.#e.execute(s)}#n(){const s=this.#e?.state??Xe();this.#a={...s,isPending:s.status==="pending",isSuccess:s.status==="success",isError:s.status==="error",isIdle:s.status==="idle",mutate:this.mutate,reset:this.reset}}#r(s){ue.batch(()=>{if(this.#t&&this.hasListeners()){const r=this.#a.variables,t=this.#a.context,a={client:this.#s,meta:this.options.meta,mutationKey:this.options.mutationKey};if(s?.type==="success"){try{this.#t.onSuccess?.(s.data,r,t,a)}catch(n){Promise.reject(n)}try{this.#t.onSettled?.(s.data,null,r,t,a)}catch(n){Promise.reject(n)}}else if(s?.type==="error"){try{this.#t.onError?.(s.error,r,t,a)}catch(n){Promise.reject(n)}try{this.#t.onSettled?.(void 0,s.error,r,t,a)}catch(n){Promise.reject(n)}}}this.listeners.forEach(r=>{r(this.#a)})})}};function j(s,r){const t=L(),[a]=m.useState(()=>new Os(t,s));m.useEffect(()=>{a.setOptions(s)},[a,s]);const n=m.useSyncExternalStore(m.useCallback(c=>a.subscribe(ue.batchCalls(c)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),l=m.useCallback((c,d)=>{a.mutate(c,d).catch(Ye)},[a]);if(n.error&&Ze(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:l,mutateAsync:n.mutate}}var Z="Progress",W=100,[Ls]=Q(Z),[Fs,Ts]=Ls(Z),we=m.forwardRef((s,r)=>{const{__scopeProgress:t,value:a=null,max:n,getValueLabel:l=Ds,...c}=s;(n||n===0)&&!ce(n)&&console.error(qs(`${n}`,"Progress"));const d=ce(n)?n:W;a!==null&&!de(a,d)&&console.error(zs(`${a}`,"Progress"));const i=de(a,d)?a:null,u=R(i)?l(i,d):void 0;return e.jsx(Fs,{scope:t,value:i,max:d,children:e.jsx(M.div,{"aria-valuemax":d,"aria-valuemin":0,"aria-valuenow":R(i)?i:void 0,"aria-valuetext":u,role:"progressbar","data-state":Pe(i,d),"data-value":i??void 0,"data-max":d,...c,ref:r})})});we.displayName=Z;var Ce="ProgressIndicator",ke=m.forwardRef((s,r)=>{const{__scopeProgress:t,...a}=s,n=Ts(Ce,t);return e.jsx(M.div,{"data-state":Pe(n.value,n.max),"data-value":n.value??void 0,"data-max":n.max,...a,ref:r})});ke.displayName=Ce;function Ds(s,r){return`${Math.round(s/r*100)}%`}function Pe(s,r){return s==null?"indeterminate":s===r?"complete":"loading"}function R(s){return typeof s=="number"}function ce(s){return R(s)&&!isNaN(s)&&s>0}function de(s,r){return R(s)&&!isNaN(s)&&s<=r&&s>=0}function qs(s,r){return`Invalid prop \`max\` of value \`${s}\` supplied to \`${r}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${W}\`.`}function zs(s,r){return`Invalid prop \`value\` of value \`${s}\` supplied to \`${r}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${W} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Ks=we,Vs=ke;function Gs({className:s,value:r,...t}){return e.jsx(Ks,{"data-slot":"progress",className:I("bg-primary/20 relative h-2 w-full overflow-hidden",s),...t,children:e.jsx(Vs,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(r||0)}%)`}})})}var F="Collapsible",[Us,Me]=Q(F),[Hs,ee]=Us(F),Se=m.forwardRef((s,r)=>{const{__scopeCollapsible:t,open:a,defaultOpen:n,disabled:l,onOpenChange:c,...d}=s,[i,u]=J({prop:a,defaultProp:n??!1,onChange:c,caller:F});return e.jsx(Hs,{scope:t,disabled:l,contentId:me(),open:i,onOpenToggle:m.useCallback(()=>u(o=>!o),[u]),children:e.jsx(M.div,{"data-state":te(i),"data-disabled":l?"":void 0,...d,ref:r})})});Se.displayName=F;var _e="CollapsibleTrigger",Ae=m.forwardRef((s,r)=>{const{__scopeCollapsible:t,...a}=s,n=ee(_e,t);return e.jsx(M.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":te(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...a,ref:r,onClick:he(s.onClick,n.onOpenToggle)})});Ae.displayName=_e;var se="CollapsibleContent",Ie=m.forwardRef((s,r)=>{const{forceMount:t,...a}=s,n=ee(se,s.__scopeCollapsible);return e.jsx(We,{present:t||n.open,children:({present:l})=>e.jsx(Bs,{...a,ref:r,present:l})})});Ie.displayName=se;var Bs=m.forwardRef((s,r)=>{const{__scopeCollapsible:t,present:a,children:n,...l}=s,c=ee(se,t),[d,i]=m.useState(a),u=m.useRef(null),o=pe(r,u),p=m.useRef(0),S=p.current,w=m.useRef(0),E=w.current,C=c.open||d,k=m.useRef(C),P=m.useRef(void 0);return m.useEffect(()=>{const h=requestAnimationFrame(()=>k.current=!1);return()=>cancelAnimationFrame(h)},[]),es(()=>{const h=u.current;if(h){P.current=P.current||{transitionDuration:h.style.transitionDuration,animationName:h.style.animationName},h.style.transitionDuration="0s",h.style.animationName="none";const _=h.getBoundingClientRect();p.current=_.height,w.current=_.width,k.current||(h.style.transitionDuration=P.current.transitionDuration,h.style.animationName=P.current.animationName),i(a)}},[c.open,a]),e.jsx(M.div,{"data-state":te(c.open),"data-disabled":c.disabled?"":void 0,id:c.contentId,hidden:!C,...l,ref:o,style:{"--radix-collapsible-content-height":S?`${S}px`:void 0,"--radix-collapsible-content-width":E?`${E}px`:void 0,...s.style},children:C&&n})});function te(s){return s?"open":"closed"}var Qs=Se,Js=Ae,Xs=Ie,b="Accordion",Ys=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ae,Zs,Ws]=ss(b),[T]=Q(b,[Ws,Me]),ne=Me(),$e=g.forwardRef((s,r)=>{const{type:t,...a}=s,n=a,l=a;return e.jsx(ae.Provider,{scope:s.__scopeAccordion,children:t==="multiple"?e.jsx(at,{...l,ref:r}):e.jsx(tt,{...n,ref:r})})});$e.displayName=b;var[Ee,et]=T(b),[Re,st]=T(b,{collapsible:!1}),tt=g.forwardRef((s,r)=>{const{value:t,defaultValue:a,onValueChange:n=()=>{},collapsible:l=!1,...c}=s,[d,i]=J({prop:t,defaultProp:a??"",onChange:n,caller:b});return e.jsx(Ee,{scope:s.__scopeAccordion,value:g.useMemo(()=>d?[d]:[],[d]),onItemOpen:i,onItemClose:g.useCallback(()=>l&&i(""),[l,i]),children:e.jsx(Re,{scope:s.__scopeAccordion,collapsible:l,children:e.jsx(Oe,{...c,ref:r})})})}),at=g.forwardRef((s,r)=>{const{value:t,defaultValue:a,onValueChange:n=()=>{},...l}=s,[c,d]=J({prop:t,defaultProp:a??[],onChange:n,caller:b}),i=g.useCallback(o=>d((p=[])=>[...p,o]),[d]),u=g.useCallback(o=>d((p=[])=>p.filter(S=>S!==o)),[d]);return e.jsx(Ee,{scope:s.__scopeAccordion,value:c,onItemOpen:i,onItemClose:u,children:e.jsx(Re,{scope:s.__scopeAccordion,collapsible:!0,children:e.jsx(Oe,{...l,ref:r})})})}),[nt,D]=T(b),Oe=g.forwardRef((s,r)=>{const{__scopeAccordion:t,disabled:a,dir:n,orientation:l="vertical",...c}=s,d=g.useRef(null),i=pe(d,r),u=Zs(t),p=ts(n)==="ltr",S=he(s.onKeyDown,w=>{if(!Ys.includes(w.key))return;const E=w.target,C=u().filter(V=>!V.ref.current?.disabled),k=C.findIndex(V=>V.ref.current===E),P=C.length;if(k===-1)return;w.preventDefault();let h=k;const _=0,q=P-1,z=()=>{h=k+1,h>q&&(h=_)},K=()=>{h=k-1,h<_&&(h=q)};switch(w.key){case"Home":h=_;break;case"End":h=q;break;case"ArrowRight":l==="horizontal"&&(p?z():K());break;case"ArrowDown":l==="vertical"&&z();break;case"ArrowLeft":l==="horizontal"&&(p?K():z());break;case"ArrowUp":l==="vertical"&&K();break}const Be=h%P;C[Be].ref.current?.focus()});return e.jsx(nt,{scope:t,disabled:a,direction:n,orientation:l,children:e.jsx(ae.Slot,{scope:t,children:e.jsx(M.div,{...c,"data-orientation":l,ref:i,onKeyDown:a?void 0:S})})})}),O="AccordionItem",[rt,re]=T(O),Le=g.forwardRef((s,r)=>{const{__scopeAccordion:t,value:a,...n}=s,l=D(O,t),c=et(O,t),d=ne(t),i=me(),u=a&&c.value.includes(a)||!1,o=l.disabled||s.disabled;return e.jsx(rt,{scope:t,open:u,disabled:o,triggerId:i,children:e.jsx(Qs,{"data-orientation":l.orientation,"data-state":Ke(u),...d,...n,ref:r,disabled:o,open:u,onOpenChange:p=>{p?c.onItemOpen(a):c.onItemClose(a)}})})});Le.displayName=O;var Fe="AccordionHeader",Te=g.forwardRef((s,r)=>{const{__scopeAccordion:t,...a}=s,n=D(b,t),l=re(Fe,t);return e.jsx(M.h3,{"data-orientation":n.orientation,"data-state":Ke(l.open),"data-disabled":l.disabled?"":void 0,...a,ref:r})});Te.displayName=Fe;var B="AccordionTrigger",De=g.forwardRef((s,r)=>{const{__scopeAccordion:t,...a}=s,n=D(b,t),l=re(B,t),c=st(B,t),d=ne(t);return e.jsx(ae.ItemSlot,{scope:t,children:e.jsx(Js,{"aria-disabled":l.open&&!c.collapsible||void 0,"data-orientation":n.orientation,id:l.triggerId,...d,...a,ref:r})})});De.displayName=B;var qe="AccordionContent",ze=g.forwardRef((s,r)=>{const{__scopeAccordion:t,...a}=s,n=D(b,t),l=re(qe,t),c=ne(t);return e.jsx(Xs,{role:"region","aria-labelledby":l.triggerId,"data-orientation":n.orientation,...c,...a,ref:r,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...s.style}})});ze.displayName=qe;function Ke(s){return s?"open":"closed"}var ot=$e,it=Le,lt=Te,ct=De,dt=ze;function Ve({...s}){return e.jsx(ot,{"data-slot":"accordion",...s})}function Ge({className:s,...r}){return e.jsx(it,{"data-slot":"accordion-item",className:I("border-b last:border-b-0",s),...r})}function Ue({className:s,children:r,...t}){return e.jsx(lt,{className:"flex",children:e.jsxs(ct,{"data-slot":"accordion-trigger",className:I("cursor-pointer  focus-visible:border-ring focus-visible:ring-ring/50 flex flex-1 items-start justify-between gap-4  py-4 text-left text-sm font-medium transition-all outline-none hover:underline focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&[data-state=open]>svg]:rotate-180",s),...t,children:[r,e.jsx(as,{className:"text-muted-foreground pointer-events-none size-4 shrink-0 translate-y-0.5 transition-transform duration-200"})]})})}function He({className:s,children:r,...t}){return e.jsx(dt,{"data-slot":"accordion-content",className:"data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down overflow-hidden text-sm",...t,children:e.jsx("div",{className:I("pt-0 pb-4",s),children:r})})}async function ut(s=100,r){let t=`${x}/system/logs?limit=${s}`;const a=await fetch(t);if(!a.ok)throw new Error("Failed to fetch system logs");return a.json()}async function mt(){const s=await fetch(`${x}/system/models`);if(!s.ok)throw new Error("Failed to fetch available models");return s.json()}function ht(){const[s,r]=m.useState(null),{data:t,refetch:a}=A({queryKey:["job-status"],queryFn:async()=>(await fetch(`${x}/jobs/status`)).json(),refetchInterval:u=>u.state.data?.status==="running"?1e3:5e3}),n=j({mutationFn:async()=>{await fetch(`${x}/jobs/stop`,{method:"POST"})},onSuccess:()=>{f.info("Stopping job..."),a()}});if(!t||t.status==="idle"||t.job_id===s&&t.status!=="running")return null;const l=t.status==="running",c=t.status==="completed",d=t.status==="failed";t.status;const i=t.total>0?t.progress/t.total*100:0;return e.jsxs("div",{className:`border p-4 space-y-3 transition-colors ${c?" border-green-200":d?"bg-red-50/50 border-red-200":"bg-muted/50"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[l&&e.jsx(Cs,{className:"h-4 w-4 animate-spin text-primary"}),c&&e.jsx(xs,{className:"h-4 w-4 text-green-600"}),d&&e.jsx(le,{className:"h-4 w-4 text-red-600"}),e.jsx("span",{className:"font-medium text-sm",children:t.job_type==="embedding_generation"?"Generating Embeddings":"Background Job"}),e.jsx("span",{className:"text-xs text-muted-foreground ml-2",children:t.message})]}),e.jsx("div",{className:"flex items-center gap-2",children:l?e.jsxs(y,{variant:"destructive",size:"sm",className:"h-7 text-xs",onClick:()=>n.mutate(),disabled:n.isPending,children:[e.jsx(le,{className:"h-3 w-3 mr-1"})," Stop"]}):e.jsx(y,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>r(t.job_id),children:e.jsx(os,{className:"h-4 w-4"})})})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(Gs,{value:c?100:i,className:`h-2 ${c?"[&>div]:bg-green-600":""}`}),e.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[e.jsxs("span",{children:[t.progress," / ",t.total]}),e.jsxs("span",{children:[c?"100":Math.round(i),"%"]})]})]})]})}function pt(){const{selectedModel:s,setSelectedModel:r}=X(),t=L(),{data:a}=A({queryKey:["system-stats"],queryFn:async()=>(await fetch(`${x}/jobs/stats`)).json(),refetchInterval:5e3}),{data:n}=A({queryKey:["available-models"],queryFn:async()=>(await fetch(`${x}/system/models`)).json(),refetchInterval:5e3}),l=j({mutationFn:async o=>{const p=await fetch(`${x}/system/models/${encodeURIComponent(o)}/load`,{method:"POST"});if(!p.ok)throw new Error("Failed to load model");return p.json()},onSuccess:()=>{f.success("Model loaded successfully"),t.invalidateQueries({queryKey:["available-models"]})},onError:o=>f.error(o.message)}),c=j({mutationFn:async()=>{const o=await fetch(`${x}/system/models/unload`,{method:"POST"});if(!o.ok)throw new Error("Failed to unload model");return o.json()},onSuccess:()=>{f.success("Model unloaded"),t.invalidateQueries({queryKey:["available-models"]})},onError:o=>f.error(o.message)}),d=n?.find(o=>o.loaded),i=l.isPending||c.isPending,u=d?.id===s||i;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"grid gap-1 md:grid-cols-3",children:[e.jsxs(N,{className:"p-4 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-2",children:[e.jsx(us,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium uppercase",children:"GPU Status"})]}),a?.gpu?e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-medium truncate",title:a.gpu.name,children:a.gpu.name}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:["Mem: ",a.gpu.memory_allocated_mb,"MB /"," ",a.gpu.memory_reserved_mb,"MB"]})]}):e.jsx("div",{className:"text-sm text-muted-foreground italic",children:a?.gpu_error?"GPU Error":"No GPU Detected"})]}),e.jsxs(N,{className:"p-4 flex flex-col justify-between gap-2!",children:[e.jsx("div",{className:"flex items-center justify-between text-muted-foreground m-0! ",children:e.jsxs("div",{className:"flex items-center gap-2 w-full",children:[e.jsx("div",{className:`h-2 w-2 rounded-full ${d?"bg-green-500":"bg-red-500"}`,title:d?"Model Loaded":"No Model Loaded"}),e.jsx("span",{className:"text-xs font-medium uppercase",children:"Active Model"}),d?.id===s?e.jsx(y,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 ml-auto",onClick:()=>c.mutate(),disabled:i,title:"Unload Model",children:e.jsx(Ss,{className:"h-4 w-4"})}):e.jsx(y,{size:"sm",variant:"outline",className:"h-8 w-8 ml-auto p-0 text-green-500 hover:text-green-600",onClick:()=>l.mutate(s),disabled:i,title:"Load Model",children:e.jsx(Ps,{className:"h-4 w-4"})})]})}),e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"flex gap-2",children:e.jsxs(xe,{value:s,onValueChange:r,disabled:d?.id===s||i,children:[e.jsx(fe,{className:I("h-8 text-xs flex-1",u&&"opacity-50 cursor-not-allowed"),onPointerDown:o=>{u&&(o.preventDefault(),o.stopPropagation(),f.warning("Please unload current model."))},children:e.jsx(ge,{placeholder:"Select Model"})}),e.jsx(ve,{children:n?.map(o=>e.jsx(G,{value:o.id,className:"text-xs",children:o.name},o.id))})]})})})]}),e.jsxs(N,{className:"p-4 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground mb-2",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-medium uppercase",children:"Storage"})]}),a?.disk&&e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"font-medium",children:[a.disk.free_gb," GB Free"]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[a.disk.percent,"% Used of ",a.disk.total_gb," GB"]})]})]})]}),e.jsx(ht,{})]})}function xt({path:s}){const r=L(),[t,a]=m.useState(s.name||""),{selectedModel:n,batchSize:l}=X(),c=j({mutationFn:async o=>{const p=await fetch(`${x}/workspace/paths/${s.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});if(!p.ok)throw new Error("Failed to update path");return p.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["paths"]}),f.success("Path updated")}}),d=j({mutationFn:async()=>{const o=await fetch(`${x}/workspace/paths/${s.id}`,{method:"DELETE"});if(!o.ok)throw new Error("Failed to delete path");return o.json()},onSuccess:()=>{r.invalidateQueries({queryKey:["paths"]}),f.success("Path deleted")}}),i=j({mutationFn:async()=>{const o=await fetch(`${x}/workspace/paths/${s.id}/thumbnails`,{method:"POST"});if(!o.ok)throw new Error("Failed to generate thumbnails");return o.json()},onSuccess:o=>{f.success(`Thumbnail generation complete! Generated ${o.generated} thumbnails.`)}}),u=j({mutationFn:async()=>{const o=await fetch(`${x}/workspace/paths/${s.id}/embeddings?model=${encodeURIComponent(n)}&batch_size=${l}`,{method:"POST"});if(!o.ok){const p=await o.json();throw new Error(p.detail||"Failed to generate embeddings")}return o.json()},onSuccess:o=>{f.success(`Embedding generation started! Job ID: ${o.job_id}`),r.invalidateQueries({queryKey:["job-status"]})},onError:o=>{f.error(o.message)}});return e.jsxs(Ge,{value:s.id.toString(),children:[e.jsx(Ue,{className:"hover:no-underline",children:e.jsxs("div",{className:"flex items-center justify-between w-full pr-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-left",children:[e.jsx(ls,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium",children:s.name||e.jsx("span",{className:"italic text-muted-foreground",children:"Untitled Collection"})}),e.jsx("span",{className:"text-xs text-muted-foreground font-mono wrap-anywhere",children:s.path})]})]}),e.jsx("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:e.jsxs(cs,{variant:"secondary",children:[s.image_count," images"]})})]})}),e.jsx(He,{children:e.jsxs("div",{className:"p-4 space-y-2 bg-muted/30 border",children:[e.jsxs("div",{className:"grid gap-2 md:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Collection Name"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{value:t,onChange:o=>a(o.target.value),placeholder:"Nickname"}),e.jsx(y,{size:"sm",onClick:()=>c.mutate({name:t}),disabled:c.isPending,children:e.jsx($s,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Actions"}),e.jsxs("div",{className:"flex flex-wrap lgap-2",children:[e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>i.mutate(),disabled:i.isPending,children:[i.isPending?e.jsx(U,{className:"w-4 h-4 mr-2"}):e.jsx(bs,{className:"w-4 h-4 mr-2"}),"Generate Thumbnails"]}),e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>u.mutate(),disabled:u.isPending,children:[u.isPending?e.jsx(U,{className:"w-4 h-4 mr-2"}):e.jsx(hs,{className:"w-4 h-4 mr-2"}),"Generate Embeddings"]}),e.jsxs(y,{variant:"destructive",size:"sm",onClick:()=>{confirm("Are you sure you want to remove this path?")&&d.mutate()},children:[e.jsx(Rs,{className:"w-4 h-4 mr-2"}),"Remove Path"]})]})]})]}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Path: ",s.path]}),e.jsxs("p",{children:["ID: ",s.id]})]})]})})]})}function ft(){const s=L(),[r,t]=m.useState(""),{data:a,isLoading:n}=A({queryKey:["paths"],queryFn:async()=>{const i=await fetch(`${x}/workspace/paths`);if(!i.ok)throw new Error("Failed to fetch paths");return i.json()}}),l=j({mutationFn:async i=>{const u=await fetch(`${x}/workspace/paths`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:i})});if(!u.ok){const o=await u.json();throw new Error(o.detail||"Failed to add path")}return u.json()},onSuccess:()=>{s.invalidateQueries({queryKey:["paths"]}),t(""),f.success("Path added successfully")},onError:i=>{f.error(i.message)}}),c=j({mutationFn:async()=>{const i=await fetch(`${x}/workspace/scan`,{method:"POST"});if(!i.ok)throw new Error("Failed to scan");return i.json()},onSuccess:i=>{f.success(`Scan complete! Added ${i.added} new images.`),s.invalidateQueries({queryKey:["paths"]})}}),d=i=>{i.preventDefault(),r&&l.mutate(r)};return e.jsxs("div",{className:"space-y-1 py-1",children:[e.jsx(pt,{}),e.jsxs(N,{children:[e.jsxs(ye,{children:[e.jsx(be,{children:"Library Collections"}),e.jsx(je,{children:"Manage your local image libraries and collections."})]}),e.jsxs(Ne,{className:"space-y-2",children:[e.jsx("form",{onSubmit:d,className:"flex gap-2",children:e.jsxs("div",{className:"grid w-full items-center gap-1.5",children:[e.jsx($,{htmlFor:"path",children:"Add Directory Path"}),e.jsxs("div",{className:"flex gap-2 h-full",children:[e.jsx(Y,{id:"path",placeholder:"/home/user/images",value:r,onChange:i=>t(i.target.value)}),e.jsxs(y,{type:"submit",disabled:l.isPending,children:[e.jsx(is,{className:"w-4 h-4 mr-2"}),"Add Path"]})]})]})}),e.jsxs("div",{className:"flex items-center justify-between border-t pt-4",children:[e.jsx("div",{className:"text-sm text-muted-foreground",children:"Global Actions"}),e.jsx(y,{variant:"outline",onClick:()=>c.mutate(),disabled:c.isPending,children:c.isPending?e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"mr-2 h-4 w-4"})," Scanning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(As,{className:"mr-2 h-4 w-4"})," Scan All Libraries"]})})]}),e.jsx("div",{className:"space-y-2",children:n?e.jsx("p",{children:"Loading paths..."}):a?.length===0?e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No paths added yet."}):e.jsx(Ve,{type:"single",collapsible:!0,className:"w-full",children:a?.map(i=>e.jsx(xt,{path:i},i.id))})})]})]})]})}function gt(){const[s,r]=m.useState(!1),t=m.useRef(null),{data:a}=A({queryKey:["system-logs-viewer"],queryFn:()=>ut(50),refetchInterval:s?2e3:!1});return m.useEffect(()=>{s&&t.current?.scrollIntoView({behavior:"auto"})},[a,s]),e.jsx(N,{className:"p-0! gap-0!",children:e.jsx(Ve,{type:"single",collapsible:!0,className:"w-full",onValueChange:n=>r(n==="logs"),children:e.jsxs(Ge,{value:"logs",className:"border-none",children:[e.jsx(Ue,{className:"py-3 px-4 hover:no-underline bg-muted/20",children:e.jsx("span",{className:"text-sm font-medium",children:"System Logs"})}),e.jsx(He,{className:"p-0",children:e.jsx(H,{type:"always",variant:"left-border",className:"h-50 w-full bg-muted/50 border-t border-border",children:e.jsxs("div",{className:"p-4 font-mono text-xs",children:[a?.map((n,l)=>e.jsx("div",{className:"whitespace-pre-wrap border-b border-border/50 py-0.5 last:border-0",children:n},l)),(!a||a.length===0)&&e.jsx("div",{className:"text-muted-foreground italic py-2",children:"No logs available..."}),e.jsx("div",{ref:t})]})})})]})})})}function vt(){const{selectedModel:s,setSelectedModel:r,batchSize:t,setBatchSize:a}=X(),{data:n,isLoading:l}=A({queryKey:["available-models"],queryFn:mt});return e.jsxs(N,{className:"my-1",children:[e.jsxs(ye,{children:[e.jsx(be,{children:"General Settings"}),e.jsx(je,{children:"Configure global application settings."})]}),e.jsxs(Ne,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Global CLIP Model"}),e.jsxs(xe,{value:s,onValueChange:r,children:[e.jsx(fe,{className:"w-full",children:e.jsx(ge,{placeholder:"Select a model"})}),e.jsx(ve,{children:l?e.jsx(G,{value:"loading",disabled:!0,children:"Loading models..."}):n?.map(c=>e.jsx(G,{value:c.id,children:c.name},c.id))})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Select the CLIP model to use for embedding generation and search."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Batch Size"}),e.jsx(Y,{type:"number",value:t,onChange:c=>a(parseInt(c.target.value,10)),min:1,max:100}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of images to process at once during embedding generation."})]})]})]})}const yt=()=>{const{tab:s}=ie.useSearch(),r=ns({from:ie.fullPath}),t=n=>{r({search:{tab:n}})},a=[{title:"General",icon:e.jsx(rs,{className:"h-4 w-4"}),value:"general"},{title:"Library",icon:e.jsx(Ns,{className:"h-4 w-4"}),value:"library"}];return e.jsxs("div",{className:"p-1 w-full grid grid-cols-4 grid-rows-[auto_1fr] md:grid-rows-[1fr] gap-1 h-full overflow-visible ",children:[e.jsx("div",{className:" col-span-4 md:col-span-1 shrink-0!  overflow-visible h-auto md:h-full border-none ring-0! shadow-none bg-transparent p-0! min-h-0 gap-1",children:e.jsxs(N,{className:"flex-1 h-auto md:h-full p-0! gap-0! shrink-0 flex flex-col overflow-visible min-h-0",children:[e.jsx("div",{className:"flex items-center justify-between shrink-0 border-b border-foreground/10 p-2 bg-muted/35",children:e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Settings"})}),e.jsx(H,{className:"flex-1 flex-col",children:e.jsxs("div",{className:"p-2 flex flex-row space-x-2 space-y-0 md:flex-col md:space-y-1 md:space-x-0",children:[e.jsx("div",{children:a.map(n=>e.jsx(y,{variant:s===n.value?"secondary":"ghost",className:I("w-fit md:w-full justify-start font-normal h-9",s===n.value&&"bg-muted font-medium"),onClick:()=>t(n.value),children:e.jsxs("span",{className:"flex items-center gap-2 truncate",children:[n.icon,e.jsx("span",{className:"hidden md:inline",children:n.title})]})},n.value))}),e.jsx("div",{className:"md:hidden flex items-center justify-between shrink-0 p-2 bg-card ml-auto ",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-sm font-medium",children:a.find(n=>n.value===s)?.title}),a.find(n=>n.value===s)?.icon]})})]})})]})}),e.jsx(N,{className:"col-span-4 md:col-span-3 flex grow flex-col overflow-hidden h-full border-none ring-0! shadow-none bg-transparent p-0! min-h-0",children:e.jsxs("div",{className:"h-full flex flex-col w-full! min-h-0 gap-1! space-y-0!",children:[e.jsx("div",{className:"flex-1 m-0 overflow-y-auto border border-foreground/10 bg-card",children:e.jsxs(H,{className:"h-full pl-1 pr-4",variant:"left-border",type:"always",children:[s==="general"&&e.jsx(vt,{}),s==="library"&&e.jsx(ft,{})]})}),e.jsx(gt,{})]})})]})},Nt=yt;export{Nt as component};
