Metadata-Version: 2.4
Name: minibt
Version: 1.1.8
Summary: ä¸€ç«™å¼é‡åŒ–äº¤æ˜“ç­–ç•¥å¼€å‘åº“ï¼Œç®€åŒ–ä»ç­–ç•¥æ­å»ºåˆ°å®ç›˜äº¤æ˜“çš„å…¨æµç¨‹
Author-email: owen <407841129@qq.com>
License: MIT
Project-URL: Homepage, https://github.com/MiniBtMaster/minibt
Project-URL: Documentation, https://www.minibt.cn/
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Operating System :: OS Independent
Classifier: Intended Audience :: Developers
Classifier: Intended Audience :: Financial and Insurance Industry
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: Office/Business :: Financial :: Investment
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy<=1.26.0,>=1.21.0
Requires-Dist: pandas<2.4.0,>=1.4.0
Requires-Dist: pandas-ta>=0.3.14b0
Requires-Dist: numpy-ext>=0.9.9
Requires-Dist: TA-Lib>=0.4.24
Requires-Dist: finta>=1.3
Requires-Dist: quantstats>=0.0.62
Requires-Dist: statsmodels>=0.13.5
Requires-Dist: scipy<1.13.2,>=1.7.0
Requires-Dist: arch>=7.2.0
Requires-Dist: pykalman>=0.10.1
Requires-Dist: tulipy>=0.4.0
Requires-Dist: tqsdk>=3.4.10
Requires-Dist: bokeh>=3.3.0
Requires-Dist: rich>=13.0.0
Requires-Dist: addict>=2.4.0
Requires-Dist: cachetools>=5.3.0
Requires-Dist: retrying>=1.3.4
Requires-Dist: psutil>=5.9.4
Requires-Dist: iteration-utilities>=0.11.0
Requires-Dist: joblib>=1.2.0
Requires-Dist: colorlog>=6.7.0
Requires-Dist: typing-extensions>=4.12.2
Requires-Dist: optuna>=3.4.0
Requires-Dist: deap>=1.4.1
Requires-Dist: torch>=1.13.1
Requires-Dist: torchcontrib>=0.0.2
Dynamic: license-file

# MiniBT - è®©é‡åŒ–äº¤æ˜“æ›´ç®€å•ã€æ›´é«˜æ•ˆçš„ä¸€ç«™å¼ç­–ç•¥å¼€å‘åº“

[![Python Version](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![PyPI version](https://img.shields.io/pypi/v/minibt.svg)](https://pypi.org/project/minibt/)
[![Version](https://img.shields.io/badge/version-1.1.8-green.svg)](https://github.com/MiniBtMaster/minibt)

<center>
<img src="https://picx.zhimg.com/v2-808c964c5c758d60de17d15524ad7bbb_1440w.jpg" 
  alt="minibt" 
  width="1000" 
  class="center-img">
</center>

æ— è®ºæ˜¯é‡åŒ–æ–°æ‰‹è¿˜æ˜¯èµ„æ·±å¼€å‘è€…ï¼Œminibt éƒ½èƒ½å¸®ä½ è½»æ¾æå®šä»ç­–ç•¥æ­å»ºåˆ°å®ç›˜äº¤æ˜“çš„å…¨æµç¨‹ â€”â€” ä»¥æç®€çš„ä»£ç å®ç°å¤æ‚é€»è¾‘ï¼Œç”¨å¼ºå¤§çš„å·¥å…·é“¾æå‡ç­–ç•¥æ•ˆæœã€‚

## âœ¨ æ ¸å¿ƒä¼˜åŠ¿

*   **ğŸš€ æç®€ç¼–ç ä½“éªŒ**ï¼šå‘Šåˆ«ç¹ççš„åº•å±‚å®ç°ï¼Œç”¨ç®€æ´è¯­æ³•å¿«é€Ÿå®šä¹‰äº¤æ˜“é€»è¾‘ï¼Œè®©ä½ çš„ç²¾åŠ›èšç„¦äºç­–ç•¥æ€æƒ³è€Œéä»£ç ç»†èŠ‚ã€‚

*   **ğŸ“Š ä¸°å¯ŒæŒ‡æ ‡å³æ’å³ç”¨**ï¼šå†…ç½® pandas_taã€talib ç­‰ä¸»æµæŒ‡æ ‡åº“ï¼Œå‡çº¿ã€MACDã€RSI ç­‰å¸¸ç”¨æŒ‡æ ‡ä¸€é”®è°ƒç”¨ï¼Œæ— éœ€é‡å¤é€ è½®å­ã€‚

*   **ğŸ“ˆ ç›´è§‚å¯è§†åŒ–åˆ†æ**ï¼šé›†æˆ Bokeh å¯è§†åŒ–å·¥å…·ï¼Œç­–ç•¥å›æµ‹ç»“æœã€èµ„é‡‘æ›²çº¿ã€ä¿¡å·åˆ†å¸ƒç­‰æ•°æ®ä¸€é”®ç”Ÿæˆäº¤äº’å¼å›¾è¡¨ï¼Œè¶‹åŠ¿æ´å¯Ÿæ›´æ¸…æ™°ã€‚

*   **ğŸ”— æ— ç¼å¯¹æ¥å®ç›˜**ï¼šæ”¯æŒ TQSDK å®ç›˜æ¥å£ï¼Œç­–ç•¥åœ¨å›æµ‹é€šè¿‡åå¯å¿«é€Ÿåˆ‡æ¢è‡³å®ç›˜äº¤æ˜“ï¼Œä»ç ”ç©¶åˆ°è½åœ°é›¶é—¨æ§›ã€‚

*   **ğŸ¤– æ™ºèƒ½ä¼˜åŒ–å‡çº§**ï¼šå†…ç½®å‚æ•°ä¼˜åŒ–å·¥å…·ä¸å¼ºåŒ–å­¦ä¹ æ¨¡å—ï¼Œè‡ªåŠ¨è¿­ä»£ç­–ç•¥å‚æ•°ã€åŠ¨æ€é€‚åº”å¸‚åœºå˜åŒ–ï¼ŒåŠ©åŠ›æå‡ç­–ç•¥ç¨³å®šæ€§ä¸æ”¶ç›Šæ½œåŠ›ã€‚

&emsp;&emsp;minibtï¼Œè®©é‡åŒ–äº¤æ˜“çš„é—¨æ§›æ›´ä½ã€æ•ˆç‡æ›´é«˜ï¼Œæ— è®ºæ˜¯å¿«é€ŸéªŒè¯æƒ³æ³•è¿˜æ˜¯éƒ¨ç½²å®ç›˜ç­–ç•¥ï¼Œéƒ½æ˜¯ä½ çš„å¾—åŠ›åŠ©æ‰‹ã€‚

## ğŸ“š ç›¸å…³èµ„æº

- **çŸ¥ä¹ä¸“æ **ï¼š[minibté‡åŒ–æ•™ç¨‹ä¸“æ ](https://zhuanlan.zhihu.com/column/c_1942555756558783128)
- **åœ¨çº¿æ•™ç¨‹**ï¼š[minibté‡åŒ–æ•™ç¨‹](https://www.minibt.cn)
- **GitHubä»“åº“**ï¼š[https://github.com/MiniBtMaster/minibt](https://github.com/MiniBtMaster/minibt)
- **PyPIä»“åº“**ï¼š[https://pypi.org/project/minibt/](https://pypi.org/project/minibt/)

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **æ ¸å¿ƒæ¡†æ¶**: minibt å›æµ‹å¼•æ“
- **æ•°æ®å¤„ç†**: NumPy, Pandas
- **æŒ‡æ ‡è®¡ç®—**: TA-Lib, Pandas-TA, Tulip
- **å¯è§†åŒ–**: Bokeh (äº¤äº’å¼å›¾è¡¨)
- **å‚æ•°ä¼˜åŒ–**: Optuna
- **å®ç›˜äº¤æ˜“**: TQSDK
- **å¼ºåŒ–å­¦ä¹ **: ElegantRL

## ğŸ“¦ å®‰è£…

### ç¯å¢ƒè¦æ±‚

minibt ä¾èµ–ä»¥ä¸‹åŸºç¡€ç¯å¢ƒï¼Œå»ºè®®ä½¿ç”¨ Python 3.8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼ˆæ¨è 3.8 - 3.11 ç³»åˆ—ï¼‰ï¼Œå¯é€šè¿‡ `python --version` æ£€æŸ¥å½“å‰ç¯å¢ƒç‰ˆæœ¬ï¼š

### é€šè¿‡ pip å®‰è£…ï¼ˆæ¨èï¼‰

```bash
pip install minibt
```

è¯¥å‘½ä»¤ä¼šè‡ªåŠ¨æ‹‰å– minibt åŠå…¶åŸºç¡€ä¾èµ–ï¼ˆå¦‚ `numpy`ã€`pandas` ç­‰ï¼‰ï¼Œä½†éƒ¨åˆ†ç‰¹æ®Šä¾èµ–ï¼ˆå¦‚ `TA-Lib` éœ€é¢å¤–ç³»ç»Ÿçº§ä¾èµ–ï¼‰éœ€æ‰‹åŠ¨å¤„ç†ã€‚

### ä»æºç å®‰è£…ï¼ˆé€‚åˆå¼€å‘/å®šåˆ¶ï¼‰

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/MiniBtMaster/minibt.git
cd minibt

# å®‰è£…ä¾èµ–
pip install -e .
```

æˆ–ä» PyPI ä¸‹è½½ whl æ–‡ä»¶å®‰è£…ï¼š

```bash
python -m pip install æ–‡ä»¶å.whl
```

### éªŒè¯å®‰è£…

å®‰è£…å®Œæˆåï¼Œæ‰“å¼€ Python äº¤äº’ç¯å¢ƒï¼ˆç»ˆç«¯æ‰§è¡Œ `python` æˆ– `ipython`ï¼‰ï¼Œè¾“å…¥ï¼š

```python
import minibt
print(minibt.__version__)
```

è‹¥è¾“å‡º `1.1.8`ï¼ˆæˆ–å¯¹åº”ç‰ˆæœ¬å·ï¼‰ï¼Œä¸”æ— å¯¼å…¥é”™è¯¯ï¼Œè¯´æ˜å®‰è£…æˆåŠŸã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¤ºä¾‹1ï¼šåŒå‡çº¿äº¤å‰ç­–ç•¥

```python
from minibt import *  # å¯¼å…¥minibtæ ¸å¿ƒåŠŸèƒ½ï¼ˆç­–ç•¥ã€æŒ‡æ ‡ã€å›æµ‹å¼•æ“ç­‰ï¼‰

class MA(Strategy):  # å®šä¹‰ç­–ç•¥ç±»ï¼Œå¿…é¡»ç»§æ‰¿StrategyåŸºç±»
    params = dict(
       length1=10,  # çŸ­æœŸå‡çº¿å‘¨æœŸï¼ˆå¯é€šè¿‡å‚æ•°ä¼˜åŒ–è°ƒæ•´ï¼‰
       length2=20   # é•¿æœŸå‡çº¿å‘¨æœŸï¼ˆå¯é€šè¿‡å‚æ•°ä¼˜åŒ–è°ƒæ•´ï¼‰
   )
   def __init__(self):
       # 1. åŠ è½½æ•°æ®ï¼šä½¿ç”¨minibtå†…ç½®æµ‹è¯•æ•°æ®ï¼ˆæ— éœ€æ‰‹åŠ¨å‡†å¤‡ï¼‰
       self.data = self.get_data(LocalDatas.test) 
      
       # 2. è®¡ç®—å‡çº¿æŒ‡æ ‡ï¼šåŸºäºæ”¶ç›˜ä»·è®¡ç®—SMA
       self.ma1 = self.data.close.sma(self.params.length1)  # çŸ­æœŸå‡çº¿
       self.ma2 = self.data.close.sma(self.params.length2)  # é•¿æœŸå‡çº¿
      

       # 3. ç”Ÿæˆäº¤æ˜“ä¿¡å·ï¼šé‡‘å‰ï¼ˆå¤šå¤´ï¼‰ã€æ­»å‰ï¼ˆç©ºå¤´ï¼‰
       self.long_signal = self.ma1.cross_up(self.ma2)  # çŸ­æœŸå‡çº¿ä¸Šç©¿é•¿æœŸå‡çº¿
       self.short_signal = self.ma2.cross_down(self.ma1)  # é•¿æœŸå‡çº¿ä¸‹ç©¿çŸ­æœŸå‡çº¿
       
   def next(self):
       # next æ–¹æ³•ï¼šé€æ ¹Kçº¿å¤„ç†æ ¸å¿ƒé€»è¾‘ï¼Œç­–ç•¥çš„"å¤§è„‘"
       # æƒ…å†µ1ï¼šæ— æŒä»“æ—¶ï¼Œæ ¹æ®ä¿¡å·å¼€ä»“
       if not self.data.position:  # position=0 è¡¨ç¤ºç©ºä»“
           if self.long_signal.new:  # é‡‘å‰ä¿¡å·æœ€æ–°å€¼
               self.data.buy()       # å¼€å¤šä»“
           elif self.short_signal.new:  # æ­»å‰ä¿¡å·æœ€æ–°å€¼
               self.data.sell()      # å¼€ç©ºä»“
      
       # æƒ…å†µ2ï¼šæŒæœ‰å¤šå¤´æ—¶ï¼Œæ­»å‰ä¿¡å·å¹³ä»“
       elif self.data.position > 0 and self.short_signal.new: 
           self.data.sell()  # å¹³å¤šä»“
      
       # æƒ…å†µ3ï¼šæŒæœ‰ç©ºå¤´æ—¶ï¼Œé‡‘å‰ä¿¡å·å¹³ä»“
       elif self.data.position < 0 and self.long_signal.new: 
           self.data.buy()   # å¹³ç©ºä»“

if __name__ == "__main__":
   # åˆå§‹åŒ–å›æµ‹å¼•æ“ï¼šauto=True è‡ªåŠ¨å¤„ç†æ•°æ®åŠ è½½ã€å›æµ‹ã€å¯è§†åŒ–
   bt = Bt(auto=True) 
   bt.run()  # å¯åŠ¨å›æµ‹ï¼Œå®Œæˆåè‡ªåŠ¨å¼¹å‡ºå¯è§†åŒ–ç•Œé¢
```

<center>
<img src="https://picx.zhimg.com/v2-539ddf5cbe7f0cb1d4b99b15d75628e5_1440w.jpg" 
  alt="åŒå‡çº¿ç­–ç•¥å›æµ‹ç»“æœ" 
  class="center-img">
</center>

### ç¤ºä¾‹2ï¼šæç®€æŒ‡æ ‡å±•ç¤º

```python
from minibt import *

if __name__ == "__main__":
    LocalDatas.test.kline.run(
        ["ma1", Multiply(PandasTa.sma, dict(length=20))],
        ["ma2", Multiply(PandasTa.sma, dict(length=30))],
        ["ma3", Multiply(PandasTa.sma, dict(length=60))],
        ["ma4", Multiply(PandasTa.sma, dict(length=120))],
        ["ebsw", Multiply(PandasTa.ebsw)])
```

<center>
<img src="https://picx.zhimg.com/v2-271b0e9d30aedf5dfdd444088563bf51_1440w.jpg" 
  alt="å¤šæŒ‡æ ‡å±•ç¤º" 
  class="center-img">
</center>

### ç¤ºä¾‹3ï¼šå‚æ•°ä¼˜åŒ–é…ç½®

```python
if __name__ == "__main__":
    bt = Bt(auto=True)
    # è®¾ç½®ä¼˜åŒ–ç›®æ ‡å’Œå‚æ•°èŒƒå›´
    bt.optstrategy(
        ["profit", "win_rate"],  # ä¼˜åŒ–ç›®æ ‡ï¼šæ”¶ç›Šå’Œèƒœç‡
        (1, 1),                  # æƒé‡é…ç½®
        length1=(5, 15, 1),      # length1å‚æ•°èŒƒå›´ï¼š5åˆ°15ï¼Œæ­¥é•¿ä¸º1
        length2=(20, 30, 1),     # length2å‚æ•°èŒƒå›´ï¼š20åˆ°30ï¼Œæ­¥é•¿ä¸º1
        opconfig=OptunaConfig(n_trials=100)  # Optunaé…ç½®ï¼š100æ¬¡è¯•éªŒ
    )
    bt.run()
```

<center>
<img src="https://pic2.zhimg.com/v2-c92fecec6a4b7a750a5d6a49e9c3217f_1440w.jpg" 
  alt="å‚æ•°ä¼˜åŒ–ç»“æœ" 
  class="center-img">
</center>

## ğŸ“– æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### æ ‡å‡†åŒ–æ¥å£ä¸ç»Ÿä¸€æ•°æ®æ¨¡å‹

minibté‡åŒ–æ¡†æ¶ä¸­æ‰€æœ‰æŒ‡æ ‡å’Œæ•°æ®å¯¹è±¡ç»Ÿä¸€å°è£…äº†æŒ‡æ ‡ä¸Kçº¿æ•°æ®çš„å…±æ€§èƒ½åŠ›ï¼Œä¸ºå­ç±»ï¼ˆå¦‚ `Line`ã€`IndSeries`ã€`IndFrame`ã€`KLine`ï¼‰æä¾›æ ‡å‡†åŒ–æ¥å£ï¼š

#### 1. å¤šç±»å‹æ•°æ®ç»Ÿä¸€æ¥å£
- **Line**: å•å€¼æ•°æ®åºåˆ—
- **IndSeries**: ä¸€ç»´æ•°æ®åºåˆ—ï¼ˆç±»ä¼¼pandas.Seriesï¼‰
- **IndFrame**: å¤šç»´æ•°æ®è¡¨æ ¼ï¼ˆç±»ä¼¼pandas.DataFrameï¼‰
- **KLine**: Kçº¿æ•°æ®å¯¹è±¡

#### 2. è¿ç®—ç¬¦é‡è½½ä½“ç³»
- æ”¯æŒç®—æœ¯è¿ç®—ï¼ˆ`+`, `-`, `*`, `/` ç­‰ï¼‰
- æ”¯æŒæ¯”è¾ƒè¿ç®—ï¼ˆ`>`, `<`, `==` ç­‰ï¼‰
- æ”¯æŒé€»è¾‘è¿ç®—ï¼ˆ`&`, `|` ç­‰ï¼‰
- æ”¯æŒä¸€å…ƒè¿ç®—ï¼ˆ`abs()`, `-x` ç­‰ï¼‰

#### 3. æ— ç¼Pandaså…¼å®¹
- è‡ªåŠ¨å°†Pandasæ–¹æ³•è¿”å›ç»“æœè½¬æ¢ä¸ºæ¡†æ¶å†…ç½®ç±»å‹
- æ”¯æŒåŸç”ŸPandas APIè°ƒç”¨
- ä¿æŒæŒ‡æ ‡å¯¹è±¡ç‰¹æ€§ä¸è¢«ç ´å

#### 4. å¤šå‘¨æœŸæ•°æ®å¤„ç†
- æ”¯æŒä¸Šé‡‡æ ·ï¼ˆupsampleï¼‰
- è‡ªåŠ¨å¤„ç†è·¨å‘¨æœŸæ•°æ®å¯¹é½
- ä¿æŒå¤šå‘¨æœŸæ•°æ®çš„ä¸€è‡´æ€§

### æ•°æ®è®¿é—®ä¸æ“ä½œ

#### åŸºç¡€å±æ€§è®¿é—®
```python
# è·å–æ•°æ®å€¼æ•°ç»„
values = indicator.values
# è·å–æ•°æ®å½¢çŠ¶ï¼ˆè¡Œæ•°, åˆ—æ•°ï¼‰
shape = indicator.shape
# è·å–è¡Œæ•°ï¼ˆæ—¶é—´æ­¥æ•°é‡ï¼‰
length = indicator.V  # æˆ– indicator.length
# è·å–åˆ—æ•°ï¼ˆç‰¹å¾ç»´åº¦ï¼‰
columns = indicator.H
```

#### ç´¢å¼•è®¿é—®
```python
# æ”¯æŒå¤šç§ç´¢å¼•æ–¹å¼
indicator[0]          # ç¬¬ä¸€è¡Œ
indicator['close']    # closeåˆ—
indicator[10:20]      # åˆ‡ç‰‡
indicator[[1, 3, 5]]  # ç´¢å¼•åˆ—è¡¨
```

#### ä¸“ç”¨ç´¢å¼•å™¨
```python
# åŸºäºä½ç½®çš„ç´¢å¼•
indicator.iloc[0]        # ç¬¬ä¸€è¡Œ
indicator.iloc[0:5]      # å‰5è¡Œ
indicator.iloc[0, 1]     # ç¬¬ä¸€è¡Œç¬¬äºŒåˆ—

# åŸºäºæ ‡ç­¾çš„ç´¢å¼•
indicator.loc['close']   # closeåˆ—
indicator.loc[0:5]       # å‰5è¡Œ

# å¿«é€Ÿæ ‡é‡è®¿é—®
indicator.at[0, 'close'] # ç¬¬ä¸€è¡Œçš„closeå€¼
indicator.iat[0, 1]      # ç¬¬ä¸€è¡Œç¬¬äºŒåˆ—çš„å€¼
```

### è¿ç®—ç¬¦é‡è½½

#### ç®—æœ¯è¿ç®—
```python
# åŸºæœ¬ç®—æœ¯è¿ç®—
result = ma5 + ma10
result = close - open
result = volume * 2
result = close / open
# åŸåœ°è¿ç®—
ma5 += 10
volume *= 1.5
```

#### æ¯”è¾ƒè¿ç®—
```python
# æ¯”è¾ƒè¿ç®—
signal = close > ma20
signal = volume >= volume.mean()
signal = rsi == 50
```

#### é€»è¾‘è¿ç®—
```python
# é€»è¾‘è¿ç®—
combined_signal = (close > ma20) & (volume > volume.mean())
either_signal = (rsi > 70) | (rsi < 30)
```

### æ•°æ®å¤„ç†ä¸è½¬æ¢

#### å†å²æ•°æ®è®¿é—®
```python
# è®¿é—®å†å²æ•°æ®
current_value = indicator.new        # å½“å‰å€¼
previous_value = indicator.prev      # å‰ä¸€ä¸ªå€¼
value_10_periods_ago = indicator.history(10)  # 10å‘¨æœŸå‰çš„å€¼
last_10_values = indicator.history(0, 10)     # æœ€è¿‘10ä¸ªå€¼
```

#### æ•°æ®å¡«å……
```python
# ç”Ÿæˆå¡«å……æ•°æ®
ones = indicator.ones        # å…¨1åºåˆ—
zeros = indicator.zeros      # å…¨0åºåˆ—
filled = indicator.full(100) # å¡«å……æŒ‡å®šå€¼çš„åºåˆ—
```

### å¤šæ¡ä»¶æ•°æ®å¤„ç†

#### ifs æ–¹æ³•
```python
# å¤šæ¡ä»¶æ•°æ®å¤„ç†
signal = indicator.ifs(
    condition1, value1,    # æ¡ä»¶1æ»¡è¶³æ—¶è®¾ä¸ºvalue1
    condition2, value2,    # æ¡ä»¶2æ»¡è¶³æ—¶è®¾ä¸ºvalue2
    other=default_value    # é»˜è®¤å€¼
)

# ç¤ºä¾‹ï¼šç”Ÿæˆäº¤æ˜“ä¿¡å·
long_signal = price.ifs(
    price > ma20, 1,       # ä»·æ ¼ä¸Šç©¿MA20æ—¶è®¾ä¸º1
    price < ma10, 0,       # ä»·æ ¼ä¸‹ç©¿MA10æ—¶è®¾ä¸º0
    other=0                # é»˜è®¤å€¼0ï¼ˆæ— ä¿¡å·ï¼‰
)
```

### æ»šåŠ¨çª—å£è®¡ç®—

#### åŸºæœ¬æ»šåŠ¨è®¡ç®—
```python
# æ»šåŠ¨çª—å£è®¡ç®—
rolling_mean = indicator.rolling(window=20).mean()
rolling_std = indicator.rolling(window=20).std()
rolling_max = indicator.rolling(window=20).max()
```

#### è‡ªå®šä¹‰æ»šåŠ¨å‡½æ•°
```python
# è‡ªå®šä¹‰æ»šåŠ¨å‡½æ•°
def custom_roll_func(window_data):
    return window_data.max() - window_data.min()

rolling_range = indicator.rolling_apply(custom_roll_func, window=20)
```

### å¤šå‘¨æœŸå¤„ç†

#### ä¸Šé‡‡æ ·
```python
# æŒ‡æ ‡ä¸Šé‡‡æ ·
minute_data = indicator.upsample()  # é»˜è®¤å‚æ•°
minute_data = indicator()
```

#### å¤šæŒ‡æ ‡å¹¶è¡Œè®¡ç®—
```python
# å¤šæŒ‡æ ‡å¹¶è¡Œè®¡ç®—
result1, result2, result3 = indicator.multi_apply(
    [func1, params1],  # ç¬¬ä¸€ä¸ªæŒ‡æ ‡
    [func2, params2],  # ç¬¬äºŒä¸ªæŒ‡æ ‡
    [func3, params3]   # ç¬¬ä¸‰ä¸ªæŒ‡æ ‡
)
```

### ç¬¬ä¸‰æ–¹æŒ‡æ ‡åº“é›†æˆ

```python
# ä½¿ç”¨PandasTAæŒ‡æ ‡
pandas_ta_result = indicator.pta.sma(length=20)

# ä½¿ç”¨TA-LibæŒ‡æ ‡
talib_result = indicator.talib.RSI(timeperiod=14)

# ä½¿ç”¨TulipæŒ‡æ ‡
tulip_result = indicator.tulip.wma(period=10)

# ä½¿ç”¨å†…ç½®æŒ‡æ ‡
btind_result = indicator.btind.pmax(period=14, multiplier=3)

# ä½¿ç”¨FinTaæŒ‡æ ‡
finta_result = indicator.finta.SMA(period=20)

# ä½¿ç”¨å¤©å‹¤æŒ‡æ ‡
tqfunc_result = indicator.tqfunc.barlast()

# ä½¿ç”¨å¤©å‹¤æŒ‡æ ‡
tqta_result = indicator.tqta.RSI()

# ä½¿ç”¨ä¿¡å·ç‰¹å¾
signal_features = indicator.sf.Binarizer()

# ä½¿ç”¨é…å¯¹äº¤æ˜“æŒ‡æ ‡
pair_result = indicator.pairtrading.bollinger_bands()

# ä½¿ç”¨å› å­åˆ†æ
factors: pd.DataFrame
factor_result = indicator.factors.single_asset_multi_factor_strategy(*factors)

# ä½¿ç”¨TradingViewæŒ‡æ ‡
gc = btdata.tradingview.G_Channels()
```

### ç»˜å›¾é…ç½®

#### åŸºæœ¬ç»˜å›¾è®¾ç½®
```python
# è®¾ç½®æŒ‡æ ‡åç§°
indicator.sname = "my_indicator"           #ç­–ç•¥é‡Œé¢å‘½åçš„å˜é‡åç§°
indicator.ind_name = "Custom Indicator"    #æŒ‡æ ‡åç§°

# è®¾ç½®ç»˜å›¾å¼€å…³
indicator.isplot = True  # å…¨éƒ¨æ˜¾ç¤º
indicator.isplot = {"line1": True, "line2": False}  # æŒ‰çº¿æ¡åè®¾ç½®

# è®¾ç½®ä¸»å›¾å åŠ 
indicator.overlap = True  # å…¨éƒ¨å åŠ 
indicator.overlap = {"line1": True, "line2": False}  # æŒ‰çº¿æ¡åè®¾ç½®

# è®¾ç½®ç»˜å›¾é«˜åº¦
indicator.height = 300  # æŒ‡æ ‡å›¾è¡¨æ˜¾ç¤ºé«˜åº¦
```

#### æ°´å¹³çº¿è®¾ç½®
```python
# æ·»åŠ æ°´å¹³çº¿
indicator.span_style = 50.0  # å•ä¸ªæ°´å¹³çº¿
indicator.span_style = SpanStyle(  # å®Œæ•´é…ç½®
    location=50.0,
    color="red",
    dash="dashed",
    width=2.0
)
```

### æ•°æ®ç±»å‹æ ‡è¯†

```python
# æ£€æŸ¥æ•°æ®ç±»å‹
is_indicator = indicator.isindicator  # æ˜¯å¦ä¸ºæŒ‡æ ‡
is_custom = indicator.iscustom        # æ˜¯å¦ä¸ºè‡ªå®šä¹‰æ•°æ®
is_mdim = indicator.isMDim            # æ˜¯å¦ä¸ºå¤šç»´æ•°æ®
is_main = indicator.ismain            # æ˜¯å¦åœ¨ä¸»å‘¨æœŸæ˜¾ç¤º
is_resample = indicator.isresample    # æ˜¯å¦ä¸ºè½¬æ¢æ•°æ®
is_replay = indicator.isreplay        # æ˜¯å¦ä¸ºå›æ”¾æ•°æ®
is_candles = indicator.iscandles      # æ˜¯å¦ä¸ºèœ¡çƒ›å›¾
is_signal = indicator.issignal        # æ˜¯å¦åŒ…å«äº¤æ˜“ä¿¡å·
```

### ç­–ç•¥å…³è”

```python
# è·å–å…³è”çš„ç­–ç•¥å’Œæ•°æ®
strategy = indicator.strategy_instance  # å…³è”çš„ç­–ç•¥å®ä¾‹
bt_data = indicator.kline               # å…³è”çš„Kçº¿æ•°æ®

# è·å–ç­–ç•¥IDå’Œç´¢å¼•
strategy_id = indicator.strategy_id    # ç­–ç•¥ID
plot_id = indicator.plot_id            # ç»˜å›¾ID
data_id = indicator.data_id            # æ•°æ®ID
resample_id = indicator.resample_id    # è½¬æ¢ID
replay_id = indicator.replay_id        # å›æ”¾ID

# è·å–å›æµ‹çŠ¶æ€
current_index = indicator.btindex      # å½“å‰å›æµ‹ç´¢å¼•
is_live = indicator.islivetrading      # æ˜¯å¦ä¸ºå®ç›˜äº¤æ˜“
```

## ğŸ¯ é«˜çº§åŠŸèƒ½

### å¤šå‘¨æœŸç­–ç•¥ç¤ºä¾‹

```python
from minibt import *


class MultiTimeframeStrategy(Strategy):
    def __init__(self):
        # ä¸»æ•°æ®ï¼ˆ1åˆ†é’Ÿï¼‰
        self.data_1m = self.get_data(LocalDatas.v2509_60)
        # è½¬æ¢åˆ°5åˆ†é’Ÿæ•°æ®
        self.data_5m = self.data_1m.resample(300)
        # åœ¨ä¸åŒå‘¨æœŸä¸Šè®¡ç®—æŒ‡æ ‡
        self.ma_1m = self.data_1m.close.sma(20)
        # æ•°æ®ä¸Šé‡‡æ ·
        self.ma_5m = self.data_5m.close.sma(20)()
        self.ma_5m.overlap = True
        # äº¤æ˜“ä¿¡å·
        self.long_signal = self.ma_1m.cross_up(self.ma_5m)
        self.short_signal = self.ma_1m.cross_down(self.ma_5m)

    def next(self):
        if not self.data_1m.position:
            # å¤šå‘¨æœŸä¿¡å·ç»„åˆ
            if self.long_signal.new:
                self.buy()
            elif self.short_signal.new:
                self.sell()
        elif self.data_1m.position > 0 and self.short_signal.new:
            self.sell()
        elif self.data_1m.position < 0 and self.long_signal.new:
            self.buy()


if __name__ == "__main__":
    Bt().run()
```

### è‡ªå®šä¹‰æŒ‡æ ‡æ„é€ å™¨

#### å¤æ‚æŒ‡æ ‡ç¤ºä¾‹ï¼ˆG-Channelsï¼‰

```python
from minibt import *


class G_Channels(BtIndicator):
    """G-ChannelsæŒ‡æ ‡ - é«˜æ•ˆè®¡ç®—ä¸Šä¸‹æå€¼é€šé“"""
    params = dict(length=144., cycle=1)
    overlap = True  # ä¸»å›¾å åŠ æ˜¾ç¤º

    def next(self):
        length = self.params.length
        cycle = min(max(int(self.params.cycle), 1), 3)
        size = self.close.size
        a = self.full()  # ä¸Šé€šé“
        b = self.full()  # ä¸‹é€šé“
        close = self.close.values
        pre_a = 0.
        pre_b = 0.
        # è®¡ç®—é€šé“
        for i in range(size):
            if i and i % cycle == 0:
                a[i] = max(close[i], pre_a) - (pre_a - pre_b) / length
                b[i] = min(close[i], pre_b) + (pre_a - pre_b) / length
                pre_a = a[i]
                pre_b = b[i]
        # å‘¨æœŸå¤§äº1æ—¶è¿›è¡Œæ’å€¼
        if cycle > 1:
            a = a.interpolate()
            b = b.interpolate()
        # è®¡ç®—ä¸­è½¨
        avg = (a + b) / 2.
        return a, b, avg  # è¿”å›ä¸Šè½¨ã€ä¸‹è½¨ã€ä¸­è½¨


class MyStrategy(Strategy):
    def __init__(self):
        self.data = self.get_data(LocalDatas.v2509_60)
        self.data.height = 600
        self.G_Channels = G_Channels(self.data)
        self.G_Channels.a.line_style = LineStyle(
            LineDash.solid, 2, Colors.blue),     # ä¸Šè½¨æ ·å¼
        self.G_Channels.b.line_style = LineStyle(
            LineDash.solid, 2, Colors.red),      # ä¸‹è½¨æ ·å¼
        self.G_Channels.avg.line_style = LineStyle(
            LineDash.dotted, 3, Colors.gray)     # ä¸­è½¨æ ·å¼


if __name__ == "__main__":
    Bt().run()
```

<center>
<img src="https://pic3.zhimg.com/v2-169d274aa723107fadea8bb06e7eaf0e_1440w.jpg" 
  alt="G-ChannelsæŒ‡æ ‡" 
  class="center-img">
</center>

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼è¯·å‚é˜… [CONTRIBUTING.md](CONTRIBUTING.md) äº†è§£å¦‚ä½•å‚ä¸é¡¹ç›®å¼€å‘ã€‚

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ“ è”ç³»æˆ‘ä»¬

- **GitHubä»“åº“**: [https://github.com/MiniBtMaster/minibt](https://github.com/MiniBtMaster/minibt)
- **PyPIé¡¹ç›®**: [https://pypi.org/project/minibt/](https://pypi.org/project/minibt/)
- **æ•™ç¨‹ç½‘ç«™**: [https://www.minibt.cn](https://www.minibt.cn)
- **è”ç³»é‚®ç®±**: 407841129@qq.com
- **ä½œè€…**: owen


## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒï¼š

- [NumPy](https://numpy.org/) - ç§‘å­¦è®¡ç®—åŸºç¡€åº“
- [Pandas](https://pandas.pydata.org/) - æ•°æ®åˆ†æå·¥å…·
- [TA-Lib](https://ta-lib.org/) - æŠ€æœ¯åˆ†ææŒ‡æ ‡åº“
- [Pandas-TA](https://github.com/twopirllc/pandas-ta) - PandasæŠ€æœ¯åˆ†ææ‰©å±•
- [Bokeh](https://bokeh.org/) - äº¤äº’å¼å¯è§†åŒ–åº“
- [Optuna](https://optuna.org/) - è¶…å‚æ•°ä¼˜åŒ–æ¡†æ¶
- [TQSDK](https://www.shinnytech.com/tqsdk/) - å¤©å‹¤é‡åŒ–äº¤æ˜“æ¥å£
- [ElegantRL](https://github.com/AI4Finance-Foundation/ElegantRL) - å¼ºåŒ–å­¦ä¹ æ¡†æ¶

---

**æ³¨æ„**: MiniBT ç›®å‰å¤„äºæ´»è·ƒå¼€å‘é˜¶æ®µï¼Œå»ºè®®å…³æ³¨é¡¹ç›®æ›´æ–°ä»¥è·å–æœ€æ–°åŠŸèƒ½å’Œä¼˜åŒ–ã€‚æ¬¢è¿è¯•ç”¨å¹¶æä¾›åé¦ˆï¼
