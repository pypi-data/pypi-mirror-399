import{r,E as G,_ as M,F as E,bd as T,e as h,n as Z,W as dt,l as pt,k as ft,aa as bt,aR as _,o as W,j as p,p as mt,ab as gt,ac as ht,ad as yt,Z as It,ay as X}from"./index.CS3tpmQq.js";import{I as Tt}from"./InputInstructions.DNVNePDU.js";import{u as Ct}from"./FormClearHelper.DyKNX1aO.js";import{s as wt}from"./sprintf.DpPCfzXw.js";import{u as vt}from"./uniqueId.C-ekQlC4.js";import{I as St}from"./input.C1Qtlpog.js";import"./base-input.DfcQke7n.js";var J=r.forwardRef(function(t,e){var a={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return r.createElement(G,M({iconAttrs:a,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},t,{ref:e}),r.createElement("path",{d:"M0 3v2h8V3H0z"}))});J.displayName="Minus";var Q=r.forwardRef(function(t,e){var a={fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"};return r.createElement(G,M({iconAttrs:a,iconVerticalAlign:"middle",iconViewBox:"0 0 8 8"},t,{ref:e}),r.createElement("path",{d:"M3 0v3H0v2h3v3h2V5h3V3H5V0H3z"}))});Q.displayName="Plus";const Vt=E("div",{target:"eaba2yi0"})(({theme:t})=>({display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",height:t.sizes.minElementHeight,borderWidth:t.sizes.borderWidth,borderStyle:"solid",borderColor:t.colors.widgetBorderColor??t.colors.secondaryBg,transitionDuration:"200ms",transitionProperty:"border",transitionTimingFunction:"cubic-bezier(0.2, 0.8, 0.4, 1)",borderRadius:t.radii.default,overflow:"hidden","&.focused":{borderColor:t.colors.primary},input:{MozAppearance:"textfield","&::-webkit-inner-spin-button, &::-webkit-outer-spin-button":{WebkitAppearance:"none",margin:t.spacing.none}}})),xt=E("div",{target:"eaba2yi1"})({display:"flex",flexDirection:"row",alignSelf:"stretch"}),K=E("button",{target:"eaba2yi2"})(({theme:t})=>({margin:t.spacing.none,border:"none",height:t.sizes.full,display:"flex",alignItems:"center",width:t.sizes.numberInputControlsWidth,justifyContent:"center",color:t.colors.bodyText,transition:"color 300ms, backgroundColor 300ms",backgroundColor:t.colors.secondaryBg,"&:hover:enabled, &:focus:enabled":{color:t.colors.white,backgroundColor:t.colors.primary,transition:"none",outline:"none"},"&:active":{outline:"none",border:"none"},"&:disabled":{cursor:"not-allowed",color:t.colors.fadedText40}})),kt=E("div",{target:"eaba2yi3"})(({theme:t,clearable:e})=>({position:"absolute",marginRight:t.spacing.twoXS,left:0,right:`calc(${t.sizes.numberInputControlsWidth} * 2 + ${e?"1em":"0em"})`})),Dt=dt.getLogger("NumberInput");function Et(t){return h(t)||t===""?void 0:t}const D=({value:t,format:e,step:a,dataType:b})=>{if(h(t))return null;let o=Et(e);if(h(o)&&Z(a)){const i=a.toString();b===T.DataType.FLOAT&&a!==0&&i.includes(".")&&(o=`%0.${i.split(".")[1].length}f`)}if(h(o))return t.toString();try{return wt.sprintf(o,t)}catch(i){return Dt.warn(`Error in sprintf(${o}, ${t}): ${i}`),String(t)}},Rt=(t,e,a)=>h(t)?!1:t-e>=a,Nt=(t,e,a)=>h(t)?!1:t+e<=a,Ft=t=>(t.element.dataType===T.DataType.INT?t.widgetMgr.getIntValue(t.element):t.widgetMgr.getDoubleValue(t.element))??t.element.default??null,q=({step:t,dataType:e})=>t||(e===T.DataType.INT?1:.01),zt=({disabled:t,element:e,widgetMgr:a,fragmentId:b})=>{const o=pt(),{dataType:i,id:S,formId:f,default:L,format:m,icon:R,min:y,max:I}=e,{width:B,elementRef:Y}=ft(),[s,tt]=r.useState(()=>q(e)),U=Ft({element:e,widgetMgr:a}),[g,C]=r.useState(!1),[l,w]=r.useState(U),[H,P]=r.useState(!1),V=r.useRef(null),A=r.useRef(vt("number_input_")),[$,v]=r.useState(()=>D({value:U,dataType:i,format:m,step:s})),x=Rt(l,s,y),k=Nt(l,s,I),O=bt({formId:f}),et=O?a.allowFormEnterToSubmit(f):g,ot=H&&B>o.breakpoints.hideWidgetDetails;r.useEffect(()=>{tt(q({step:e.step,dataType:e.dataType}))},[e.dataType,e.step]),r.useEffect(()=>{g||v(D({value:l,dataType:i,format:m,step:s}))},[i,m,s]);const u=r.useCallback(({value:n,source:c})=>{if(Z(n)&&(y>n||n>I))V.current?.reportValidity();else{const d=n??L??null;switch(i){case T.DataType.INT:a.setIntValue({id:S,formId:f},d,c,b);break;case T.DataType.FLOAT:a.setDoubleValue({id:S,formId:f},d,c,b);break;default:throw new Error("Invalid data type")}C(!1),w(d),v(D({value:d,dataType:i,format:m,step:s}))}},[y,I,V,a,b,s,i,S,f,L,m]),rt=r.useCallback(()=>{g&&u({value:l,source:{fromUi:!0}}),P(!1)},[g,l,u]),nt=r.useCallback(()=>{P(!0)},[]),j=r.useCallback(()=>{const{value:n}=e;e.setValue=!1,w(n??null),v(D({value:n??null,dataType:i,format:m,step:s})),u({value:n??null,source:{fromUi:!1}})},[e,s,u,i,m]);r.useEffect(()=>{e.setValue?j():u({value:l,source:{fromUi:!1}});const n=V.current;if(n){const c=d=>{d.preventDefault()};return n.addEventListener("wheel",c),()=>{n.removeEventListener("wheel",c)}}},[]),e.setValue&&j();const N=h(e.default)&&!t,at=r.useCallback(()=>{const n=e.default??null;w(n),u({value:n,source:{fromUi:!0}})},[e]);Ct({element:e,widgetMgr:a,onFormCleared:at});const st=n=>{const{value:c}=n.target;if(c==="")C(!0),w(null),v(null);else{let d;e.dataType===T.DataType.INT?d=parseInt(c,10):d=parseFloat(c),C(!0),w(d),v(c)}},F=r.useCallback(()=>{k&&(C(!0),u({value:(l??y)+s,source:{fromUi:!0}}))},[l,y,s,k]),z=r.useCallback(()=>{x&&(C(!0),u({value:(l??I)-s,source:{fromUi:!0}}))},[l,I,s,x]),it=r.useCallback(n=>{const{key:c}=n;switch(c){case"ArrowUp":n.preventDefault(),F();break;case"ArrowDown":n.preventDefault(),z();break}},[F,z]),lt=r.useCallback(n=>{n.key==="Enter"&&(g&&u({value:l,source:{fromUi:!0}}),a.allowFormEnterToSubmit(f)&&a.submitForm(f,b))},[g,l,u,a,f,b]),ct=_(o.iconSizes.lg)+2*_(o.spacing.twoXS),ut=R?o.breakpoints.hideNumberInputControls+ct:o.breakpoints.hideNumberInputControls;return W("div",{className:"stNumberInput","data-testid":"stNumberInput",ref:Y,children:[p(ht,{label:e.label,disabled:t,labelVisibility:mt(e.labelVisibility?.value),htmlFor:A.current,children:e.help&&p(gt,{content:e.help,label:e.label})}),W(Vt,{className:H?"focused":"","data-testid":"stNumberInputContainer",children:[p(St,{type:"number",inputRef:V,value:$??"",placeholder:e.placeholder,onBlur:rt,onFocus:nt,onChange:st,onKeyPress:lt,onKeyDown:it,clearable:N,clearOnEscape:N,disabled:t,"aria-label":e.label,startEnhancer:e.icon&&p(It,{"data-testid":"stNumberInputIcon",iconValue:e.icon,size:"lg"}),id:A.current,overrides:{ClearIconContainer:{style:{padding:0}},ClearIcon:{props:{overrides:{Svg:{style:{color:o.colors.grayTextColor,padding:o.spacing.threeXS,height:o.sizes.clearIconSize,width:o.sizes.clearIconSize,":hover":{fill:o.colors.bodyText}}}}}},Input:{props:{"data-testid":"stNumberInputField",step:s,min:y,max:I,type:"number",inputMode:""},style:{fontWeight:o.fontWeights.normal,lineHeight:o.lineHeights.inputWidget,paddingRight:o.spacing.sm,paddingLeft:o.spacing.md,paddingBottom:o.spacing.sm,paddingTop:o.spacing.sm,"::placeholder":{color:o.colors.fadedText60}}},InputContainer:{style:()=>({borderTopRightRadius:0,borderBottomRightRadius:0})},Root:{style:{borderTopRightRadius:0,borderBottomRightRadius:0,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeftWidth:0,borderRightWidth:0,borderTopWidth:0,borderBottomWidth:0,paddingRight:0,paddingLeft:R?o.spacing.sm:0}},StartEnhancer:{style:{paddingLeft:0,paddingRight:0,minWidth:o.iconSizes.lg,color:yt(R)?o.colors.fadedText60:"inherit"}}}}),B>ut&&W(xt,{children:[p(K,{"data-testid":"stNumberInputStepDown",onClick:z,disabled:!x||t,tabIndex:-1,children:p(X,{content:J,size:"xs",color:x?"inherit":o.colors.fadedText40})}),p(K,{"data-testid":"stNumberInputStepUp",onClick:F,disabled:!k||t,tabIndex:-1,children:p(X,{content:Q,size:"xs",color:k?"inherit":o.colors.fadedText40})})]})]}),ot&&p(kt,{clearable:N,children:p(Tt,{dirty:g,value:$??"",inForm:O,allowEnterToSubmit:et})})]})},$t=r.memo(zt);export{$t as default};
