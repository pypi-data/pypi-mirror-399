Metadata-Version: 2.4
Name: tina-python
Version: 0.4.9rc0
Summary: tina is in your computer!
Home-page: https://gitee.com/wang-churi/tina
Author: ç‹å‡ºæ—¥
Author-email: wangchuri@163.com
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: Apache Software License
Classifier: Operating System :: OS Independent
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: httpx
Requires-Dist: dotenv
Provides-Extra: mcp
Requires-Dist: mcp-python; extra == "mcp"
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# å¦‚ä½•å®‰è£…tina

```bash
pip install tina-python
```
å¦‚æœéœ€è¦ä½¿ç”¨MCPæœåŠ¡(MCPå³æ¨¡å‹ä¸Šä¸‹æ–‡åè®®)
```bash
pip install tina-python[mcp]
```
## æºä»£ç 
tinaéœ€è¦ä»¥ä¸‹ä¾èµ–ï¼š
```
æœ€åŸºç¡€çš„ä¾èµ–ï¼š
httpx
dotenv
ä½¿ç”¨MCPæœåŠ¡ï¼š
mcp-python
```
```bash
cd [æºä»£ç æ–‡ä»¶å¤¹]
pip install -r requirements.txt
```

- [ä»‹ç»](#tinaæ˜¯ä»€ä¹ˆ)
- [å¿«é€Ÿå¼€å§‹](#ä¸€ä»ä¸€ä¸ªtinaå¼€å§‹æ¥è§¦)
# tinaæ˜¯ä»€ä¹ˆ?
tinaæ˜¯ä¸€ä¸ªç®€å•çš„åŸºäºå¤§æ¨¡å‹çš„æ™ºèƒ½ä½“åº“ï¼Œ

ä¸€å¼€å§‹ä½¿ç”¨çš„OpenAI SDKï¼Œåé¢æƒ³è¦æ‰©å±•åŠŸèƒ½çš„æ—¶å€™ä½¿ç”¨äº†LangChain å‘ç°æˆ‘æƒ³è¦çš„åŠŸèƒ½ä»‹äºè¿™ä¸¤ç§ä¹‹é—´
æœ‰çš„æ—¶å€™ä¹Ÿè®¸æˆ‘åªæƒ³è¦è°ƒç”¨ä¸€ä¸ªå¤§æ¨¡å‹è·å¾—ä¸€ä¸ªè¾“å‡ºï¼Œç”¨ä¸ç€å…¶ä»–çš„å¾ˆå¤šåŠŸèƒ½ï¼Œè€Œä¸”ä½¿ç”¨æ–¹å¼ä¸æ˜¯å¾ˆç¬¦åˆæˆ‘çš„ç›´è§‰ï¼Œæ‰€ä»¥æˆ‘è‡ªå·±ç”¨httpxè‡ªå·±å°è£…äº†ä¸€ä¸ªç®€å•çš„åº“

ä½ å¯ä»¥ç”¨å®ƒæ¥åšä¸€ä¸ªå¿«é€Ÿçš„å¤§æ¨¡å‹åº”ç”¨çš„åŸå‹éªŒè¯ï¼Œå½“ç„¶å¥¹åªæ˜¯æˆ‘ä¸€ä¸ªå¤§å­¦çš„å…´è¶£ä½¿ç„¶å¼€å‘çš„ä¸€ä¸ªäº§ç‰©ï¼Œåšæˆ‘ç»ƒä¹ pythonçš„ä½œå“ï¼Œå¦‚æœè¿½æ±‚ç¨³å®šè¯·å»ä½¿ç”¨langchainç­‰æˆç†Ÿçš„æ¡†æ¶å“¦
```python
#ç®€å•çš„è°ƒç”¨å¤§æ¨¡å‹æ¥ç¿»è¯‘ä¸€ä¸ªå¥å­
from tina.llm import BaseAPI

llm = BaseAPI(
    api_key="å¡«å†™ä½ è‡ªå·±çš„api",
    base_url="ä½ é€‰æ‹©çš„APIæä¾›å•†",
    model="æ¨¡å‹åç§°"
)
result = llm.predict(
    input_text = "å¸®æˆ‘ç¿»è¯‘ä¸€ä¸‹è¿™å¥è¯ï¼šHello tina",
    sys_prompt = "ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„ç¿»è¯‘å®¶...",
)
print(result)
```
```python
#å°è¯•ä¸€ä¸‹å¤§æ¨¡å‹è°ƒç”¨å·¥å…·çš„èƒ½åŠ›
from tina import Agent,Tools
from tina.llm import BaseAPI
# æˆ‘ä»¬ä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„promptæ¥ä¾›ä½ ä½¿ç”¨
system_prompt = "ä½ æ˜¯ä¸€ä¸ªAgentï¼Œè¯·çµæ´»çš„ä½¿ç”¨å·¥å…·æ¥å®Œæˆæˆ‘çš„ä»»åŠ¡"
tools = Tools()
llm = BaseAPI(
    api_key="å¡«å†™ä½ è‡ªå·±çš„api",
    base_url="ä½ é€‰æ‹©çš„APIæä¾›å•†",
    model="æ¨¡å‹åç§°"
)
agent = Agent(
    llm = llm,
    tools = tools,
    system_prompt = system_prompt # ä¼ é€’ä½ çš„prompt
)

result = agent.predict(
    input_text = "ç°åœ¨å‡ ç‚¹äº†",
)

for i in result:
    print(i,end="")

```
```python
# åˆ©ç”¨MCPæ¥æ›´å¥½çš„æ‰©å±•Agentçš„åŠŸèƒ½
# é­”å¡”çš„MCPå¹¿åœº https://www.modelscope.cn/mcp
from tina import Agent,Tools
from tina.llm import BaseAPI
from tina.mcp import MCPClient

# å®ä¾‹åŒ–ä¸€ä¸ªMCPæœåŠ¡å™¨å¹¶ä¸”æ·»åŠ ä¸€ä¸ªæœåŠ¡
mcp = MCPClient()
mcp.add_server(
    server_id="playwright", 
    config={
        "type":"stdio",
        "command":"npx",
        "args":["@playwright/mcp@latest"]
    }
)
system_prompt = "ä½ æ˜¯ä¸€ä¸ªæµè§ˆå™¨è‡ªåŠ¨åŒ–åŠ©æ‰‹"

llm = BaseAPI(
    api_key="å¡«å†™ä½ è‡ªå·±çš„api",
    base_url="ä½ é€‰æ‹©çš„APIæä¾›å•†",
    model="æ¨¡å‹åç§°"
)
tools = Tools()

agent = Agent(
    llm=llm,
    tools=tools,
    mcp=MCP,
    system_prompt = system_prompt
)# MCPçš„å·¥å…·ä¼šè¢«å¤§æ¨¡å‹ä¸»åŠ¨çš„è°ƒç”¨
result = agent.predict(
    input_text= "å¯¼èˆªå»bing",
)
for i in result:
    print(i,end="")
```

`æ³¨æ„ï¼štinaåªåŒ…å«äº†å°‘é‡åŸºæœ¬å·¥å…·ï¼Œä¸åŒ…æ‹¬å…¶ä»–å·¥å…·ï¼Œåªæ˜¯è¯´ï¼Œæˆ‘å¯ä»¥è®©ä½ æ–¹ä¾¿çš„ç»™å¤§æ¨¡å‹éƒ¨ç½²å·¥å…·æ¥ç©ï¼Œä½ æ›´å¤šéœ€è¦è€ƒè™‘å·¥å…·æ€ä¹ˆå®ç°`

æ¯”å¦‚ä½ å†™äº†ä¸€ä¸ªå‡½æ•°ï¼Œä½¿ç”¨Toolsç±»çš„æ–¹æ³•å°±å¯ä»¥å°†å·¥å…·ä¿¡æ¯æäº¤ä¹‹åï¼Œè®¾ç½®ä¸€ä¸ªæ™ºèƒ½ä½“å°±å¯ä»¥ä½¿ç”¨äº†ï¼Œå…·ä½“è¯·çœ‹ä¸‹é¢çš„å§

å¥¹åŒ…å«ä»¥ä¸‹å†…å®¹ï¼š

### 1.ç®€å•çš„è°ƒç”¨å¤§æ¨¡å‹
åªéœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªå¤§æ¨¡å‹å¯¹è±¡ï¼Œå³å¯é€šè¿‡è®¾å®šæ–¹æ³•çš„å‚æ•°å³å¯ï¼›
### 2.å·¥å…·è°ƒç”¨æœºåˆ¶
ä½ åªéœ€è¦å†™å¥½å·¥å…·çš„Pythonä»£ç ï¼Œç„¶åé€šè¿‡Toolsçš„æ–¹æ³•æ³¨å†Œå·¥å…·ï¼Œè‡ªåŠ¨è¿è¡Œå’Œè§£æ
### 3.è®¾å®šAgent
è®¾å®šä¸€ä¸ªæ™ºèƒ½ä½“ï¼Œåªéœ€è¦å°†ä¸Šé¢çš„å¤§æ¨¡å‹ï¼Œå·¥å…·å®ä¾‹åŒ–ï¼Œé€šè¿‡å‚æ•°è®¾å®šå®ä¾‹åŒ–agentå³å¯ï¼Œå’Œè°ƒç”¨å’Œå¤§æ¨¡å‹ä¸€æ ·ç®€å•
### 4.æ¨¡å—åŒ–è®¾è®¡
è¿™æ„å‘³ç€ä»¥ä¸Šçš„åŠŸèƒ½ä½ éƒ½å¯ä»¥æ‹†å¼€æ¥ç”¨ï¼Œé€‰æ‹©ä½ å–œæ¬¢çš„éƒ¨åˆ†è¿›è¡Œ


# ä¸€.ä»ä¸€ä¸ªtinaå¼€å§‹æ¥è§¦
tinaä¸­çš„Tinaæ˜¯ä¸€ä¸ªåœ¨æ§åˆ¶å°å®ç°çš„Agent,ä½œä¸ºtinaçš„AIè¯´æ˜ä¹¦ï¼Œå¥¹é»˜è®¤æºå¸¦äº†å®Œæ•´çš„readmeï¼Œä½ å¯ä»¥ç›´æ¥é—®å¥¹å…³äºtinaæ¡†æ¶æ€ä¹ˆä½¿ç”¨çš„äº‹
```python
from tina import Tina
my_tina = Tina()
#ä½¿ç”¨runæ¥å¯åŠ¨
my_tina.run()
```
å½“ä½ æˆåŠŸå¯åŠ¨åï¼Œå¯ä»¥çœ‹åˆ°ä¸‹é¢è¿™æ ·çš„é¡µé¢
```console
(Â´â–½`Êƒâ™¡Æª)"  tina by QiQi in ğŸŒŸ XIMO


ğŸ˜Š æ¬¢è¿ä½¿ç”¨tinaï¼Œä½ å¯ä»¥è¾“å…¥#helpæ¥æŸ¥çœ‹å¸®åŠ©
ğŸ¤” é€€å‡ºå¯¹è¯ï¼š"#exit"


( â€¢ Ì€Ï‰â€¢Ì ) >>>User:
```
å¥¹å¯ä»¥å›ç­”å…³äºtinaæ¡†æ¶çš„é—®é¢˜ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸€ä¸ªæ¯”è¾ƒå…¨èƒ½çš„æ™ºèƒ½ä½“

# äºŒ.å®ä¾‹åŒ–ä¸€ä¸ªå¤§æ¨¡å‹
## 1.æœ¬åœ°æ¨¡å‹ä½¿ç”¨
åœ¨0.5.0ç‰ˆæœ¬æš‚æ—¶ç§»é™¤äº†æœ¬åœ°æ¨¡å‹çš„ä½¿ç”¨ï¼ŒåæœŸä¼šé€šè¿‡llama.cppè¿›è¡Œæœ¬åœ°æ¨¡å‹è°ƒç”¨
## 2.apiè°ƒç”¨
è¾“å‡ºå‚æ•°æ ¼å¼è§£é‡Šï¼š
```
å¤§æ¨¡å‹çš„è¾“å‡ºä¼šè¢«è§£æä¸ºä¸‹é¢çš„å­—å…¸æ ¼å¼
ä¸‹é¢æ˜¯æœ€åŸºæœ¬çš„è¾“å‡ºï¼Œè¿™ä¸¤ä¸ªé”®ä¼šä¸€ç›´å­˜åœ¨ï¼Œä¸ç®¡æœ‰æ²¡æœ‰å€¼
{
    "role":"assistant",#å­—ç¬¦ä¸²
    "content":"",#å­—ç¬¦ä¸²
}
ä¸‹é¢æ˜¯åªæœ‰è·å–åˆ°ç›¸å…³çš„è¾“å‡ºæ‰ä¼šè¿”å›çš„é”®
{
    "reasoning_content":""#å¦‚æœä½¿ç”¨æ¨ç†æ¨¡å‹ï¼Œæ¨ç†çš„å†…å®¹ä¼šåœ¨è¿™é‡Œï¼Œstr
    "tool_name":#å‡ºç°äº†å·¥å…·åç§°æ‰ä¼šè¿”å›ã€‚str
    "tool_arguments":#å‡ºç°äº†å·¥å…·å‚æ•°æ‰ä¼šå‡ºç°ï¼Œstr
    "tool_calls":#å‡ºç°äº†å®Œæ•´çš„å·¥å…·è°ƒç”¨æ‰ä¼šå‡ºç°ï¼Œlist
}
tool_callsä¸­æ¯ä¸€é¡¹çš„æ ¼å¼å¦‚ä¸‹
{
    "index": index,
    "function": {"arguments": ""},
    "type": "",
    "id": ""
}
```
APIéœ€è¦çš„å‚æ•°ï¼Œæ¯”å¦‚api_key base_urlå’Œmodel_nameï¼Œåœ¨å¼€å‘ç¯å¢ƒä¸‹æ¨èä½¿ç”¨.envæ–‡ä»¶

ä¸‹é¢æ˜¯ä¸ª.envæ–‡ä»¶çš„ç¤ºä¾‹ï¼Œå®ä¾‹åŒ–çš„å¤§æ¨¡å‹ç±»ä¼šé»˜è®¤è¯»å–å½“å‰ç»ˆç«¯ç›®å½•ä¸‹çš„`tina.env`æ–‡ä»¶ï¼š
```
LLM_API_KEY=""
BASE_URL="" //æ³¨æ„ï¼Œæˆ‘ä¸ä¼šé»˜è®¤æ·»åŠ /chat/completions å¦‚æœæŸ¥è¯¢åˆ°æ˜¯openaiæ ¼å¼çš„ï¼Œè¯·æ‰‹åŠ¨æ·»åŠ /chat/completions
MODEL_NAME = ""
MAX_INPUT = 8000 #æœ€å¤§çš„è¾“å…¥å­—ç¬¦æ•°
```

### predict() apredict()
predict()æ˜¯åŒæ­¥æ–¹æ³•  
apredict()æ˜¯å¼‚æ­¥æ–¹æ³•  
ä¸¤è€…å‚æ•°ä¸€è‡´ï¼Œåªæ˜¯è°ƒç”¨æ–¹æ³•ä¸åŒ
> æ³¨æ„ï¼šä½¿ç”¨åŒæ­¥çš„æ–¹æ³•çš„æ—¶å€™ï¼Œä¸å¯ä»¥æ³¨å†Œå¼‚æ­¥çš„å·¥å…·ï¼Œä½†æ˜¯apredict()æ–¹æ³•å¯ä»¥åŒæ—¶æ³¨å†ŒåŒæ­¥å·¥å…·å’Œå¼‚æ­¥å·¥å…·  
```python
from tina.llm import BaseAPI
llm = BaseAPI()

# 1. å•æ¬¡å¯¹è¯ï¼Œç”¨äºå¿«é€Ÿè·å¾—å•æ¬¡çš„å¤§æ¨¡å‹è¾“å‡º
# éæµå¼è¾“å‡º
result = llm.predict(
    input_text = "è¯·å¸®æˆ‘ç¿»è¯‘è¿™å¥è¯ï¼šHello tina",
    sys_prompt = "ä½ ä½œä¸ºä¸€ä¸ªä¸“ä¸šçš„ç¿»è¯‘å®¶",
    stream=False # è®¾ç½®streamå‚æ•°æ¥è·å–éæµå¼è¾“å‡º
)
# é€šè¿‡"content"å¯ä»¥è·å–è¾“å‡ºç»“æœ
print(result["content"])

# æµå¼è¾“å‡º
result = llm.predict(
    input_text = "è¯·å¸®æˆ‘ç¿»è¯‘è¿™å¥è¯ï¼šHello tina",
    sys_prompt = "ä½ ä½œä¸ºä¸€ä¸ªä¸“ä¸šçš„ç¿»è¯‘å®¶",
    stream=True 
)
# è¿”å›çš„æ˜¯ç”Ÿæˆå™¨
for chunk in result:
    print(chunk["content"],end="")

# 2. è‡ªå·±è®¾ç½®messageså‚æ•°æ¥è®¾ç½®å¯¹è¯ä¸Šä¸‹æ–‡ï¼Œå®ç°å¤šæ¬¡å¯¹è¯
messages = [
    {"role": "system", "content": "ä½ ä½œä¸ºä¸€ä¸ªä¸“ä¸šçš„ç¿»è¯‘å®¶"},
    {"role": "user", "content": "è¯·å¸®æˆ‘ç¿»è¯‘è¿™å¥è¯ï¼šHello tina"}ï¼Œ
    {"role": "assistant", "content": "..."}ï¼Œ
    {"role": "user", "content": "è¯·å¸®æˆ‘ç¿»è¯‘è¿™å¥è¯ï¼šHello anit"}ï¼Œ
]
result = llm.predict(
    input_text = "è¯·å¸®æˆ‘ç¿»è¯‘è¿™å¥è¯ï¼šHello tina", # è¿™é‡Œä½¿ç”¨input_textå‚æ•°ï¼Œä¼šè‡ªåŠ¨åœ°å¸®ä½ æ·»åŠ åˆ°messagesä¸­ï¼Œç­‰ä»·äºä½ è‡ªå·±appendä¸€ä¸ªuseræ¶ˆæ¯
    messages = messages,
    stream=True
)
for chunk in result:
    print(chunk["content"],end="")
```

#### predict() å’Œ apredict() æ–¹æ³•è¯¦è§£

è°ƒç”¨å¤§è¯­è¨€æ¨¡å‹æ‰§è¡Œé¢„æµ‹ä»»åŠ¡ï¼Œæ”¯æŒå•æ¬¡å¯¹è¯å’Œå¤šè½®å¯¹è¯æ¨¡å¼

æ­¤æ–¹æ³•ä½œä¸ºç»Ÿä¸€å…¥å£ï¼Œæ ¹æ®streamå‚æ•°è‡ªåŠ¨è°ƒç”¨å¯¹åº”çš„ä¸“ç”¨æ–¹æ³•ï¼š
- stream=False: è°ƒç”¨ predict_no_stream()
- stream=True: è°ƒç”¨ predict_stream()

##### å‚æ•°è¯´æ˜

| å‚æ•°å | ç±»å‹ | è¯´æ˜ | é»˜è®¤å€¼ |
|--------|------|------|--------|
| input_text | str, optional | ç”¨æˆ·è¾“å…¥æ–‡æœ¬ | None |
| sys_prompt | str, optional | ç³»ç»Ÿæç¤ºè¯ | "ä½ çš„å·¥ä½œéå¸¸çš„å‡ºè‰²ï¼" |
| messages | list, optional | å†å²å¯¹è¯æ¶ˆæ¯åˆ—è¡¨ã€‚æ ¼å¼ä¸º: [{"role": "system", "content": "..."}, {"role": "user", "content": "..."}, {"role": "assistant", "content": "..."}] | None |
| temperature | float, optional | ç”Ÿæˆæ–‡æœ¬çš„éšæœºæ€§å‚æ•° (0.0-1.0) | 1.0 |
| top_p | float, optional | æ ¸é‡‡æ ·å‚æ•° (0.0-1.0) | 0.9 |
| top_k | int, optional | Top-Ké‡‡æ ·å‚æ•°ï¼Œé™åˆ¶å€™é€‰è¯æ±‡æ•°é‡ã€‚æ³¨æ„ï¼šä¸æ˜¯æ‰€æœ‰æ¨¡å‹éƒ½æ”¯æŒï¼Œä¸æ”¯æŒæ—¶ä¼šè‡ªåŠ¨å¿½ç•¥ | None |
| min_p | float, optional | Min-Pé‡‡æ ·å‚æ•°ï¼Œè®¾ç½®æœ€å°æ¦‚ç‡é˜ˆå€¼ã€‚æ³¨æ„ï¼šè¾ƒæ–°çš„é‡‡æ ·æ–¹æ³•ï¼Œè€æ¨¡å‹å¯èƒ½ä¸æ”¯æŒ | None |
| max_tokens | int, optional | æœ€å¤§ç”Ÿæˆtokenæ•°é‡ | None |
| presence_penalty | float, optional | å­˜åœ¨æƒ©ç½šå‚æ•° (-2.0åˆ°2.0) | None |
| frequency_penalty | float, optional | é¢‘ç‡æƒ©ç½šå‚æ•° (-2.0åˆ°2.0) | None |
| stream | bool, optional | æ˜¯å¦å¯ç”¨æµå¼å“åº” | False |
| format | str, optional | è¿”å›æ ¼å¼ç±»å‹ï¼Œ"text"æˆ–"json" | "text" |
| json_format | str, optional | JSONæ ¼å¼æ¨¡æ¿ | ç©ºå­—ç¬¦ä¸² |
| tools | list, optional | å·¥å…·è°ƒç”¨åˆ—è¡¨ã€‚æ ¼å¼ä¸º: [{"name": "...", "description": "...", "parameters": {...}}] | None |
| timeout | int, optional | è¯·æ±‚è¶…æ—¶æ—¶é—´(ç§’) | 180 |

##### è¿”å›å€¼

Union[dict, Generator[dict, None, None]]:
- éæµå¼æ¨¡å¼è¿”å›å­—å…¸æ ¼å¼ï¼š{"role": "assistant", "content": "...", "tool_calls": [...]}
- æµå¼æ¨¡å¼è¿”å›ç”Ÿæˆå™¨ï¼Œé€å—è¿”å›å“åº”å†…å®¹å’Œ/æˆ–å·¥å…·è°ƒç”¨ä¿¡æ¯

##### å¼‚å¸¸å¤„ç†

APIRequestFailed: å½“APIè°ƒç”¨å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸

##### ä½¿ç”¨ç¤ºä¾‹

###### å•æ¬¡å¯¹è¯æ¨¡å¼
```python
>>> predict(input_text="ä½ å¥½")
{"role": "assistant", "content": "ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®åŠ©ä½ çš„å—ï¼Ÿ"}
```

###### å¤šè½®å¯¹è¯æ¨¡å¼
```python
>>> messages = [{"role": "user", "content": "åŒ—äº¬å¤©æ°”å¦‚ä½•ï¼Ÿ"}]
>>> predict(messages=messages)
```
            
###### æµå¼å“åº”
```python
>>> for chunk in predict(input_text="è®²ä¸ªæ•…äº‹", stream=True):
     print(chunk)
```
            
###### ä½¿ç”¨é«˜çº§é‡‡æ ·å‚æ•°
```python
>>> result = predict(input_text="åˆ›æ„å†™ä½œ", top_k=50, min_p=0.1, max_tokens=1000)
```


# ä¸‰.å·¥å…·æ³¨å†Œ
å·¥å…·çš„æ³¨å†Œä¸»è¦ä½¿ç”¨Toolsæ¥å®ç°  
Toolsæ˜¯ä¸€ä¸ªå·¥å…·ç±»ï¼Œç”¨äºæ³¨å†Œï¼Œç®¡ç†å’Œæä¾›å·¥å…·æ‰§è¡Œçš„ä¸Šå±‚api  
å®ä¾‹åŒ–çš„Toolsæˆ‘ç§°ä¸ºå·¥å…·é›†  
å»ºè®®å¼€å‘è€…ï¼Œå®ä¾‹åŒ–çš„å·¥å…·é›†å˜é‡åç§°å°±æ˜¯å·¥å…·é›†çš„åç§°
## å…ˆå®ä¾‹åŒ–Toolsç±»
```python 
from tina import Tools

tools = Tools()
```
## äº†è§£Googleé£æ ¼çš„æ³¨é‡Š
åœ¨åé¢çš„å·¥å…·æ³¨å†Œä¸­ä½ ä¼šå‘ç°è‡ªå·±ä¸éœ€è¦å¡«å†™å‚æ•°ç±»å‹å’Œæè¿°ï¼Œ  
è¿™æ˜¯å› ä¸ºæˆ‘ä¼šè§£æä½ çš„æ³¨é‡Šï¼Œå¹¶è‡ªåŠ¨ç”Ÿæˆå‚æ•°ç±»å‹å’Œæè¿°  
å¦‚æœè¿˜éœ€è¦å†ä¸€æ¬¡å¡«å†™å‚æ•°ç±»å‹å’Œæè¿°çš„è¯å¾ˆéº»çƒ¦ï¼Œæˆ‘ä¸»å¼ æ³¨é‡Šå³æè¿°ï¼Œè¿™æ ·å¯ä»¥ä¸€æ¬¡å†™å¥½  
ä¸‹é¢çš„æ˜¯Googleé£æ ¼çš„æ³¨é‡Š
```python
def query(text:str) -> str:
    """
    æŸ¥è¯¢æ–‡æ¡£
    Args:
        text: str æŸ¥è¯¢çš„æ–‡æœ¬
    """
    return query(text)
```
## å•ä¸ªå·¥å…·æ³¨å†Œï¼šregister_tool
```python
#æ ¼å¼å¦‚ä¸‹
tools.register_tool(
    tool=å·¥å…·å‡½æ•°,
    description="å·¥å…·åŠŸèƒ½çš„æè¿°"
)

#ç¤ºä¾‹
async def query(text):
    """
    æŸ¥è¯¢æ–‡æ¡£
    Args:
        text: str æœç´¢çš„æ–‡æœ¬
    """
    ...
    return result
# åŒæ­¥å’Œå¼‚æ­¥å·¥å…·éƒ½å¯ä»¥æ³¨å†Œ
tools.register_tool(
    tool=query,
    description = "åœ¨æ–‡æ¡£é‡Œé¢æŸ¥è¯¢"
)

```
## ä½¿ç”¨è£…é¥°å™¨ï¼ˆæ–°å¢çš„æ–¹æ³•ï¼‰:@register()
```python
# åŒæ­¥å·¥å…·æ³¨å†Œ
@tools.register()
def add(a,b):
    """
    ä¸¤ä¸ªæ•°å­—ç›¸åŠ 
    Args:
        a:int æ•°å­—a
        b:int æ•°å­—b
    """
    return a+b
# å¼‚æ­¥å·¥å…·æ³¨å†Œ
@tools.register()
async def query(text):
    """
    æŸ¥è¯¢æ–‡æ¡£
    Args:
        text: str æœç´¢çš„æ–‡æœ¬
    """
    ...
    return result
```
## æ³¨å†Œä¸å¸¦åŠŸèƒ½å®ç°çš„å·¥å…·: register_no_function
```python
tools.register_no_function(
    name="å·¥å…·åå­—",
    description="å·¥å…·åŠŸèƒ½æè¿°",
    required_parameters=[],
    parameters={}
)


# name (str): å‡½æ•°çš„åç§°ï¼Œä¸€å®šè¦æ­£ç¡®
# description (str): å‡½æ•°çš„æè¿°ï¼Œå¯ä»¥è¯¦ç»†æè¿°å‡½æ•°çš„åŠŸèƒ½
# required_parameters (list): ä¸€å®šè¦æœ‰è¾“å…¥çš„å‚æ•°åˆ—è¡¨
# parameters (dict): å‚æ•°çš„è¯¦ç»†ä¿¡æ¯ï¼Œæ‰€æœ‰çš„å‚æ•°éƒ½è¦æœ‰ç±»å‹å’Œæè¿°
# æ ¼å¼ï¼š
# {
#     "å‚æ•°å": {
#         "type": "å‚æ•°ç±»å‹",
#         "description": "å‚æ•°æè¿°"
#             }
# }
```
## æ³¨é”€å·¥å…· unregister
ä»å·¥å…·é›†ä¸­åˆ é™¤æˆ–è€…æ³¨é”€ä¸€ä¸ªå·¥å…·
```python
tools.unregister(tool_name)
```
## æ·»åŠ å·¥å…·é›†
ä½ å¯ä»¥ä½¿ç”¨+ å’Œ += æ¥å¯¹å·¥å…·é›†è¿›è¡Œæ·»åŠ 
```python
from tina.utils.system_tools import system_tools
from tina import Tools
tools = Tools()
tools += system_tools # æ·»åŠ tinaè‡ªå¸¦çš„ç³»ç»Ÿå·¥å…·åŒ…
# ä¹Ÿå¯ä»¥æŒ‰ç…§ä¸‹é¢çš„æ ¼å¼
tools = tools + system_tools
```
## æ‰§è¡Œå·¥å…· execute
åªèƒ½æ‰§è¡Œæœ‰åŠŸèƒ½å®ç°çš„å·¥å…·
```python
from tina import Tools
tools = Tools()

@tools.register()
def hello(name: str):
    """
    æè¿°
    Args:
        name (str): åå­—
    """
    print("hello, %s" % name)
# å‡è®¾ä¸‹é¢çš„æ˜¯å¤§æ¨¡å‹è¿”å›çš„tool_calls
tool_calls = [
    {
        "index":0,
        "type": "function",
        "function": {
            "name": "hello"
            "arguments": "{\"name\":\"Tina\"}"
        }
        "id": "xxxxxxxxxxxxxxxxxxxx"
    }
]
# ç›´æ¥ä¼ é€’tool_calls Toolsä¼šè‡ªå·±å¤„ç†
tools.execute(
    tool_calls = tool_calls
)
```

# å››.è®¾ç½®ä¸€ä¸ªAgent
tinaé‡Œé¢çš„Agentå’Œå¤§æ¨¡å‹çš„åŒºåˆ«åœ¨äº
Agentæ‹¥æœ‰å·¥å…·å’Œå¤–ç•Œäº¤äº’ï¼ŒåŒæ—¶å†…éƒ¨ä¼šæ‰§è¡Œå·¥å…·è·å–ç»“æœï¼Œè€Œå¤§æ¨¡å‹æ˜¯ä¸€ä¸ªç®€å•çš„è¾“å…¥è¾“å‡ºä½¿ç”¨ã€‚  
Agentä¼šè‡ªåŠ¨åœ°ç»´æŠ¤messageså’Œè¿è¡Œéœ€è¦çš„çŠ¶æ€  
**Agentä¸æ˜¯è‡ªåŠ¨è¿è¡Œçš„ï¼Œä½ éœ€è¦è‡ªå·±è®¾è®¡äº‹ä»¶æ¥ä½¿ç”¨Agentçš„æ–¹æ³•**
```python
from tina import Agent,Tools
from tina.llm import BaseAPI
llm = BaseAPI()
tools = Tools()
system_prompt = "ä½ æ˜¯ä¸€ä¸ªæœ‰ç”¨çš„Agent"
# Agentå¯ä»¥åœ¨åªéœ€è¦ä¸€ä¸ªLLMå’ŒToolsçš„æ—¶å€™åˆ›å»ºï¼Œè¿™ä¸ªæ—¶å€™ç³»ç»Ÿä¼šä½¿ç”¨tinaé»˜è®¤çš„prompt
agent = Agent(
    llm =llm,
    tools = tools,
    system_prompt = system_prompt #è¯¥å‚æ•°å¯é€‰
)
```
## Agentçš„æ–¹æ³•
### predict() å’Œ apredict()
å®é™…ä¸Šï¼Œä½ å¯ä»¥åƒä½¿ç”¨LLMä¸€æ ·ä½¿ç”¨Agent.  
æœ€åŸºç¡€è·å–è¾“å‡ºï¼Œå’ŒLLMä¸€æ ·çš„æ–¹æ³•è¿˜æ˜¯predict()æ–¹æ³•  
apredict()æ–¹æ³•çš„å‚æ•°å’Œpredict()ä¸€æ ·ï¼Œä½†æ˜¯æ˜¯å¼‚æ­¥æ–¹æ³•
```
å’ŒLLMçš„è¾“å‡ºä¸€è‡´ï¼Œå½“Agentè®¾ç½®å‚æ•°ä¸ºéæµå¼çš„æ—¶å€™ï¼ŒAgentä¼šæ‰§è¡Œå®Œå·¥å…·å†ä¸€æ¬¡å›å¤ä¹‹åä¸€æ¬¡æ€§è¾“å‡ºï¼Œè¾“å‡ºç»“æœä¸ºï¼š
{
    "role":"assistant",
    "content":"..."
}
å¦‚æœæ˜¯æµå¼çš„è¾“å‡ºï¼Œä¸€ä¸‹çš„å†…å®¹ä¼šä¸€ç›´å‡ºç°ï¼š
{
    "role":"assistant",
    "content":"..."
}
å½“å‡ºç°äº†tool_nameæ—¶ï¼ŒAgentä¼šå…ˆè¿”å›å·¥å…·åç§°ï¼Œè®©å¼€å‘è€…å¯ä»¥æå‰çŸ¥é“å¤§æ¨¡å‹ä½¿ç”¨äº†ä»€ä¹ˆå·¥å…·ï¼š
{
    "role":"assistant",
    "content":"...",
    "tool_name":"...",
}
æ¥ä¸‹æ¥å·¥å…·å‚æ•°ä¼šä»¥ç‰‡æ®µçš„æ–¹å¼ä¸€æ®µä¸€æ®µçš„è¾“å‡º,æ³¨æ„ï¼Œè¿™å¹¶ä¸ä»¥ä¸ºç€ä½ éœ€è¦æ”¶é›†è¿™äº›ç‰‡æ®µï¼Œå› ä¸ºåé¢Agentä¼šè¿”å›ä¸€ä¸ªå®Œæ•´çš„tool_callsç»™ä½ ï¼š
{
    "role":"assistant",
    "content":"...",
    "tool_arguments":"..."
}
å½“å‡ºç°äº†å®Œæ•´çš„tool_callsæ—¶ï¼ŒAgentä¼šç›´æ¥è¿”å›ä¸€ä¸ªå®Œæ•´çš„tool_callsï¼š
{
    "role":"assistant",
    "content":"...",
    "tool_calls":[]
}
å‡ºç°äº†tool_callsä¹‹åï¼ŒAgentä¼šè‡ªåŠ¨åœ°æ‰§è¡Œå·¥å…·ï¼Œç„¶åè¿”å›ä¸‹é¢çš„ç»“æœï¼Œè§’è‰²ä¼šå˜ä¸ºtoolï¼Œå†…å®¹æ˜¯å·¥å…·è¿”å›çš„ç»“æœï¼š
{
    "role":"tool"
    "content":"...",
}
æ³¨æ„å¦‚æœæ˜¯æ€è€ƒæ¨¡å‹ã€‚æ€è€ƒå†…å®¹ä¼šåœ¨reasoning_contenté‡Œé¢ï¼š
{
    "role":"assistant",
    "content":"...",
    "reasoning_content":""
}
ç„¶åä¼šæ¥ç€è¿”å›æ­£å¸¸çš„è¾“å‡º
```
```python
...
result = agent.predict(instruction="ä½ å¥½ï¼Ÿ")
#agent.predict()é»˜è®¤æµå¼è¾“å‡º
for chunk in result:
    print(chunk,end="")
...
```
```python
predict(
    instruction:str,#è¾“å…¥æŒ‡ä»¤
    temperature:float,
    top_p:float,
    top_k:int,
    min_p:float,
    stream:bool=False,#æ˜¯å¦æµå¼è¾“å‡º
)
```
### disable_toolå’Œenable_tool
è¯¥æ–¹æ³•ç”¨äºç¦ç”¨æˆ–å¯ç”¨å·¥å…·  
ç”¨äºä¸€äº›ç‰¹æ®Šæƒ…å†µç›´æ¥ç¦ç”¨æˆ–å¯ç”¨å·¥å…·  
```python
# å‡è®¾æœ‰ä¸€ä¸ªsearchå·¥å…·
agent.disable_tool("search") #è¿™ä¸ªæ—¶å€™Agentä¸ä¼šçŸ¥é“è¿™ä¸ªå·¥å…·ï¼Œä½†æ˜¯å®ƒä¾ç„¶åœ¨å·¥å…·é›†å­˜åœ¨
agent.enable_tool("search") # é‡æ–°å¯ç”¨å·¥å…·ï¼ŒAgentä¼šé‡æ–°çŸ¥é“è¿™ä¸ªå·¥å…·
```
### è·å–æ¶ˆæ¯åˆ—è¡¨ get_messages
```python
# è¿”å›å½“å‰agentçš„æ¶ˆæ¯åˆ—è¡¨
agent.get_messages() 
```
### æ¸…é™¤æ¶ˆæ¯ clear_messages
```python
# ä¼šæ¸…ç©ºé™¤äº†ç³»ç»Ÿæ¶ˆæ¯çš„æ‰€æœ‰æ¶ˆæ¯
agent.clear_messages()
```
### è·å–å½“å‰å·¥å…·åˆ—è¡¨ get_tools
```python
# è·å–å½“å‰agentå¯ç”¨çš„å·¥å…·åˆ—è¡¨
agent.get_tools()
```
### è·å–ç³»ç»Ÿæç¤ºè¯ get_system_prompt
```python
agent.get_system_prompt()
```
### æ·»åŠ æ¶ˆæ¯ add_message
```python
# æ·»åŠ æ¶ˆæ¯ï¼Œç”¨äºç³»ç»Ÿè‡ªåŠ¨æ·»åŠ æ¶ˆæ¯ï¼Œä¹Ÿå¯ä»¥ä¸´æ—¶æ’å…¥ç³»ç»Ÿæ¶ˆæ¯æ”¹å˜Agentçš„è¿è¡Œé€»è¾‘
agent.add_message(
    role="user",# å¯ä»¥æ˜¯userï¼Œassistantï¼Œsystem
    content="ä½ å¥½ï¼Œè¿™æ˜¯ç”¨æˆ·æ¶ˆæ¯"
)
```
### æ·»åŠ æ¶ˆæ¯åˆ—è¡¨ add_messages
```python
messages = [
    {"role": "user", "content": "ä½ å¥½ï¼Œè¿™æ˜¯ç”¨æˆ·æ¶ˆæ¯"},
    {"role": "assistant", "content": "ä½ å¥½ï¼Œè¿™æ˜¯åŠ©æ‰‹æ¶ˆæ¯"},
    {"role": "system", "content": "ä½ å¥½ï¼Œè¿™æ˜¯ç³»ç»Ÿæ¶ˆæ¯"},
]
agent.add_messages(
    messages
)
```
### è·å–å·¥å…·æ‰§è¡Œç»“æœåˆ—è¡¨ get_tools_call_results
```python
tools_results = agent.get_tools_call_results()
```
### è·å–å·¥å…·è°ƒç”¨è®°å½• get_tools_call
```python
tools_call = agent.get_tools_call()
```
### æ·»åŠ mcpæœåŠ¡å™¨ add_mcp_server
```python
config={
    "type":"stdio",
    "command":"npx",
    "args":["@playwright/mcp@latest"]
}
agent.add_server(
    server_id="playwright", 
    config=config
)
```
### åˆ é™¤mcpæœåŠ¡å™¨ remove_mcp_server
```python
agent.remove_mcp_server("playwright")
```
### è·å–mcpæœåŠ¡å™¨ä¿¡æ¯ get_mcp_server_info
```python
agent.get_mcp_server_info("playwright")
```

# äº”. æ·»åŠ MCPæœåŠ¡å™¨
## å®ä¾‹åŒ–MCPå®¢æˆ·ç«¯
```python
from tina.mcp import MCPClient

mcp = MCPClient()
# æ·»åŠ playwright MCPæœåŠ¡ï¼Œä¸€ä¸ªæµè§ˆå™¨è‡ªåŠ¨åŒ–å·¥å…·
mcp.add_server(
    server_id="playwright", 
    config={
        "type":"stdio",
        "command":"npx",
        "args":["@playwright/mcp@latest"]
    }
)
from tina import Agent,Tools
from tina.llm import BaseAPI
llm = BaseAPI()
tools = Tools()
system_prompt = "ä½ æ˜¯ä¸€ä¸ªæµè§ˆå™¨è‡ªåŠ¨åŒ–åŠ©æ‰‹"
agent = Agent(
    llm = llm,
    tools = tools,
    system_prompt = system_prompt,
    mcp = mcp #å¯ä»¥ç›´æ¥ä¼ é€’mcpå®¢æˆ·ç«¯å®ä¾‹
)

```
