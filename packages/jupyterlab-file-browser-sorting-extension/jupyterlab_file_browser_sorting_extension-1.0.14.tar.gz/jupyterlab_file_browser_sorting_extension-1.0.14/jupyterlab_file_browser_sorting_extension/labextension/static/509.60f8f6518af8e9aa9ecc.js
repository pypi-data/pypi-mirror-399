"use strict";(self.webpackChunkjupyterlab_file_browser_sorting_extension=self.webpackChunkjupyterlab_file_browser_sorting_extension||[]).push([[509],{509(e,t,o){o.r(t),o.d(t,{default:()=>d});var n=o(780),r=o(223);const i="jupyterlab_file_browser_sorting_extension:plugin",s="filebrowser:toggle-unix-sorting";let a=!1,c=!0;function l(e,t){const o=[...e],n="descending"===t.direction?-1:1;function r(e){return"directory"===e.type?0:a&&e.name.endsWith(".ipynb")?1:2}return o.sort((e,o)=>{var i,s;const a=r(e),l=r(o);if(a!==l)return a-l;let d;return d="last_modified"===t.key?new Date(e.last_modified).getTime()-new Date(o.last_modified).getTime():"file_size"===t.key?(null!==(i=o.size)&&void 0!==i?i:0)-(null!==(s=e.size)&&void 0!==s?s:0):function(e,t){return c?function(e,t){const o=e.length,n=t.length,r=Math.min(o,n);for(let o=0;o<r;o++){const n=e.charCodeAt(o),r=t.charCodeAt(o);if(n!==r)return n-r}return o-n}(e.name,t.name):function(e,t){return e.localeCompare(t,void 0,{numeric:!0,sensitivity:"base"})}(e.name,t.name)}(e,o),d*n}),o}const d={id:i,description:"LC_COLLATE=C file browser sorting",autoStart:!0,requires:[n.IFileBrowserFactory],optional:[r.ISettingRegistry],activate:(e,t,o)=>{const{commands:n}=e,{tracker:r}=t,d=new WeakSet;function u(){r.forEach(e=>{var t;(t=e.listing)&&t.sortState&&t.sort(t.sortState)})}function f(e){const t=e.listing;t&&function(e){if(!e||d.has(e))return;d.add(e);let t=[];Object.defineProperty(e,"sortedItems",{get:function(){return t},configurable:!0});const o=e.sort.bind(e);e.sort=function(e){const n=this.model;if(!n)return void o(e);const r=Array.from(n.items());if(0===r.length)return this._sortState=e,t=[],this._sortedItems=[],void o(e);const i=l(r,e);t=i,this._sortedItems=i,this._sortState=e,this.update()};const n=e.model;n&&n.refreshed&&n.refreshed.connect(()=>{e.sortState&&e.sort(e.sortState)}),e.sortState&&e.sort(e.sortState)}(t)}o&&(o.load("@jupyterlab/filebrowser-extension:browser").then(e=>{var t;a=null!==(t=e.get("sortNotebooksFirst").composite)&&void 0!==t&&t,e.changed.connect(()=>{var t;a=null!==(t=e.get("sortNotebooksFirst").composite)&&void 0!==t&&t})}).catch(()=>{}),o.load(i).then(e=>{var t;c=null===(t=e.get("useCLocaleSorting").composite)||void 0===t||t,e.changed.connect(()=>{var t;const o=null===(t=e.get("useCLocaleSorting").composite)||void 0===t||t;c=o,u()})}).catch(()=>{})),n.addCommand(s,{label:"Unix Style Sorting",caption:"Sort: dot files first, uppercase before lowercase",isToggleable:!0,isToggled:()=>c,execute:async()=>{if(o){const e=await o.load(i);await e.set("useCLocaleSorting",!c)}else c=!c,u()}}),e.contextMenu.addItem({command:s,selector:".jp-DirListing-headerItem",rank:100}),e.restored.then(()=>{r.forEach(f),r.widgetAdded.connect((e,t)=>{f(t)})})}}}}]);