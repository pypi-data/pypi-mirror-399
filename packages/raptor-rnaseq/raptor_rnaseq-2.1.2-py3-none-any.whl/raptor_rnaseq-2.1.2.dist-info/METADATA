Metadata-Version: 2.4
Name: raptor-rnaseq
Version: 2.1.2
Summary: RNA-seq Analysis Pipeline Testing and Optimization Resource with ML-powered recommendations and adaptive threshold optimization
Home-page: https://github.com/AyehBlk/RAPTOR
Author: Ayeh Bolouki
Author-email: Ayeh Bolouki <ayehbolouki1988@gmail.com>
Maintainer-email: Ayeh Bolouki <ayehbolouki1988@gmail.com>
License: MIT
Project-URL: Homepage, https://github.com/AyehBlk/RAPTOR
Project-URL: Documentation, https://github.com/AyehBlk/RAPTOR/tree/main/docs
Project-URL: Repository, https://github.com/AyehBlk/RAPTOR
Project-URL: Bug Tracker, https://github.com/AyehBlk/RAPTOR/issues
Project-URL: Changelog, https://github.com/AyehBlk/RAPTOR/blob/main/docs/CHANGELOG.md
Keywords: rna-seq,differential-expression,bioinformatics,computational-biology,transcriptomics,pipeline,benchmarking,data-analysis,genomics,machine-learning,quality-assessment,data-quality,dashboard,interactive,threshold-optimization,adaptive-threshold
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Science/Research
Classifier: Intended Audience :: Developers
Classifier: Topic :: Scientific/Engineering :: Bio-Informatics
Classifier: Topic :: Scientific/Engineering :: Artificial Intelligence
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Operating System :: OS Independent
Classifier: Operating System :: POSIX :: Linux
Classifier: Operating System :: MacOS
Classifier: Natural Language :: English
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: numpy>=1.21.0
Requires-Dist: pandas>=1.3.0
Requires-Dist: scipy>=1.7.0
Requires-Dist: matplotlib>=3.4.0
Requires-Dist: seaborn>=0.11.0
Requires-Dist: scikit-learn>=1.0.0
Requires-Dist: joblib>=1.1.0
Requires-Dist: pyyaml>=5.4.0
Requires-Dist: jinja2>=3.0.0
Requires-Dist: click>=8.0.0
Requires-Dist: tqdm>=4.62.0
Requires-Dist: colorama>=0.4.4
Requires-Dist: statsmodels>=0.13.0
Provides-Extra: ml
Requires-Dist: scikit-learn>=1.0.0; extra == "ml"
Requires-Dist: joblib>=1.1.0; extra == "ml"
Provides-Extra: dashboard
Requires-Dist: streamlit>=1.28.0; extra == "dashboard"
Requires-Dist: plotly>=5.14.0; extra == "dashboard"
Requires-Dist: psutil>=5.8.0; extra == "dashboard"
Provides-Extra: advanced
Requires-Dist: bayesian-optimization>=1.2.0; extra == "advanced"
Requires-Dist: markdown>=3.3.0; extra == "advanced"
Requires-Dist: weasyprint>=52.5; extra == "advanced"
Requires-Dist: colorlog>=6.6.0; extra == "advanced"
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=3.0.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: flake8>=4.0.0; extra == "dev"
Requires-Dist: mypy>=0.950; extra == "dev"
Requires-Dist: sphinx>=4.0.0; extra == "dev"
Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "dev"
Provides-Extra: docs
Requires-Dist: sphinx>=4.0.0; extra == "docs"
Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "docs"
Requires-Dist: sphinx-click>=3.0.0; extra == "docs"
Provides-Extra: all
Requires-Dist: scikit-learn>=1.0.0; extra == "all"
Requires-Dist: joblib>=1.1.0; extra == "all"
Requires-Dist: streamlit>=1.28.0; extra == "all"
Requires-Dist: plotly>=5.14.0; extra == "all"
Requires-Dist: psutil>=5.8.0; extra == "all"
Requires-Dist: bayesian-optimization>=1.2.0; extra == "all"
Requires-Dist: markdown>=3.3.0; extra == "all"
Requires-Dist: weasyprint>=52.5; extra == "all"
Requires-Dist: colorlog>=6.6.0; extra == "all"
Requires-Dist: pytest>=7.0.0; extra == "all"
Requires-Dist: pytest-cov>=3.0.0; extra == "all"
Requires-Dist: black>=22.0.0; extra == "all"
Requires-Dist: flake8>=4.0.0; extra == "all"
Requires-Dist: mypy>=0.950; extra == "all"
Requires-Dist: sphinx>=4.0.0; extra == "all"
Requires-Dist: sphinx_rtd_theme>=1.0.0; extra == "all"
Requires-Dist: sphinx-click>=3.0.0; extra == "all"
Dynamic: author
Dynamic: home-page
Dynamic: license-file
Dynamic: requires-python

<p align="center">
  <img src="https://img.shields.io/badge/ü¶ñ_RAPTOR-v2.1.1-brightgreen?style=for-the-badge" alt="RAPTOR v2.1.1"/>
</p>

<h1 align="center">RAPTOR</h1>
<h3 align="center">RNA-seq Analysis Pipeline Testing and Optimization Resource</h3>

<p align="center">
  <strong>Making free science for everybody around the world üåç</strong>
</p>

<p align="center">
  <a href="https://pypi.org/project/raptor-rnaseq/"><img src="https://img.shields.io/pypi/v/raptor-rnaseq.svg?style=flat&logo=pypi&logoColor=white" alt="PyPI version"/></a>
  <a href="https://www.python.org/"><img src="https://img.shields.io/badge/Python-3.8+-blue.svg" alt="Python 3.8+"/></a>
  <a href="https://opensource.org/licenses/MIT"><img src="https://img.shields.io/badge/License-MIT-green.svg" alt="MIT License"/></a>
  <a href="https://doi.org/10.5281/zenodo.17607161"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.17607161.svg" alt="DOI"/></a>
  <a href="https://github.com/AyehBlk/RAPTOR/releases/tag/v2.1.1"><img src="https://img.shields.io/badge/Release-v2.1.1-orange.svg" alt="Release v2.1.1"/></a>
</p>

<p align="center">
  <a href="#-quick-start">Quick Start</a> ‚Ä¢
  <a href="#-features">Features</a> ‚Ä¢
  <a href="#-installation">Installation</a> ‚Ä¢
  <a href="#-documentation">Documentation</a> ‚Ä¢
  <a href="#-pipelines">Pipelines</a> ‚Ä¢
  <a href="#-citation">Citation</a>
</p>

---

## üÜï What's New in v2.1.1

###  Adaptive Threshold Optimizer (ATO)

**Stop using arbitrary thresholds!** The new Adaptive Threshold Optimizer determines data-driven significance cutoffs for differential expression analysis.

```python
from raptor.threshold_optimizer import optimize_thresholds
import pandas as pd

df = pd.read_csv('deseq2_results.csv')
result = optimize_thresholds(df, goal='discovery')

print(f"Optimal logFC: {result.logfc_threshold:.2f}")
print(f"Significant genes: {result.n_significant}")
print(f"\n{result.methods_text}")  # Publication-ready!
```

**Key Features:**
- Multiple p-value adjustment methods (BH, BY, Storey q-value, Holm, Bonferroni)
- Five logFC optimization methods (MAD, mixture model, power-based, percentile, consensus)
- œÄ‚ÇÄ estimation for true null proportion
- Three analysis goals: discovery, balanced, validation
- Auto-generated publication methods text
- Interactive dashboard integration

---

##  What is RAPTOR?

**RAPTOR** is a comprehensive framework for benchmarking and optimizing RNA-seq differential expression analysis pipelines. Instead of guessing which pipeline works best for your data, RAPTOR provides **evidence-based, ML-powered recommendations** through systematic comparison of 8 popular pipelines.

### Why RAPTOR?

| Challenge | RAPTOR Solution |
|-----------|-----------------|
| Which pipeline should I use? | ‚úÖ **ML recommendations** with 87% accuracy |
| What thresholds should I use? | ‚úÖ **Adaptive Threshold Optimizer** (NEW!) |
| Is my data quality good enough? | ‚úÖ **Quality assessment** with batch effect detection |
| How do I know results are reliable? | ‚úÖ **Ensemble analysis** combining multiple pipelines |
| What resources do I need? | ‚úÖ **Resource monitoring** with predictions |
| How do I present results? | ‚úÖ **Automated reports** publication-ready |

---

##  Features

<table>
<tr>
<td width="50%">

###  Adaptive Threshold Optimizer (NEW!)
- Data-driven logFC and p-value thresholds
- Multiple statistical methods
- Publication-ready methods text
- Interactive dashboard page

###  ML-Based Recommendations
- 87% prediction accuracy
- Confidence scoring (0-100%)
- Learns from 10,000+ analyses
- Explains its reasoning

###  Quality Assessment
- 6-component quality scoring
- Batch effect detection
- Outlier identification
- Actionable recommendations

</td>
<td width="50%">

###  Ensemble Analysis
- 5 combination methods
- 33% fewer false positives
- High-confidence gene lists
- Consensus validation

###  Interactive Dashboard
- Web-based interface (no coding!)
- Real-time visualizations
- Drag-and-drop data upload
- One-click reports

###  Resource Monitoring
- Real-time CPU/memory tracking
- <1% performance overhead
- Resource predictions
- Cost estimation for cloud

</td>
</tr>
</table>

---

##  Quick Start

### Option 1: Interactive Dashboard (Recommended)

```bash
# Install
pip install raptor-rnaseq

# Launch dashboard
raptor dashboard

# Opens at http://localhost:8501
# Upload data ‚Üí Get ML recommendation ‚Üí Use üéØ Threshold Optimizer ‚Üí Done!
```

### Option 2: Command Line

```bash
# Profile your data and get ML recommendation
raptor profile --counts counts.csv --metadata metadata.csv --use-ml

# Run recommended pipeline
raptor run --pipeline 3 --data fastq/ --output results/

# Optimize thresholds (NEW!)
raptor optimize-thresholds --input results.csv --goal balanced

# Generate report
raptor report --results results/ --output report.html
```

### Option 3: Python API

```python
from raptor import RNAseqDataProfiler, MLPipelineRecommender
from raptor.threshold_optimizer import optimize_thresholds

# Profile your data
profiler = RNAseqDataProfiler(counts, metadata)
profile = profiler.run_full_profile()

# Get ML recommendation
recommender = MLPipelineRecommender()
recommendation = recommender.recommend(profile)

print(f"Recommended: Pipeline {recommendation['pipeline_id']}")
print(f"Confidence: {recommendation['confidence']:.1%}")

# After running pipeline, optimize thresholds (NEW!)
de_results = pd.read_csv('de_results.csv')
result = optimize_thresholds(de_results, goal='balanced')
print(f"Optimal |logFC|: {result.logfc_threshold:.2f}")
print(result.methods_text)
```

---

##  Installation

### Requirements

- **Python**: 3.8 or higher
- **R**: 4.0 or higher (for DE analysis)
- **RAM**: 8GB minimum (16GB recommended)
- **Disk**: 10GB free space

### Install from PyPI (Recommended)

```bash
pip install raptor-rnaseq
```

With optional dependencies:

```bash
# With dashboard support
pip install raptor-rnaseq[dashboard]

# With all features
pip install raptor-rnaseq[all]
```

### Install from GitHub

```bash
# Clone repository
git clone https://github.com/AyehBlk/RAPTOR.git
cd RAPTOR

# Install Python dependencies
pip install -r requirements.txt

# Verify installation
python install.py
```

### Conda Environment

```bash
conda env create -f environment.yml
conda activate raptor
```

---

##  Pipelines

RAPTOR benchmarks **8 RNA-seq analysis pipelines**:

| ID | Pipeline | Aligner | Quantifier | DE Tool | Speed | ML Rank |
|----|----------|---------|------------|---------|-------|---------|
| 1 | STAR-RSEM-DESeq2 | STAR | RSEM | DESeq2 | ‚≠ê‚≠ê | #2 |
| 2 | HISAT2-StringTie-Ballgown | HISAT2 | StringTie | Ballgown | ‚≠ê‚≠ê‚≠ê | #5 |
| **3** | **Salmon-edgeR** ‚≠ê | Salmon | Salmon | edgeR | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **#1** |
| 4 | Kallisto-Sleuth | Kallisto | Kallisto | Sleuth | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | #3 |
| 5 | STAR-HTSeq-limma | STAR | HTSeq | limma-voom | ‚≠ê‚≠ê | #4 |
| 6 | STAR-featureCounts-NOISeq | STAR | featureCounts | NOISeq | ‚≠ê‚≠ê | #6 |
| 7 | Bowtie2-RSEM-EBSeq | Bowtie2 | RSEM | EBSeq | ‚≠ê‚≠ê | #7 |
| 8 | HISAT2-Cufflinks-Cuffdiff | HISAT2 | Cufflinks | Cuffdiff | ‚≠ê | #8 |

‚≠ê **Pipeline 3 (Salmon-edgeR)** is the ML model's most frequently recommended pipeline due to its optimal speed/accuracy balance.

---

##  Repository Structure

```
RAPTOR/
‚îú‚îÄ‚îÄ raptor/                 # Core Python package
‚îÇ   ‚îú‚îÄ‚îÄ profiler.py         # Data profiling
‚îÇ   ‚îú‚îÄ‚îÄ recommender.py      # Rule-based recommendations
‚îÇ   ‚îú‚îÄ‚îÄ ml_recommender.py   # ML recommendations
‚îÇ   ‚îú‚îÄ‚îÄ threshold_optimizer/ # üÜï Adaptive Threshold Optimizer (v2.1.1)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ato.py          # Core ATO class
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ visualization.py # ATO visualizations
‚îÇ   ‚îú‚îÄ‚îÄ data_quality_assessment.py
‚îÇ   ‚îú‚îÄ‚îÄ ensemble_analysis.py
‚îÇ   ‚îú‚îÄ‚îÄ resource_monitoring.py
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ dashboard/              # Interactive web dashboard
‚îú‚îÄ‚îÄ pipelines/              # Pipeline configurations (8 pipelines)
‚îú‚îÄ‚îÄ scripts/                # Workflow scripts (00-10)
‚îú‚îÄ‚îÄ examples/               # Example scripts & demos
‚îú‚îÄ‚îÄ tests/                  # Test suite
‚îú‚îÄ‚îÄ docs/                   # Documentation
‚îú‚îÄ‚îÄ config/                 # Configuration templates
‚îú‚îÄ‚îÄ install.py              # Master installer
‚îú‚îÄ‚îÄ launch_dashboard.py     # Dashboard launcher
‚îú‚îÄ‚îÄ requirements.txt        # Python dependencies
‚îî‚îÄ‚îÄ setup.py                # Package setup
```

---

##  Documentation

### Getting Started
| Document | Description |
|----------|-------------|
| [INSTALLATION.md](docs/INSTALLATION.md) | Detailed installation guide |
| [QUICK_START.md](docs/QUICK_START.md) | 5-minute quick start |
| [DASHBOARD.md](docs/DASHBOARD.md) | Interactive dashboard guide |

### Core Features
| Document | Description |
|----------|-------------|
| [THRESHOLD_OPTIMIZER.md](docs/THRESHOLD_OPTIMIZER.md) | üÜï Adaptive threshold optimization |
| [PROFILE_RECOMMEND.md](docs/PROFILE_RECOMMEND.md) | Data profiling & recommendations |
| [QUALITY_ASSESSMENT.md](docs/QUALITY_ASSESSMENT.md) | Quality scoring & batch effects |
| [BENCHMARKING.md](docs/BENCHMARKING.md) | Pipeline benchmarking |

### Advanced Features
| Document | Description |
|----------|-------------|
| [ENSEMBLE.md](docs/ENSEMBLE.md) | Multi-pipeline ensemble analysis |
| [RESOURCE_MONITORING.md](docs/RESOURCE_MONITORING.md) | Resource tracking |
| [CLOUD_DEPLOYMENT.md](docs/CLOUD_DEPLOYMENT.md) | AWS/GCP/Azure deployment |

### Reference
| Document | Description |
|----------|-------------|
| [PIPELINES.md](docs/PIPELINES.md) | Pipeline details & selection guide |
| [API.md](docs/API.md) | Python API reference |
| [FAQ.md](docs/FAQ.md) | Frequently asked questions |
| [CHANGELOG.md](docs/CHANGELOG.md) | Version history |

---

##  Usage Examples

### Example 1: Quick Threshold Optimization (NEW!)

```python
from raptor.threshold_optimizer import optimize_thresholds
import pandas as pd

# Load DE results
df = pd.read_csv('deseq2_results.csv')

# Optimize thresholds
result = optimize_thresholds(df, goal='balanced')

print(f"Optimal |logFC|: {result.logfc_threshold:.3f}")
print(f"Significant genes: {result.n_significant}")
print(f"œÄ‚ÇÄ estimate: {result.pi0:.3f}")

# Get publication methods text
print(result.methods_text)

# Save results
result.results_df.to_csv('optimized_results.csv')
```

### Example 2: Full Workflow

```python
from raptor import RNAseqDataProfiler, MLPipelineRecommender
from raptor.threshold_optimizer import optimize_thresholds
import pandas as pd

# 1. Profile data
counts = pd.read_csv('counts.csv', index_col=0)
metadata = pd.read_csv('metadata.csv')

profiler = RNAseqDataProfiler(counts, metadata, use_ml=True)
profile = profiler.profile(quality_check=True)
print(f"Quality Score: {profile['quality_score']}/100")

# 2. Get ML recommendation
recommender = MLPipelineRecommender()
recommendations = recommender.recommend(profile, n=3)
print(f"Recommended: {recommendations[0]['pipeline_name']}")

# 3. [Run recommended pipeline - produces DE results]
# raptor run --pipeline 3 ...

# 4. Optimize thresholds (NEW in v2.1.1)
de_results = pd.read_csv('deseq2_results.csv')
result = optimize_thresholds(
    de_results,
    logfc_col='log2FoldChange',
    pvalue_col='pvalue',
    goal='balanced'
)

print(f"\nüéØ Optimized Thresholds:")
print(f"   LogFC: |{result.logfc_threshold:.3f}|")
print(f"   Significant: {result.n_significant} genes")

# 5. Save results with methods text
result.results_df.to_csv('final_results.csv')
with open('methods.txt', 'w') as f:
    f.write(result.methods_text)
```

### Example 3: Ensemble Analysis with ATO

```python
from raptor.ensemble_analysis import EnsembleAnalyzer
from raptor.threshold_optimizer import optimize_thresholds

# Combine results from multiple pipelines
analyzer = EnsembleAnalyzer()
consensus = analyzer.combine_results(
    results_dict={'deseq2': df1, 'edger': df2, 'limma': df3},
    method='weighted_vote',
    min_agreement=2
)

# Use ATO for uniform thresholds across ensemble
result = optimize_thresholds(consensus['combined'], goal='balanced')
print(f"Consensus DE genes: {result.n_significant}")
```

---

##  Performance

### ML Recommendation Accuracy

| Metric | Value |
|--------|-------|
| Overall Accuracy | 87% |
| Top-3 Accuracy | 96% |
| Prediction Time | <0.1s |
| Training Data | 10,000+ analyses |

### Threshold Optimizer Benefits

| Metric | Traditional | With ATO |
|--------|-------------|----------|
| Threshold justification | Arbitrary | Data-driven |
| Methods text | Manual | Auto-generated |
| False positives | Higher | Optimized |
| Reproducibility | Variable | Standardized |

---

##  Contributing

We welcome contributions! RAPTOR is open-source and aims to make free science accessible to everyone.

```bash
# Fork and clone
git clone https://github.com/YOUR_USERNAME/RAPTOR.git

# Create feature branch
git checkout -b feature/amazing-feature

# Make changes and test
pytest tests/

# Submit pull request
```

See [CONTRIBUTING.md](docs/CONTRIBUTING.md) for guidelines.

---

##  Citation

If you use RAPTOR in your research, please cite:

```bibtex
@software{bolouki2025raptor,
  author       = {Bolouki, Ayeh},
  title        = {RAPTOR: RNA-seq Analysis Pipeline Testing and Optimization Resource},
  year         = {2025},
  version      = {2.1.1},
  publisher    = {Zenodo},
  doi          = {10.5281/zenodo.17607161},
  url          = {https://github.com/AyehBlk/RAPTOR}
}
```

[![DOI](https://zenodo.org/badge/DOI/10.5281/zenodo.17607161.svg)](https://doi.org/10.5281/zenodo.17607161)

---

##  License

This project is licensed under the **MIT License** - see the [LICENSE](LICENSE) file for details.

```
MIT License
Copyright (c) 2025 Ayeh Bolouki
```

---

##  Contact

**Ayeh Bolouki**

- üèõÔ∏è GIGA, University of Li√®ge, Belgium
- üìß Email: ayehbolouki1988@gmail.com
- üêô GitHub: [@AyehBlk](https://github.com/AyehBlk)
- üî¨ Research: Computational Biology, Bioinformatics, Multi-omics Analysis

---

##  Acknowledgments

- The Bioconductor community for the R package ecosystem
- All users who provided feedback

---

<p align="center">
  <strong>‚≠ê Star this repository if you find RAPTOR useful!</strong>
</p>

<p align="center">
  <img src="https://img.shields.io/github/stars/AyehBlk/RAPTOR?style=social" alt="GitHub Stars"/>
</p>

<p align="center">
  <em>RAPTOR v2.1.1 - Making pipeline selection evidence-based, not guesswork ü¶ñ</em>
</p>
