

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>otupy.core.consumer.Consumer &mdash; otupy  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=5929fcd5"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="otupy.core.content" href="otupy.core.content.html" />
    <link rel="prev" title="otupy.core.consumer" href="otupy.core.consumer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            otupy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../background.html">Background</a></li>
<li class="toctree-l1"><a class="reference internal" href="../architecture.html">Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download and setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage.html">Usage</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="otupy.apps.connector.html">MIRANDA Connector</a></li>
<li class="toctree-l1"><a class="reference internal" href="otupy.apps.ctxd.html">Context Discovery</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="otupy.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="otupy.actuators.html">otupy.actuators</a></li>
<li class="toctree-l2"><a class="reference internal" href="otupy.apps.html">otupy.apps</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="otupy.core.html">otupy.core</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="otupy.core.actions.html">otupy.core.actions</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.actuator.html">otupy.core.actuator</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.args.html">otupy.core.args</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.command.html">otupy.core.command</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="otupy.core.consumer.html">otupy.core.consumer</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">otupy.core.consumer.Consumer</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.content.html">otupy.core.content</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.content_type.html">otupy.core.content_type</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.encoder.html">otupy.core.encoder</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.extensions.html">otupy.core.extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.message.html">otupy.core.message</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.producer.html">otupy.core.producer</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.profile.html">otupy.core.profile</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.register.html">otupy.core.register</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.response.html">otupy.core.response</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.results.html">otupy.core.results</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.target.html">otupy.core.target</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.transfer.html">otupy.core.transfer</a></li>
<li class="toctree-l3"><a class="reference internal" href="otupy.core.version.html">otupy.core.version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="otupy.encoders.html">otupy.encoders</a></li>
<li class="toctree-l2"><a class="reference internal" href="otupy.profiles.html">otupy.profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="otupy.transfers.html">otupy.transfers</a></li>
<li class="toctree-l2"><a class="reference internal" href="otupy.types.html">otupy.types</a></li>
<li class="toctree-l2"><a class="reference internal" href="otupy.utils.html">otupy.utils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../developerguide.html">Developer guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developingextensions.html">Developing extensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">Logging for <code class="docutils literal notranslate"><span class="pre">otupy</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation.html">Building the documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ctxd/ctxd.html">Context Discovery Actuator Profile</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../relateddocuments.html">OpenC2 specifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Authors and acknowledgment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Licence</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">otupy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="otupy.html">otupy</a></li>
          <li class="breadcrumb-item"><a href="otupy.core.html">otupy.core</a></li>
          <li class="breadcrumb-item"><a href="otupy.core.consumer.html">otupy.core.consumer</a></li>
      <li class="breadcrumb-item active">otupy.core.consumer.Consumer</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="otupy-core-consumer-consumer">
<h1>otupy.core.consumer.Consumer<a class="headerlink" href="#otupy-core-consumer-consumer" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="otupy.core.consumer.Consumer">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">Consumer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">actuators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="otupy.core.encoder.Encoder.html#otupy.core.encoder.Encoder" title="otupy.core.encoder.Encoder"><span class="pre">Encoder</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="otupy.core.transfer.Transferclass.html#otupy.core.transfer.Transfer" title="otupy.core.transfer.Transfer"><span class="pre">Transfer</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#otupy.core.consumer.Consumer" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>OpenC2 Consumer</p>
<p>The <cite>Consumer</cite> is designed to dispatch OpenC2 <cite>Message`s to the relevant `Actuator</cite>. 
The current implementation receives the configuration at initialization time. It is therefore
not conceived to be runned itself as a service, but to be integrated in an external component 
that reads the relevant configuration from file and passes it to the Consumer.</p>
<p>The <cite>Consumer</cite> has two main tasks:</p>
<ul class="simple">
<li><p>creating the OpenC2 stack to process Messages (namely the combination of an Encoding format and a Transfer protocol);</p></li>
<li><p>dispatching incoming <cite>Command`s to the relevant `Actuator</cite>.</p></li>
</ul>
<p>Each <cite>Consumer</cite> will only run a single <cite>Transfer</cite> protocol. All registered <cite>Encoder`s can be used,
and a default `Encoder</cite> is explicitely given that will be used when no other selection is available 
(e.g., to answer Messages that the Consumer does not understand).</p>
<p class="rubric">Methods</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#otupy.core.consumer.Consumer.dispatch" title="otupy.core.consumer.Consumer.dispatch"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dispatch</span></code></a></p></td>
<td><p>Dispatches Commands to Actuators</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#otupy.core.consumer.Consumer.run" title="otupy.core.consumer.Consumer.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
<td><p>Runs a <cite>Consumer</cite></p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt class="sig sig-object py" id="otupy.core.consumer.Consumer.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">consumer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">actuators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="otupy.core.encoder.Encoder.html#otupy.core.encoder.Encoder" title="otupy.core.encoder.Encoder"><span class="pre">Encoder</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="otupy.core.transfer.Transferclass.html#otupy.core.transfer.Transfer" title="otupy.core.transfer.Transfer"><span class="pre">Transfer</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#otupy.core.consumer.Consumer.__init__" title="Link to this definition"></a></dt>
<dd><p>Create a <cite>Consumer</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>consumer</strong> – This is a string that identifies the <cite>Consumer</cite> and is used in <cite>from</cite> 
and <cite>to</cite> fields of the OpenC2 <cite>Message</cite> (see Table 3.1 of the Language Specification.</p></li>
<li><p><strong>actuators</strong> – This must be a list of available <cite>Actuator</cite>s. The list contains the
<cite>Actuator</cite> instances that will be used by the <cite>Consumer</cite>.</p></li>
<li><p><strong>encoder</strong> – This is an instance of the <cite>Encoder</cite> that will be used by default.</p></li>
<li><p><strong>transfer</strong> – This is the <cite>Transfer</cite> protocol that will be used to send/receive <cite>Message</cite>s.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otupy.core.consumer.Consumer.dispatch">
<span class="sig-name descname"><span class="pre">dispatch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#otupy.core.consumer.Consumer.dispatch" title="Link to this definition"></a></dt>
<dd><p>Dispatches Commands to Actuators</p>
<p>This method scans the actuator profile carried in the <cite>Command</cite> and select one or more
<cite>Actuator`s that will process the `Command</cite>.</p>
<p>The current implementation is only meant to be used within the
implementation of <cite>Transfer</cite> protocols as a callback for returning control to the main code.
This approach is motivated by those Transfer protocols that replies to messages on the same 
TCP connection, so to avoid errors with NAT and firewalls 
(if a Command were passed back from the <cite>Transfer.receive()</cite> and processed within the <cite>Consumer.run()</cite>, 
the following <cite>Transfer.send()</cite> would use a different TCP connection).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>msg</strong> – The full otupy <cite>Message</cite> that embeds the <cite>Command</cite> to be processed.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <cite>Message</cite> that embeds the <cite>Response</cite> (from the <cite>Actuator</cite> or elaborated by the <cite>Consumer</cite> in
case of errors).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="otupy.core.consumer.Consumer.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="otupy.core.encoder.Encoder.html#otupy.core.encoder.Encoder" title="otupy.core.encoder.Encoder"><span class="pre">Encoder</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transfer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="otupy.core.transfer.Transferclass.html#otupy.core.transfer.Transfer" title="otupy.core.transfer.Transfer"><span class="pre">Transfer</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#otupy.core.consumer.Consumer.run" title="Link to this definition"></a></dt>
<dd><p>Runs a <cite>Consumer</cite></p>
<p>This is the entry point of the <cite>Consumer</cite>. It must be invoked to start operation of the <cite>Consumer</cite>.
This method may be blocking, depending on the implementation of the <cite>receive()</cite> method of the 
used <cite>Transfer</cite>.</p>
<p>The arguments of this method can be used to create multiple OpenC2 stacks (e.g., using 
different <cite>Encoder`s and `Transfer`s). This feature clearly requires the `Transfer</cite> 
implementation to be non-blocking.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>encoder</strong> – A different <cite>Encoder</cite> that might be passed to overwrite what set at initialization time.</p></li>
<li><p><strong>transfer</strong> – A different <cite>Transfer</cite> that might be passed to overwrite what set at initialization time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="otupy.core.consumer.html" class="btn btn-neutral float-left" title="otupy.core.consumer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="otupy.core.content.html" class="btn btn-neutral float-right" title="otupy.core.content" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Matteo Repetto.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>